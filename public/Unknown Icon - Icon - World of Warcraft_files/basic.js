WH.dataEnv={MAIN:1,PTR:2,BETA:3,CLASSIC:4,TBC:5};WH.dataEnvTerm={1:"live",2:"ptr",3:"beta",4:"classic",5:"burningCrusade"};WH.dataTree={RETAIL:1,CLASSIC:4,TBC:5};WH.dataTreeTerm={1:"live",4:"classic",5:"burningCrusade"};WH.dataEnvToTree={};WH.dataEnvToTree[WH.dataEnv.MAIN]=WH.dataTree.RETAIL;WH.dataEnvToTree[WH.dataEnv.PTR]=WH.dataTree.RETAIL;WH.dataEnvToTree[WH.dataEnv.BETA]=WH.dataTree.RETAIL;WH.dataEnvToTree[WH.dataEnv.CLASSIC]=WH.dataTree.CLASSIC;WH.dataEnvToTree[WH.dataEnv.TBC]=WH.dataTree.TBC;WH.dataTreeToRoot={};WH.dataTreeToRoot[WH.dataTree.RETAIL]=WH.dataEnv.MAIN;WH.dataTreeToRoot[WH.dataTree.CLASSIC]=WH.dataEnv.CLASSIC;WH.dataTreeToRoot[WH.dataTree.TBC]=WH.dataEnv.TBC;WH.BETA_DOMAIN="shadowlands";if(WH.staticUrl===undefined){WH.staticUrl="https://wow.zamimg.com"}WH.Types=new function(){const h=this;this.NPC=1;this.OBJECT=2;this.ITEM=3;this.ITEM_SET=4;this.QUEST=5;this.SPELL=6;this.ZONE=7;this.FACTION=8;this.PET=9;this.ACHIEVEMENT=10;this.TITLE=11;this.EVENT=12;this.CLASS=13;this.RACE=14;this.SKILL=15;this.CURRENCY=17;this.PROJECT=18;this.SOUND=19;this.BUILDING=20;this.FOLLOWER=21;this.MISSION_ABILITY=22;this.MISSION=23;this.SHIP=25;this.THREAT=26;this.RESOURCE=27;this.CHAMPION=28;this.ICON=29;this.ORDER_ADVANCEMENT=30;this.FOLLOWER_A=31;this.FOLLOWER_H=32;this.SHIP_A=33;this.SHIP_H=34;this.CHAMPION_A=35;this.CHAMPION_H=36;this.TRANSMOG_ITEM=37;this.BFA_CHAMPION=38;this.BFA_CHAMPION_A=39;this.AFFIX=40;this.BFA_CHAMPION_H=41;this.AZERITE_ESSENCE_POWER=42;this.AZERITE_ESSENCE=43;this.STORYLINE=44;this.ADVENTURE_COMBATANT_ABILITY=46;this.ENCOUNTER=47;this.COVENANT=48;this.SOULBIND=49;this.PET_ABILITY=200;this.SCREENSHOT=91;this.GUIDE_IMAGE=98;this.GUIDE=100;this.TRANSMOG_SET=101;this.OUTFIT=110;this.GEAR_SET=111;this.LISTVIEW=158;this.SURVEY_COVENANTS=161;const e=[this.NPC,this.OBJECT,this.ITEM,this.ITEM_SET,this.QUEST,this.SPELL,this.ZONE,this.FACTION,this.PET,this.ACHIEVEMENT,this.TITLE,this.EVENT,this.CLASS,this.RACE,this.SKILL,this.CURRENCY,this.SOUND,this.BUILDING,this.FOLLOWER,this.MISSION_ABILITY,this.MISSION,this.SHIP,this.THREAT,this.RESOURCE,this.CHAMPION,this.ICON,this.ORDER_ADVANCEMENT,this.BFA_CHAMPION,this.AFFIX,this.AZERITE_ESSENCE_POWER,this.AZERITE_ESSENCE,this.STORYLINE,this.ADVENTURE_COMBATANT_ABILITY,this.PET_ABILITY];const a=function(){let types={};types[WH.dataTree.RETAIL]=[h.ACHIEVEMENT,h.ADVENTURE_COMBATANT_ABILITY,h.AFFIX,h.AZERITE_ESSENCE,h.AZERITE_ESSENCE_POWER,h.BFA_CHAMPION,h.BUILDING,h.CHAMPION,h.CLASS,h.CURRENCY,h.EVENT,h.FACTION,h.FOLLOWER,h.GUIDE,h.GUIDE_IMAGE,h.ICON,h.ITEM,h.ITEM_SET,h.LISTVIEW,h.MISSION,h.MISSION_ABILITY,h.NPC,h.OBJECT,h.ORDER_ADVANCEMENT,h.OUTFIT,h.PET,h.PET_ABILITY,h.QUEST,h.RACE,h.RESOURCE,h.SCREENSHOT,h.SHIP,h.SKILL,h.SOUND,h.SPELL,h.STORYLINE,h.THREAT,h.TITLE,h.TRANSMOG_SET,h.ZONE];types[WH.dataTree.CLASSIC]=[h.CLASS,h.FACTION,h.GEAR_SET,h.GUIDE,h.GUIDE_IMAGE,h.ICON,h.ITEM,h.ITEM_SET,h.LISTVIEW,h.NPC,h.OBJECT,h.OUTFIT,h.PET,h.QUEST,h.RACE,h.RESOURCE,h.SCREENSHOT,h.SKILL,h.SOUND,h.SPELL,h.ZONE];types[WH.dataTree.TBC]=[h.CLASS,h.FACTION,h.GUIDE,h.GUIDE_IMAGE,h.ICON,h.ITEM,h.ITEM_SET,h.LISTVIEW,h.NPC,h.OBJECT,h.OUTFIT,h.PET,h.QUEST,h.RACE,h.RESOURCE,h.SCREENSHOT,h.SKILL,h.SOUND,h.SPELL,h.ZONE];return types}();const g=0;const j=1;const c=2;const d=3;const f={typeNames:undefined};this.existsInDataEnv=function(l){return a[WH.getDataTree()].includes(l)};this.getGameEntityTypes=function(){return e.slice()};this.getRequiredTrees=function(l){let result=[];let wasMissing=false;for(let tree in a){if(!a.hasOwnProperty(tree)){continue}if(a[tree].includes(l)){result.push(parseInt(tree))}else{wasMissing=true}}return wasMissing?result:null};this.hasName=function(l){return f.typeNames.hasOwnProperty(l)};this.getLowerPlural=function(l){return b(l)[d]};this.getLowerSingular=function(l){return b(l)[j]};this.getUpperPlural=function(l){return b(l)[c]};this.getUpperSingular=function(l){return b(l)[g]};function b(l){if(f.typeNames===undefined){f.typeNames=WH.getPageData("WH.Types.names")||{}}return f.typeNames[l]||Array(4).fill(WH.term("unknownType_format",l),0,4)}};if(typeof Object.assign!=="function"){Object.defineProperty(Object,"assign",{value:function assign(b,a){if(b===null||b===undefined){throw new TypeError("Cannot convert undefined or null to object")}let to=Object(b);for(let index=1;index<arguments.length;index++){let nextSource=arguments[index];if(nextSource!==null&&nextSource!==undefined){for(let nextKey in nextSource){if(Object.prototype.hasOwnProperty.call(nextSource,nextKey)){to[nextKey]=nextSource[nextKey]}}}}return to},writable:true,configurable:true})}if(!String.prototype.ltrim){String.prototype.ltrim=function(){return this.replace(/^\s*/,"")}}if(!String.prototype.rtrim){String.prototype.rtrim=function(){return this.replace(/\s*$/,"")}}if(!String.prototype.repeat){String.prototype.repeat=function(a){if(this==null){throw new TypeError("can't convert "+this+" to object")}var c=""+this;a=+a;if(a!=a){a=0}if(a<0){throw new RangeError("repeat count must be non-negative")}if(a==Infinity){throw new RangeError("repeat count must be less than infinity")}a=Math.floor(a);if(c.length==0||a==0){return""}if(c.length*a>=1<<28){throw new RangeError("repeat count must not overflow maximum string size")}var b=c.length*a;a=Math.floor(Math.log(a)/Math.log(2));while(a){c+=c;a--}c+=c.substring(0,b-c.length);return c}}if(!Array.prototype.includes){Object.defineProperty(Array.prototype,"includes",{value:function(b,c){if(this==null){throw new TypeError('"this" is null or not defined')}let o=Object(this);let len=o.length>>>0;if(len===0){return false}let n=c|0;let k=Math.max(n>=0?n:len-Math.abs(n),0);function a(d,e){return d===e||(typeof d==="number"&&typeof e==="number"&&isNaN(d)&&isNaN(e))}while(k<len){if(a(o[k],b)){return true}k++}return false}})}if(Element.prototype.getAttributeNames==undefined){Element.prototype.getAttributeNames=function(){var b=this.attributes;var d=b.length;var a=new Array(d);for(var c=0;c<d;c++){a[c]=b[c].name}return a}}if(!Math.sign){Math.sign=function(a){return((a>0)-(a<0))||+a}}if(window.NodeList&&!NodeList.prototype.forEach){NodeList.prototype.forEach=Array.prototype.forEach}if(window.DOMTokenList&&!DOMTokenList.prototype.forEach){DOMTokenList.prototype.forEach=Array.prototype.forEach}WH.error=function(a){console.error.apply(console.error,Array.prototype.slice.call(arguments));if(!a){console.error("The error message was empty, and thus will not be logged.");return}if(WH.Track){WH.Track.nonInteractiveEvent.apply(WH.Track,["Error"].concat(Array.prototype.slice.call(arguments)))}};WH.info=function(a){console.info.apply(console.info,Array.prototype.slice.call(arguments))};WH.log=function(a){console.log.apply(console.log,Array.prototype.slice.call(arguments))};WH.warn=function(a){console.warn.apply(console.warn,Array.prototype.slice.call(arguments))};(function(){const a={};WH.getPageData=function(b){if(WH.wowheadRemote){return undefined}if(a.hasOwnProperty(b)){return a[b]}let script=document.querySelector(("script#data."+b).replace(/\./g,"\\."));if(script){return JSON.parse(script.innerHTML)}return undefined};WH.setPageData=function(b,c){if(a.hasOwnProperty(b)){WH.warn("Duplicate data key",b)}a[b]=c}})();Object.assign(WH.PageMeta,WH.getPageData("pageMeta")||{});WH.PageMeta.serverTime=WH.PageMeta.serverTime?new Date(WH.PageMeta.serverTime):new Date();if(WH.PageMeta.staticUrl!==undefined){WH.staticUrl=WH.PageMeta.staticUrl}WH.setValueOnObject=function(a,b,c,d){if(["string","number"].includes(typeof b)){a[b]=c;return true}if(!(b instanceof Array)){WH.error("Invalid key type passed to WH.setValueOnObject:",typeof b,a,b,c);return false}if(b.length<1){WH.error("WH.setValueOnObject called with an empty key list:",a,b,c);return false}while(b.length>1){let nextKey=b.shift();if(typeof a[nextKey]==="undefined"){a[nextKey]={}}if(typeof a[nextKey]!=="object"){WH.error("Dead end while setting value on object.",a,b,c);return false}a=a[nextKey]}if(d){let key=b.shift();if(typeof a[key]==="undefined"){a[key]=c}}else{a[b.shift()]=c}return true};WH.normalizeEvent=function(a){if(!a){if(typeof window.event!="undefined"){a=window.event}else{return null}}if(a.which){a._button=a.which}else{a._button=a.button+1}a._target=a.target||a.srcElement;return a};WH.stringCompare=function(d,c){if(d==c){return 0}if(d==null){return-1}if(c==null){return 1}var f=parseFloat(d);var e=parseFloat(c);if(!isNaN(f)&&!isNaN(e)&&f!=e){return f<e?-1:1}if(typeof d=="string"&&typeof c=="string"){return d.localeCompare(c,undefined,{numeric:true})}return d<c?-1:1};WH.trim=function(a){return a.replace(/(^\s*|\s*$)/g,"")};WH.rtrim=function(b,c){var a=b.length;while(--a>0&&b.charAt(a)==c){}b=b.substring(0,a+1);if(b==c){b=""}return b};WH.sprintf=function(c){if(typeof c!=="string"){WH.error("No format passed to WH.sprintf.",c);return""}for(var b=1,a=arguments.length;b<a;++b){c=c.replace("$"+b,arguments[b])}return c};WH.sprintfGlobal=function(c){for(var b=1,a=arguments.length;b<a;++b){c=c.replace(new RegExp("\\$"+b,"g"),arguments[b])}return c};WH.stringReplace=function(c,b,a){while(c.indexOf(b)!=-1){c=c.replace(b,a)}return c};WH.term=function(a){if(!WH.TERMS){return a}let args=[WH.TERMS[a]].concat(Array.prototype.slice.call(arguments,1));return WH.Strings.sprintf.apply(null,args)};WH.wowTerm=function(a){if(!WH.GlobalStrings){return a}let args=[WH.GlobalStrings[a]].concat(Array.prototype.slice.call(arguments,1));return WH.Strings.sprintf.apply(null,args)};WH.htmlEntities=function(a){return a.replace(/[\u00A0-\u9999<>\&]/gim,function(b){return"&#"+b.charCodeAt(0)+";"})};WH.stub=function(a){let classNames=a.split(".");let currentClass=WH;for(let i=0,className;className=classNames[i];i++){if(!currentClass[className]){currentClass[className]={}}currentClass=currentClass[className]}};WH.urlEncode=function(a){a=encodeURIComponent(a);a=WH.stringReplace(a,"+","%2B");return a};WH.urlEncodeHref=function(a){a=encodeURIComponent(a);a=WH.stringReplace(a,"%20","+");a=WH.stringReplace(a,"%3D","=");return a};WH.numberFormat=function(b){var c=(""+parseFloat(b)).split(".");b=c[0];var a=c.length>1?"."+c[1]:"";if(b.length<=3){return b+a}return WH.numberFormat(b.substr(0,b.length-3))+","+b.substr(b.length-3)+a};WH.numberLocaleFormat=function(d,b){var c="";if(typeof b=="number"){c=Locale.locales[b].name}else{if(typeof b=="string"){c=b}else{c=Locale.getName()}}if(c.length==4){c=c.substr(0,2).toLowerCase()+"-"+c.substr(2).toUpperCase()}var a=""+d;try{a=d.toLocaleString(c)}catch(f){a=d.toLocaleString()}return a};WH.inArray=function(f,g,b,e){if(f==null){return-1}if(!Array.isArray(f)){WH.error("Tried looking for a value in a haystack which is not an array.",arguments);return-1}var a;if(b){a=f.length;for(var d=e||0;d<a;++d){if(b(f[d])==g){return d}}return-1}a=f.indexOf(g,e);if(a>=0){return a}a=f.length;for(var c=e||0;c<a;++c){if(f[c]==g){return c}}return-1};WH.isSet=function(a){return typeof window[a]!=="undefined"};if(!WH.isSet("console")){var console={log:function(){}}}WH.arrayWalk=function(f,e,c){for(var d=0,b=f.length;d<b;++d){var a=e(f[d],c,f,d);if(a!=null){f[d]=a}}};WH.arrayApply=function(e,d,b){for(var c=0,a=e.length;c<a;++c){d(e[c],b,e,c)}};WH.arrayFilter=function(e,d){var b=[];for(var c=0,a=e.length;c<a;++c){if(d(e[c])){b.push(e[c])}}return b};WH.arrayUnique=function(e){var b={};for(var c=e.length-1;c>=0;--c){b[e[c]]=1}var a=[];for(var d in b){a.push(d)}return a};WH.closest=function(b,a){while(b&&b.nodeType===Node.ELEMENT_NODE){if(b.matches(a)){return b}b=b.parentNode}return undefined};WH.ge=function(a){if(typeof a!="string"){return a}return document.getElementById(a)};WH.gE=function(b,a){return b.getElementsByTagName(a)};WH.qs=function(a,b){return(b||document).querySelector(a)};WH.qsa=function(a,b){return(b||document).querySelectorAll(a)};WH.ce=function(a,b,c){};WH.ce=(function(a){return function(b,d,e){var c=a(b);if(d){WH.cOr(c,d)}if(e){WH.ae(c,e)}if(c.tagName==="INPUT"&&c.type==="range"&&!WH.isRemote()&&WH.DOM){WH.DOM.styleRangeElement(c)}return c}})(typeof document.createElementOriginal==="function"?document.createElementOriginal.bind(document):document.createElement.bind(document));WH.de=function(b,a){if(typeof b==="string"){b=(a||document).querySelector(b)}if(b&&b.parentNode){b.parentNode.removeChild(b)}};WH.ae=function(a,b){if(Array.isArray(b)){WH.arrayApply(b,a.appendChild.bind(a));return b}else{return a.appendChild(b)}};WH.aef=function(a,b){return a.insertBefore(b,a.firstChild)};WH.ee=function(b,a){if(!a){a=0}while(b.childNodes[a]){b.removeChild(b.childNodes[a])}};WH.ct=function(a){return document.createTextNode(a)};WH.st=function(a,b){if(a.firstChild&&a.firstChild.nodeType==3){a.firstChild.nodeValue=b}else{WH.aef(a,WH.ct(b))}};WH.noWrap=function(a){a.style.whiteSpace="nowrap"};WH.rf=function(){return false};WH.rfWithoutControlKey=function(a){a=WH.normalizeEvent(a);if(a.ctrlKey||a.shiftKey||a.altKey||a.metaKey){return}return false};WH.aE=function(c,b,d,a){if(typeof c==="string"){c=document.querySelector(c)}if(c){c.addEventListener(b,d,a||false)}};WH.dE=function(c,b,d,a){if(typeof c==="string"){c=document.querySelector(c)}if(c){c.removeEventListener(b,d,a||false)}};WH.preventSelectStart=function(a){a.dataset.preventSelectStart="true"};WH.sp=function(a){if(!a){a=window.event}a.stopPropagation()};WH.setCookie=function(b,g,e,f,d){var a=new Date();var c=b+"="+encodeURI(e)+"; ";a.setDate(a.getDate()+g);c+="expires="+a.toUTCString()+"; ";if(f){c+="path="+f+"; "}if(d){c+="domain="+d+"; "}document.cookie=c;WH.getCookies(b);WH.getCookies.C[b]=e};WH.deleteCookie=function(a){WH.setCookie(a,-1);WH.getCookies.C[a]=null};WH.getCookies=function(b){if(WH.getCookies.I==null){var e=decodeURI(document.cookie).split("; ");WH.getCookies.C={};for(var c=0,a=e.length;c<a;++c){var g=e[c].indexOf("="),f,d;if(g!=-1){f=e[c].substr(0,g);d=e[c].substr(g+1)}else{f=e[c];d=""}WH.getCookies.C[f]=d}WH.getCookies.I=1}if(!b){return WH.getCookies.C}else{return WH.getCookies.C[b]}};WH.dO=function(a){return WH.cO({},a)};WH.cO=function(c,b){for(var a in b){if(b[a]!==null&&typeof b[a]=="object"&&b[a].length){c[a]=b[a].slice(0)}else{c[a]=b[a]}}return c};WH.cOr=function(d,c,b){for(var a in c){if(b&&(a.substr(0,b.length)==b)){continue}if(c[a]!==null&&typeof c[a]=="object"){if(Array.isArray(c[a])){d[a]=c[a].slice(0)}else{if(!d[a]){d[a]={}}WH.cOr(d[a],c[a],b)}}else{d[a]=c[a]}}return d};WH.fround=function(b){if(Math.fround){return Math.fround(b)}else{if(typeof Float32Array!="undefined"&&Float32Array){var a=new Float32Array(1);a[0]=+b;return a[0]}else{return b}}};WH.displayBlock=function(b,a){if(typeof b==="string"){b=(a||document).querySelector(b);if(!b){return}}b.style.display="block"};WH.displayDefault=function(b,a){if(typeof b==="string"){b=(a||document).querySelector(b);if(!b){return}}b.style.removeProperty("display")};WH.displayInline=function(b,a){if(typeof b==="string"){b=(a||document).querySelector(b);if(!b){return}}b.style.display="inline"};WH.displayNone=function(b,a){if(typeof b==="string"){b=(a||document).querySelector(b);if(!b){return}}b.style.display="none"};WH.setData=function(b,d,c,a){let elements;if(typeof b==="string"){elements=(a||document).querySelectorAll(b)}else{if(b){if(b.dataset){elements=[b]}else{if(b.length){elements=b}else{WH.error("Element not supported by WH.setData().",d,c,b,a);return}}}else{WH.error("No element passed to WH.setData().",d,c,b,a);return}}if(c==null){for(let i=0,b;b=elements[i];i++){delete b.dataset[d]}}else{for(let i=0,b;b=elements[i];i++){b.dataset[d]=c}}};WH.Browser={ie:!!(window.attachEvent&&!window.opera)||!!window.MSInputMethodContext,opera:!!window.opera,safari:navigator.userAgent.indexOf("Safari")!=-1,firefox:navigator.userAgent.indexOf("Firefox")!=-1,chrome:navigator.userAgent.indexOf("Chrome")!=-1};WH.getWindowSize=function(){var b=0,a=0;if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){b=document.documentElement.clientWidth;a=document.documentElement.clientHeight}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){b=document.body.clientWidth;a=document.body.clientHeight}else{if(typeof window.innerWidth=="number"){b=window.innerWidth;a=window.innerHeight}}}return{w:b,h:a}};WH.getScroll=function(){if(typeof window.scrollY!=="number"){return{x:window.pageXOffset,y:window.pageYOffset}}return{x:window.scrollX,y:window.scrollY}};WH.getCursorPos=function(c){var b,d;if(window.innerHeight){b=c.pageX;d=c.pageY}else{var a=WH.getScroll();b=c.clientX+a.x;d=c.clientY+a.y}return{x:b,y:d}};WH.ac=function(b,a){let x=0;let y=0;while(b){let match;if(b.style.transform&&(match=b.style.transform.match(/scale\(([\d.]+)\)/i))){x*=parseFloat(match[1]);y*=parseFloat(match[1])}x+=b.offsetLeft;y+=b.offsetTop;let parent=b.parentNode;while(parent&&parent!==b.offsetParent&&parent.offsetParent){if(parent.scrollLeft||parent.scrollTop){x-=(parent.scrollLeft|0);y-=(parent.scrollTop|0);break}parent=parent.parentNode}b=b.offsetParent}if(window.Lightbox&&Lightbox.isVisible()){a=true}if(a){let scroll=WH.getScroll();x+=scroll.x;y+=scroll.y}let result=[x,y];result.x=x;result.y=y;return result};WH.getOffset=function(a,b){let rect=a.getBoundingClientRect();let offset={left:rect.left,top:rect.top};if(b!==true){let scroll=WH.getScroll();offset.left+=scroll.x;offset.top+=scroll.y}return offset};WH.scrollTo=function(d,a,b){if(typeof d==="string"){var c=document.querySelector(d);if(!c){WH.error("Could not select element to scroll to.",d);return}d=c}if(!d||d.nodeType!==Node.ELEMENT_NODE){WH.error("Invalid target to scroll to.",d);return}d.scrollIntoView({behavior:b===false?"auto":"smooth",block:typeof a==="string"?a:"start"})};WH.isElementFixedPosition=function(a){while(a&&a.nodeType===Node.ELEMENT_NODE){if(getComputedStyle(a).getPropertyValue("position")==="fixed"){return true}a=a.parentNode}return false};WH.createReverseLookupJson=function(c){var a={};for(var b in c){a[c[b]]=b}return a};WH.getLocaleFromDomain=function(a){var c=WH.getLocaleFromDomain.L;if(a&&(typeof a=="string")){var b=a.split(".");return c[b[0]]||0}return 0};WH.getLocaleFromDomain.L={ko:1,fr:2,de:3,cn:4,es:6,ru:7,pt:8,it:9};WH.getDomainFromLocale=function(a){var b;if(WH.getDomainFromLocale.L){b=WH.getDomainFromLocale.L}else{b=WH.getDomainFromLocale.L=WH.createReverseLookupJson(WH.getLocaleFromDomain.L)}return(b[a]?b[a]:"")};WH.getTypeIdFromTypeString=function(a){if(!WH.getTypeIdFromTypeString.lookup[a]){WH.error("No type ID found for type string ["+a+"].");return-1}return WH.getTypeIdFromTypeString.lookup[a]};WH.getTypeIdFromTypeString.lookup={mount:-1000,recipe:-1001,"battle-pet":-1002,npc:1,object:2,item:3,itemset:4,"item-set":4,quest:5,spell:6,zone:7,faction:8,pet:9,achievement:10,title:11,event:12,statistic:16,currency:17,building:20,follower:21,garrisonability:22,missionability:22,"mission-ability":22,mission:23,ship:25,threat:26,resource:27,champion:28,icon:29,"order-advancement":30,"bfa-champion":38,affix:40,"azerite-essence":43,"azerite-essence-power":42,storyline:WH.Types.STORYLINE,"adventure-combatant-ability":WH.Types.ADVENTURE_COMBATANT_ABILITY,guide:100,"transmog-set":101,outfit:110,petability:200,"pet-ability":200};WH.fetch=(function(){let convertDictionaryToUrlEncoded=function(a){let body=[];for(let key in a){if(a.hasOwnProperty(key)){body.push(encodeURIComponent(key)+"="+encodeURIComponent(a[key]))}}return body.join("&")};let getRequestContentType=function(a){if(a.contentType){return a.contentType}if(typeof a.form==="object"){return"application/x-www-form-urlencoded"}if(a.hasOwnProperty("json")){return"application/json"}if(typeof a.body==="string"){return"application/octet-stream"}return undefined};if(typeof window.fetch!=="function"){let onXhrLoad=function(b,a,d){let xhr=this;let data=xhr.responseText;let isJsonResponse=(xhr.getResponseHeader("content-type")||"").indexOf("application/json")===0;let error=null;if(xhr.status<200||xhr.status>399){error="Legacy WH.fetch call got a bad response code."}else{if(isJsonResponse){try{data=JSON.parse(data)}catch(c){data=undefined;error="Could not process Legacy WH.fetch JSON response. "+c.message}}}if(error){WH.error(error,b,xhr.status,xhr.responseText,xhr);if(a.error){a.error(data,xhr.status)}}else{if(a.success){a.success(data,xhr.status)}}if(a.complete){a.complete(data,xhr.status)}};let onXhrError=function(b,a,c){let xhr=this;let message="Legacy WH.fetch call could not complete.";let data=xhr.responseText||undefined;WH.error(message,b,xhr.status,xhr.responseText,xhr);if(a.error){a.error(data,xhr.status)}if(a.complete){a.complete(data,xhr.status)}};return function(b,a){a=a||{};if(a.query){b+=(b.indexOf("?")>-1?"&":"?")+WH.Url.buildQuery(a.query)}let method=a.method||"GET";if(a.hasOwnProperty("data")||(typeof a.body==="string")){method=a.method||"POST"}let request=new XMLHttpRequest();WH.aE(request,"load",onXhrLoad.bind(request,b,a));WH.aE(request,"error",onXhrError.bind(request,b,a));request.overrideMimeType("text/plain");request.open(method,b,true);let contentType=getRequestContentType(a);if(contentType){request.setRequestHeader("Content-Type",contentType)}if(typeof a.form==="object"){request.send(convertDictionaryToUrlEncoded(a.form))}else{if(a.hasOwnProperty("json")){request.send(JSON.stringify(a.json))}else{if(typeof a.body==="string"){request.send(a.body)}else{request.send()}}}}}let onFetchResponsePromise=function(c,b,a,d){if(!a.ok){WH.error("WH.fetch call got a bad response code.",c,a.status,d,a);if(b.error){b.error(d,a.status)}}else{if(b.success){b.success(d,a.status)}}if(b.complete){b.complete(d,a.status)}};let onFetchResponsePromiseError=function(c,b,a,d){let message="Could not process WH.fetch response. "+d.message;WH.error(message,c,a.status,"",a);if(b.error){b.error(undefined,a.status)}if(b.complete){b.complete(undefined,a.status)}};let onFetch=function(c,b,a){let jsonResponse=(a.headers.get("content-type")||"").indexOf("application/json")===0;(jsonResponse?a.json():a.text()).then(onFetchResponsePromise.bind(null,c,b,a))["catch"](onFetchResponsePromiseError.bind(null,c,b,a))};let onFetchError=function(b,a,c){let message="WH.fetch call could not complete. "+c.message;WH.error(message,b,0,"",c);if(a.error){a.error(undefined,0,c.message)}if(a.complete){a.complete(undefined,0,c.message)}};return function(b,a){a=a||{};if(a.query){b+=(b.indexOf("?")>-1?"&":"?")+WH.Url.buildQuery(a.query)}let useCookies=typeof a.cookies==="boolean"?a.cookies:true;let fetchOptions={credentials:useCookies?"same-origin":"omit",headers:new Headers(),method:a.method||"GET",mode:a.mode||"same-origin"};let contentType=getRequestContentType(a);if(contentType){fetchOptions.headers.set("Content-Type",contentType)}if(typeof a.form==="object"){fetchOptions.method=a.method||"POST";fetchOptions.body=convertDictionaryToUrlEncoded(a.form)}else{if(a.hasOwnProperty("json")){fetchOptions.method=a.method||"POST";fetchOptions.body=JSON.stringify(a.json)}else{if(typeof a.body==="string"){fetchOptions.method=a.method||"POST";fetchOptions.body=a.body}}}fetch(b,fetchOptions).then(onFetch.bind(null,b,a))["catch"](onFetchError.bind(null,b,a))}})();WH.ajaxIshRequest=function(c,e){var d=document.getElementsByTagName("head")[0];if(c.substr(0,5)==="http:"&&location.protocol==="https:"){WH.error("Refused to AJAX-ish load URL.",c);return undefined}if(e){var a=WH.ce("script",{type:"text/javascript",src:c});WH.ae(d,a);return a}var b=WH.getGets();if(b.refresh!=null){if(b.refresh.length){c+=("&refresh="+b.refresh)}else{c+="&refresh"}}if(b.locale!=null){c+="&locale="+b.locale}if(b.ptr!=null){c+="&ptr"}var a=WH.ce("script",{type:"text/javascript",src:c,charset:"utf8"});WH.ae(d,a);return a};WH.xhrJsonRequest=function(a,c){var b=new XMLHttpRequest();b.onload=function(d){var f=d.target.response;switch(d.target.responseType){case"json":break;case"":case"text":try{f=JSON.parse(f)}catch(g){WH.error("Could not parse expected JSON response",d.target);return c()}break;default:WH.error("Unexpected response type from JSON request",d.target);return c()}return c(f)};b.onerror=function(){return c()};b.open("GET",a,true);b.responseType="json";b.send()};WH.getGets=function(){if(WH.getGets.C!=null){return WH.getGets.C}var b=WH.getQueryString();var a=WH.parseQueryString(b);WH.getGets.C=a;return a};WH.visitUrlWithPostData=function(b,d){var c=WH.ce("form");c.action=b;c.method="post";for(var a in d){if(d.hasOwnProperty(a)){var e=WH.ce("input");e.type="hidden";e.name=a;e.value=d[a];WH.ae(c,e)}}WH.ae(document.body,c);c.submit()};WH.getQueryString=function(){var a="";if(location.pathname){a+=location.pathname.substr(1)}if(location.search){if(location.pathname){a+="&"}a+=location.search.substr(1)}return a};WH.parseQueryString=function(e){e=decodeURIComponent(e).replace(/^\?+/,"");var d=e.split("&");var c={};for(var b=0,a=d.length;b<a;++b){WH.splitQueryParam(d[b],c)}return c};WH.splitQueryParam=function(c,d){if(c===""){return}var e=c.indexOf("=");var a;var b;if(e!=-1){a=c.substr(0,e);b=c.substr(e+1)}else{a=c;b=""}d[a]=b};WH.createRect=function(d,c,b,a){return{l:d,t:c,r:d+b,b:c+a}};WH.intersectRect=function(d,c){return!(d.l>=c.r||c.l>=d.r||d.t>=c.b||c.t>=d.b)};WH.getViewport=function(){var a=$(window);return new Rectangle(a.scrollLeft(),a.scrollTop(),a.width(),a.height())};WH.keyPressIsAlphaNumeric=function(b){var a=document.all?b.keycode:b.which;return((a>47&&a<58)||(a>64&&a<91)||(a>95&&a<112)||a==222||a==0)};WH.isRemote=function(){return!WH.PageMeta.wowhead};WH.isDev=function(){return!!WH.PageMeta.dev};WH.getDataEnv=function(){return WH.PageMeta.hasOwnProperty("dataEnv")?WH.PageMeta.dataEnv.env:WH.dataEnv.MAIN};WH.getDataEnvFromTerm=function(a){for(let dataEnv in WH.dataEnvTerm){if(WH.dataEnvTerm[dataEnv]===a){return parseInt(dataEnv)}}return undefined};WH.getDataEnvTerm=function(a){return WH.dataEnvTerm[a||WH.getDataEnv()]};WH.getDataTree=function(a){if(a!==undefined){return WH.dataEnvToTree[a]}return WH.PageMeta.hasOwnProperty("dataEnv")?WH.PageMeta.dataEnv.tree:WH.dataTree.RETAIL};WH.getDataTreeTerm=function(a){if(typeof a==="undefined"){a=WH.getDataTree()}if(a===WH.dataTree.CLASSIC){return"classic"}if(a===WH.dataTree.TBC){return"burningCrusade"}return"live"};WH.getRootEnv=function(a){return WH.dataTreeToRoot[WH.getDataTree(a||WH.getDataEnv())]};WH.getServerTime=function(){return WH.PageMeta.serverTime};WH.getDataBuild=function(a){return(WH.PageMeta.dataBuild&&WH.PageMeta.dataBuild[a||WH.getDataEnv()])||"0"};WH.isBeta=function(){return WH.getDataEnv()===WH.dataEnv.BETA};WH.isBetaActive=function(){if(WH.PageMeta.hasOwnProperty("dataEnv")){return WH.PageMeta.dataEnv.active.beta}return!!WH.wowheadRemote};WH.isBurningCrusadeActive=function(){if(WH.PageMeta.hasOwnProperty("dataEnv")){return WH.PageMeta.dataEnv.active.burningCrusade}return!!WH.wowheadRemote};WH.isClassicTree=function(a){return WH.getDataTree(a)===WH.dataTree.CLASSIC};WH.isBurningCrusadeTree=function(a){return WH.getDataTree(a)===WH.dataTree.TBC};WH.isPtr=function(){return WH.getDataEnv()===WH.dataEnv.PTR};WH.isPtrActive=function(){if(WH.PageMeta.hasOwnProperty("dataEnv")){return WH.PageMeta.dataEnv.active.ptr}return!!WH.wowheadRemote};WH.isRetailTree=function(a){return WH.getDataTree(a)===WH.dataTree.RETAIL};WH.suppressExternalDebug=function(){return!!WH.PageMeta.suppressExternalDebug};WH.setupFooterMenus=function(){var b={"footer-help-menu":mn_footer_help,"footer-tools-menu":mn_footer_tools,"footer-about-menu":mn_footer_about};for(var c in b){if(!b.hasOwnProperty(c)){continue}var a=$("#"+c);if(a.length){a.addClass("hassubmenu");Menu.add(a.get(0),b[c])}}};WH.getScreenshotUrl=function(f,c,b){if(!c){c="normal"}b=b||{};var a=c=="normal"&&typeof b.description=="string"&&b.description?"-"+WH.Strings.slug(b.description,true):"";var d={2:".jpg",3:".png",18:".webp"};var e=d[b.imageType||2]||d[2];return WH.staticUrl+"/uploads/screenshots/"+c+"/"+f+a+e};WH.maxLevel=WH.maxLevel||60;WH.maxSkill=WH.maxSkill||900;WH.convertRatingToPercent=function(a,b,h,g){var c=WH.convertRatingToPercent.RB,d=WH.convertRatingToPercent.LH,e=WH.convertRatingToPercent.LT;if(a<0){a=1}else{if(a>WH.maxLevel){a=WH.maxLevel}}if((b==12||b==13||b==14||b==15)&&a<34){a=34}if((b==28||b==36)&&(g==2||g==6||g==7||g==11)){c[b]/=1.3}if(h<0){h=0}if(e&&e[b]&&(a>=80)&&(a-80<e[b].length)){return h/e[b][a-80]}var f;if(!c||c[b]==null){f=0}else{var j;if(a>80){j=d[a]}else{if(a>70){j=(82/52)*Math.pow((131/63),((a-70)/10))}else{if(a>60){j=(82/(262-3*a))}else{if(a>10){j=((a-8)/52)}else{j=2/52}}}}f=h/c[b]/j}return f};WH.statToRating={11:0,12:1,13:2,14:3,15:4,16:5,17:6,18:7,19:8,20:9,21:10,25:15,26:15,27:15,28:17,29:18,30:19,31:5,32:8,34:15,35:15,36:17,37:23,44:24,49:25,57:26,59:11,60:12,61:13,62:16,63:20,64:21,40:29};WH.statToJson={0:"mana",1:"health",3:"agi",4:"str",5:"int",6:"spi",7:"sta",8:"energy",9:"rage",10:"focus",13:"dodgertng",14:"parryrtng",15:"blockrtng",16:"mlehitrtng",17:"rgdhitrtng",18:"splhitrtng",19:"mlecritstrkrtng",20:"rgdcritstrkrtng",21:"splcritstrkrtng",22:"corruption",23:"corruptionres",24:"_splhitrtng",25:"_mlecritstrkrtng",26:"_rgdcritstrkrtng",27:"_splcritstrkrtng",28:"mlehastertng",29:"rgdhastertng",30:"splhastertng",31:"hitrtng",32:"critstrkrtng",33:"_hitrtng",34:"_critstrkrtng",35:"resirtng",36:"hastertng",37:"exprtng",38:"atkpwr",39:"rgdatkpwr",40:"versatility",41:"splheal",42:"spldmg",43:"manargn",44:"armorpenrtng",45:"splpwr",46:"healthrgn",47:"splpen",49:"mastrtng",50:"armorbonus",51:"firres",52:"frores",53:"holres",54:"shares",55:"natres",56:"arcres",57:"pvppower",58:"amplify",59:"multistrike",60:"readiness",61:"speedbonus",62:"lifesteal",63:"avoidance",64:"sturdiness",66:"cleave",71:"agistrint",72:"agistr",73:"agiint",74:"strint"};WH.jsonToStat={};for(var i in WH.statToJson){WH.jsonToStat[WH.statToJson[i]]=i}WH.individualToGlobalStat={16:31,17:31,18:31,19:32,20:32,21:32,24:33,25:34,26:34,27:34,28:36,29:36,30:36};WH.convertScalingFactor=function(b,g,f,d,j){var a=WH.convertScalingFactor.SV;var c=WH.convertScalingFactor.SD;if(!a||!a[b]){if(g_user.roles&U_GROUP_ADMIN){alert("There are no item scaling values for level "+b)}return(j?{}:0)}var l={},h=a[b],e=c[f];if(!e||!(d>=0&&d<=9)){l.v=h[g]}else{l.n=WH.statToJson[e[d]];l.s=e[d];l.v=Math.floor(h[g]*e[d+10]/10000)}return(j?l:l.v)};g_itemScalingCallbacks=[];WH.effectAverage=function(f,j,e,a){var c=WH.convertScalingSpell.RandPropPoints;var h=f.scalingClass;var d=f.coefficient[a];var g=1;var b=0;if(d!=0&&h!=0){if(f.scalesWithItemLevel){if(h==19){b=c[e][0]}else{if(h==21){b=c[e][2]}else{b=c[e][1]}}}else{b=WH.convertScalingSpell.SV[j][h-1]}if(h==255){g=WH.getCombatRatingMult(e,12)}return d*b*g}return f.effectBasePoints[a]};WH.convertScalingSpell=function(s,d,a,e,t,l){var f=WH.convertScalingSpell.SpellInformation;if(!f||!f[d]){return s}a=a-1;if(s.effects==undefined){s.effects={}}if(!s.effects.hasOwnProperty(a+1)){s.effects[a+1]={}}var p=f[d];var r=0;var c=WH.effectAverage(p,t,l,a);if(p.deltaCoefficient[a]!=0){var j=p.deltaCoefficient[a];var b=Math.ceil(c-(c*j/2));var q=Math.floor(c+(c*j/2));if(e==0){r=(b+q)/2}else{if(e==1){r=b}else{if(e==2){r=q}}}}else{if(p.coefficient[a]!=0){r=c}else{r=p.effectBasePoints[a]}}r=Math.abs(r);var g="avg";switch(parseInt(e)){case 0:case 3:g="avg";break;case 1:g="min";break;case 2:g="max";break;case 4:g="pts";break;default:g="avg"}var m=5;var h=m;if(window.g_pageInfo&&window.g_pageInfo.type==WH.Types.AZERITE_ESSENCE_POWER){h=WH.Wow.Item.INVENTORY_TYPE_NECK}if(p.scalesWithItemLevel&&p.appliesRatingAura&&p.appliesRatingAura[a]){r*=WH.getCombatRatingMult(l,h)}s.effects[a+1][g]=r;return s};WH.getDataSource=function(){if(WH.isSet("g_pageInfo")){switch(g_pageInfo.type){case WH.Types.ITEM:if(WH.isSet("g_items")){return g_items}break;case WH.Types.SPELL:if(WH.isSet("g_spells")){return g_spells}break;case WH.Types.AZERITE_ESSENCE_POWER:if(WH.isSet("g_azeriteEssencePowers")){return g_azeriteEssencePowers}break;case WH.Types.PET_ABILITY:if(WH.isSet("g_petabilities")){return g_petabilities}break}}return[]};WH.setJsonItemLevel=function(v,b,h){if(h&&((h.scalingcategory-11)>0)){var z=h.maxlvlscaling?Math.min(b,h.maxlvlscaling):b;var g=WH.getSpellScalingValue(h.scalingcategory,z);for(var t=1;t<3;++t){var a=h["itemenchspell"+t];var m=h["itemenchtype"+t];var p=WH.statToJson[a];if((m==5)&&v[p]){var j=h["damage"+t];if(j){v[p]=Math.round(g*j)}}}if(h.allstats){for(var w in v){v[w]=Math.round(g*h.damage1)}}}if(!v.scadist||!v.scaflags){return}v.bonuses=v.bonuses||{};var l=v.scaflags&255,d=(v.scaflags>>8)&255,q=(v.scaflags&(1<<16))!=0,f=(v.scaflags&(1<<17))!=0,r=(v.scaflags&(1<<18))!=0,s;switch(l){case 5:case 1:case 7:case 17:s=7;break;case 3:case 12:s=8;break;case 16:case 11:case 14:s=9;break;case 15:s=10;break;case 23:case 21:case 22:case 13:s=11;break;default:s=-1}if(s>=0){for(var t=0;t<10;++t){var e=WH.convertScalingFactor(b,s,v.scadist,t,1);if(e.n){v[e.n]=e.v}v.bonuses[e.s]=e.v}}if(r){v.splpwr=v.bonuses[45]=WH.convertScalingFactor(b,6)}if(q){switch(l){case 3:v.armor=WH.convertScalingFactor(b,11+d);break;case 5:v.armor=WH.convertScalingFactor(b,15+d);break;case 1:v.armor=WH.convertScalingFactor(b,19+d);break;case 7:v.armor=WH.convertScalingFactor(b,23+d);break;case 16:v.armor=WH.convertScalingFactor(b,28);break;case 14:v.armor=WH.convertScalingFactor(b,29);break;default:v.armor=0}}if(f){var c=(v.mledps?"mle":"rgd"),u;switch(l){case 23:case 21:case 22:case 13:v.dps=v[c+"dps"]=WH.convertScalingFactor(b,r?2:0);u=0.3;break;case 17:v.dps=v[c+"dps"]=WH.convertScalingFactor(b,r?3:1);u=0.2;break;case 15:v.dps=v[c+"dps"]=WH.convertScalingFactor(b,d==19?5:4);u=0.3;break;default:v.dps=v[c+"dps"]=0;u=0}v.dmgmin=v[c+"dmgmin"]=Math.floor(v.dps*v.speed*(1-u));v.dmgmax=v[c+"dmgmax"]=Math.floor(v.dps*v.speed*(1+u))}};WH.scaleItemEnchantment=function(h,b){var f=h.enchantment;if(h.scalinginfo&&(h.scalinginfo.scalingcategory-11)>0){var e=f.match(/\d+/g);if(e){var g=parseInt(h.scalinginfo.maxlvlscaling)?Math.min(b,parseInt(h.scalinginfo.maxlvlscaling)):b;var a=WH.getSpellScalingValue(h.scalinginfo.scalingcategory,g);for(var c=0;c<e.length;++c){var d=h.scalinginfo["damage"+(c+1)];if(d){f=f.replace(e[c],Math.round(a*d))}}}}return f};WH.getItemRandPropPointsType=function(a){var b=a.slotbak?a.slotbak:a.slot;switch(b){case 1:case 4:case 5:case 7:case 15:case 17:case 20:case 25:return 0;case 2:case 9:case 11:case 16:return 2;case 3:case 6:case 8:case 10:case 12:return 1;case 13:case 14:case 21:case 22:case 23:return 3;case 26:if(a.subclass==19){return 3}return 0;case 28:return 4;break;default:return-1}};WH.scaleItemLevel=function(b,a){let retItemLevel=b.level;let curvePointsDB=WH.curvePoints;if(!curvePointsDB){return retItemLevel}let curveId=null;let minLevel=null;let maxLevel=null;if(b.scadist){let scalingDistributions=WH.convertScalingFactor.SD;let scalingDistribution=scalingDistributions?scalingDistributions[b.scadist]:null;if(scalingDistribution&&scalingDistribution[22]&&scalingDistribution[22]>0){minLevel=scalingDistribution[20];maxLevel=scalingDistribution[21];curveId=scalingDistribution[22]}}else{if(b.contenttuning){let contentTuning=WH.contentTuningLevels[b.contenttuning];if(contentTuning){minLevel=contentTuning[0];maxLevel=contentTuning[1]}}curveId=b.playercurve}if(curveId){let playerLevel=a?a:WH.maxLevel;if(minLevel&&playerLevel<minLevel){playerLevel=minLevel}if(maxLevel&&playerLevel>maxLevel){playerLevel=maxLevel}let curvePoints=curvePointsDB[curveId];if(curvePoints&&curvePoints.length>0){let indexHi=-1;for(let index in curvePoints){let point=curvePoints[index];if(point[1]>=playerLevel){indexHi=index;break}}let pointHi=curvePoints[indexHi!=-1?indexHi:(curvePoints.length-1)];let pointLo=null;let y=0;if(indexHi>0){pointLo=curvePoints[indexHi-1];let xDiff=pointHi[1]-pointLo[1];if(xDiff>0){let lvlDiff=playerLevel-pointLo[1];let div=lvlDiff/xDiff;let yDiff=pointHi[2]-pointLo[2];let yOffset=div*yDiff;y=pointLo[2]+yOffset}}else{y=pointHi[2]}if(y>0){retItemLevel=Math.round(y)}}}return retItemLevel};WH.applyStatModifications=function(ad,r,R,z,ag,h,H,q){var a={};if(ad.hasOwnProperty("level")){a=WH.dO(ad)}else{WH.cOr(a,ad,"__")}if(ag&&ag.length){var F=false;for(var Z=0;Z<ag.length;++Z){var s=ag[Z];if(s>0&&WH.isSet("g_itembonuses")&&g_itembonuses[s]){var I=g_itembonuses[s];for(var Y=0;Y<I.length;++Y){var A=I[Y];switch(A[0]){case 11:case 13:if(F===false||A[2]<F){a.scadist=A[1];a.scadistbonus=s;a.contenttuning=A[3];a.playercurve=A[4];F=A[2]}break;default:break}}}}}a.level=WH.scaleItemLevel(a,h);if(R=="pvp"&&ad.pvpUpgrade){a.level+=ad.pvpUpgrade}if(a.subitems&&a.subitems[r]){for(var ah in a.subitems[r].jsonequip){if(!a.hasOwnProperty(ah)){a[ah]=0}a[ah]+=a.subitems[r].jsonequip[ah]}}if(ag&&ag.length){if(ad.statsInfo){a.statsInfo={};for(var Z in ad.statsInfo){a.statsInfo[Z]={alloc:parseInt(ad.statsInfo[Z].alloc),qty:ad.statsInfo[Z].qty,socketMult:ad.statsInfo[Z].socketMult}}}var E=[0,0,0,0,2147483647,2147483647,2147483647,2147483647];a.extraStats=[];var l=a.scadistbonus?false:0;let craftingStats=[24,25];let craftingIndex=0;for(var Z=0;Z<ag.length;++Z){var s=ag[Z];if(s>0&&WH.isSet("g_itembonuses")&&g_itembonuses[s]){var I=g_itembonuses[s];for(var Y=0;Y<I.length;++Y){var A=I[Y];if(A[0]==25){A[0]=2;let stat=a.statsInfo[craftingStats[craftingIndex]];if(stat&&stat.alloc){A[2]=stat.alloc}else{A[2]=0}craftingIndex=Math.min(craftingIndex+1,craftingStats.length-1)}switch(A[0]){case 1:if(!a.scadistbonus){a.level+=A[1];l=false}break;case 2:if(a.statsInfo){if(a.statsInfo.hasOwnProperty(A[1])){a.statsInfo[A[1]].alloc+=A[2]}else{a.extraStats.push(A[1]);a.statsInfo[A[1]]={alloc:parseInt(A[2]),qty:0,socketMult:0}}}break;case 3:a.quality=parseInt(A[1]);break;case 4:var e=A[1];var b=A[2];var V=4;var U=4;do{if(b<=E[V]){var w=e;e=E[V-4];E[V-4]=w;var T=b;b=E[V];E[V]=T}++V;--U}while(U);break;case 5:if(WH.isSet("g_item_namedescriptions")&&g_item_namedescriptions[A[1]]){a.nameSuffix=g_item_namedescriptions[A[1]][0]}break;case 6:var N=a.nsockets?a.nsockets:0;a.nsockets=N+A[1];for(var W=N;W<(N+A[1]);++W){a["socket"+(W+1)]=A[2]}break;case 7:break;case 8:a.reqlevel+=A[1];break;case 14:if(l!==false){l=a.level}break;case 16:a.bond=parseInt(A[1]);break;default:break}}}}if(l){a.level=l;a.previewLevel=l}if(WH.isSet("g_item_namedescriptions")){a.namedesc=a.namedesc?a.namedesc:"";for(var Y=0;Y<4;++Y){if(E[Y]&&g_item_namedescriptions[E[Y]]){a.namedesc+=(!a.namedesc?"":" ")+g_item_namedescriptions[E[Y]][0];if(!Y){a.namedesccolor=g_item_namedescriptions[E[Y]][1]}}}}}(function(){if(!q||!q.length||!a.statsInfo){return}for(let fromStat,fromIndex=0;fromStat=WH.Wow.Item.CRAFTING_STAT_FROM[fromIndex];fromIndex++){let toStat=q[fromIndex];if(!toStat){continue}if(!a.statsInfo[fromStat]){continue}if(a.statsInfo[toStat]){a.statsInfo[toStat].alloc+=ad.statsInfo[fromStat].alloc}else{a.statsInfo[toStat]=a.statsInfo[fromStat];a.extraStats.push(toStat)}delete a.statsInfo[fromStat]}})();if(ad.statsInfo&&ad.level&&WH.applyStatModifications.ScalingData){var ab=WH.applyStatModifications.ScalingData.AV,p=WH.applyStatModifications.ScalingData.SV,D=WH.applyStatModifications.ScalingData.AL;a.level=z?z:(R&&ad.upgrades&&ad.upgrades[R-1]?(a.level+ad.upgrades[R-1]):a.level);var v=a.level-ad.level;var Q=Math.pow(1.15,v/15);var L=WH.getItemRandPropPointsType(a);var S=[];for(var aa=a.level;aa>=0;aa--){if(p.hasOwnProperty(aa)){S=p[aa];break}}var u=0;if(L!=-1){var P=0;switch(a.quality){case 5:case 4:P=0;break;case 7:case 3:P=1;break;case 2:P=2;break;default:break}var t=P*5+L;u=S[t]?S[t]:0}var O=S[15];for(var Z in WH.statToJson){var g=WH.statToJson[Z];if(a[g]||(a.statsInfo&&a.statsInfo[Z])){var m=0;var af=0;if(a.statsInfo.hasOwnProperty(Z)){m=parseFloat(a.statsInfo[Z].socketMult);af=parseInt(a.statsInfo[Z].alloc)}var C=Math.round(m*O);if(af&&(u>0||a.contenttuning>0)){a[g]=Math.floor(af*0.0001*u-C+0.5)}else{a[g]=Math.floor(((a[g]+C)*Q)-C)}if(g=="sta"){a[g]=Math.floor(a[g]*WH.getStaminaRatingMult(a.level,a.slot||g_items[a.id].slot))}else{if(H&&WH.inArray(WH.applyStatModifications.BASE_STATS,Z)<0){a[g]=Math.floor(a[g]*WH.getCombatRatingMult(a.level,a.slot||g_items[a.id].slot))}else{if(g==="corruption"||g==="corruptionres"){a[g]=af}}}switch(g){case"agistrint":a.agi=a.str=a["int"]=a[g];break;case"agistr":a.agi=a.str=a[g];break;case"agiint":a.agi=a["int"]=a[g];break;case"strint":a.str=a["int"]=a[g];break;default:break}}}if(a.armor&&ab[a.level]){var G=(a.quality==7)?3:a.quality;var c=(a.subclass==-6)?1:a.subclass;if(WH.inArray([1,2,3,4],c)!=-1){var ae=ab[a.level][11+G];var M=ab[a.level][c-1];var f=D[a.slot][c-1];a.armor=Math.floor(M*ae*f+0.5)}if(a.subclass==6){a.armor=ab[a.level][4+G]}}if(a.dps){var d=["dps","mledps","rgddps"];var X=["dmgmin1","mledmgmin","rgddmgmin","dmgmax1","mledmgmax","rgddmgmax"];var ac=WH.getEffectiveWeaponDamage(a,false);var B=WH.getEffectiveWeaponDamage(a,true);ac=Math.floor(Math.max(1,ac));B=Math.max(1,B);if(!WH.isRetailTree()){ac=a.damagemin||ac;B=a.damagemax||B}var K=((ac+B)/2)/a.speed;var J=K>=1000?0:(WH.isRetailTree()?1:2);K=parseFloat(K.toFixed(J));for(var Z in d){if(a[d[Z]]){a[d[Z]]=K}}for(var Z in X){if(a[X[Z]]){if(X[Z].indexOf("max")!=-1){a[X[Z]]=B}else{a[X[Z]]=ac}}}}}return a};WH.applyStatModifications.BASE_STATS=[4,3,5,71,72,73,74,7,1,0,8,9,2,10];WH.applyStatModifications.ITEM_TIMEWALKINGMODE_TBC_LEVEL=67;WH.applyStatModifications.ITEM_TIMEWALKINGMODE_WOTLK_LEVEL=92;WH.applyStatModifications.ITEM_TIMEWALKINGMODE_CATA_LEVEL=104;WH.applyStatModifications.ITEM_TIMEWALKINGMODE_MISTS_LEVEL=116;WH.getItemDamageValue=function(c,e,a){var b=WH.applyStatModifications.ScalingData.DV;var d=7*a+e;if(b&&b[c]&&b[c][d]){return b[c][d]}return 0};WH.getEffectiveWeaponDamage=function(j,a){var f=j.level;var c=j.subclass;var h=j.quality;var d=j.slotbak?j.slotbak:j.slot;var g=0;var l=false;var b=j.flags2&512;if(j.classs!=2){return 0}if(h>7){return 0}if(h==7){h=3}if(d>22){if(d==24){g=0;l=true}if(!l&&(d<=24||d>26)){l=true}}else{if(d==21||d==22||d==13){if(!b){g=WH.getItemDamageValue(f,h,0)}else{g=WH.getItemDamageValue(f,h,1)}l=true}if(!l&&d!=15){if(d!=17){l=true}else{if(!b){g=WH.getItemDamageValue(f,h,2)}else{g=WH.getItemDamageValue(f,h,3)}l=true}}}if(!l&&c>=2){if(c==2||c==3||c==18){if(!b){g=WH.getItemDamageValue(f,h,2)}else{g=WH.getItemDamageValue(f,h,3)}l=true}if(!l&&c==19){g=WH.getItemDamageValue(f,h,1)}}if(g>0){var e=j.dmgrange||0;if(!a){return g*j.speed*(1-e/2)}else{return Math.floor((g*j.speed*(1+e/2))+0.5)}}return 0};WH.getJsonReforge=function(c,a){if(!a){if(!WH.reforgeStats){return[]}c.__reforge={};c.__reforge.all=[];for(var a in WH.reforgeStats){var d=WH.getJsonReforge(c,a);if(d.amount){c.__reforge.all.push(d)}}return c.__reforge.all}if(!WH.reforgeStats||!WH.reforgeStats[a]){return{}}c.__statidx={};for(var b in c){if(WH.individualToGlobalStat[WH.jsonToStat[b]]){c.__statidx[WH.individualToGlobalStat[WH.jsonToStat[b]]]=c[b]}else{c.__statidx[WH.jsonToStat[b]]=c[b]}}if(!c.__reforge){c.__reforge={}}var d=c.__reforge[a]=WH.dO(WH.reforgeStats[a]);c.__reforge[a].amount=Math.floor(d.v*(c.__statidx[d.i1]&&!c.__statidx[d.i2]?c.__statidx[d.i1]:0));return c.__reforge[a]};WH.getJsonItemEnchantMask=function(a){if(a.classs==2&&a.subclass==19){return 1<<(21-1)}return 1<<(a.slot-1)};WH.getArtifactKnowledgeMultiplier=function(a){let multiplier=1;for(let i=0,possibleMultiplier;possibleMultiplier=WH.Tooltip.ARTIFACT_KNOWLEDGE_MULTIPLIERS[i];i++){if(i>a){break}multiplier=possibleMultiplier}return multiplier};WH.getCurveValue=function(c,b){var d;if(!WH.curvePoints||!(d=WH.curvePoints[c])){return undefined}var f=d[0][1];var e=d[0][2];if(f>b){return e}for(var g=0,a;a=d[g];g++){if(b==a[1]){return a[2]}if(b<a[1]){return(a[2]-e)/(a[1]-f)*(b-f)+e}f=a[1];e=a[2]}return e};WH.setItemModifications=function(l,u,B,r,M,v,G){if(!WH.isSet("g_items")||!g_items[u]||!g_items[u].jsonequip){return l}if(!M){M=WH.maxLevel}B=B?B.split(":"):null;var m=g_items[u].bonusesData;var H=0;var a=B?B.indexOf("u"):-1;if(m&&a!=-1){H=B[a+1];B.splice(a,1)}if(!v){v=0;switch(r){case"twtbc":v=WH.applyStatModifications.ITEM_TIMEWALKINGMODE_TBC_LEVEL;break;case"twwotlk":v=WH.applyStatModifications.ITEM_TIMEWALKINGMODE_WOTLK_LEVEL;break;case"twcata":v=WH.applyStatModifications.ITEM_TIMEWALKINGMODE_CATA_LEVEL;break;case"twmists":v=WH.applyStatModifications.ITEM_TIMEWALKINGMODE_MISTS_LEVEL;break}}r=!v?r:null;var E=WH.applyStatModifications(g_items[u].jsonequip,0,r,v,B,M,undefined,G);if(!E.name&&g_items[u].hasOwnProperty("name_"+Locale.getName())){E.name=g_items[u]["name_"+Locale.getName()];E.quality=g_items[u].quality}if(H){var I=WH.bonusesBtnGetContextBonusId(B);var q=m[I].sub[H].sub;for(var D in q){var F=WH.applyStatModifications(g_items[u].jsonequip,0,r,v,[I,D]);for(var c in F.statsInfo){var d=F[WH.statToJson[c]];if(E.statsInfo[c]){if(typeof E[WH.statToJson[c]]=="number"||!E[WH.statToJson[c]]){var b=E[WH.statToJson[c]]?E[WH.statToJson[c]]:d;E[WH.statToJson[c]]={};E[WH.statToJson[c]]["min"]=b;E[WH.statToJson[c]]["max"]=b}var A=E[WH.statToJson[c]]["min"];var e=E[WH.statToJson[c]]["max"];if(d<A){E[WH.statToJson[c]]["min"]=d}else{if(d>e){E[WH.statToJson[c]]["max"]=d}}}}}}l=l.replace(/(<!--ilvl-->)\d+\+?/,function(N,O){return O+E.level+(E.previewLevel?"+":"")});let displaySlider=false;let minLevel=1;let maxLevel=WH.maxLevel;if(E.scadist){let scalingDistributions=WH.convertScalingFactor.SD;let scalingDistribution=scalingDistributions?scalingDistributions[E.scadist]:null;if(scalingDistribution&&scalingDistribution[21]){displaySlider=true;minLevel=scalingDistribution[20]?scalingDistribution[20]:1;maxLevel=scalingDistribution[21]}}else{if(E.contenttuning){let contentTuning=WH.contentTuningLevels[E.contenttuning];if(contentTuning){displaySlider=true;minLevel=contentTuning[0];maxLevel=contentTuning[1]}}}if(displaySlider){M=((M&&M<=maxLevel)?M:maxLevel);l=l.replace(/(<!--lvl-->)\d+/g,function(N,O){return O+((M&&M<=maxLevel)?M:maxLevel)});l=l.replace(/(<!--minlvl-->)\d+/,function(N,O){return O+minLevel});l=l.replace(/(<!--maxlvl-->)\d+/,function(N,O){return O+maxLevel});let didReplace=false;l=l.replace(/<!--i\?(\d+):(\d+):(\d+):(\d+)(?::(\d+):(\d+))?/,function(R,T,Q,N,O,P,S){didReplace=true;return"<!--i?"+T+":"+minLevel+":"+maxLevel+":"+M+":"+(E.scadist||E.contenttuning)+":"+(S||0)});if(!didReplace){l+="<!--i?"+u+":"+minLevel+":"+maxLevel+":"+M+":"+(E.scadist||E.contenttuning)+":0-->"}l=l.replace(/(<!--huindex-->)\d+/,function(N,O){let heirloomUpgradeIdx=0;if(E.scadistbonus&&E.heirloombonuses){for(let i=0,heirloomBonus;heirloomBonus=E.heirloombonuses[i];i++){if(parseInt(E.scadistbonus)===heirloomBonus){heirloomUpgradeIdx=i+1;break}}}return O+heirloomUpgradeIdx})}else{l=l.replace(/<!--i\?(\d+):(\d+):(\d+):(\d+)(?::(\d+):(\d+))?/,function(R,T,Q,N,O,P,S){return"<!--i?"+T+":"+Q+":"+N+":"+(M?M:N)})}var w;if(w=WH.ge("sl"+u)){w.style.display=displaySlider?"":"none"}l=l.replace(/(<!--pvpilvl-->)\d+/,function(N,O){return O+(E.level+((r!="pvp")?E.pvpUpgrade:0))});l=l.replace(/(<!--ilvldelta-->)\d+/,function(O,P){var N=1718;var Q=Math.floor(WH.getCurveValue(N,E.level)||2);return P+Q});l=l.replace(/(<!--rlvl-->)\d+/,function(N,O){return O+E.reqlevel});l=l.replace(/(<!--uindex-->)\d+/,function(N,O){return(r&&r!="pvp")?(O+r):N});var z=(typeof E.dmgrange!="undefined")&&E.dmgrange;var J=new RegExp("(<!--dmg-->)[\\d,]+"+(z?"(\\D*?)[\\d,]+":"")+"");l=l.replace(J,function(O,P,N){return P+WH.numberFormat(E.dmgmin1)+(z?(N+WH.numberFormat(E.dmgmax1)):"")});l=l.replace(/(<!--dps-->\D*?)([\d,]+(?:\.\d+)?)/,function(O,P){var N=E.dps>=1000?0:(WH.isRetailTree()?1:2);return P+(E.dps?WH.numberFormat(E.dps.toFixed(N)):"0")});l=l.replace(/(<!--amr-->)\d+/,function(N,O){return O+E.armor});var L=WH.getCombatRatingMult(E.level,g_items[u].slot);l=(function(N){let div=WH.ce("div",{innerHTML:N});WH.qsa("span",div).forEach(function(O){let c;let ratingId;let statComment;let ratingComment;O.childNodes.forEach(function(P){if(P.nodeType===Node.COMMENT_NODE){let s;if(s=(P.nodeValue||"").match(/^stat(\d+)$/)){c=parseInt(s[1]);statComment=P}if(s=(P.nodeValue||"").match(/^rtg(\d+)$/)){ratingId=parseInt(s[1]);ratingComment=P}}});if(c===undefined&&ratingId===undefined){return}let hidden=false;if(ratingId){let value=E[WH.statToJson[ratingId]]?E[WH.statToJson[ratingId]]:0;let sign=value<0?"-":"+";if(value){let min=Math.floor((H&&value.min?value.min:value)*L);let max=Math.floor((H&&value.max?value.max:value)*L);value=WH.numberLocaleFormat(min!=max?(min+"-"+max):min)}else{hidden=true;value=0}let signNode=ratingComment.previousSibling;if(signNode&&signNode.nodeType===Node.TEXT_NODE){signNode.nodeValue=signNode.nodeValue.replace(/[-+]$/,sign)}let amountNode=ratingComment.nextSibling;if(amountNode&&amountNode.nodeType===Node.TEXT_NODE){amountNode.nodeValue=amountNode.nodeValue.replace(/[-\d\.,]+/,value)}}else{let value=E[WH.statToJson[c]]?E[WH.statToJson[c]]:0;if(value){let min=H&&value.min?value.min:value;let max=H&&value.max?value.max:value;value=(min>0?"+":"-")+WH.numberLocaleFormat(min!=max?(min+"-"+max):min)}else{hidden=true;value="+0"}let amountNode=statComment.nextSibling;if(amountNode&&amountNode.nodeType===Node.TEXT_NODE){amountNode.nodeValue=amountNode.nodeValue.replace(/[-+][-\d\.,]+/,value)}}if(hidden){WH.displayNone(O);let node=O.nextSibling;while(node){if(node.nodeType===Node.ELEMENT_NODE){if(node.nodeName.toLowerCase()==="br"){node.parentNode.replaceChild(document.createComment("br"),node)}break}node=node.nextSibling}}else{WH.displayDefault(O)}});return div.innerHTML})(l);if(E.extraStats&&E.extraStats.length){l=l.replace(/<!--re--><span[^<]*?<\/span>(<br \/>)?/,"");var h=WH.applyStatModifications.BASE_STATS;l=l.replace(/<!--ebstats-->/,function(V){var Q="";for(var P=0;P<E.extraStats.length;++P){var N=E.extraStats[P];if(h.indexOf(N)==-1){continue}var S="$1$2 "+(WH.statToJson&&WH.statToJson[N]&&LANG.traits[WH.statToJson[N]]?LANG.traits[WH.statToJson[N]][1]:"Unknown");var R=WH.statToJson&&WH.statToJson[N]?E[WH.statToJson[N]]:0;var O=Math.floor((H&&R.min?R.min:R)*L);var T=Math.floor((H&&R.max?R.max:R)*L);var U=WH.numberLocaleFormat(O!=T?(O+"-"+T):O);Q+="<br /><span><!--stat"+N+"-->"+WH.sprintf(S,(O<0)?"-":"+",U)+"</span>"}return Q+V});l=l.replace(/<!--egstats-->/,function(X){var R="";for(var Q=0;Q<E.extraStats.length;++Q){var O=E.extraStats[Q];if(h.indexOf(O)!=-1){continue}var aa=L;var N="q2";switch(WH.statToJson[O]){case"corruption":N="stat-corruption";aa=1;break;case"corruptionres":N="q6";aa=1;break}var U="$1$2 "+(WH.statToJson&&WH.statToJson[O]&&LANG.traits[WH.statToJson[O]]?LANG.traits[WH.statToJson[O]][1]:"Unknown");var T=WH.statToJson&&WH.statToJson[O]?E[WH.statToJson[O]]:0;var P=Math.floor((H&&T.min?T.min:T)*aa);var V=Math.floor((H&&T.max?T.max:T)*aa);var W=WH.numberLocaleFormat(P!=V?(P+"-"+V):P);var S=WH.sprintf("<!--rtg$1-->$2",O,W);var Y="";if(WH.statToRating&&WH.statToRating[O]){Y=WH.sprintf("&nbsp;<small>(<!--rtg%$1-->0&nbsp;@&nbsp;L$2"+WH.maxLevel+")</small>",O,H?"":"<!--lvl-->")}var Z="";if(O==50){Z="<!--stat%d-->"}if(O==64){U=U.substr(5);Y=""}R+='<br /><span class="'+N+'">'+Z+WH.sprintf(U,(P>=0)?"+":"-",S)+Y+"</span>"}return R+X})}l=l.replace(/(<!--nstart-->)(.*)(<!--nend-->)/,function(R,O,P,N){var T=E.quality;var Q=E.name;var S=E.nameSuffix?(" "+E.nameSuffix):"";return O+WH.sprintf('<b class="q$1">$2</b>',T,Q+S)+N});l=l.replace(/(<!--ndstart-->)(.*)(<!--ndend-->)/,function(Q,O,N,R){if(!E.namedesc){return O+R}if(!E.namedesccolor){return Q}var P=parseInt(E.namedesccolor).toString(16);while(P.length<6){P="0"+P}return O+WH.sprintf('<br /><span style="color: $1">$2</span>',"#"+P,E.namedesc)+R});var t=g_items[u].jsonequip.nsockets|0;if((!t&&E.nsockets)||(t&&E.nsockets>t)){l=l.replace(/<!--ps-->(<br(?: \/)?>)?/,function(T,V){var Q="";for(var O=t;O<E.nsockets;++O){if(!E["socket"+(O+1)]){continue}var R=E["socket"+(O+1)];var P="socket-unknown";var N=81;var S=R;switch(R){case 1:P="socket-meta";N=81;S=1;break;case 2:P="socket-red";N=81;S=2;break;case 3:P="socket-yellow";N=81;S=3;break;case 4:P="socket-blue";N=81;S=4;break;case 5:P="socket-hydraulic";N=81;S=5;break;case 6:P="socket-cogwheel";N=81;S=6;break;case 7:P="socket-prismatic";N=81;S=9;break;case 8:P="socket-relic-iron";N=225;S=64;break;case 9:P="socket-relic-blood";N=225;S=128;break;case 10:P="socket-relic-shadow";N=225;S=256;break;case 11:P="socket-relic-fel";N=225;S=512;break;case 12:P="socket-relic-arcane";N=225;S=1024;break;case 13:P="socket-relic-frost";N=225;S=2048;break;case 14:P="socket-relic-fire";N=225;S=4096;break;case 15:P="socket-relic-water";N=225;S=8192;break;case 16:P="socket-relic-life";N=225;S=16384;break;case 17:P="socket-relic-storm";N=225;S=32768;break;case 18:P="socket-relic-holy";N=225;S=65536;break;default:break}var U=WH.sprintf('<a href="/items/gems?filter=$1;$2;0" class="$3 q0">',N,S,P);U+=g_socket_names[R]?g_socket_names[R]:(g_gem_types[R]?WH.sprintf(WH.TERMS.emptyrelicslot_format.replace("%s","$1"),g_gem_types[R]):"Unknown Socket");U+="</a>";Q+="<br>"+U}return(t==0?"<br>":"")+Q+"<br><br>"})}if(B&&WH.Tooltip.BONUS_ITEM_EFFECTS){l=l.replace(/<!--itemEffects:(\d)-->/,function(O,N){let useCorruptionColor=E.extraStats&&E.extraStats.indexOf(parseInt(WH.jsonToStat.corruption))>=0;let result="";for(let bonus,bonusIndex=0;bonus=B[bonusIndex];bonusIndex++){let effectIds=WH.Tooltip.BONUS_ITEM_EFFECTS[bonus]||[];for(let effectId,effectIdIndex=0;effectId=effectIds[effectIdIndex];effectIdIndex++){let effectHtml=WH.Tooltip.ITEM_EFFECT_TOOLTIP_HTML[effectId];if(effectHtml){if(useCorruptionColor){effectHtml=effectHtml.replace(/\b(class=")q2\b/g,"$1stat-corruption")}result+=(result?"<br>":"")+effectHtml}}}return result+((result&&N)?"<br>":"")+O})}if(WH.applyStatModifications&&WH.convertScalingSpell.SpellInformation){var s;var g={effects:{}};var j=/(<!--pts(\d):(\d):(\d+(?:\.\d+)?):(\d+)(:\d+(?:\.\d+)?)?(:crm)?-->(?:<!--rtg\d+-->)?)(\d+(?:\.\d+)?)(<!---->(%?))?/g;while((s=j.exec(l))!==null){var C=s[2];var K=s[3];var f=s[5];if(f<=0){continue}g[f]=g[f]||{};WH.cO(g[f],WH.convertScalingSpell(g[f],f,C,K,M,E.level))}l=WH.adjustSpellPoints(l,g,E.level,g_items[u].jsonequip.slot)}var p=0;switch(v){case WH.applyStatModifications.ITEM_TIMEWALKINGMODE_TBC_LEVEL:p=70;break;case WH.applyStatModifications.ITEM_TIMEWALKINGMODE_WOTLK_LEVEL:p=80;break;case WH.applyStatModifications.ITEM_TIMEWALKINGMODE_CATA_LEVEL:p=85;break;case WH.applyStatModifications.ITEM_TIMEWALKINGMODE_MISTS_LEVEL:p=90;break;default:break}if(p){l=l.replace(/<!--ee(\d+):(\d+):(\d+):(\d+):(\d+):(\d+)-->([^<]*)<\/span>/gi,function(N,W,O,P,V,T,R,S){var U={enchantment:S,scalinginfo:{scalingcategory:W,minlvlscaling:O,maxlvlscaling:P,damage1:V/1000,damage2:T/1000,damage3:R/1000}};var Q=WH.scaleItemEnchantment(U,p);return"<!--ee-->"+Q+"</span>"})}l=l.replace(/(<!--rtg%(\d+)-->)([\.,0-9]+)%?/g,function(P,R,Q,O){_=l.match(new RegExp("<!--rtg"+Q+"-->([\\d\\.,]+)(-[\\d\\.,]+)?"));if(!_){return P}if(_[2]){_[2]=_[2].replace(/\D/,"")}_[1]=_[1].replace(/\D/,"");var N=_[2]?((Math.abs(parseInt(_[2]))+parseInt(_[1]))/2):_[1];return R+(_[2]?"~":"")+(Math.round(WH.convertRatingToPercent(M?M:WH.maxLevel,Q,N)*100)/100)+(Q!=49?"%":"")});l=l.replace(/<!--bo-->(<br(?: \/)?>)?/,function(O,N){let bond="";if(E.bond){switch(E.bond){case 1:bond=WH.GlobalStrings.ITEM_BIND_ON_PICKUP;break;case 2:bond=WH.GlobalStrings.ITEM_BIND_ON_EQUIP;break;case 3:bond=WH.GlobalStrings.ITEM_BIND_ON_USE;break;case 4:case 5:bond=WH.GlobalStrings.ITEM_BIND_QUEST;break;default:bond=WH.TERMS.unknownBindType_stc;break}}if(bond!=""){bond="<br />"+bond}return"<!--bo-->"+bond+N});(function(){var N=WH.ce("div");N.innerHTML=l;N.querySelectorAll('a[href*="/spell="]').forEach(function(P){var O=P.dataset.wowhead||"";O=O.replace(/(^|&)i?lvl=\d+/g,"");if(M){O+=(O?"&":"")+"lvl="+M}if(E.level){O+=(O?"&":"")+"ilvl="+E.level}P.dataset.wowhead=O});let priceFactors=WH.getPageData("item.sellprice."+u);let sellPriceDiv=N.querySelector(".whtt-sellprice");if(priceFactors&&sellPriceDiv){let labelNode=sellPriceDiv.firstChild;WH.ee(sellPriceDiv);WH.ae(sellPriceDiv,labelNode);let levels=priceFactors.itemLevel;let levelFactor=levels[E.level]||levels[Math.max.apply(null,Object.keys(levels))];let qualityFactor=priceFactors.quality[E.quality]||0;let newPrice=Math.floor(priceFactors.base*levelFactor*qualityFactor);WH.ae(sellPriceDiv,WH.Wow.buildMoney({copper:newPrice}))}l=N.innerHTML})();return l};WH.setTooltipLevel=function(e,b,B){var h=typeof e;if(h=="number"){var a=WH.getDataSource();if(a[e]&&a[e][(B?"buff_":"tooltip_")+Locale.getName()]){e=a[e][(B?"buff_":"tooltip_")+Locale.getName()]}else{return e}}else{if(h!="string"){return e}}e=e.replace(/<!--(gem|ee)(\d+):(\d+):(\d+):(\d+):(\d+):(\d+)-->([^<]*)<\/span>/gi,function(j,O,N,F,G,M,K,I,J){var L={enchantment:J,scalinginfo:{scalingcategory:N,minlvlscaling:F,maxlvlscaling:G,damage1:M/1000,damage2:K/1000,damage3:I/1000}};var H=WH.scaleItemEnchantment(L,b);return"<!--"+O+"-->"+H+"</span>"});var C=e.match(/<!--i?\?([0-9-:]*)-->/);var f;var q;if(C){f=C[1].split(":").map(Number);b=Math.min(f[2],Math.max(f[1],b));q=f[4]||0}if(q){if(!e.match(/<!--pts\d:\d:\d+(?:\.\d+)?:\d+-->/g)&&!(q<0)&&!B){e=WH.setItemModifications(e,f[0],null,null,b);WH.updateItemStringLink.call(this)}else{if(q>0){if(!f[7]&&WH.isSet("g_pageInfo")&&g_pageInfo.type==3&&g_items[g_pageInfo.typeId]&&g_items[g_pageInfo.typeId].quality!=7){b=Math.min(g_items[g_pageInfo.typeId].reqlevel,b)}var A={scadist:q};e=e.replace(/<!--cast-->\d+\.\d+/,"<!--cast-->"+A.cast);var p=/<!--pts([0-9-:]*)-->/g;var u=p.exec(e);A.effects=true;while(u!=null){var z=u[1].split(":").map(Number);var s=z[0];var E=z[1];var c=z[3];if(c>0){if(A[c]==undefined){A[c]={};A[c].effects={}}WH.cO(A[c],WH.convertScalingSpell(A[c],c,s,E,b,b))}u=p.exec(e)}if(A.effects){var d=5;var l=d;if(window.g_pageInfo&&window.g_pageInfo.type==WH.Types.AZERITE_ESSENCE_POWER){l=WH.Wow.Item.INVENTORY_TYPE_NECK}e=WH.adjustSpellPoints(e,A,b,l);if(this.modified){for(var m in this.modified[1]){var D=this.modified[1][m];for(var v=0;v<D.length;++v){D[v][0]=WH.adjustSpellPoints(D[v][0],A,b,l);D[v][1]=WH.adjustSpellPoints(D[v][1],A,b,l)}}}}}else{var r=-q;var g=WH.getSpellScalingValue(r,b);for(var w=0;w<3;++w){var t=f[5+w]/1000;e=e.replace(new RegExp("<!--gem"+(w+1)+"-->(.+?)<"),"<!--gem"+(w+1)+"-->"+Math.round(g*t)+"<")}}}}e=e.replace(/<!--ppl(\d+):(\d+):(\d+):(\d+):(\d+)(?::(1))?-->\s*\d+/gi,function(I,L,G,F,J,K,H){var j=H?Math.ceil:Math.floor;return"<!--ppl"+L+":"+G+":"+F+":"+J+":"+K+"-->"+j(parseInt(J)+(Math.min(Math.max(b,G),F)-G)*K/100)});e=e.replace(/(<!--rtg%(\d+)-->)([\.0-9]+)%?/g,function(F,H,G,j){_=e.match(new RegExp("<!--rtg"+G+"-->(\\d+)"));if(!_){return F}return H+(Math.round(WH.convertRatingToPercent(b,G,_[1])*100)/100)+(G!=49?"%":"")});e=e.replace(/(<!--i?\?\d+:\d+:\d+:)\d+/g,"$1"+b);e=e.replace(/<!--lvl-->\d+/g,"<!--lvl-->"+b);return e};WH.getSpellScalingValue=function(a,c){var b=WH.convertScalingSpell?WH.convertScalingSpell.SV:null;if(!b){return 0}return b[c][a-1]};WH.adjustSpellPoints=function(e,c,b,f){var a=1;if(b&&f){a=WH.getCombatRatingMult(b,f)}for(var d=1;d<=20;++d){e=e.replace(new RegExp("<!--pts"+d+":0:0:(\\d+)(:\\d+(?:\\.\\d+)?)?(:crm)?-->(<!--rtg\\d+-->)?(.+?)<","g"),function(p,h,l,g,j){var m=(c[h]&&c[h].hasOwnProperty("effects"))?c[h].effects[d]:c.effects[d];if(!m){return p}var q=Math.round(m.avg*(g?a:1));return"<!--pts"+d+":0:0:"+h+(l||"")+(g||"")+"-->"+(j?j:"")+q+"<"});e=e.replace(new RegExp("<!--pts"+d+":1:0:(\\d+)(:\\d+(?:\\.\\d+)?)?(:crm)?-->(<!--rtg\\d+-->)?(.+?)<","g"),function(p,h,l,g,j){var m=(c[h]&&c[h].hasOwnProperty("effects"))?c[h].effects[d]:c.effects[d];if(!m){return p}var q=Math.round(m.min*(g?a:1));return"<!--pts"+d+":1:0:"+h+(l||"")+(g||"")+"-->"+(j?j:"")+q+"<"});e=e.replace(new RegExp("<!--pts"+d+":2:0:(\\d+)(:\\d+(?:\\.\\d+)?)?(:crm)?-->(<!--rtg\\d+-->)?(.+?)<","g"),function(p,h,l,g,j){var m=(c[h]&&c[h].hasOwnProperty("effects"))?c[h].effects[d]:c.effects[d];if(!m){return p}var q=Math.round(m.max*(g?a:1));return"<!--pts"+d+":2:0:"+h+(l||"")+(g||"")+"-->"+(j?j:"")+q+"<"});e=e.replace(new RegExp("<!--pts"+d+":3:(\\d+(?:\\.\\d+)?):(\\d+)(:\\d+(?:\\.\\d+)?)?(:crm)?-->(<!--rtg\\d+-->)?(.+?)<","g"),function(q,p,h,l,g,j){var m=(c[h]&&c[h].hasOwnProperty("effects"))?c[h].effects[d]:c.effects[d];if(!m){return q}var r=Math.round(m.avg*p*(g?a:1));return"<!--pts"+d+":3:"+p+":"+h+(l||"")+(g||"")+"-->"+(j?j:"")+r+"<"});e=e.replace(new RegExp("<!--pts"+d+":4:0:(\\d+)(:\\d+(?:\\.\\d+)?)?(:crm)?-->(<!--rtg\\d+-->)?(.+?)<","g"),function(p,h,l,g,j){var m=(c[h]&&c[h].hasOwnProperty("effects"))?c[h].effects[d]:c.effects[d];if(!m){return p}var q=Math.round(m.pts*(g?a:1));return"<!--pts"+d+":4:0:"+h+(l||"")+(g||"")+"-->"+(j?j:"")+q+"<"})}return e};WH.getStaminaRatingMult=function(a,b){let slotRatingOffset=0;switch(b){case 2:case 11:slotRatingOffset=3;break;case 12:slotRatingOffset=2;break;case 13:case 14:case 15:case 17:case 21:case 22:case 23:case 25:case 26:slotRatingOffset=1;break}return WH.staminaFactor&&WH.staminaFactor[a]&&WH.staminaFactor[a][slotRatingOffset]||1};WH.getCombatRatingMult=function(d,c){var a=0;switch(c){case 2:case 11:a=3;break;case 12:a=2;break;case 13:case 14:case 15:case 17:case 21:case 22:case 23:case 25:case 26:a=1;break}var b=(WH.convertRatingToPercent.hasOwnProperty("RM")&&WH.convertRatingToPercent.RM.hasOwnProperty(d))?WH.convertRatingToPercent.RM[d][a]:1;if(typeof b=="undefined"){b=1}return b};WH.roundArtifactPower=function(b){var a=1;if(b>50){a=5}if(b>1000){a=25}if(b>5000){a=50}return WH.roundHalfEven(b/a)*a};WH.roundHalfEven=function(b){if(Math.floor(b*100000)%100000==50000){var a=Math.floor(b);return a+a%2}return Math.round(b)};WH.setTooltipSpells=function(g,m,h,K){m=m||[];h=h||{};if(!m.length){m=[0]}else{let c=window.g_pageInfo?g_pageInfo.typeId:null;if(c){let idIndex=m.indexOf(parseInt(c));if(idIndex!==-1){m[idIndex]=0}}}if(K===undefined){var E=function(M){var L=[];if(M.hasOwnProperty("data")){L.push(M.data)}for(var j=0;j<M.children.length;j++){L=L.concat(E(M.children[j]))}return L};for(let c in h){if(!h.hasOwnProperty(c)){continue}if(h[c].length<2){continue}for(var s=0;s<h[c].length;s++){h[c][s]={data:h[c][s],children:[]};var u=0;for(var r=0;r<=1;r++){var b=-1;while((b=h[c][s].data[r].indexOf("<!--sp"+c+"-->",b+1))>=0){u++}}var I=s-u;if(I<0){continue}while(u-->0){var l=h[c].splice(I,1);s--;h[c][s].children.push(l[0])}}h[c]=E({children:h[c]})}}K=K||{};var f=function(j){K[j]=(K[j]||0)+1;if(K[j]>=(h[j]||[]).length){K[j]=0}};var B=[];var e=/<!--sp([0-9]+):[01]-->/g;var p;while(p=e.exec(g)){var A=p[0];var J=p.index+A.length;var q="<!--sp"+p[1]+"-->";var z=g.indexOf(q,J);if(z<0){WH.warn("Could not find closing end tag for tooltip spell.",q,g);return g}var H=new RegExp("<!--sp"+p[1]+":[01]-->","g");H.lastIndex=J;var t=H.exec(g);while(t&&t.index<z){z=g.indexOf(q,z+q.length);if(z<0){WH.warn("Could not find nested closing end tag for tooltip spell.",q,g);return g}t=H.exec(g)}B.push(g.substring(p.index,z+q.length));e.lastIndex=z+q.length}var d=0;var G=/^(<!--sp([0-9]+):[01]-->).*(<!--sp\2-->)$/;for(var F=0;F<B.length;++F){var c=B[F].match(G)[2];var a=WH.inArray(m,parseInt(c))>=0?1:0;if(h[c]==null){continue}if(K[c]==null){K[c]=0}var v=h[c][K[c]];if(v==null||v[a]==null){continue}f(c);if(a&&(p=v[2].match(/^(!?)(\d+)$/))){if(p[1]){if(WH.inArray(m,parseInt(p[2]))>=0){a=0}}else{m.push(parseInt(p[2]))}}var D=v[a];D=WH.setTooltipSpells(D,m,h,K);var w="<!--sp"+c+":"+a+"-->"+D+"<!--sp"+c+"-->";g=g.substr(0,d)+g.substr(d).replace(B[F],w);d=g.indexOf(w,d)+w.length;if(a){for(var C=F+1;C<B.length;C++){if(g.indexOf(B[C],d)!==d){break}p=B[C].match(G);w=p[1]+p[3];g=g.substr(0,d)+g.substr(d).replace(B[C],w);f(p[2]);d+=w.length;F++}}}g=WH.Tooltip.evalFormulas(g);return g};WH.enhanceTooltip=function(P,O,A,W,v,g,b,U,T,C,d,K,M,L){if((!WH.applyStatModifications||!WH.applyStatModifications.ScalingData)&&(L||U)){g_itemScalingCallbacks.push((function(ae){return function(){var af=WH.enhanceTooltip.call(ae,P,O,A,W,v,g,b,U,T,C,d,K,M,L);WH.updateTooltip.call(ae,af)}})(this));return WH.TERMS.loading_ellipsis}var ad=typeof P,aa,Q;var z=WH.getDataSource();var q=WH.isSet("g_pageInfo")?g_pageInfo.type:null;Q=WH.isSet("g_pageInfo")?g_pageInfo.typeId:null;this._knownSpells=g;if(ad=="number"){Q=P;var R="tooltip_";if(v){R="buff_"}if(K){R="tooltip_premium_"}if(M){R="text_"}if(z[Q]&&z[Q][R+Locale.getName()]){P=z[Q][R+Locale.getName()];aa=z[Q][(v?"buff":"")+"spells_"+Locale.getName()];this._rppmModList=z[Q]["rppmmod"];if(aa){P=WH.setTooltipSpells(P,g,aa)}}else{return P}}else{if(ad!="string"){return P}}var r;if(A){var ab=WH.getGets();if(ab.lvl){P=WH.setTooltipLevel(P,ab.lvl,v)}r=ab.ilvl}let getCraftedStats=function(){let params=WH.parseQueryString(WH.getQueryString());if(!params["crafted-stats"]){return[]}return params["crafted-stats"].split(":").map(function(ae){return parseInt(ae)}).filter(function(ae){return WH.Wow.Item.CRAFTING_STAT_TO.includes(ae)})};let craftedStats=getCraftedStats();if((L||U||craftedStats.length)&&Q){P=WH.setItemModifications(P,Q,L,U,this._selectedLevel?this._selectedLevel:null,r,craftedStats)}if(O){P=P.replace(/\(([^\)]*?<!--lvl-->[^\(]*?)\)/gi,function(af,ae){return'(<a href="javascript:" onmousedown="return false" class="tip" style="color: white; cursor: pointer" onclick="WH.staticTooltipLevelClick(this, null, 0)" onmouseover="WH.Tooltip.showAtCursor(event, \'<span class=\\\'q2\\\'>\' + WH.TERMS.clicktochangelevel_stc + \'</span>\')" onmousemove="WH.Tooltip.cursorUpdate(event)" onmouseout="WH.Tooltip.hide()">'+ae+"</a>)"});if(P.indexOf("<!--artpow:")>0){if(!this.hasOwnProperty("_knowledgeLevel")){var G=/(&|\?)artk=(\d+)/.exec(location.href);if(G&&parseInt(G[2])<=g_artifact_knowledge_max_level){this._knowledgeLevel=parseInt(G[2])}}var F=this._knowledgeLevel?parseInt(this._knowledgeLevel):0;P=P.replace(/(<!--ndstart-->)?<!--ndend-->/i,function(ae,af){return(af?af+"<br />":" ")+'<a href="javascript:" onmousedown="return false" class="tip" style="color: white; cursor: pointer" onclick="WH.staticTooltipKnowledgeLevelClick(this, null, '+Q+')" onmouseover="WH.Tooltip.showAtCursor(event, \'<span class=\\\'q2\\\'>\' + WH.TERMS.clicktochangelevel_stc + \'</span>\')" onmousemove="WH.Tooltip.cursorUpdate(event)" onmouseout="WH.Tooltip.hide()">'+WH.sprintf(WH.TERMS.knowledge_format.replace("%d","$1"),F)+"</a>"});P=P.replace(/(<!--artpow:(\d+)-->)[\d\.\,]+/,function(ae,ag,af){return ag+WH.numberLocaleFormat(WH.roundArtifactPower(parseInt(af)*WH.getArtifactKnowledgeMultiplier(F)))})}}if(W&&Slider){var V=WH.groupSizeScalingShouldShow(Q);if(v){v.bufftip=this;if(V&&WH.isSet("g_difficulties")&&g_difficulties[V]){P=WH.groupSizeScalingOnChange.call(v,this,g_difficulties[V].maxplayers,1,true)}}else{var e=new RegExp("<!--"+((q&&q==3)?"i":"")+"\\?(\\d+):(\\d+):(\\d+):(\\d+)");var l=P.match(e);if(typeof l=="undefined"&&q==3){e=new RegExp("<!--\\?(\\d+):(\\d+):(\\d+):(\\d+)");l=P.match(e)}if(!l&&!WH.isRetailTree()){e=new RegExp("<!--ppl(\\d+):(\\d+):(\\d+):(\\d+):(\\d+)");var a=P.match(e);if(a){l=[null,null,a[2],WH.maxLevel,WH.maxLevel]}}if(V&&WH.isSet("g_difficulties")&&g_difficulties[V]){var s=WH.ce("label");s.innerHTML=WH.TERMS.difficulty+": ";this._difficultyBtn=WH.ce("a");this._difficultyBtn.ttId=Q;WH.difficultyBtnBuildMenu.call(this,Q);Menu.add(this._difficultyBtn,this._difficultyBtn.menu);$("#dd"+Q).append(s).append(this._difficultyBtn);WH.difficultyBtnOnChange.call(this,z[Q].initial_dd||V,z[Q].initial_ddSize);P=WH.groupSizeScalingOnChange.call(this,this,g_difficulties[V].maxplayers,0,true)}else{if(l){if(l[2]!=l[3]){this.slider=Slider.init(W,{maxValue:parseInt(l[3]),minValue:Math.max(parseInt(l[2]),1),onMove:WH.tooltipSliderMove.bind(this),title:WH.GlobalStrings.LEVEL});Slider.setValue(this.slider,parseInt(l[4]));this.slider.onmouseover=function(ae){WH.Tooltip.showAtCursor(ae,WH.TERMS.dragtochangelevel_stc,0,0,"q2")};this.slider.onmousemove=WH.Tooltip.cursorUpdate;this.slider.onmouseout=WH.Tooltip.hide;WH.Tooltip.simple(Slider.getInput(this.slider),WH.TERMS.clicktochangelevel_stc,"q2")}}}}}if(b){if(v&&v.modified){v.bufftip=this}else{var Z=0;for(var ac in aa){if(aa.hasOwnProperty(ac)&&g_spells.hasOwnProperty(ac)&&WH.inArray(g,ac)==-1){Z++}}var H;for(var ac in aa){if(!g_spells[ac]||WH.inArray(g,ac)!=-1){continue}if(Z<4){var X=WH.ce("label");var f=WH.ce("input",{type:"checkbox",dataset:{spellId:ac}});WH.ae(X,f);WH.aE(f,"click",WH.tooltipSpellsChange.bind(this));WH.ae(X,WH.ce("a",{dataset:{wowhead:"spell="+ac+"&know="+ac}},WH.ct(g_spells[ac]["name_"+Locale.getName()]+(g_spells[ac]["rank_"+Locale.getName()]||""))));X.setAttribute("unselectable","");WH.ae(b,X);WH.ae(b,WH.ce("br"))}else{if(!H){H=WH.ce("select");H.multiple=true;H.size=6;WH.ae(b,H);WH.aE(H,"change",WH.tooltipSpellsChange.bind(this))}WH.ae(H,WH.ce("option",{value:ac},WH.ct(g_spells[ac]["name_"+Locale.getName()]+(g_spells[ac]["rank_"+Locale.getName()]||""))))}}}this.modified=[b,aa,g];$(b).toggle(!$(b).is(":empty"))}if(d){var a=P.match(/<!--rppm-->(\d+(?:\.\d+)?)<!--rppm-->/);if(a){var m=$("#rppm"+Q);if(this._rppmModList.hasOwnProperty(4)){this._rppmModBase=parseFloat(a[1]);if(m.is(":empty")){this._rppmSpecModList=this._rppmModList[4];this._rppmSpecModList.splice(0,0,{spec:-1,modifiervalue:0,filename:""});m.append(WH.getMajorHeading(WH.TERMS.realppmmodifiers,2,3));for(var ac in this._rppmSpecModList){var t=Icon.create(this._rppmSpecModList[ac]["filename"],0,null);t.style.display="inline-block";t.style.verticalAlign="middle";var j=$('<input name="rppmmod" type="radio" id="rppm-'+ac+'" />');j.get(0).checked=(this._rppmSpecModList[ac]["spec"]==-1);m.append(j).append(this._rppmSpecModList[ac]["spec"]==-1?"":t).append('<label for="rppm-'+ac+'"> <a>'+(this._rppmSpecModList[ac]["spec"]==-1?WH.TERMS.none:WH.Wow.PlayerClass.Specialization.getName(this._rppmSpecModList[ac]["spec"]))+"</a></label>").append("<br />");var S=this;$("#rppm-"+ac).change(function(){WH.tooltipRPPMChange.call(this,S)})}}else{var B=this._rppmModBase;var E=this._rppmSpecModList;P=P.replace(/<!--rppm-->(\[?)(\d+(?:\.\d+)?)([^<]*)<!--rppm-->/,function(ae,ah,ag,af){return"<!--rppm-->"+ah+(B*(1+parseFloat(E[$('input[name="rppmmod"]:checked',m).attr("id").match(/\d+$/)[0]].modifiervalue))).toFixed(2)+af+"<!--rppm-->"})}}m.toggle(!(m.is(":empty")));var J="";if(this._rppmModList.hasOwnProperty(1)){J+=" + "+LANG.traits.hastertng[2]}else{if(this._rppmModList.hasOwnProperty(2)){J+=" + "+LANG.traits.critstrkrtng[2]}}if(g_pageInfo.type==6&&this._rppmModList.hasOwnProperty(6)){J+=" + Budget"}if(J.length>0){P=P.replace(/<!--rppm-->\[?(\d+(?:\.\d+)?)([^<]*)<!--rppm-->/,function(ae,ag,af){return"<!--rppm-->["+ag+J+"]"+af+"<!--rppm-->"})}}}if(C){for(ac=1;ac<=T;++ac){$(C).append('<input type="checkbox" id="item-upgrade-'+ac+'" />').append('<label for="item-upgrade-'+ac+'"><a>'+WH.term("itemUpgrade_format",ac)+"</a></label>").append("<br />");$("#item-upgrade-"+ac).change(WH.upgradeItemTooltip.bind(this,C,ac))}if(z[Q]&&z[Q].hasOwnProperty("tooltip_"+Locale.getName()+"_pvp")){$(C).append('<input type="checkbox" id="item-upgrade-pvp" />').append('<label for="item-upgrade-pvp"><a>'+WH.TERMS.pvpmode+"</a></label>").append("<br />");$("#item-upgrade-pvp").change(WH.upgradeItemTooltip.bind(this,C,"pvp"))}if(z[Q]&&z[Q].hasOwnProperty("tooltip_"+Locale.getName()+"_twtbc")){$(C).append('<input type="checkbox" id="item-upgrade-twtbc" />').append('<label for="item-upgrade-twtbc"><a>'+g_difficulty_names[24]+" "+WH.TERMS.theburningcrusade_short+"</a></label>").append("<br />");$("#item-upgrade-twtbc").change(WH.upgradeItemTooltip.bind(this,C,"twtbc"))}if(z[Q]&&z[Q].hasOwnProperty("tooltip_"+Locale.getName()+"_twwotlk")){$(C).append('<input type="checkbox" id="item-upgrade-twwotlk" />').append('<label for="item-upgrade-twwotlk"><a>'+g_difficulty_names[24]+" "+WH.TERMS.wrathofthelichking_abbrev+"</a></label>").append("<br />");$("#item-upgrade-twwotlk").change(WH.upgradeItemTooltip.bind(this,C,"twwotlk"))}if(z[Q]&&z[Q].hasOwnProperty("tooltip_"+Locale.getName()+"_twcata")){$(C).append('<input type="checkbox" id="item-upgrade-twcata" />').append('<label for="item-upgrade-twcata"><a>'+g_difficulty_names[24]+" "+WH.TERMS.cataclysm_abbrev+"</a></label>").append("<br />");$("#item-upgrade-twcata").change(WH.upgradeItemTooltip.bind(this,C,"twcata"))}if(z[Q]&&z[Q].hasOwnProperty("tooltip_"+Locale.getName()+"_twmists")){$(C).append('<input type="checkbox" id="item-upgrade-twmists" />').append('<label for="item-upgrade-twmists"><a>'+g_difficulty_names[24]+" "+WH.TERMS.mistsofpandaria_abbrev+"</a></label>").append("<br />");$("#item-upgrade-twmists").change(WH.upgradeItemTooltip.bind(this,C,"twmists"))}$(C).toggle(!$(C).is(":empty"))}if(q==3){var u=$("#cs"+Q);if(u&&WH.Wow.Item.tooltipHasSpecStats(P)){if(!this._classSpecBtn){var w=WH.ce("label");w.innerHTML=WH.TERMS.showingtooltipfor_stc+" ";this._classSpecBtn=WH.ce("a");this._classSpecBtn.ttId=Q;WH.classSpecBtnBuildMenu.call(this,z[Q].hasOwnProperty("validMenuSpecs")?z[Q].validMenuSpecs:false);Menu.add(this._classSpecBtn,this._classSpecBtn.menu);u.append(w).append(this._classSpecBtn).show()}var I=WH.LocalStorage.get("tooltips_class:spec");I=I?I.split(":"):null;var Y=/(&|\?)class=(\d+)/.exec(location.href);if(Y){I=[Y[2],0]}var D=/(&|\?)spec=(\d+)/.exec(location.href);var N,p;if(D){N=D[2];p=WH.Wow.PlayerClass.getBySpec(N);if(p){I=[p,N]}}if(I&&I.length==2){P=WH.classSpecBtnOnChange.call(this,I[0],I[1],P,true)}else{$(this._classSpecBtn).text(WH.isRetailTree()?WH.TERMS.chooseaspec_stc:WH.TERMS.chooseAClass_stc)}}}if(z[Q]&&WH.bonusesBtnShouldShow(z[Q].bonusesData)){var c=$("#bs"+Q);if(c&&!this._bonusesBtn){var h=WH.ce("label");h.innerHTML=WH.TERMS.itembonuses+": ";this._bonusesBtn=WH.ce("a");this._bonusesBtn.ttId=Q;this._bonusesBtn.menu=WH.bonusesBtnBuildMenu.call(this,z[Q]);Menu.add(this._bonusesBtn,this._bonusesBtn.menu);$(this._bonusesBtn).text(WH.TERMS.selectbonus_stc);c.append(h).append(this._bonusesBtn).show();if(L!==""){WH.bonusesBtnOnChange.call(this,L,true)}}}(function(){let craftedStatDiv=WH.ge("craftedStatsSelector"+Q);if(!z[Q]||!craftedStatDiv||craftedStatDiv.dataset.initialized){return}const ae=this;let statSlots=0;let anchor;let toggleCraftedStat=function(af){let currentStats=getCraftedStats();let pos=currentStats.indexOf(af);if(pos>=0){currentStats.splice(pos,1)}else{currentStats.push(af);currentStats=currentStats.slice(-1*statSlots)}WH.Url.modifyPageQuery(function(ag){if(currentStats.length){ag["crafted-stats"]=currentStats.join(":")}else{delete ag["crafted-stats"]}});updateAnchor();if(z[Q]["tooltip_"+Locale.getName()]){let L=this._bonusesBtn&&this._bonusesBtn.selectedBonus?this._bonusesBtn.selectedBonus:null;let tooltipStr=WH.enhanceTooltip.call(this,Q,true,true,false,null,this._knownSpells,WH.ge("ks"+Q),U,null,null,true,null,null,L);WH.updateTooltip.call(this,tooltipStr)}};let updateAnchor=function(){let text="";let currentStats=getCraftedStats();if(!currentStats.length){text=WH.TERMS.none}else{currentStats.forEach(function(af){text+=(text?" + ":"")+LANG.traits[WH.statToJson[af]][0]})}WH.st(anchor,text)};craftedStatDiv.dataset.initialized=1;let statsInfo=z[Q].jsonequip&&z[Q].jsonequip.statsInfo||{};WH.Wow.Item.CRAFTING_STAT_FROM.forEach(function(af){if(statsInfo.hasOwnProperty(af)){statSlots++}});if(!statSlots){return}WH.displayDefault(craftedStatDiv);WH.ae(craftedStatDiv,WH.ce("label",{},WH.ct(WH.TERMS.optionalReagentStats+WH.TERMS.colon_punct)));anchor=WH.ce("a",{},WH.ct(WH.TERMS.none));WH.ae(craftedStatDiv,anchor);let menu=[];WH.Wow.Item.CRAFTING_STAT_TO.forEach(function(af){menu.push(Menu.createItem({label:LANG.traits[WH.statToJson[af]][0],name:af,url:toggleCraftedStat.bind(ae,af),options:{checkedFunc:function(ag){return getCraftedStats().includes(parseInt(ag[Menu.ITEM_NAME]))}}}))});menu.sort(function(ag,af){return ag[Menu.ITEM_LABEL].localeCompare(af[Menu.ITEM_LABEL])});Menu.add(anchor,menu);updateAnchor()}).call(this);if(q===WH.Types.ITEM){WH.updateItemStringLink.call(this)}return P};WH.groupSizeScalingShouldShow=function(a){if(WH.isSet("g_difficulties")&&WH.isSet("g_spells")&&g_spells[a]&&g_spells[a].difficulties&&g_spells[a].difficulties.length>0){return g_spells[a].difficulties[0]}return false};WH.groupSizeScalingSliderMove=function(f,d,b){var a=WH.getDataSource();var c=WH.isSet("g_pageInfo")?g_pageInfo.typeId:null;if(!a[c]){return}let dd=this._difficultyBtn.selectedDD;let ddSize=b.value;WH.Url.modifyPageQuery(function(e){if(dd!=WH.groupSizeScalingShouldShow(c)||ddSize!=g_difficulties[WH.groupSizeScalingShouldShow(c)].maxplayers){e.dd=dd;e.ddsize=ddSize}else{delete e.dd;delete e.ddsize}});WH.groupSizeScalingOnChange.call(this,this,b.value,0);if(this.bufftip){WH.groupSizeScalingOnChange.call(this,this.bufftip,b.value,1)}WH.Tooltip.hide()};WH.groupSizeScalingOnChange=function(a,c,p,q){const r=this;while(a.className.indexOf("tooltip")==-1){a=a.parentNode}c=parseInt(c);if(isNaN(c)){return}var f=WH.getDataSource();var h=WH.isSet("g_pageInfo")?g_pageInfo.typeId:null;if(!f[h]){return}var e=this._difficultyBtn.selectedDD;var l=Locale.getName();var d="server_"+(p?"buff_":"tooltip_")+l;var m="dd"+e+"ddsize"+c;WH.groupSizeScalingOnChange.lastCall=m;if(!f[h][d]){f[h]["server_tooltip_"+l]={};f[h]["server_buff_"+l]={};var b="dd"+f[h].initial_dd+"ddsize"+f[h].initial_ddSize;f[h]["server_tooltip_"+l][b]=f[h]["tooltip_"+l];f[h]["server_buff_"+l][b]=f[h]["buff_"+l]}if(f[h][d][m]){var g=f[h][d][m];if(q){return g}WH.updateTooltip.call(a,g);return}if(q){return f[h][d.substr(7)]}if(p){return}if(f[h][d].hasOwnProperty(m)){return}f[h][d][m]="";var j="/spell="+h+"&dd="+e+"&ddsize="+c;if(WH.isBeta()||WH.isPtr()){j+="&"+WH.getDataBuild()}WH.xhrJsonRequest(j,(function(s){if(!s){return}f[h]["server_tooltip_"+l][m]=s.tooltip;f[h]["server_buff_"+l][m]=s.buff;if(WH.groupSizeScalingOnChange.lastCall===m){WH.groupSizeScalingOnChange.call(r,a,c);if(r.bufftip){WH.groupSizeScalingOnChange.call(r,r.bufftip,c,true)}}}))};WH.difficultyBtnBuildMenu=function(f){var e=[];var a=g_spells[f];for(var d=0;d<a.difficulties.length;++d){var c=a.difficulties[d];var b=[c,g_difficulty_names[c],WH.difficultyBtnOnChange.bind(this,c,false)];e.push(b)}this._difficultyBtn.menu=e};WH.difficultyBtnOnChange=function(b,d){this._difficultyBtn.selectedDD=b;$(this._difficultyBtn).text("");WH.arrayWalk(this._difficultyBtn.menu,function(j){j.checked=false});var h=Menu.findItem(this._difficultyBtn.menu,[b]);h.checked=true;$(this._difficultyBtn).text(h[MENU_IDX_LABEL]);var f=this._difficultyBtn.selectedPlayers||d;var e=g_difficulties[b].minplayers,a=g_difficulties[b].maxplayers,c=g_difficulties[b].maxplayers;if(f){if(f>a){c=a}else{if(f<e){c=e}else{c=f}}}e=a;var g=$("#sl"+this._difficultyBtn.ttId);g.html("").hide();this.slider=null;if(e!=a){g.show();this.slider=Slider.init(g.get(0),{maxValue:parseInt(a),minValue:parseInt(e),onMove:WH.groupSizeScalingSliderMove.bind(this),title:WH.TERMS.players});Slider.setValue(this.slider,parseInt(c));this.slider.onmouseover=function(j){WH.Tooltip.showAtCursor(j,WH.TERMS.dragtochangeplayers_stc,0,0,"q2")};this.slider.onmousemove=WH.Tooltip.cursorUpdate;this.slider.onmouseout=WH.Tooltip.hide;WH.Tooltip.simple(Slider.getInput(this.slider),WH.TERMS.clicktochangeplayers_stc,"q2")}WH.groupSizeScalingSliderMove.call(this,null,null,{value:c})};WH.classSpecBtnOnChange=function(e,a,d,b){e=parseInt(e);a=a?parseInt(a):null;WH.ee(this._classSpecBtn);this._classSpecBtn.selectedSpec=a;let menuItem=Menu.findItem(this._classSpecBtn.menu,[e,a]);if(menuItem&&menuItem[Menu.ITEM_OPTIONS]&&menuItem[Menu.ITEM_OPTIONS].tinyIcon){let tinyIcon=menuItem[Menu.ITEM_OPTIONS].tinyIcon;let icon=WH.Icon.create(tinyIcon,WH.Icon.SMALL,"javascript:");icon.style.display="inline-block";icon.style.verticalAlign="middle";WH.ae(this._classSpecBtn,icon)}let specName=WH.Wow.PlayerClass.Specialization.getName(a);WH.ae(this._classSpecBtn,WH.ce("span",undefined,WH.ct(" "+((!WH.isRetailTree()||!specName)?g_chr_classes[e]:WH.Strings.sprintf(WH.TERMS.specclass_format,specName,g_chr_classes[e])))));if(!b){WH.LocalStorage.set("tooltips_class:spec",e+":"+a)}var c=d?d:this.innerHTML;c=c.replace(/<!--scstart(\d+):(\d+)--><span class="q(\d+)">(<!--asc\d+-->)?(.*?)<\/span><!--scend-->/i,function(m,h,j,g,l,f){g=1;var q=h==2&&(!g_classes_allowed_weapon[e]||WH.inArray(g_classes_allowed_weapon[e],j)==-1);var p=h==4&&(!g_classes_allowed_armor[e]||WH.inArray(g_classes_allowed_armor[e],j)==-1);if(q||p){g=10}return"<!--scstart"+h+":"+j+'--><span class="q'+g+'">'+(l?l:"")+f+"</span><!--scend-->"});if(WH.isRetailTree()){c=c.replace(/<span[^>]*?><!--stat(\d+)-->([-+][\d\.,]+(?:-[\d\.,]+)?)(\D*?)<\/span>/gi,function(l,j,g,f){let div=WH.ce("div",{innerHTML:l});let span=WH.qs("span",div);span.classList.remove("q0","q2");j=parseInt(j);if(j===50){span.classList.add("q2")}if(g_grayedOutStats[j]&&(g_grayedOutStats[j].indexOf(a)!=-1)){span.classList.remove("q2");span.classList.add("q0")}let realStatId=a?WH.getStatForSpec(j,a):WH.getStatForClass(j,e);if(realStatId!==j&&WH.statToJson[realStatId]){var h=LANG.traits[WH.statToJson[realStatId]];if(h){f=" "+h[1]}}span.innerHTML="<!--stat"+j+"-->";WH.ae(span,WH.ct(g+f));return span.outerHTML});c=c.replace(/(<!--traitspecstart:(\d+)(?::(\d+))?-->)[\w\W]*?(<!--traitspecend-->)/g,function(l,j,f,h,g){var m="";if(WH.isSet("g_pageInfo")&&g_pageInfo.hasOwnProperty("typeId")&&g_pageInfo.type==3&&g_items.hasOwnProperty(g_pageInfo.typeId)&&g_items[g_pageInfo.typeId].hasOwnProperty("affectsArtifactPowerTypesData")&&g_items[g_pageInfo.typeId].affectsArtifactPowerTypesData.hasOwnProperty(f)&&g_items[g_pageInfo.typeId].affectsArtifactPowerTypesData[f].hasOwnProperty(a)){m=g_items[g_pageInfo.typeId].affectsArtifactPowerTypesData[f][a]}else{if(h){m='<span style="color: #00FF00">'+WH.sprintf(LANG["tooltip_relicrank"+(h>1?"s":"")+"increase"].replace("%d","$1"),h)+": </span>"+WH.TERMS.relic_minortrait}}return j+m+g})}WH.Url.modifyPageQuery(function(f){if(e){f["class"]=e}else{delete f["class"]}if(WH.isRetailTree()&&a){f.spec=a}else{delete f.spec}});if(!d){this.innerHTML=WH.Tooltip.evalFormulas(c)}return c};WH.classSpecBtnBuildMenu=function(l){var d=[];if(!WH.isRetailTree()){d.push([,WH.TERMS.chooseAClass_stc]);var j=Menu.findItem(mn_spells,[7]);d=d.concat($.extend(true,[],Menu.getSubmenu(j)))}else{d.push([,WH.TERMS.chooseaspec_stc]);var r=Menu.findItem(mn_spells,[-12]);d=d.concat($.extend(true,[],Menu.getSubmenu(r)))}for(var m in g_chr_specs_by_class){var f=g_chr_specs_by_class[m];for(var q in d){var b=d[q];if(b[Menu.ITEM_NAME]==m){if(!WH.isRetailTree()){b[Menu.ITEM_URL]=WH.classSpecBtnOnChange.bind(this,m,0,false)}else{if(b[Menu.ITEM_URL]){b[Menu.ITEM_URL]=null}for(var e=0,p=f.length;e<p;e++){var a=Menu.getSubmenu(d[q]);for(var g=0,c=a.length;g<c;g++){var h=a[g];if(h[Menu.ITEM_NAME]==f[e]){if(l&&(WH.inArray(l,f[e])<0)){delete h[Menu.ITEM_OPTIONS].tinyIcon;h[Menu.ITEM_OPTIONS].className="q0";h[Menu.ITEM_URL]="javascript:"}else{h[Menu.ITEM_URL]=WH.classSpecBtnOnChange.bind(this,m,f[e],false)}break}}}}break}}}this._classSpecBtn.menu=d};WH.getStatForClass=function(a,b){let potentialStat=undefined;let specIds=WH.Wow.PlayerClass.Specialization.getByClass(b)||[];for(let i=0,specId;specId=specIds[i];i++){let specStat=WH.getStatForSpec(a,specId);if(potentialStat===undefined){potentialStat=specStat}else{if(potentialStat!==specStat){potentialStat=null;break}}}return potentialStat};WH.getStatForSpec=function(d,p){var a=3;var q=4;var h=5;var b=71;var j=72;var f=73;var g=74;var c;var e;var m=g_specPrimaryStatOrders[p];var l=g_specPrimaryStatOrders[p].length;if(d===b){e=0;if(!l){return h}while(1){c=m[e];if(c>=a&&c<=h){break}e++;if(e>=l){return h}}}else{if(d!==j){if(d!==f){if(d!==g){return d}e=0;if(l){while(1){c=m[e];if(c>=q&&c<=h){break}e++;if(e>=l){return h}}return c}return h}e=0;if(l){while(1){c=m[e];if(m[e]===a){break}if(m[e]===h){break}e++;if(e>=l){return h}}return c}return h}e=0;if(!l){return a}while(1){c=m[e];if(c>=a&&c<=q){break}e++;if(e>=l){return a}}}return c};WH.bonusesBtnShouldShow=function(a){for(var b in a){if(a.hasOwnProperty(b)){return true}}return false};WH.bonusesBtnBuildMenu=function(t){var w=[];var e=t.bonusesData;if(e){for(var h in e){var u=e[h].groupedUpgrade;var p=WH.getItemBonusName.call(this,h,t);var d=[h,p,WH.bonusesBtnOnChange.bind(this,(u?"u:":"")+h,false)];if(typeof u=="undefined"){for(var q in e[h].sub){u=e[h].sub[q].groupedUpgrade;p=WH.getItemBonusName.call(this,q,t,h);if(p=="???"){continue}var g=[q,p,WH.bonusesBtnOnChange.bind(this,h+":"+(u?"u:":"")+q,false,true)];Menu.addToSubmenu(d,g)}}var l=Menu.getSubmenu(d);if(l){l.sort(function(A,z){var C=WH.getItemBonusChanceType(A[Menu.ITEM_NAME]);var B=WH.getItemBonusChanceType(z[Menu.ITEM_NAME]);return WH.stringCompare(C,B)||WH.stringCompare(A[MENU_IDX_LABEL],z[MENU_IDX_LABEL])});var v=[];var c=0;for(var s=0;s<l.length;++s){var q=l[s][MENU_IDX_NAME];if(q&&e[h].sub[q].type!=c){c=e[h].sub[q].type;var r=WH.TERMS.unknown;switch(c){case 1:r=WH.TERMS.upgrades;break;case 2:r=WH.TERMS.stats;break;case 4:r=WH.TERMS.sockets;break;default:break}v.push([s,r])}}for(var s=0;s<v.length;++s){var b=v[s][0]+s;var m=[null,v[s][1]];l.splice(b,0,m)}}w.push(d)}var f={};for(var j=0;j<w.length;j++){if(f.hasOwnProperty(w[j][1])){w[j][1]+=WH.TERMS.wordspace_punct+WH.TERMS.openparenthesis_punct+ ++f[w[j][1]]+WH.TERMS.closedparenthesis_punct}else{f[w[j][1]]=1}}w.sort(function(B,z){var C=B[1].innerText?B[1].innerText:B[1];var A=z[1].innerText?z[1].innerText:z[1];return WH.stringCompare(C,A)})}var a=[[null,WH.TERMS.selectbonus_stc]];if(w.length>0){a=a.concat(w)}return a};WH.getItemBonusChanceType=function(f){var e=0;if(f>0&&WH.isSet("g_itembonuses")&&g_itembonuses&&g_itembonuses[f]){var a=g_itembonuses[f];for(var c=0;c<a.length;++c){var b=a[c];var d=0;switch(b[0]){case 1:case 3:case 4:case 5:case 11:d=1;break;case 2:d=2;break;case 6:d=4;break;default:break}if(d&&(!e||d<e)){e=d}}}return e};WH.getItemBonusUpgradeType=function(d){if(d>0&&WH.isSet("g_itembonuses")&&g_itembonuses&&g_itembonuses[d]){var a=g_itembonuses[d];for(var c=0;c<a.length;++c){var b=a[c];switch(b[0]){case 3:case 4:case 5:case 11:return 1<<b[0];default:break}}}return 0};WH.getItemBonusName=function(g,s,f){var h="";var c=s.level;let hasCorruptionResist=false;if(f&&WH.isSet("g_itembonuses")&&f>0&&g_itembonuses[f]){for(var d=0;d<g_itembonuses[f].length;++d){var m=g_itembonuses[f][d];if(m[0]==1){c+=m[1]}}}if(WH.isSet("g_itembonuses")&&g>0&&g_itembonuses[g]){var e=g_itembonuses[g].slice();e.sort(function(t,j){return t[0]-j[0]});var a="";var r="";let desc="";let suffix="";let effectName="";for(var d=0;d<e.length;++d){var m=e[d];switch(m[0]){case 1:a=WH.TERMS.itemlevel+" "+(c+m[1]);break;case 2:h+=(h?" / ":"")+((WH.statToJson[m[1]]&&LANG.traits[WH.statToJson[m[1]]])?LANG.traits[WH.statToJson[m[1]]][1]:"Unknown stat");if(m[1]==23){h+=" "+m[2];hasCorruptionResist=true}break;case 3:r=m[1];break;case 4:if(WH.isSet("g_item_namedescriptions")&&g_item_namedescriptions[m[1]]){desc=g_item_namedescriptions[m[1]][0]}break;case 5:if(WH.isSet("g_item_namedescriptions")&&g_item_namedescriptions[m[1]]){suffix=g_item_namedescriptions[m[1]][0]}break;case 6:var l=m[2];h+=(h?" / ":"")+m[1]+" "+(g_socket_names[l]||(g_gem_types[l]?WH.sprintf(WH.TERMS.emptyrelicslot_format.replace("%s","$1"),g_gem_types[l]):"Unknown Socket"));break;case 8:h+=(h?" / ":"")+WH.sprintf(WH.TERMS.requireslevel_format.replace("%s","$1"),s.reqlevel+m[1]);break;case 11:if(s.heirloombonuses){var p="?";for(var b=0,q;q=s.heirloombonuses[b];b++){if(parseInt(g)===q){p=b+1;break}}h+=(h?" / ":"")+WH.sprintf(WH.TERMS.heirloomupgradejs_format,p)}break;case 13:a=WH.TERMS.scaleswithlevel_stc;break;case 14:if(s.actualBonusLevels&&s.actualBonusLevels[g]){a=WH.TERMS.itemlevel+" "+s.actualBonusLevels[g]+"+"}else{a=WH.TERMS.itemlevel+" "+c+"+"}break;case 23:if(m[1]>0){effectName=WH.Tooltip.ITEM_EFFECT_NAMES[m[1]]||""}break;default:break}}if(hasCorruptionResist&&!a&&c){a=WH.TERMS.itemlevel+WH.TERMS.wordspace_punct+c}if(a){h=h?a+" / "+h:a}desc+=suffix?WH.TERMS.wordspace_punct+suffix:"";h+=desc?" / "+desc:"";if(effectName&&!hasCorruptionResist){h=effectName+(h?" / "+h:"")}h+=(r&&s.quality!=r)?" / "+WH.Wow.Item.getQualityName(r):"";if(h.substr(0,3)==" / "){h=h.substr(3)}}else{if(g=="0"){h=WH.TERMS.normal}}return h?h:(f?WH.TERMS.openparenthesis_punct+g+WH.TERMS.closedparenthesis_punct:WH.TERMS.normal)};WH.bonusesBtnGetContextBonusId=function(a){let contextBonusId=0;let itemBonusesListGroup=WH.getPageData("WH.Wow.Item.Bonuses.listGroup");if(a&&a.length){for(let i=0;i<a.length;++i){let bonusId=parseInt(a[i]);if((window.g_itembonuses&&g_itembonuses["-1"]&&g_itembonuses["-1"].includes(bonusId))||(itemBonusesListGroup!==null&&itemBonusesListGroup.includes(bonusId))){contextBonusId=a[i];break}}}return contextBonusId};WH.bonusesBtnIsComboValid=function(g,d,h){if(!g[d]||!g[d].sub){return false}var e=g[d].sub;var f=32768;var c=32768;for(var a in h){var j=h[a];if(j!=d){if(e[j]){if((f&e[j].type)==1){}else{if(f&e[j].type){f=false;break}else{f|=e[j].type}}if(c&e[j].upgradeType){c=false;break}else{c|=e[j].upgradeType}}else{f=false;break}}}return f&&c};WH.bonusesGetItem=function(){var a=WH.getDataSource();var b=this._bonusesBtn.ttId;return a[b]};WH.bonusesGetDefaultAdjustmentBonus=function(c){var b=WH.bonusesGetItem.call(this);var a=WH.bonusesBtnGetContextBonusId(c);if(b.defaultAdjustmentBonuses[a]){return b.defaultAdjustmentBonuses[a].toString()}return null};WH.bonusesBtnOnChange=function(M,W,b){var B=WH.getDataSource();var C=this._bonusesBtn.ttId;var L=B[C].bonusesData;if(b===true){var e=M.split(":");var E=0;var w=e.indexOf("u");if(w!=-1){E=e[w+1];e.splice(w,1)}var m=e[0];var J=!Menu.findItem(this._bonusesBtn.menu,e).checked;var P=0;var r=[];WH.arrayWalk(this._bonusesBtn.menu,function(ac){if(ac.checked){P=ac[MENU_IDX_NAME];var j=Menu.getSubmenu(ac);if(j){WH.arrayWalk(j,function(ad){if(ad[MENU_IDX_NAME]&&ad.checked){r.push(ad[MENU_IDX_NAME]);if(P==m&&L[P].sub[ad[MENU_IDX_NAME]].groupedUpgrade&&!E){E=ad[MENU_IDX_NAME]}}})}}});var d;if(P==m){if(J){d=r.concat(e)}else{r.splice(r.indexOf(e[1]),1);d=r.concat([m])}}else{d=e}d.sort(function(ac,j){return ac-j});if(!WH.bonusesBtnIsComboValid(L,m,d)){d=e;var F=L[m].sub[e[1]].type;var K=L[m].sub[e[1]].upgradeType;for(var Y=0;Y<r.length;++Y){if(F!=L[m].sub[r[Y]].type){d.push(r[Y])}else{if(K!=L[m].sub[r[Y]].upgradeType){d.push(r[Y])}}}d.sort(function(ac,j){return ac-j})}if(E){var G=d.indexOf(E);if(G!=-1){d.splice(d.indexOf(E),0,"u")}}M=d.join(":").replace(/^0:/,"")}this._bonusesBtn.selectedBonus=M;var I=this._bonusesBtn.selectedBonus.split(":");var Q=WH.bonusesGetDefaultAdjustmentBonus.call(this,I);if(Q!=null){var O=false;for(var Y in I){var u=I[Y];if(1372<=u&&u<=1672){O=true}}if(!O){I.push(Q);this._bonusesBtn.selectedBonus=I.join(":")}}var w=I.indexOf("u");if(w!=-1){I.splice(w,1)}var t=[];for(var Y=0;Y<this._bonusesBtn.menu.length;Y++){var z=this._bonusesBtn.menu[Y][MENU_IDX_NAME];if(z&&t.indexOf(z)<0){t.push(z)}}I.sort(function(ac,j){return(t.indexOf(ac)<0?1:-1)-(t.indexOf(j)<0?1:-1)});$(this._bonusesBtn).html("");var q=WH.bonusesBtnGetContextBonusId(I);WH.arrayWalk(this._bonusesBtn.menu,function(ac){ac.checked=ac[MENU_IDX_NAME]==q;var j=Menu.getSubmenu(ac);if(j){WH.arrayWalk(j,function(ad){if(ad[MENU_IDX_NAME]){ad.checked=ac.checked&&I.indexOf(ad[MENU_IDX_NAME])!=-1;if(ad.$a){ad[MENU_IDX_OPT]=null;Menu.updateItem(ad)}}})}});var aa=Menu.findItem(this._bonusesBtn.menu,[q]);if(aa){var T=Menu.getSubmenu(aa);if(T){WH.arrayWalk(T,function(ac){if(ac[MENU_IDX_NAME]){var j=I;if(I.indexOf(ac[MENU_IDX_NAME])==-1){j=j.concat([ac[MENU_IDX_NAME]])}j.sort(function(ae,ad){return ae-ad});if(!WH.bonusesBtnIsComboValid(L,q,j)&&I.indexOf(Q)==-1){ac[MENU_IDX_OPT]={"class":"q0"}}else{ac[MENU_IDX_OPT]={}}Menu.updateItem(ac)}})}}var v=(aa&&aa[MENU_IDX_LABEL])||WH.getItemBonusName.call(this,q,B[C]);for(var Y=0;Y<I.length;++Y){if(I[Y]!=q&&I[Y]!=Q){v+=" + "+WH.getItemBonusName.call(this,I[Y],B[C],q)}}$(this._bonusesBtn).append(v);var s=0;if(WH.isSet("g_itembonuses")&&g_items&&g_items[C]){for(var Y in I){var p=I[Y];if(g_itembonuses[p]){for(var X=0;X<g_itembonuses[p].length;++X){var D=g_itembonuses[p][X];if(D[0]==7&&g_items[C].appearances&&g_items[C].appearances[D[1]]){s=g_items[C].appearances[D[1]][0];break}}}}}var R=$("#e8c7e052e3e0");if(R.length>0){var l=R.get(0).attributes.onclick.value;var g=new RegExp("\\(this, "+C+", \\[[^\\]]*?],");if(g.test(l)){var N=[];for(var f in I){var h=I[f];if(h==0){N.push(h);continue}var V=WH.isSet("g_itembonuses")&&g_itembonuses[h]?g_itembonuses[h]:[];for(var A in V){if(!V.hasOwnProperty(A)){continue}var ab=V[A][0];var H=V[A][1];if(WH.inArray([1,2,6,14],ab)!=-1){if(ab==2&&WH.inArray([61,62,63,64,66],H)!=-1){continue}N.push(h)}}}R.get(0).attributes.onclick.value=l.replace(g,"(this, "+C+", ["+N.join(",")+"],")}}var Z=$("#ic"+C);if(Z.length>0&&g_items){var U=g_items.getIcon(C,I);if(U){Z[0].removeChild(Z[0].firstChild);Z[0].appendChild(Icon.create(U,2))}}var a=$("#wh-mv-view-in-3d-button")[0];if(a){if(!a.dataset.mvDisplayIdOrig&&a.dataset.mvDisplayId){a.dataset.mvDisplayIdOrig=a.dataset.mvDisplayId}if(!s&&a.dataset.mvDisplayIdOrig){s=a.dataset.mvDisplayIdOrig}if(s){let gathered=WH.Gatherer.get(parseInt(a.dataset.mvType),parseInt(a.dataset.mvTypeId));let raceMask=gathered&&gathered.jsonequip&&gathered.jsonequip.races;let raceId=WH.Wow.Models.getRaceIdFromMask(raceMask);if(gathered.classs!==WH.Wow.Item.CLASS_ARMOR){raceId=undefined}a.attributes.onclick.value=a.attributes.onclick.value.replace(/"displayId":\d+/,'"displayId":'+s);a.dataset.mvDisplayId=s;let stickyImg=WH.ge("sticky-screenshot-model-substitute");if(stickyImg){stickyImg.src=WH.Wow.Item.getThumbUrl(parseInt(s),raceId)}}}let bonusForUrl=this._bonusesBtn.selectedBonus.replace(/u:/,"");WH.Url.modifyPageQuery(function(j){if(bonusForUrl){j.bonus=bonusForUrl}else{delete j.bonus}});WH.updateItemStringLink.call(this);if(!W&&B[C]["tooltip_"+Locale.getName()]){var c=WH.ge("sl"+C);c.innerHTML="";this.slider=null;var S=WH.enhanceTooltip.call(this,C,true,true,c,null,this._knownSpells,WH.ge("ks"+C),this._selectedUpgrade,null,null,true,null,null,this._bonusesBtn.selectedBonus);WH.updateTooltip.call(this,S)}};WH.updateItemStringLink=function(){var a=WH.getDataSource();var l=WH.isSet("g_pageInfo")?g_pageInfo.typeId:null;if(a[l]){var q="";var b=[];if(this._bonusesBtn&&this._bonusesBtn.selectedBonus){q=this._bonusesBtn.selectedBonus.replace(/u:/,"");b=q.split(":")}var h=(typeof this._selectedUpgrade=="number")?this._selectedUpgrade:0;var s=(a[l].upgradeData.length>0)?a[l].upgradeData[h].id:"";var v=this._selectedLevel?this._selectedLevel:WH.maxLevel;var d=this._knowledgeLevel?this._knowledgeLevel:0;var r=(this._classSpecBtn&&this._classSpecBtn.selectedSpec)?this._classSpecBtn.selectedSpec:"";var g=0;var j="";if(s){g|=4;j=(j?":":"")+s}else{if(b.length&&g_itembonuses){bonus_check_block:for(var m=0,e;e=b[m];m++){if(!g_itembonuses[e]){continue}for(var c=0,t;t=g_itembonuses[e][c];c++){if(t[0]==11||t[0]==13){g|=512;j=(j?":":"")+v;break bonus_check_block}}}}}if(d){g|=8388608;j=(j?":":"")+(d+1)}var u=""+(g?g:"")+"::"+(b.length?b.length+":":"")+q+":"+j;var p=WH.ge("open-links-button");if(p){var f={type:3,typeId:l,linkColor:"ff"+WH.Wow.Item.getQualityColor(a[l].quality,true).replace(/^#/,""),linkId:"item:"+l+"::::::::"+v+":"+r+":"+u,linkName:a[l]["name_"+Locale.getName()],bonuses:b,slot:a[l].slot};if(v!=WH.maxLevel){f.lvl=v}if(r){f.spec=r}if(sliderControl=WH.ge("sl"+l)){f.dropLevel=$(sliderControl).find("input").val()}p.onclick=WH.Links.show.bind(WH.Links,p,f)}}};WH.upgradeItemTooltip=function(d,j){var c=WH.getDataSource();var g=g_pageInfo.typeId;if(c[g]){var e=$("#"+d.id+" > input");var a=null;if(typeof j!="number"){e.each(function(l,m){if(m.id.indexOf(j)!=-1){a=m;return false}})}else{a=e.get(j-1)}var h=a.checked;e.each(function(l,m){m.checked=false});a.checked=h;if(!h){j=null}this._selectedUpgrade=j;WH.updateItemStringLink.call(this);if(c[g]["tooltip_"+Locale.getName()]){var f=this._bonusesBtn&&this._bonusesBtn.selectedBonus?this._bonusesBtn.selectedBonus:null;var b=WH.enhanceTooltip.call(this,g,true,true,false,null,this._knownSpells,WH.ge("ks"+g),j,null,null,true,null,null,f);WH.updateTooltip.call(this,b)}}};WH.updateTooltip=function(a){if(this.classList.contains("partial-sub-tooltip")){this.innerHTML=WH.Tooltip.evalFormulas(a);return}this.innerHTML="<table><tr><td>"+WH.Tooltip.evalFormulas(a)+'</td><th style="background-position: top right"></th></tr><tr><th style="background-position: bottom left"></th><th style="background-position: bottom right"></th></tr></table>';WH.Tooltip.fixSafe(this,1,1)};WH.staticTooltipLevelClick=function(b,c,l,q){while(b.className.indexOf("tooltip")==-1){b=b.parentNode}var e=b.innerHTML;var m=e.match(/<!--i?\?(\d+):(\d+):(\d+):(\d+)/);if(!m&&!WH.isRetailTree()){m=e.match(/<!--ppl(\d+):(\d+):(\d+):(\d+):(\d+)/);if(m){m=[null,m[1],m[2],WH.maxLevel,0]}}if(!m){return}var h=parseInt(m[1]),a=parseInt(m[2]),j=parseInt(m[3]),f=parseInt(m[4]);if(a>=j){return}if(isNaN(c)){c=prompt(WH.sprintf(WH.TERMS.ratinglevel_format,a,j),f)}c=parseInt(c);if(isNaN(c)){return}if(c==f||c<a||c>j){return}b._selectedLevel=c;var d=WH.getDataSource();m=(WH.setTooltipLevel.bind(b,d[h][(q?"buff_":"tooltip_")+Locale.getName()],c,q))();var g=b._bonusesBtn&&b._bonusesBtn.selectedBonus?b._bonusesBtn.selectedBonus:null;var p=b._selectedUpgrade?b._selectedUpgrade:0;m=WH.enhanceTooltip.call(b,m,true,null,null,null,null,null,p,null,null,null,null,null,g);WH.updateTooltip.call(b,m);if(b.slider&&!l){Slider.setValue(b.slider,c)}if(!q){(WH.tooltipSpellsChange.bind(b))()}};WH.staticTooltipKnowledgeLevelClick=function(g,f,d){while(g.className.indexOf("tooltip")==-1){g=g.parentNode}var b=g.innerHTML;if(isNaN(f)){WH.Tooltip.hide();f=prompt(WH.sprintf(WH.TERMS.ratinglevel_format,0,g_artifact_knowledge_max_level),g._knowledgeLevel?g._knowledgeLevel:0)}f=parseInt(f);if(isNaN(f)){return}if(f<0||f>g_artifact_knowledge_max_level){return}g._knowledgeLevel=f;WH.Url.modifyPageQuery(function(h){if(f){h.artk=f}else{delete h.artk}});var a=WH.getDataSource();b=(WH.setTooltipLevel.bind(g,a[d]["tooltip_"+Locale.getName()],g._selectedLevel,null))();var e=g._bonusesBtn&&g._bonusesBtn.selectedBonus?g._bonusesBtn.selectedBonus:null;var c=g._selectedUpgrade?g._selectedUpgrade:0;b=WH.enhanceTooltip.call(g,b,true,null,null,null,null,null,c,null,null,null,null,null,e);WH.updateTooltip.call(g,b)};WH.tooltipSliderMove=function(c,b,a){WH.staticTooltipLevelClick(this,a.value,1);if(this.bufftip){WH.staticTooltipLevelClick(this.bufftip,a.value,1,1)}WH.Tooltip.hide()};WH.tooltipSpellsChange=function(){if(!this.modified){return}var c=this.modified[0],a=this.modified[1],b=[];$.each($("input:checked",c),function(d,e){b.push(parseInt(e.dataset.spellId))});$.each($("select option",c),function(e,d){if(d.selected){b.push(parseInt(d.value))}});this.modified[2]=b;this.innerHTML=WH.setTooltipSpells(this.innerHTML,b,a);if(this.bufftip){(WH.tooltipSpellsChange.bind(this.bufftip))()}};WH.tooltipRPPMChange=function(b){var a=$(this).attr("id").match(/\d+$/)[0];b.innerHTML=WH.Tooltip.evalFormulas(b.innerHTML.replace(/<!--rppm-->(\[?)(\d+(?:\.\d+)?)([^<]*)<!--rppm-->/,function(c,f,e,d){return"<!--rppm-->"+f+(b._rppmModBase*(1+parseFloat(b._rppmSpecModList[a].modifiervalue))).toFixed(2)+d+"<!--rppm-->"}))};WH.validateBpet=function(j,d){var a=1,h=25,l=25,b=0,f=4,e=3,m=(1<<10)-1,c=3,g=$.extend({},d);if(j.minlevel){a=j.minlevel}if(j.maxlevel){h=j.maxlevel}if(j.companion){h=a}if(!g.level){g.level=l}g.level=Math.min(Math.max(g.level,a),h);if(j.minquality){b=j.minquality;if(j.untameable){f=b}}if(j.maxquality){f=j.maxquality}if(g.quality==null){g.quality=e}g.quality=Math.min(Math.max(g.quality,b),f);if(j.companion){delete(g.quality)}if(j.breeds>0){m=j.breeds&m}if(!(m&(1<<c-3))){c=Math.floor(3+Math.log(m)/Math.LN2)}if(g.breed&&g.breed>=13){g.breed-=10}if(!g.breed||!(m&(1<<g.breed-3))){g.breed=c}return g};WH.calcBattlePetStats=function(j,c,l,a,d){if(!WH.battlePetBreedStats[c]){c=3}var h=j.health;if(isNaN(h)){h=0}var b=j.power;if(isNaN(b)){b=0}var f=j.speed;if(isNaN(f)){f=0}if(isNaN(l)){l=1}l=Math.min(Math.max(0,l),5);if(isNaN(a)){a=1}a=Math.min(Math.max(1,a),25);var e=WH.battlePetBreedStats[c];var g=1+(l/10);h=((h+e[0])*5*a*g)+100;b=(b+e[1])*a*g;f=(f+e[2])*a*g;if(d){h=h*5/6;b=b*4/5}return{health:Math.round(h),power:Math.round(b),speed:Math.round(f)}};WH.battlePetBreedStats={3:[0.5,0.5,0.5],4:[0,2,0],5:[0,0,2],6:[2,0,0],7:[0.9,0.9,0],8:[0,0.9,0.9],9:[0.9,0,0.9],10:[0.4,0.9,0.4],11:[0.4,0.4,0.9],12:[0.9,0.4,0.4]};WH.battlePetAbilityLevels=[1,2,4,10,15,20];WH.Tooltip={ARTIFACT_KNOWLEDGE_MULTIPLIERS:undefined,BONUS_ITEM_EFFECTS:undefined,ITEM_EFFECT_NAMES:undefined,ITEM_EFFECT_TOOLTIP_HTML:undefined,showingTooltip:false,create:function(j,m){var g=WH.ce("div"),q=WH.ce("table"),c=WH.ce("tbody"),f=WH.ce("tr"),b=WH.ce("tr"),a=WH.ce("td"),p=WH.ce("th"),l=WH.ce("th"),h=WH.ce("th");g.className="wowhead-tooltip";p.style.backgroundPosition="top right";l.style.backgroundPosition="bottom left";h.style.backgroundPosition="bottom right";if(j){a.innerHTML=WH.Tooltip.evalFormulas(j)}WH.ae(f,a);WH.ae(f,p);WH.ae(c,f);WH.ae(b,l);WH.ae(b,h);WH.ae(c,b);WH.ae(q,c);if(!m){WH.Tooltip.icon=WH.ce("p");WH.Tooltip.icon.style.visibility="hidden";WH.ae(WH.Tooltip.icon,WH.ce("div"));WH.ae(g,WH.Tooltip.icon)}WH.ae(g,q);if(!m){var e=WH.ce("div");e.className="wowhead-tooltip-powered";WH.ae(g,e);WH.Tooltip.logo=e}return g},getMultiPartHtml:function(b,a){return"<table><tr><td>"+b+"</td></tr></table><table><tr><td>"+a+"</td></tr></table>"},evalFormulas:function(e){if(typeof e!=="string"){return e}let exp=/<span class="wh-tooltip-formula" style="display:none">(\[[\w\W]*?\])<\/span>(?:\d+(?:\.\d+)?)?/g;e=e.replace(exp,"$1");var a=0;var d=0;var c="";var g=0;for(var f=0;f<e.length;f++){var b=e.substr(f,1);switch(b){case"[":a++;d=0;c="";break;case"]":a--;if(a<0){a=0}d=0;c="";break;case"(":if(a>0){break}c+=b;d++;break;case")":if(a>0){break}if(d>0){c+=b;d--}break;default:if(a==0&&d>0){c+=b}}if(a==0&&d==0&&c){g=f-c.length+1;if(/[^ ()0-9\+\*\/\.-]/.test(c.replace(/<!--[\w\W]*?-->/g,"").replace(/\b(floor|ceil|abs)\b/gi,""))){c="";continue}if(/^\([0-9\.]*\)$/.test(c)){c="";continue}if(!/<!--[\w\W]*?-->/g.test(c)){c="";continue}e=e.substr(0,g)+"["+e.substring(g,f+1)+"]"+e.substr(f+1);f+=2;c=""}}e=e.replace(/\[([^\]]+)\]/g,function(j,m){var h;m=m.replace(/<!--[\w\W]*?-->/g,"");m=m.replace(/\b(floor|ceil|abs)\b/gi,"Math.$1");try{h=Function('"use strict";return ('+m+")")()}catch(l){h=undefined}if(typeof h==="undefined"){return j}return'<span class="wh-tooltip-formula" style="display:none">'+j+"</span>"+Math.abs(h).toFixed(3).replace(/0+$/,"").replace(/\.$/,"")});return e},fix:function(l,b,d){var j=WH.gE(l,"table")[0],f=WH.gE(j,"td")[0],g=f.childNodes;l.className=WH.trim(l.className.replace("tooltip-slider",""));if(g.length>=2&&g[0].nodeName=="TABLE"&&g[1].nodeName=="TABLE"){g[0].style.whiteSpace="nowrap";var e=parseInt(l.style.width);if(!l.slider||!e){if(g[1].offsetWidth==0){e=320}else{if(g[1].offsetWidth>300){e=Math.max(300,g[0].offsetWidth)+20}else{e=Math.max(g[0].offsetWidth,g[1].offsetWidth)+20}}}for(var h=2;h<g.length;h++){if(g[h].nodeName=="BLOCKQUOTE"){e=Math.max(e,g[h].offsetWidth+20)}}e=Math.min(320,e);if(e>20){if(l.slider){Slider.setSize(l.slider,e-6);l.className+=" tooltip-slider"}l.className+=" wowhead-tooltip-width-restriction wowhead-tooltip-width-"+e;l.style.width=e+"px";g[0].style.width=g[1].style.width="100%";if(!b&&l.offsetHeight>document.body.clientHeight){j.className="shrink"}}}else{if(g.length>=1&&l.slider){var a=g[0].nodeName=="TABLE";if(a){g[0].style.whiteSpace="nowrap"}var e=parseInt(l.style.width);if(!e&&a){e=g[0].offsetWidth+20}else{e=j.offsetWidth+20}e=Math.min(320,e);if(e>20){l.style.width=e+"px";if(a){g[0].style.width="100%"}if(l.slider){Slider.setSize(l.slider,e-6);l.className+=" tooltip-slider"}if(!b&&l.offsetHeight>document.body.clientHeight){j.className="shrink"}}}}if(d){WH.Tooltip.setTooltipVisibility(l,true)}},fixSafe:function(c,b,a){WH.Tooltip.fix(c,b,a)},attachImage:function(d,e,j,l){if(typeof l=="undefined"){l=""}if(typeof jQuery!="undefined"){jQuery(d.parentNode).children(".image"+l).remove()}else{var m=new RegExp("\\bimage"+l+"\\b");for(var h=0;h<d.parentNode.childNodes.length;h++){if(m.test(d.parentNode.childNodes[h].className)){d.parentNode.removeChild(d.parentNode.childNodes[h]);h--}}}var f=typeof e;if(f=="number"){var g=WH.getDataSource(),b=e;if(g[b]&&g[b]["image_"+Locale.getName()+l]){e=g[b]["image_"+Locale.getName()+l]}else{return}}else{if(f!="string"||!e){return}}var a=WH.ce("div");a.className="image"+l+(j?" "+j:"");a.style.backgroundImage="url("+e+")";if(typeof jQuery!="undefined"){jQuery(d).after(a)}else{d.parentNode.insertBefore(a,d.nextSibling)}},append:function(e,b,a,d){var e=WH.ge(e);var f=WH.Tooltip.create(b,a);if(d){var c=WH.ce("p");c.style.backgroundImage="url("+WH.staticUrl+"/images/wow/icons/medium/"+d.toLowerCase()+".jpg)";WH.ae(c,WH.ce("div"));WH.ae(f,c)}WH.ae(e,f);WH.Tooltip.fixSafe(f,1,1)},reset:function(){if(WH.Tooltip.tooltip){WH.Tooltip.tooltip.parentNode.removeChild(WH.Tooltip.tooltip);WH.Tooltip.tooltip=null}if(WH.Tooltip.tooltip2){WH.Tooltip.tooltip2.parentNode.removeChild(WH.Tooltip.tooltip2);WH.Tooltip.tooltip2=null}},prepare:function(c,e){var a=e===true?"fixed":"absolute";if(WH.Tooltip.tooltip){WH.Tooltip.tooltip.style.position=a;WH.Tooltip.tooltip2.style.position=a;return}var d=(typeof c!="undefined")?c:document.body;var b=WH.Tooltip.create();b.style.position=a;b.style.left=b.style.top="-2323px";WH.ae(d,b);WH.Tooltip.tooltip=b;WH.Tooltip.tooltipTable=WH.gE(b,"table")[0];WH.Tooltip.tooltipTd=WH.gE(b,"td")[0];var b=WH.Tooltip.create(null,true);b.style.position=a;b.style.left=b.style.top="-2323px";WH.ae(d,b);WH.Tooltip.tooltip2=b;WH.Tooltip.tooltipTable2=WH.gE(b,"table")[0];WH.Tooltip.tooltipTd2=WH.gE(b,"td")[0]},prepareScreen:function(){if(WH.Tooltip.screen){WH.Tooltip.screen.style.display="block"}else{WH.Tooltip.screen=WH.ce("div",{id:"wowhead-tooltip-screen",className:"wowhead-tooltip-screen"});WH.Tooltip.screenCloser=WH.ce("a",{id:"wowhead-tooltip-screen-close",className:"wowhead-tooltip-screen-close",onclick:$WowheadPower.clearTouchTooltip});WH.Tooltip.screenInnerWrapper=WH.ce("div",{id:"wowhead-tooltip-screen-inner-wrapper",className:"wowhead-tooltip-screen-inner-wrapper"});WH.Tooltip.screenInner=WH.ce("div",{id:"wowhead-tooltip-screen-inner",className:"wowhead-tooltip-screen-inner"});WH.Tooltip.screenInnerBox=WH.ce("div",{id:"wowhead-tooltip-screen-inner-box",className:"wowhead-tooltip-screen-inner-box"});WH.Tooltip.screenCaption=WH.ce("div",{id:"wowhead-tooltip-screen-caption",className:"wowhead-tooltip-screen-caption"});WH.ae(WH.Tooltip.screen,WH.Tooltip.screenCloser);WH.ae(WH.Tooltip.screenInner,WH.Tooltip.screenInnerBox);WH.ae(WH.Tooltip.screenInnerWrapper,WH.Tooltip.screenInner);WH.ae(WH.Tooltip.screen,WH.Tooltip.screenInnerWrapper);WH.ae(WH.Tooltip.screen,WH.Tooltip.screenCaption);WH.ae(document.body,WH.Tooltip.screen)}WH.Tooltip.mobileTooltipShown=true;WH.Tooltip.setupIScroll()},destroyIScroll:function(){if(WH.Tooltip.iScroll){WH.Tooltip.iScroll.destroy();WH.Tooltip.iScroll=null}},setupIScroll:function(){if(!WH.Tooltip.mobileScrollSetUp){var a=function(b){if(WH.Tooltip.mobileTooltipShown){if(!document.getElementById("wowhead-tooltip-screen-inner").contains(b.target)){b.preventDefault()}}};WH.aE(document.body,"touchmove",a);WH.aE(document.body,"mousewheel",a);WH.Tooltip.mobileScrollSetUp=true}if(typeof IScroll!="function"){return}setTimeout(function(){WH.Tooltip.destroyIScroll();WH.Tooltip.iScroll=new IScroll(WH.Tooltip.screenInnerWrapper,{mouseWheel:true,tap:true})},1)},setTooltipVisibility:function(a,b){if(b){a.setAttribute("data-visible","yes");a.style.visibility="visible"}else{a.setAttribute("data-visible","no");a.style.visibility="hidden"}},set:function(d,b,c,a){WH.Tooltip.tooltip.style.width="550px";WH.Tooltip.tooltip.style.left="-2323px";WH.Tooltip.tooltip.style.top="-2323px";WH.Tooltip.tooltip.className="wowhead-tooltip";if(d.nodeName){WH.ee(WH.Tooltip.tooltipTd);WH.ae(WH.Tooltip.tooltipTd,d)}else{WH.Tooltip.tooltipTd.innerHTML=WH.Tooltip.evalFormulas(d)}WH.Tooltip.tooltip.style.display="";WH.Tooltip.setTooltipVisibility(WH.Tooltip.tooltip,true);WH.Tooltip.fix(WH.Tooltip.tooltip,0,0);if(b){WH.Tooltip.showSecondary=true;WH.Tooltip.tooltip2.style.width="550px";WH.Tooltip.tooltip2.style.left="-2323px";WH.Tooltip.tooltip2.style.top="-2323px";if(b.nodeName){WH.ee(WH.Tooltip.tooltipTd2);WH.ae(WH.Tooltip.tooltipTd2,b)}else{WH.Tooltip.tooltipTd2.innerHTML=WH.Tooltip.evalFormulas(b)}WH.Tooltip.tooltip2.style.display="";WH.Tooltip.fix(WH.Tooltip.tooltip2,0,0)}else{WH.Tooltip.showSecondary=false}if(window.Platform&&Platform.isTouch()||window.WH&&WH.isTouch()){let target=WH.Tooltip.showSecondary?WH.Tooltip.tooltipTd2:WH.Tooltip.tooltipTd;let closer=WH.ce("a");closer.href="javascript:";closer.className="wowhead-touch-tooltip-closer";closer.onclick=$WowheadPower.clearTouchTooltip;WH.ae(target,closer)}WH.Tooltip.tooltipTable.style.display=(d=="")?"none":"";WH.Tooltip.attachImage(WH.Tooltip.tooltipTable,c,a);WH.Tooltip.generateEvent("show")},moveTests:[[null,null],[null,false],[false,null],[false,false]],move:function(r,q,e,t,d,b){if(!WH.Tooltip.tooltipTable){return}var u=WH.Tooltip.tooltip,j=WH.Tooltip.tooltipTable.offsetWidth,c=WH.Tooltip.tooltipTable.offsetHeight,m=WH.Tooltip.tooltip2,g=WH.Tooltip.showSecondary?WH.Tooltip.tooltipTable2.offsetWidth:0,a=WH.Tooltip.showSecondary?WH.Tooltip.tooltipTable2.offsetHeight:0,s;u.style.width=(j==0)?"auto":(j+"px");m.style.width=g+"px";var p,f;for(var h=0,l=WH.Tooltip.moveTests.length;h<l;++h){s=WH.Tooltip.moveTests[h];p=WH.Tooltip.moveTest(r,q,e,t,d,b,s[0],s[1]);if(WH.WAS&&!WH.WAS.intersect(p)){f=true;break}else{if(!WH.WAS){break}}}if(WH.WAS&&!f){WH.WAS.intersect(p,true)}u.style.left=p.l+"px";u.style.top=p.t+"px";WH.Tooltip.setTooltipVisibility(u,true);if(WH.Tooltip.showSecondary){m.style.left=p.l+j+"px";m.style.top=p.t+"px";WH.Tooltip.setTooltipVisibility(m,true)}WH.Tooltip.generateEvent("move")},moveTest:function(d,j,r,l,b,a,m,h){var B=d,q=j,e=WH.Tooltip.tooltip,s=WH.Tooltip.tooltipTable.offsetWidth,A=WH.Tooltip.tooltipTable.offsetHeight,p=WH.Tooltip.tooltip2,t=WH.Tooltip.showSecondary?WH.Tooltip.tooltipTable2.offsetWidth:0,g=WH.Tooltip.showSecondary?WH.Tooltip.tooltipTable2.offsetHeight:0,f=WH.getWindowSize(),c=WH.getScroll(),z=c.x,w=c.y,v=c.x+f.w,u=c.y+f.h;if(e.style.position==="fixed"){d-=c.x;j-=c.y;B-=d;q-=j;c={x:0,y:0};z=w=0;v=f.w;u=f.h}if(m==null){m=(d+r+s+t<=v)}if(h==null){h=(j-Math.max(A,g)>=w)}if(m){d+=r+b}else{d=Math.max(d-(s+t),z)-b}if(h){j-=Math.max(A,g)+a}else{j+=l+a}if(d<z){d=z}else{if(d+s+t>v){d=v-(s+t)}}if(j<w){j=w}else{if(j+Math.max(A,g)>u){j=Math.max(c.y,u-Math.max(A,g))}}if(WH.Tooltip.iconVisible){if(B>=d-48&&B<=d&&q>=j-4&&q<=j+48){j-=48-(q-j)}}return WH.createRect(d,j,s,A)},show:function(g,j,c,a,b,d,e,h,f){if(j==null||WH.Tooltip.disabled){return}if(!c||c<1){c=1}if(!a||a<1){a=1}if(b){j='<span class="'+b+'">'+j+"</span>"}let offset=WH.getOffset(g);WH.Tooltip.prepare(undefined,f);WH.Tooltip.set(j,d,e,h);WH.Tooltip.move(offset.left,offset.top,g.offsetWidth,g.offsetHeight,c,a)},showAtCursor:function(g,l,c,a,b,d,f,j){if(l==null||WH.Tooltip.disabled){return}if(!c||c<10){c=10}if(!a||a<10){a=10}if(b){l='<span class="'+b+'">'+l+"</span>";if(d){d='<span class="'+b+'">'+d+"</span>"}}g=WH.normalizeEvent(g);var h=WH.getCursorPos(g);WH.Tooltip.prepare(undefined,g.target?WH.isElementFixedPosition(g.target):false);WH.Tooltip.set(l,d,f,j);WH.Tooltip.move(h.x,h.y,0,0,c,a)},showAtXY:function(j,g,f,b,a,c,d,h,e){if(j==null||WH.Tooltip.disabled){return}WH.Tooltip.prepare(undefined,e);WH.Tooltip.set(j,c,d,h);WH.Tooltip.move(g,f,0,0,b,a)},showFadingTooltipAtCursor:function(a,b,e,d,c){a=WH.Tooltip.prepareTooltipHtml(a,e,d,c);WH.Tooltip.showAtCursor(c,a,undefined,undefined,b);requestAnimationFrame(function(){WH.Tooltip.tooltip.classList.add("fade-out")})},showInScreen:function(e,j,b,c,d,h,f){$WowheadPower.clearTouchTooltip(true);if(j==null||WH.Tooltip.disabled){return}if(b){j='<span class="'+b+'">'+j+"</span>"}WH.Tooltip.prepareScreen();WH.ee(WH.Tooltip.screenCaption);var g=WH.ce("a",{innerHTML:WH.isRemote()?"Tap Link":WH.TERMS.taplink,onclick:(function(m,a){m.setAttribute("data-disable-wowhead-tooltip","true");if(m.fireEvent){m.fireEvent("on"+a)}else{if(typeof MouseEvent=="function"){m.dispatchEvent(new MouseEvent(a,{bubbles:true,cancelable:true}))}else{var p=document.createEvent("Events");p.initEvent(a,true,true);m.dispatchEvent(p)}}if(m){m.removeAttribute("data-disable-wowhead-tooltip")}$WowheadPower.clearTouchTooltip()}).bind(null,e,"click")});var l=WH.ce("i",{className:"fa fa-hand-o-up"});WH.aef(g,l);WH.ae(WH.Tooltip.screenCaption,g);$WowheadPower.setParent(WH.Tooltip.screenInnerBox);WH.Tooltip.setIcon(f);WH.Tooltip.set(j,c,d,h);WH.Tooltip.move()},cursorUpdate:function(b,a,d){if(WH.Tooltip.disabled||!WH.Tooltip.tooltip){return}b=WH.normalizeEvent(b);if(!a||a<10){a=10}if(!d||d<10){d=10}var c=WH.getCursorPos(b);WH.Tooltip.move(c.x,c.y,0,0,a,d)},hide:function(){if(WH.Tooltip.tooltip){WH.Tooltip.showingTooltip=false;WH.Tooltip.tooltip.style.display="none";WH.Tooltip.setTooltipVisibility(WH.Tooltip.tooltip,false);WH.Tooltip.tooltipTable.className="";WH.Tooltip.setIcon(null);if(WH.WAS){WH.WAS.restoreHidden()}WH.Tooltip.generateEvent("hide")}if(WH.Tooltip.tooltip2){WH.Tooltip.tooltip2.style.display="none";WH.Tooltip.setTooltipVisibility(WH.Tooltip.tooltip2,false);WH.Tooltip.tooltipTable2.className=""}},setIcon:function(a,b){WH.Tooltip.prepare(undefined,b);if(a){WH.Tooltip.icon.style.backgroundImage="url("+WH.staticUrl+"/images/wow/icons/medium/"+a.toLowerCase()+".jpg)";WH.Tooltip.icon.style.visibility="visible"}else{WH.Tooltip.icon.style.backgroundImage="none";WH.Tooltip.icon.style.visibility="hidden"}WH.Tooltip.iconVisible=a?1:0},generateEvent:function(a){if(!WH.Tooltip.tooltip){return}try{WH.Tooltip.tooltip.dispatchEvent(new Event(a))}catch(c){try{var b=document.createEvent("Event");b.initEvent(a,true,true);WH.Tooltip.tooltip.dispatchEvent(b)}catch(c){void(0)}}},addTooltipText:function(a,c,b){if(!a){WH.error("Tooltip text addition element not found!",a,c,b);return}a._fixTooltip=(function(f,m,h,e){var g=/<\/table>\s*$/;var l=typeof h==="function"?h():h;var j=h?' class="'+l+'"':"";var d=typeof m==="function"?m():m;if(g.test(e)){return e.replace(g,'<tr><td colspan="2"><div'+j+' style="margin-top:10px">'+d+"</div></td></tr></table>")}else{return e+"<div"+j+' style="margin-top:10px">'+d+"</div>"}}).bind(null,a,c,b)},prepareTooltipHtml:function(a,d,c,b){a=typeof a==="function"?a.call(b.target,b):a;if(typeof a==="string"){if(d===undefined&&a.length<30){d=true}let attributes=[];if(d){attributes.push(' class="no-wrap"')}if(c&&!isNaN(c)){attributes.push(' style="max-width:'+c+'px"')}if(attributes.length){a="<div"+attributes.join("")+">"+a+"</div>"}}return a},simple:function(c,e,g,a,h,f,j){if(c instanceof jQuery){for(var d=0,b;b=c[d];d++){WH.Tooltip.simple(b,e,g,a,h,f,j)}return}if(a){if(h){c.onmouseover=function(l){let tooltipHtml=WH.Tooltip.prepareTooltipHtml(e,f,j,l);WH.Tooltip.show(c,tooltipHtml,false,false,g);l.stopPropagation()}}else{c.onmouseover=function(l){let tooltipHtml=WH.Tooltip.prepareTooltipHtml(e,f,j,l);WH.Tooltip.show(c,tooltipHtml,false,false,g)}}}else{if(h){c.onmouseover=function(l){let tooltipHtml=WH.Tooltip.prepareTooltipHtml(e,f,j,l);WH.Tooltip.showAtCursor(l,tooltipHtml,false,false,g);l.stopPropagation()}}else{c.onmouseover=function(l){let tooltipHtml=WH.Tooltip.prepareTooltipHtml(e,f,j,l);WH.Tooltip.showAtCursor(l,tooltipHtml,false,false,g)}}c.onmousemove=WH.Tooltip.cursorUpdate}c.onmouseout=WH.Tooltip.hide},simpleNonTouch:function(a,d,b,c,e){if(!Platform.isTouch()){WH.Tooltip.simple(a,d,b,c,false,e)}},simpleOverride:function(e,f,c,a,h,g,j,d,l,b,m){e.overrideTooltip={html:f,htmlGenerator:c,spanClass:a,icon:h,html2:g,html2Generator:j,image:d,imageClass:l,map:b,spellData:m}}};WH.createButton=function(m,d,r){var j="btn btn-site";var h="";var e="";var c="";var q="";var f=[];var p=[];if(!r){r={}}if(!r["no-margin"]){p.push("margin-left:5px")}if(typeof d!="string"||d===""){d="javascript:"}if(r["new-window"]){h=' target="_blank"'}if(typeof r.id=="string"){e=' id="'+r.id+'"'}if(typeof r.size!="undefined"){switch(r.size){case"small":case"large":f.push("btn-"+r.size);break}}else{f.push("btn-small")}if(typeof r["class"]=="string"){f.push(r["class"])}if(typeof r.type=="string"){switch(r.type){case"default":case"gray":j="btn";break;default:j="btn btn-"+r.type}}if(r.disabled){f.push("btn-disabled");d="javascript:"}if(f.length){j+=" "+f.join(" ")}if(j){j=' class="'+j+'"'}if(!(typeof r["float"]!="undefined"&&!r["float"])){p.push("float:right")}if(typeof r.style=="string"){p.push(r.style)}if(p.length){c=' style="'+p.join(";")+'"'}var g='<a href="'+d+'"'+h+e+j+c+">"+(m||"")+"</a>";var b=WH.ce("div");b.innerHTML=g;var l=b.childNodes[0];if(typeof r.click=="function"&&!r.disabled){l.onclick=r.click}if(typeof r.tooltip!="undefined"){if(r.tooltip!==false){l.setAttribute("data-whattach","true")}if(r.tooltip===false){l.rel="np"}else{if(typeof r.tooltip=="string"){WH.Tooltip.simple(l,r.tooltip,null,true)}else{if(typeof r.tooltip=="object"&&r.tooltip["text"]){WH.Tooltip.simple(l,r.tooltip["text"],r.tooltip["class"],true)}}}}return l};if(WH.isSet("$WowheadPower")){$WowheadPower.init()};