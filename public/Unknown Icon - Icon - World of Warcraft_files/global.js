(function(){function d(C){var l=true;var u=false;var z=null;var D={text:true,search:true,url:true,tel:true,email:true,password:true,number:true,date:true,month:true,week:true,time:true,datetime:true,"datetime-local":true};function m(E){if(E&&E!==document&&E.nodeName!=="HTML"&&E.nodeName!=="BODY"&&"classList"in E&&"contains"in E.classList){return true}return false}function q(G){var F=G.type;var E=G.tagName;if(E==="INPUT"&&D[F]&&!G.readOnly){return true}if(E==="TEXTAREA"&&!G.readOnly){return true}if(G.isContentEditable){return true}return false}function v(E){if(E.classList.contains("focus-visible")){return}E.classList.add("focus-visible");E.setAttribute("data-focus-visible-added","")}function p(E){if(!E.hasAttribute("data-focus-visible-added")){return}E.classList.remove("focus-visible");E.removeAttribute("data-focus-visible-added")}function t(E){if(E.metaKey||E.altKey||E.ctrlKey){return}if(m(C.activeElement)){v(C.activeElement)}l=true}function g(E){l=false}function w(E){if(!m(E.target)){return}if(l||q(E.target)){v(E.target)}}function h(E){if(!m(E.target)){return}if(E.target.classList.contains("focus-visible")||E.target.hasAttribute("data-focus-visible-added")){u=true;window.clearTimeout(z);z=window.setTimeout(function(){u=false},100);p(E.target)}}function B(E){if(document.visibilityState==="hidden"){if(u){l=true}r()}}function r(){document.addEventListener("mousemove",o);document.addEventListener("mousedown",o);document.addEventListener("mouseup",o);document.addEventListener("pointermove",o);document.addEventListener("pointerdown",o);document.addEventListener("pointerup",o);document.addEventListener("touchmove",o);document.addEventListener("touchstart",o);document.addEventListener("touchend",o)}function A(){document.removeEventListener("mousemove",o);document.removeEventListener("mousedown",o);document.removeEventListener("mouseup",o);document.removeEventListener("pointermove",o);document.removeEventListener("pointerdown",o);document.removeEventListener("pointerup",o);document.removeEventListener("touchmove",o);document.removeEventListener("touchstart",o);document.removeEventListener("touchend",o)}function o(E){if(E.target.nodeName&&E.target.nodeName.toLowerCase()==="html"){return}l=false;A()}document.addEventListener("keydown",t,true);document.addEventListener("mousedown",g,true);document.addEventListener("pointerdown",g,true);document.addEventListener("touchstart",g,true);document.addEventListener("visibilitychange",B,true);r();C.addEventListener("focus",w,true);C.addEventListener("blur",h,true);if(C.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&C.host){C.host.setAttribute("data-js-focus-visible","")}else{if(C.nodeType===Node.DOCUMENT_NODE){document.documentElement.classList.add("js-focus-visible");document.documentElement.setAttribute("data-js-focus-visible","")}}}if(typeof window!=="undefined"&&typeof document!=="undefined"){window.applyFocusVisiblePolyfill=d;var f;try{f=new CustomEvent("focus-visible-polyfill-ready")}catch(c){f=document.createEvent("CustomEvent");f.initCustomEvent("focus-visible-polyfill-ready",false,false,{})}window.dispatchEvent(f)}if(typeof document!=="undefined"){d(document)}})();"abbr article aside audio canvas details figcaption figure footer header hgroup mark menu meter nav output progress section summary time video".replace(/\w+/g,function(c){document.createElement(c)});/*!iScroll v5.1.3 ~ (c) 2008-2014 Matteo Spinelli ~ http://cubiq.org/license*/(function(g,c,f){var l=g.requestAnimationFrame||g.webkitRequestAnimationFrame||g.mozRequestAnimationFrame||g.oRequestAnimationFrame||g.msRequestAnimationFrame||function(m){g.setTimeout(m,1000/60)};var d=(function(){var r={};var t=c.createElement("div").style;var p=(function(){var z=["t","webkitT","MozT","msT","OT"],v,w=0,u=z.length;for(;w<u;w++){v=z[w]+"ransform";if(v in t){return z[w].substr(0,z[w].length-1)}}return false})();function q(u){if(p===false){return false}if(p===""){return u}return p+u.charAt(0).toUpperCase()+u.substr(1)}r.getTime=Date.now||function m(){return new Date().getTime()};r.extend=function(w,v){for(var u in v){w[u]=v[u]}};r.addEvent=function(z,w,v,u){z.addEventListener(w,v,!!u)};r.removeEvent=function(z,w,v,u){z.removeEventListener(w,v,!!u)};r.prefixPointerEvent=function(u){return g.MSPointerEvent?"MSPointer"+u.charAt(9).toUpperCase()+u.substr(10):u};r.momentum=function(C,w,z,u,D,E){var v=C-w,A=f.abs(v)/z,F,B;E=E===undefined?0.0006:E;F=C+(A*A)/(2*E)*(v<0?-1:1);B=A/E;if(F<u){F=D?u-(D/2.5*(A/8)):u;v=f.abs(F-C);B=v/A}else{if(F>0){F=D?D/2.5*(A/8):0;v=f.abs(C)+F;B=v/A}}return{destination:f.round(F),duration:B}};var o=q("transform");r.extend(r,{hasTransform:o!==false,hasPerspective:q("perspective")in t,hasTouch:"ontouchstart"in g,hasPointer:g.PointerEvent||g.MSPointerEvent,hasTransition:q("transition")in t});r.isBadAndroid=/Android /.test(g.navigator.appVersion)&&!(/Chrome\/\d/.test(g.navigator.appVersion));r.extend(r.style={},{transform:o,transitionTimingFunction:q("transitionTimingFunction"),transitionDuration:q("transitionDuration"),transitionDelay:q("transitionDelay"),transformOrigin:q("transformOrigin")});r.hasClass=function(v,w){var u=new RegExp("(^|\\s)"+w+"(\\s|$)");return u.test(v.className)};r.addClass=function(v,w){if(r.hasClass(v,w)){return}var u=v.className.split(" ");u.push(w);v.className=u.join(" ")};r.removeClass=function(v,w){if(!r.hasClass(v,w)){return}var u=new RegExp("(^|\\s)"+w+"(\\s|$)","g");v.className=v.className.replace(u," ")};r.offset=function(u){var w=-u.offsetLeft,v=-u.offsetTop;while(u=u.offsetParent){w-=u.offsetLeft;v-=u.offsetTop}return{left:w,top:v}};r.preventDefaultException=function(w,v){for(var u in v){if(v[u].test(w[u])){return true}}return false};r.extend(r.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3});r.extend(r.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(u){return u*(2-u)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(u){return f.sqrt(1-(--u*u))}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(v){var u=4;return(v=v-1)*v*((u+1)*v+u)+1}},bounce:{style:"",fn:function(u){if((u/=1)<(1/2.75)){return 7.5625*u*u}else{if(u<(2/2.75)){return 7.5625*(u-=(1.5/2.75))*u+0.75}else{if(u<(2.5/2.75)){return 7.5625*(u-=(2.25/2.75))*u+0.9375}else{return 7.5625*(u-=(2.625/2.75))*u+0.984375}}}}},elastic:{style:"",fn:function(u){var v=0.22,w=0.4;if(u===0){return 0}if(u==1){return 1}return(w*f.pow(2,-10*u)*f.sin((u-v/4)*(2*f.PI)/v)+1)}}});r.tap=function(w,u){var v=c.createEvent("Event");v.initEvent(u,true,true);v.pageX=w.pageX;v.pageY=w.pageY;w.target.dispatchEvent(v)};r.click=function(w){var v=w.target,u;if(!(/(SELECT|INPUT|TEXTAREA)/i).test(v.tagName)){u=c.createEvent("MouseEvents");u.initMouseEvent("click",true,true,w.view,1,v.screenX,v.screenY,v.clientX,v.clientY,w.ctrlKey,w.altKey,w.shiftKey,w.metaKey,0,null);u._constructed=true;v.dispatchEvent(u)}};return r})();function h(p,m){this.wrapper=typeof p=="string"?c.querySelector(p):p;this.scroller=this.wrapper.children[0];this.scrollerStyle=this.scroller.style;this.options={startX:0,startY:0,scrollY:true,directionLockThreshold:5,momentum:true,bounce:true,bounceTime:600,bounceEasing:"",preventDefault:true,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:true,useTransition:true,useTransform:true};for(var o in m){this.options[o]=m[o]}this.translateZ=this.options.HWCompositing&&d.hasPerspective?" translateZ(0)":"";this.options.useTransition=d.hasTransition&&this.options.useTransition;this.options.useTransform=d.hasTransform&&this.options.useTransform;this.options.eventPassthrough=this.options.eventPassthrough===true?"vertical":this.options.eventPassthrough;this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault;this.options.scrollY=this.options.eventPassthrough=="vertical"?false:this.options.scrollY;this.options.scrollX=this.options.eventPassthrough=="horizontal"?false:this.options.scrollX;this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough;this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold;this.options.bounceEasing=typeof this.options.bounceEasing=="string"?d.ease[this.options.bounceEasing]||d.ease.circular:this.options.bounceEasing;this.options.resizePolling=this.options.resizePolling===undefined?60:this.options.resizePolling;if(this.options.tap===true){this.options.tap="tap"}this.x=0;this.y=0;this.directionX=0;this.directionY=0;this._events={};this._init();this.refresh();this.scrollTo(this.options.startX,this.options.startY);this.enable()}h.prototype={version:"5.1.3",_init:function(){this._initEvents()},destroy:function(){this._initEvents(true);this._execEvent("destroy")},_transitionEnd:function(m){if(m.target!=this.scroller||!this.isInTransition){return}this._transitionTime();if(!this.resetPosition(this.options.bounceTime)){this.isInTransition=false;this._execEvent("scrollEnd")}},_start:function(o){if(d.eventType[o.type]!=1){if(o.button!==0){return}}if(!this.enabled||(this.initiated&&d.eventType[o.type]!==this.initiated)){return}if(this.options.preventDefault&&!d.isBadAndroid&&!d.preventDefaultException(o.target,this.options.preventDefaultException)){o.preventDefault()}var m=o.touches?o.touches[0]:o,p;this.initiated=d.eventType[o.type];this.moved=false;this.distX=0;this.distY=0;this.directionX=0;this.directionY=0;this.directionLocked=0;this._transitionTime();this.startTime=d.getTime();if(this.options.useTransition&&this.isInTransition){this.isInTransition=false;p=this.getComputedPosition();this._translate(f.round(p.x),f.round(p.y));this._execEvent("scrollEnd")}else{if(!this.options.useTransition&&this.isAnimating){this.isAnimating=false;this._execEvent("scrollEnd")}}this.startX=this.x;this.startY=this.y;this.absStartX=this.x;this.absStartY=this.y;this.pointX=m.pageX;this.pointY=m.pageY;this._execEvent("beforeScrollStart")},_move:function(t){if(!this.enabled||d.eventType[t.type]!==this.initiated){return}if(this.options.preventDefault){t.preventDefault()}var v=t.touches?t.touches[0]:t,p=v.pageX-this.pointX,o=v.pageY-this.pointY,u=d.getTime(),m,w,r,q;this.pointX=v.pageX;this.pointY=v.pageY;this.distX+=p;this.distY+=o;r=f.abs(this.distX);q=f.abs(this.distY);if(u-this.endTime>300&&(r<10&&q<10)){return}if(!this.directionLocked&&!this.options.freeScroll){if(r>q+this.options.directionLockThreshold){this.directionLocked="h"}else{if(q>=r+this.options.directionLockThreshold){this.directionLocked="v"}else{this.directionLocked="n"}}}if(this.directionLocked=="h"){if(this.options.eventPassthrough=="vertical"){t.preventDefault()}else{if(this.options.eventPassthrough=="horizontal"){this.initiated=false;return}}o=0}else{if(this.directionLocked=="v"){if(this.options.eventPassthrough=="horizontal"){t.preventDefault()}else{if(this.options.eventPassthrough=="vertical"){this.initiated=false;return}}p=0}}p=this.hasHorizontalScroll?p:0;o=this.hasVerticalScroll?o:0;m=this.x+p;w=this.y+o;if(m>0||m<this.maxScrollX){m=this.options.bounce?this.x+p/3:m>0?0:this.maxScrollX}if(w>0||w<this.maxScrollY){w=this.options.bounce?this.y+o/3:w>0?0:this.maxScrollY}this.directionX=p>0?-1:p<0?1:0;this.directionY=o>0?-1:o<0?1:0;if(!this.moved){this._execEvent("scrollStart")}this.moved=true;this._translate(m,w);if(u-this.startTime>300){this.startTime=u;this.startX=this.x;this.startY=this.y}},_end:function(t){if(!this.enabled||d.eventType[t.type]!==this.initiated){return}if(this.options.preventDefault&&!d.preventDefaultException(t.target,this.options.preventDefaultException)){t.preventDefault()}var v=t.changedTouches?t.changedTouches[0]:t,p,o,r=d.getTime()-this.startTime,m=f.round(this.x),A=f.round(this.y),z=f.abs(m-this.startX),w=f.abs(A-this.startY),q=0,u="";this.isInTransition=0;this.initiated=0;this.endTime=d.getTime();if(this.resetPosition(this.options.bounceTime)){return}this.scrollTo(m,A);if(!this.moved){if(this.options.tap){d.tap(t,this.options.tap)}if(this.options.click){d.click(t)}this._execEvent("scrollCancel");return}if(this._events.flick&&r<200&&z<100&&w<100){this._execEvent("flick");return}if(this.options.momentum&&r<300){p=this.hasHorizontalScroll?d.momentum(this.x,this.startX,r,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:m,duration:0};o=this.hasVerticalScroll?d.momentum(this.y,this.startY,r,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:A,duration:0};m=p.destination;A=o.destination;q=f.max(p.duration,o.duration);this.isInTransition=1}if(m!=this.x||A!=this.y){if(m>0||m<this.maxScrollX||A>0||A<this.maxScrollY){u=d.ease.quadratic}this.scrollTo(m,A,q,u);return}this._execEvent("scrollEnd")},_resize:function(){var m=this;clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout(function(){m.refresh()},this.options.resizePolling)},resetPosition:function(o){var m=this.x,p=this.y;o=o||0;if(!this.hasHorizontalScroll||this.x>0){m=0}else{if(this.x<this.maxScrollX){m=this.maxScrollX}}if(!this.hasVerticalScroll||this.y>0){p=0}else{if(this.y<this.maxScrollY){p=this.maxScrollY}}if(m==this.x&&p==this.y){return false}this.scrollTo(m,p,o,this.options.bounceEasing);return true},disable:function(){this.enabled=false},enable:function(){this.enabled=true},refresh:function(){var m=this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth;this.wrapperHeight=this.wrapper.clientHeight;this.scrollerWidth=this.scroller.offsetWidth;this.scrollerHeight=this.scroller.offsetHeight;this.maxScrollX=this.wrapperWidth-this.scrollerWidth;this.maxScrollY=this.wrapperHeight-this.scrollerHeight;this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0;this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0;if(!this.hasHorizontalScroll){this.maxScrollX=0;this.scrollerWidth=this.wrapperWidth}if(!this.hasVerticalScroll){this.maxScrollY=0;this.scrollerHeight=this.wrapperHeight}this.endTime=0;this.directionX=0;this.directionY=0;this.wrapperOffset=d.offset(this.wrapper);this._execEvent("refresh");this.resetPosition()},on:function(o,m){if(!this._events[o]){this._events[o]=[]}this._events[o].push(m)},off:function(p,o){if(!this._events[p]){return}var m=this._events[p].indexOf(o);if(m>-1){this._events[p].splice(m,1)}},_execEvent:function(p){if(!this._events[p]){return}var o=0,m=this._events[p].length;if(!m){return}for(;o<m;o++){this._events[p][o].apply(this,[].slice.call(arguments,1))}},scrollBy:function(m,q,o,p){m=this.x+m;q=this.y+q;o=o||0;this.scrollTo(m,q,o,p)},scrollTo:function(m,q,o,p){p=p||d.ease.circular;this.isInTransition=this.options.useTransition&&o>0;if(!o||(this.options.useTransition&&p.style)){this._transitionTimingFunction(p.style);this._transitionTime(o);this._translate(m,q)}else{this._animate(m,q,o,p.fn)}},scrollToElement:function(o,p,m,t,r){o=o.nodeType?o:this.scroller.querySelector(o);if(!o){return}var q=d.offset(o);q.left-=this.wrapperOffset.left;q.top-=this.wrapperOffset.top;if(m===true){m=f.round(o.offsetWidth/2-this.wrapper.offsetWidth/2)}if(t===true){t=f.round(o.offsetHeight/2-this.wrapper.offsetHeight/2)}q.left-=m||0;q.top-=t||0;q.left=q.left>0?0:q.left<this.maxScrollX?this.maxScrollX:q.left;q.top=q.top>0?0:q.top<this.maxScrollY?this.maxScrollY:q.top;p=p===undefined||p===null||p==="auto"?f.max(f.abs(this.x-q.left),f.abs(this.y-q.top)):p;this.scrollTo(q.left,q.top,p,r)},_transitionTime:function(m){m=m||0;this.scrollerStyle[d.style.transitionDuration]=m+"ms";if(!m&&d.isBadAndroid){this.scrollerStyle[d.style.transitionDuration]="0.001s"}},_transitionTimingFunction:function(m){this.scrollerStyle[d.style.transitionTimingFunction]=m},_translate:function(m,o){if(this.options.useTransform){this.scrollerStyle[d.style.transform]="translate("+m+"px,"+o+"px)"+this.translateZ}else{m=f.round(m);o=f.round(o);this.scrollerStyle.left=m+"px";this.scrollerStyle.top=o+"px"}this.x=m;this.y=o},_initEvents:function(m){var o=m?d.removeEvent:d.addEvent,p=this.options.bindToWrapper?this.wrapper:g;o(g,"orientationchange",this);o(g,"resize",this);if(this.options.click){o(this.wrapper,"click",this,true)}if(!this.options.disableMouse){o(this.wrapper,"mousedown",this);o(p,"mousemove",this);o(p,"mousecancel",this);o(p,"mouseup",this)}if(d.hasPointer&&!this.options.disablePointer){o(this.wrapper,d.prefixPointerEvent("pointerdown"),this);o(p,d.prefixPointerEvent("pointermove"),this);o(p,d.prefixPointerEvent("pointercancel"),this);o(p,d.prefixPointerEvent("pointerup"),this)}if(d.hasTouch&&!this.options.disableTouch){o(this.wrapper,"touchstart",this);o(p,"touchmove",this);o(p,"touchcancel",this);o(p,"touchend",this)}o(this.scroller,"transitionend",this);o(this.scroller,"webkitTransitionEnd",this);o(this.scroller,"oTransitionEnd",this);o(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var o=g.getComputedStyle(this.scroller,null),m,p;if(this.options.useTransform){o=o[d.style.transform].split(")")[0].split(", ");m=+(o[12]||o[4]);p=+(o[13]||o[5])}else{m=+o.left.replace(/[^-\d.]/g,"");p=+o.top.replace(/[^-\d.]/g,"")}return{x:m,y:p}},_animate:function(z,w,q,m){var u=this,t=this.x,r=this.y,o=d.getTime(),v=o+q;function p(){var A=d.getTime(),C,B,D;if(A>=v){u.isAnimating=false;u._translate(z,w);if(!u.resetPosition(u.options.bounceTime)){u._execEvent("scrollEnd")}return}A=(A-o)/q;D=m(A);C=(z-t)*D+t;B=(w-r)*D+r;u._translate(C,B);if(u.isAnimating){l(p)}}this.isAnimating=true;p()},handleEvent:function(m){switch(m.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(m);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(m);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(m);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(m);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(m);break;case"keydown":this._key(m);break;case"click":if(!m._constructed){m.preventDefault();m.stopPropagation()}break}}};h.utils=d;if(typeof module!="undefined"&&module.exports){module.exports=h}else{g.IScroll=h}})(window,document,Math);var g_localTime=new Date();var g_blogimages={};function MessageBox(c,f){c.find(".wh-message-box").remove();var d=$("<div></div>");d.hide();d.addClass("wh-message-box");d.html('<div class="message">'+f+'</div><div class="close" title="Click on this box to close it"></div>');d.click(function(){$(this).fadeOut()});c.append(d[0]);d.fadeIn()}function Rectangle(g,f,d,c){this.l=g;this.t=f;this.r=g+d;this.b=f+c}Rectangle.prototype={intersectWith:function(c){return!(this.l>=c.r||c.l>=this.r||this.t>=c.b||c.t>=this.b)},contains:function(c){return(this.l<=c.l&&this.t<=c.t&&this.r>=c.r&&this.b>=c.b)},containedIn:function(c){return c.contains(this)}};WH.aE(window,"load",function(){if(!(window.JSON&&WH.LocalStorage.isSupported())){return}var p=WH.LocalStorage.get("lvBrowse");if(!p){return}p=window.JSON.parse(p);if(!p){return}var w=/^\/[-a-z]+=\d+/i;var q=w.exec(location.pathname);if(!q){return}q=q[0];var f=function(d,u){if(!u){return WH.ce("i",{className:"fa fa-"+d})}return WH.ce("a",{className:"fa fa-"+d,href:u})};for(var r=0;r<p.length;r++){var v=p[r].urls;for(var o=0;o<v.length;o++){if(v[o]==q){var c=o>0?v[o-1]:false;var h=(o+1)<v.length?v[o+1]:false;var t=p[r].path+p[r].hash;var m=WH.qs(".breadcrumb");if(!m){return}var l=WH.ce("div",{className:"breadcrumb-browse"});WH.ae(m,l);var g=f("arrow-circle-up",t);WH.Tooltip.simple(g,WH.TERMS.backtolist,"q2",undefined,undefined,true);WH.ae(l,f("arrow-circle-left",c));WH.ae(l,g);WH.ae(l,f("arrow-circle-right",h));return}}}});WH.smoothScroll=function(d,c){switch(typeof d){case"string":case"object":case"jQuery":var f=$(d).offset();if(!f){return}d=f.top;break;case"number":break;default:return}if(WH.Layout.Responsive.isZulInMobileMode()){d-=50}else{d-=10}$("html, body").animate({scrollTop:d},c||500)};WH.getReputationPlusAchievementText=function(c,h,g,f){var l=WH.getAchievementText(c,h,g,true);var m=$("<span>").addClass("wsach-pts");m.mouseover(function(o){WH.Tooltip.showAtCursor(o,WH.TERMS.reputationtip,0,0,"q")}).mousemove(function(o){WH.Tooltip.cursorUpdate(o)}).mouseout(function(){WH.Tooltip.hide()});m.addClass("q1");m.text(WH.numberFormat(f));var d=$("<span>");d.append(" (");d.append(m);d.append(" &ndash; ");d.append(l);d.append(") ");return d};WH.getAchievementText=function(c,l,h,d){var f=$("<span>").addClass("wsach-pts");f.mouseover(function(m){WH.Tooltip.showAtCursor(m,WH.TERMS.userachcount_tip,0,0,"q")}).mousemove(function(m){WH.Tooltip.cursorUpdate(m)}).mouseout(function(){WH.Tooltip.hide()});var g=" ";if(!d){g+=" ("}if(c){g+="<i>"+c+"</i>&middot;"}if(l){g+="<b>"+l+"</b>&middot;"}if(!h){h=0}g+="<u>"+h+"</u>";if(!d){g+=")"}f.html(g);return f};WH.formatTimeElapsed=function(h){function d(u,t,r){if(r&&LANG.timeunitsab[t]==""){r=0}if(r){return u+" "+LANG.timeunitsab[t]}else{return u+" "+(u==1?LANG.timeunitssg[t]:LANG.timeunitspl[t])}}var l=[31557600,2629800,604800,86400,3600,60,1];var o=[1,3,3,-1,5,-1,-1];h=Math.max(h,1);for(var g=3,m=l.length;g<m;++g){if(h>=l[g]){var f=g;var q=Math.floor(h/l[f]);if(o[f]!=-1){var c=o[f];h%=l[f];var p=Math.floor(h/l[c]);if(p>0){return d(q,f,1)+" "+d(p,c,1)}}return d(q,f,0)}}return"(n/a)"};WH.formatDate=function(d,q,h,f,p){var l=new Date();var c=new Date();c.setTime(l.getTime()-(1000*q));var g;var t=new Date(c.getYear(),c.getMonth(),c.getDate());var r=new Date(l.getYear(),l.getMonth(),l.getDate());var o=(r.getTime()-t.getTime());o/=1000;o/=86400;o=Math.round(o);if(q>=2592000){g=WH.TERMS.on_lc+WH.formatDateSimple(h,f)}else{if(o>1){g=WH.sprintf(WH.TERMS.daysago_format,o);if(d){var m=new Date();m.setTime(h.getTime()+(g_localTime-WH.getServerTime()));d.className+=" tip";d.title=m.toLocaleString()}}else{if(q>=43200){if(l.getDay()==c.getDay()){g=WH.TERMS.today_lc}else{g=WH.TERMS.yesterday_lc}g=WH.formatTimeSimple(c,g);if(d){var m=new Date();m.setTime(h.getTime()+(g_localTime-WH.getServerTime()));d.className+=" tip";d.title=m.toLocaleString()}}else{g=WH.sprintf(WH.TERMS.ago2_format,WH.formatTimeElapsed(q));if(d){var m=new Date();m.setTime(h.getTime()+(g_localTime-WH.getServerTime()));d.className+=" tip";d.title=m.toLocaleString()}}}}if(p==1){g=g.substr(0,1).toUpperCase()+g.substr(1)}if(d){WH.ae(d,WH.ct(g))}else{return g}};WH.formatDateSimple=function(o,m){function h(d){return(d<10?"0"+d:d)}var c="",f=o.getDate(),l=o.getMonth()+1,g=o.getFullYear();if(g<=1970){c+=WH.TERMS.unknowndate_stc}else{c+=WH.sprintf(WH.TERMS.date3_format,h(f),h(l),g)}if(m!=null){c=WH.formatTimeSimple(o,c)}return c};WH.formatTimeSimple=function(m,c,g){function l(d){return(d<10?"0"+d:d)}var f=m.getHours(),h=m.getMinutes();if(c==null){c=""}c+=(g?" ":WH.TERMS.at_lc);if(f==12){c+=WH.TERMS.noon_lc}else{if(f==0){c+=WH.TERMS.midnight_lc}else{if(f>12){c+=(f-12)+":"+l(h)+" "+WH.TERMS.pm}else{c+=f+":"+l(h)+" "+WH.TERMS.am}}}return c};WH.formatStartEndDates=function(d,g){if(!d&&!g){return""}var m=false;var h=false;if(d){m=new Date(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate())}if(g){h=new Date(g.getUTCFullYear(),g.getUTCMonth(),g.getUTCDate())}var p="";if(!h){p=WH.TERMS.starts+" "+m.toLocaleDateString()}else{if(!m){p=WH.TERMS.ends+" "+h.toLocaleDateString()}else{var l=(function(){try{new Date().toLocaleDateString("i")}catch(r){return r.name==="RangeError"}return false})();var f={month:"long",year:"numeric"};var q="",o="",c=0;if(l&&(m.getDate()==1)){q=m.toLocaleDateString(undefined,f);c++}else{q=m.toLocaleDateString()}if(l&&((new Date(h.valueOf()+36*60*60*1000)).getMonth()!=h.getMonth())){o=h.toLocaleDateString(undefined,f);c++}else{o=h.toLocaleDateString()}if(q==o){p=q}else{if(c==1){p=m.toLocaleDateString()+" - "+h.toLocaleDateString()}else{p=q+" - "+o}}}}return p};WH.createTextGlow=function(o,h){var g=WH.ce("span");for(var f=-1;f<=1;++f){for(var c=-1;c<=1;++c){var m=WH.ce("div");m.style.position="absolute";m.style.whiteSpace="nowrap";m.style.left=f+"px";m.style.top=c+"px";if(f==0&&c==0){m.style.zIndex=4}else{m.style.color="black";m.style.zIndex=2}m.innerHTML=o;WH.ae(g,m)}}g.style.position="relative";g.className="glow"+(h!=null?" "+h:"");var l=WH.ce("span");l.style.visibility="hidden";l.innerHTML+=o;WH.ae(g,l);return g};WH.createProgressBar=function(f){if(f==null){f={}}if(typeof f.text=="undefined"){f.text=" "}if(f.color==null){f.color="rep0"}if(f.width==null||f.width>100){f.width=100}var g,h;if(f.hoverText){g=WH.ce("a");g.href="javascript:"}else{g=WH.ce("span")}g.className="progressbar";if(f.text||f.hoverText){h=WH.ce("div");h.className="progressbar-text";if(f.text){var c=WH.ce("del");WH.ae(c,WH.ct(f.text));WH.ae(h,c)}if(f.hoverText){var d=WH.ce("ins");WH.ae(d,WH.ct(f.hoverText));WH.ae(h,d)}WH.ae(g,h)}h=WH.ce("div");h.className="progressbar-"+f.color;h.style.width=f.width+"%";if(f.height){h.style.height=f.height}WH.ae(h,WH.ct(WH.Strings.nbsp));WH.ae(g,h);if(f.text){var h=WH.ce("div");h.className="progressbar-text progressbar-hidden";WH.ae(h,WH.ct(f.text));WH.ae(g,h)}return g};WH.createReputationBar=function(d,g){if(!g){g=0}var l=WH.getReputationProgress(g);var h=l.length>0?(l[l.length-1][1]+999):0;if(!d){d=0}if(d<0){d=0}else{if(d>h){d=h}}var o=d,f=0,p,m=h;if(h!=0){while(f<l.length){if(d<l[f][1]){break}++f}--f;o-=l[f][1];m=(f+1<l.length)?(l[f+1][1]-l[f][1]):999}if(g){p=g_friendship_reactions[WH.sprintf("$1-$2",g,f)]}else{p=g_reputation_standings[f]}var c={text:p,hoverText:o+" / "+m,color:"rep"+f,width:parseInt(o/m*100)};return WH.createProgressBar(c)};WH.getReputationProgress=function(c){if(window.g_friendships_thresholds&&Array.isArray(g_friendships_thresholds[c])){return g_friendships_thresholds[c]}return[[0,0],[0,36000],[0,39000],[0,42000],[0,45000],[0,51000],[0,63000],[0,84000]]};WH.createAchievementBar=function(g,f,d,h){if(!g){g=0}var c={text:g+(h>0?"(+"+h+")":"")+(f>0?" / "+f:""),color:(d?"rep7":"ach"+(f>0?0:1)),width:(f>0?parseInt(g/f*100):100)};return WH.createProgressBar(c)};WH.addCompletionIcons=function(o,h,m,g){var l=0;let displaysByType;if(h==="transmog-set"){displaysByType=typeof m==="object"?m:WH.getPageData("transmog-set-detail-completion")}for(var c in g_user.lists){if(!g_user.lists.hasOwnProperty(c)){continue}let list=g_user.lists[c];if(!list.character){continue}let d=0;if(h==="transmog-set"){d=WH.Wow.TransmogSet.getCompletionAmount(displaysByType,list.id);if(d==null){continue}}else{if(!(list.id in g_completion[h])){continue}d=(WH.inArray(g_completion[h][list.id],m)!=-1)?1:0}if(g&&!d){continue}WH.ae(o,WH.createCompletionIcon(list,d));l++}if(h==="quest"&&g_user.characterProfiles&&g_user.characterProfiles.length){for(var f,c=0;f=g_user.characterProfiles[c];c++){var d=WH.inArray(f.quests,m)!=-1;if(g&&!d){continue}WH.ae(o,WH.createCompletionIcon({classs:f["class"],character:f.name,realm:f.realm},d?1:0));l++}}return l};WH.createCompletionIcon=function(g,f,c){var d=WH.ce("a");if(g.url){d.href="/list="+g.id+"/"+g.url}d.className="progress-icon progress-"+(f?Math.max(1,Math.floor(f*8)):0);WH.Tooltip.simple(d,WH.getCompletionTooltip(g,f),"",true);if(c){d.rel=c}return d};WH.getCompletionTooltip=function(d,c){let result=WH.ce("div");WH.ae(result,WH.ce("span",{className:"q"},WH.ct(((c>=1)?WH.TERMS.complete:WH.TERMS.incomplete)+WH.TERMS.colon_punct)));WH.ae(result,WH.ce("br"));let span=WH.ce("span",{style:{whiteSpace:"nowrap"}});WH.ae(result,span);WH.ae(span,WH.ce("b",{className:"c"+d.classs},WH.ct(d.character)));let parts=[WH.Strings.nbsp,d.realm];if(d.hasOwnProperty("region")){parts.push(d.region)}WH.ae(span,WH.ce("span",{className:"q0"},WH.ct(parts.join(" "))));if(c>0&&c<1){WH.ae(span,WH.ct(WH.Strings.sprintf(WH.TERMS.parens_format,"",Math.round(c*100)+"%")))}return result.innerHTML};WH.getCompletionFlags=function(l,o){var d=0;var c=g_user.lists||[];for(var f=c.length-1;f>=0;f--){var m=c[f];if(!(m.id in g_completion[l])||!m.character){continue}d=(d<<1)|(WH.inArray(g_completion[l][m.id],o)!=-1?1:0)}if(l==="quest"&&g_user.characterProfiles&&g_user.characterProfiles.length){for(var f=g_user.characterProfiles.length-1;f>=0;f--){var h=g_user.characterProfiles[f];var g=WH.inArray(h.quests,o)!=-1;d=(d<<1)|(g?1:0)}}return d};WH.preventPageScroll=function(c){var d=(c.originalEvent&&c.originalEvent.wheelDelta)||(c.originalEvent&&-c.originalEvent.detail)||c.wheelDelta||-c.detail;this.scrollTop+=(d<0?1:-1)*100;c.preventDefault()};WH.pickerWheel=function(c){c.preventDefault();if(c.deltaY>0){this.scrollTop+=100}else{this.scrollTop-=100}};WH.setSelectedLink=function(f,d){if(!WH.setSelectedLink.groups){WH.setSelectedLink.groups={}}var c=WH.setSelectedLink.groups;if(c[d]){c[d].className=c[d].className.replace("selected","")}f.className+=" selected";c[d]=f};WH.addPagination=function(r,g){function u(A,d){var z;if(A==g.page){z=WH.ce("span");z.className="selected"}else{z=WH.ce("a");z.href=(A>1?g.url+g.sep+A+g.pound:g.url+g.pound)}WH.ae(z,WH.ct(d!=null?d:A));return z}if(!g.pound){g.pound=""}if(!g.sep){g.sep="."}if(g.allOrNothing&&g.nPages<=1){return}var p=(g.align&&g.align=="left");var h=WH.ce("div"),t,w=WH.ce("var");h.className="pages";if(p){h.className+=" pages-left"}if(g.nPages>1){t=WH.ce("div");t.className="pages-numbers";var v=Math.max(2,g.page-2);var o=Math.min(g.nPages-1,g.page+2);var c=[];if(g.page!=g.nPages){c.push(u(g.page+1,String.fromCharCode(187)))}c.push(u(g.nPages));if(o<g.nPages-1){var f=WH.ce("span");WH.ae(f,WH.ct("..."));c.push(f)}for(var m=o;m>=v;--m){c.push(u(m))}if(v>2){var f=WH.ce("span");WH.ae(f,WH.ct("..."));c.push(f)}c.push(u(1));if(g.page!=1){c.push(u(g.page-1,String.fromCharCode(171)))}if(p){c.reverse()}for(var m=0,q=c.length;m<q;++m){WH.ae(t,c[m])}t.firstChild.style.marginRight="0";t.lastChild.style.marginLeft="0"}var w=WH.ce("var");WH.ae(w,WH.ct(WH.Strings.sprintf(WH.TERMS[g.wording[g.nItems==1?0:1]],g.nItems)));if(g.nPages>1){var f=WH.ce("span");WH.ae(f,WH.ct(String.fromCharCode(8211)));WH.ae(w,f);var l=WH.ce("a");l.className="go-to-page fa fa-files-o";l.href="javascript:";l.onclick=function(){var d=prompt(WH.sprintf(WH.TERMS.gotopage_format,1,g.nPages),g.page);if(d!=null){d|=0;if(d!=g.page&&d>=1&&d<=g.nPages){document.location.href=(d>1?g.url+g.sep+d+g.pound:g.url+g.pound)}}};l.onmouseover=function(d){WH.Tooltip.showAtCursor(d,WH.TERMS.gotopage_tip,0,0,"q2")};l.onmousemove=WH.Tooltip.cursorUpdate;l.onmouseout=WH.Tooltip.hide;WH.ae(w,l)}if(p){WH.ae(h,w);if(t){WH.ae(h,t)}}else{if(t){WH.ae(h,t)}WH.ae(h,w)}WH.ae(r,h)};WH.disclose=function(d,c){let isNowVisible=WH.toggleDisplay(d,true);c.classList.remove("disclosure-"+(isNowVisible?"off":"on"));c.classList.add("disclosure-"+(isNowVisible?"on":"off"));return false};WH.toggle=function(c){let isNowVisible=WH.toggleDisplay(c,true);this.classList.remove("toggler-"+(isNowVisible?"off":"on"));this.classList.add("toggler-"+(isNowVisible?"on":"off"));return false};WH.setupChangeWarning=function(h,l,d){if(!h){return}function f(){return d}h.submit(function(){window.onbeforeunload=null});var g=[];for(var c in l){var m=l[c];if(!m){continue}g[c]=m.val();m.keydown(function(){for(var o in l){var p=l[o];if(!p){continue}if(p.val()!=g[o]){window.onbeforeunload=f;return}window.onbeforeunload=null}})}};$(document).ready(function(){WH.qsa("dfn[title]").forEach(function(c){let text=c.title;c.removeAttribute("title");c.classList.add("tip");WH.Tooltip.simple(c,text,"q",undefined,undefined,undefined,250)});$(".text").bind("copy",function(){$("*[unselectable]",this).each(function(f,d){var c=$(d).text();$(d).text("");setTimeout(function(){$(d).text(c)},1)})})});$(document).ready(function(){$("input").each(function(){var g=$(this).attr("maxlength");var f=$(this).attr("data-charwarning");var c=f?$("#"+f):null;if(!g||!c){return}var d=function(){c.hide()};var h=function(p){var l=g-p;var q=p/g;var o=parseInt((q>=0.5)?255:(q*2*255)).toString(16);var m=parseInt((q<0.5)?255:(255-((q-0.5)*2*255))).toString(16);if(o.length==1){o="0"+o}if(m.length==1){m="0"+m}c.text(WH.sprintf(WH.TERMS.charactersremaining_format,l));c.show();c.css("color","#"+o+m+"00")};$(this).focus(function(){h($(this).val().length)}).blur(function(){d()}).keyup(function(){h($(this).val().length)})})});WH.getN5=function(c){var d=Math.abs(c);if(d<10000){return WH.numberFormat(c)}if(d<100000){return(Math.round(c/100)/10)+"k"}if(d<1000000){return Math.round(c/1000)+"k"}if(d<10000000){return(Math.round(c/1000/10)/100)+"m"}if(d<100000000){return(Math.round(c/1000/100)/10)+"m"}if(d<1000000000){return Math.round(c/1000/1000)+"m"}if(d<10000000000){return(Math.round(c/1000/1000/10)/100)+"b"}if(d<10000000000){return(Math.round(c/1000/1000/100)/10)+"b"}return Math.round(c/1000/1000/1000)+"b"};WH.debug=function(c){if(!WH.isDev()&&!WH.User.hasRole(U_GROUP_ADMIN)){WH.debug=function(){};return}WH.debug=function(){var g=["DEBUG:"];var h=null;try{var d=(new Error).stack.split("\n");if(typeof d[2]==="string"){var f=d[2].replace(/^ *at /,"");h=f.match(/(.*) \(([^()]+)\)$/);if(h){if(WH.suppressExternalDebug()&&h[2].indexOf(WH.staticUrl)===-1){return}g.push(h[1])}else{g.push(f)}}}catch(l){}g=g.concat(Array.prototype.slice.call(arguments));if(h){g.push(h[2])}console.debug.apply(console.debug,g)};WH.debug.apply(WH,Array.prototype.slice.call(arguments))};WH.decodeNumber=function(h,d){var f=0;h=h+"";var l=1;while(h.length>0){var g=h.charAt(h.length-1);var c=d.indexOf(g);if(c===-1){return null}f+=c*l;l*=d.length;h=h.substr(0,h.length-1)}return f};WH.encodeNumber=function(m,h){var d=h.length;var f=[m];while(f[0]>d){var o=Math.floor(f[0]/d);f[0]=f[0]-(o*d);f.unshift(o)}var g="";for(var l=0,c=f.length;l<c;l++){g+=h.charAt(f[l])}return g};WH.getThrownErrorMessage=function(c){if(typeof c==="string"){return c}return c&&[c.name,c.message].filter(Boolean).join(": ")||"Unknown error"};WH.userIsLoggedIn=function(){return typeof g_user=="object"&&g_user.id};WH.getElementViewportOffset=function(f){if(!(f instanceof jQuery)){f=$(f)}var d=f.offset().top;var h=d+f.outerHeight();var l=$(window);var c=l.scrollTop();var g=c+l.height();if(h>g){return h-g}if(d<c){return d-c}return 0};WH.onLoad=function(c){if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",c)}else{requestAnimationFrame(c)}};WH.onMutate=function(g,p,q){q=q||{};if(typeof MutationObserver==="undefined"){if(q.fallbackTimer!==false){let fallback=q.triggerOnce?setTimeout:setInterval;fallback(p.bind(g),q.fallbackTimer||150)}return}var d={observer:null};var o=q.triggerOnce?function(){d.observer.disconnect();p.apply(g)}:p.bind(g);var c={characterData:true,childList:true,subtree:true};var f=["attributes","characterData","childList","subtree"];for(var h=0,l=f.length;h<l;h++){if(q.hasOwnProperty(f[h])){c[f[h]]=q[f[h]]}}var m=new MutationObserver(o);d.observer=m;m.observe(g,c)};WH.getMajorHeading=function(h,c,g,d){if(isNaN(c)||c<1||c>6){c=2}if(isNaN(g)||g<1||g>6){g=c}var f=["heading-size-"+g];return WH.constructHeading("h"+c,h,f,d)};WH.getImitationHeading=function(g,f,c){if(isNaN(f)||f<1||f>6){f=2}var d=["imitation-heading","heading-size-"+f];return WH.constructHeading("div",g,d,c)};WH.constructHeading=function(c,g,f,d){if(typeof d!="object"){d={}}if(typeof d.classes=="string"){f.push(d.classes)}var h=WH.ce(c);h.className=f.join(" ");if(typeof d.styles=="string"){h.style=d.styles}if(typeof d.id=="string"){h.id=d.id}if(typeof g=="string"){h.innerHTML=g}else{if(g.nodeType===Node.ELEMENT_NODE||g.nodeType===Node.TEXT_NODE){h.appendChild(g)}else{$(h).append(g)}}return h};WH.clickToCopy=function(d,f,c){c=c||{};WH.aE(d,"click",WH.clickToCopy.copy.bind(null,d,f,c));WH.preventSelectStart(d);d.classList.add("click-to-copy");if(c.modifyTooltip){d._fixTooltip=function(g){return g+"<br>"+WH.ce("span",{className:"q2",innerHTML:WH.clickToCopy.getTooltip(false,c)}).outerHTML};c.overrideOtherTooltips=false}WH.Tooltip.simple(d,WH.clickToCopy.getTooltip.bind(null,false,c),undefined,c.attachToElement,c.overrideOtherTooltips)};WH.clickToCopy.copy=function(d,g,c,f){f.preventDefault();f.stopPropagation();if(g===undefined){if(!d.childNodes[0]||!d.childNodes[0].textContent){let error="Could not find text to copy.";WH.error(error,d);if(c.attachToElement){WH.Tooltip.show(d,error,undefined,undefined,"q10")}else{WH.Tooltip.showAtCursor(f,error,undefined,undefined,"q10")}return}g=d.childNodes[0].textContent}else{if(typeof g==="function"){g=g()}}WH.copyToClipboard(g);if(c.attachToElement){WH.Tooltip.show(d,WH.clickToCopy.getTooltip(true,c))}else{WH.Tooltip.showAtCursor(f,WH.clickToCopy.getTooltip(true,c))}};WH.clickToCopy.getTooltip=function(c,d){let text="";let properties=undefined;if(c){text=" "+WH.TERMS.copied;properties={className:"q1 fa fa-check"}}else{text=WH.TERMS.clickToCopy}let textDiv=WH.ce("div",properties,WH.ct(text));if(d.prefix){textDiv.style.marginTop="10px";let prefix=(typeof d.prefix==="function")?d.prefix():d.prefix;return prefix+textDiv.outerHTML}return textDiv.outerHTML};WH.copyToClipboard=function(d,c){if(!WH.copyToClipboard.hiddenInput){WH.copyToClipboard.hiddenInput=WH.ce("textarea",{className:"hidden-element"});WH.ae(document.body,WH.copyToClipboard.hiddenInput)}WH.copyToClipboard.hiddenInput.value=d;let textWasEmpty=WH.copyToClipboard.hiddenInput.value==="";if(textWasEmpty){WH.copyToClipboard.hiddenInput.value=WH.TERMS.nothingToCopy_tip}WH.copyToClipboard.hiddenInput.focus();WH.copyToClipboard.hiddenInput.select();if(!document.execCommand("copy")){prompt(null,d)}WH.copyToClipboard.hiddenInput.blur();if(c){if(textWasEmpty){WH.Tooltip.showFadingTooltipAtCursor(WH.TERMS.nothingToCopy_tip,"q10")}else{let tooltip=WH.ce("span",{className:"q1 fa fa-check"},WH.ct(" "+WH.TERMS.copied));WH.Tooltip.showFadingTooltipAtCursor(tooltip.outerHTML)}}};WH.createRange=function(g,c){var d={};for(var f=g;f<=c;++f){d[f]=f}return d};WH.isElementInView=function(f,g){var h=f.getBoundingClientRect();var d=document.documentElement.scrollTop;var m=d+window.innerHeight;var c=h.top+d;var l=c+h.height;if(g===true){return d<c&&m>l}else{return c<=m&&l>=d}};WH.objectToArray=function(c,g){var f=[];for(var d in c){if(c.hasOwnProperty(d)){f.push({property:d,value:c[d]})}}if(g){f.sort(function(l,h){return WH.stringCompare(l[g],h[g])})}return f};WH.sortIdArray=function(d,c,f){d.sort(f?function(h,g){return WH.stringCompare(c[h][f],c[g][f])}:function(h,g){return WH.stringCompare(c[h],c[g])})};WH.sortJsonArray=function(h,d,l,g){var c=[];for(var f in h){if(h.hasOwnProperty(f)&&d[f]&&(g==null||g(d[f]))){c.push(f)}}if(l!=null){c.sort(l)}else{WH.sortIdArray(c,d)}return c};WH.sortObjectArray=function(h,d){for(var c=0,g;g=d[c];c++){var f=1;if(g.substr(0,1)==="-"){f=-1;g=g.substr(1)}h.sort((function(p,o,m,l){if(m[p]===l[p]){return 1*o}if(typeof m[p]==="string"||typeof l[p]==="string"){return WH.stringCompare(""+m[p],""+l[p])*o}return(m[p]>l[p]?1:-1)*o}).bind(null,g,f))}};WH.isEqualSimpleObject=function(g,f){for(var d in g){if(typeof g[d]=="object"){if(typeof f[d]!="object"){return false}if(!WH.isEqualSimpleObject(g[d],f[d])){return false}}else{if(g[d]!==f[d]){return false}}}for(var c in f){if(typeof f[c]=="object"){if(typeof g[c]!="object"){return false}if(!WH.isEqualSimpleObject(g[c],f[c])){return false}}else{if(g[c]!==f[c]){return false}}}return true};WH.deUrlize=function(d){var g=d.split("-");var c="";for(var f=0;f<g.length;f++){if(c){c+=" "}c+=WH.ucfirst(g[f])}return c};WH.ensureUrlProtocol=function(c,d){if(typeof c!=="string"){WH.error("Supplied URL was not a string.",c);c=""}if(d){if(!d.match(/:$/)){d+=":"}return c.replace(/^https?:/,d).replace(/^(\/[^\/])/,d+"//"+location.host+"$1").replace(/^(\/\/)/,d+"$1")}else{return c.replace(/^(\/[^\/])/,location.protocol+"//"+location.host+"$1").replace(/^(\/\/)/,location.protocol+"$1")}};WH.getTinyIconUrl=function(c){return c.indexOf("/")===-1?WH.Icon.getIconUrl(c,WH.Icon.TINY):c};WH.removeAccents=function(g){var f=g;var d=[["ß","á","ä","à","â","è","ê","é","ë","í","î","ì","ï","ñ","ò","ó","ö","ô","ú","ü","û","ù","œ","Á","Ä","À","Â","È","Ê","É","Ë","Í","Î","Ì","Ï","Ñ","Ò","Ó","Ö","Ô","Ú","Ü","Û","Ù","œ"],["ss","a","a","a","a","e","e","e","e","i","i","i","i","n","o","o","o","o","u","u","u","u","oe","A","A","A","A","E","E","E","E","I","I","I","I","N","O","O","O","O","U","U","U","U","Oe"]];for(var c=0;c<d[0].length;c++){f=f.replace(new RegExp(d[0][c],"g"),d[1][c])}return f};WH.isDateValid=function(c){return/^(20[0-2]\d)-([01]\d)-([0-3]\d) ([0-2]\d):([0-5]\d):([0-5]\d)$/.exec(c)};WH.isIpAddress=function(c){return/[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+/.test(c)};WH.isEmailValid=function(c){if(c.length>64){return false}return c.match(/^([a-z0-9._-]+)(\+[a-z0-9._-]+)?(@[a-z0-9.-]+\.[a-z]{2,})$/i)!=null};WH.getCurrentDomain=function(){if(WH.getCurrentDomain.CACHE){return WH.getCurrentDomain.CACHE}var c=location.hostname;if(!WH.isIpAddress(c)){var d=c.split(".");if(d.length>2){d.splice(0,d.length-2)}c=d.join(".")}WH.getCurrentDomain.CACHE=c;return c};WH.isExternalUrl=function(c){return!(!c||(c.indexOf("http")!=0&&c.indexOf("//")!=0)||c.indexOf("wowhead.com")!=-1||c.indexOf("wowheadnews.")!=-1||c.indexOf(WH.getCurrentDomain())!=-1)};WH.getRelativeHostPrefix=function(){var d=true;if(WH.isDev()){d=location.protocol==="https:"}var h=d?"_https":"_http";if(!WH.getRelativeHostPrefix.CACHE){WH.getRelativeHostPrefix.CACHE={}}if(h in WH.getRelativeHostPrefix.CACHE){return WH.getRelativeHostPrefix.CACHE[h]}var f="";if(d!==(location.protocol==="https:")&&!/^[0-9\.]+$/.test(location.hostname)){var g=/^([\w\W]*)\.[^\.]+\.com$/.exec(location.hostname);g=g?g[1]:"www";var c="";if(location.port){c=location.port}if(c.substr(0,1)!==":"){c=":"+c}if(c===":80"||c===":"){c=""}f="https://"+g+".wowhead.com"+c}if(!d){f=f.replace(/^https:/,"http:")}WH.getRelativeHostPrefix.CACHE[h]=f;return f};WH.fixWowheadHttps=function(c){if(WH.isDev()){return c.replace(/\bhttps?:(\/\/(?:[^\/:]+\.)?(?:wowhead\.com|zamimg\.com)[:\/])/g,"$1")}return c.replace(/\bhttp:(\/\/(?:[^\/:]+\.)?(?:wowhead\.com|zamimg\.com)[:\/])/g,"https:$1")};WH.goToLoginPage=function(c){window.location=WH.Url.getLoginPath(c)};WH.createOrRegex=function(g,d){g=g.replace(/(\(|\)|\|\+|\*|\?|\$|\^)/g,"\\$1");var l=g.split(" "),h="";for(var f=0,c=l.length;f<c;++f){if(f>0){h+="|"}h+=l[f]}return new RegExp((d!=null?"("+d+")?":"")+"("+h+")","gi")};WH.getHash=function(){return"#"+decodeURIComponent(location.href.split("#")[1]||"")};WH.modifyUrl=function(c,h,d,f){if(!d){d=$.noop}var g="";if(c.match(/(#.+)$/)){g=RegExp.$1;c=c.replace(g,"")}if(typeof d.custom=="function"){c=d.custom(c,f)}if(d.returnAfterCustom){return c+g}$.each(h,function(r,q){var p;var l;var t;var o=c.match(new RegExp("(&|\\?)?"+r+"=?([^&]+)?"));if(o!=null){p=o[0];l=o[1];t=decodeURIComponent(o[2])}if(q==null){if(!p){return}t=null}else{if(q.substr(0,2)=="+="){if(t&&d.onAppendCollision){t=d.onAppendCollision(t,q.substr(2),d.menuUrl)}else{if(!t&&d.onAppendEmpty){t=d.onAppendEmpty(q.substr(2),d.menuUrl)}else{if(!t){t=""}t+=$.trim(q.substr(2))}}}else{t=q}}if(p){var m="";if(l){m+=l}if(t!=null){m+=r;if(t){m+="="+WH.urlEncodeHref(t)}}c=c.replace(p,m)}else{if(t||q==null||q.substr(0,2)!="+="){c+=(/[&?]/.test(c)?"&":"?")+r;if(t){c+="="+WH.urlEncodeHref(t)}}}});c=c.replace("?&","?");c=c.replace(/&&/g,"&");c=c.replace(/\/\?/g,"/");c=c.replace(/(&|\?)+$/,"");return c+g};WH.pageWasReloaded=function(){if(window.performance){if(performance.getEntriesByType){var c=performance.getEntriesByType("navigation");for(var d=0;d<c.length;d++){if(c[d].type==="reload"){return true}}}else{if(performance.navigation){return performance.navigation.type===1}}}return false};WH.getPreferredTransmogRace=function(){var c=WH.LocalStorage.get("transmog_racegender");if(!c&&g_user&&g_user.settings&&g_user.settings.defaultModel){c=[g_user.settings.defaultModel.race,g_user.settings.defaultModel.gender].join(",")}if(!c||((""+c).indexOf(",")<0)){c="1,2"}c=c.split(",");if(c[0]==25||c[0]==26){c[0]=24}if(!parseInt(c[0],10)){c[0]=1}if(!parseInt(c[1],10)){c[1]=2}if(!WH.Wow.Race.isPlayableRace(c[0])){c[0]=WH.Wow.Race.ID_HUMAN}return{race:parseInt(c[0]),gender:parseInt(c[1])}};WH.isBlizzardReferral=function(){var c=false;if(typeof WH.getGets().brl!=="undefined"){c="brl"}else{c=!!(document.referrer&&document.referrer.match(/^https?:\/\/[^\/]*\bbattle\.net\//))}WH.isBlizzardReferral=(function(d){return d}).bind(null,c);return c};WH.updateContentHeight=function(){var h=$(".main-contents");var d=h.outerHeight()-h.height();var f=$(".sidebar");var c=f.height()-d;var g=$("#main-precontents");if(g.length){c-=g.outerHeight()}if(WH.WAS.isSkinned()){c+=10}if(h.height()<c){h.css({"min-height":c+"px"})}};WH.prepInfobox=function(){$(".infobox").each(function(){var g=$(this);if(g.data("infobox-completion-info-added")!==true&&g_user.lists&&typeof g_pageInfo=="object"&&g_types[g_pageInfo.type]&&typeof g_pageInfo.typeId=="number"){var c=$(".compact-completion-display",g);if(c.length){var d=$("span",c);if(d.length){var f=0;d.each(function(){var q=$(this);var m=q.html();try{m=JSON.parse(m)}catch(o){return}var p;for(var l=0,h;h=g_user.lists[l];l++){if(h.id==m.id){p=h;break}}if(p){q.parent().append(WH.createCompletionIcon(p,m.completed?1:0,m.rel));q.remove();f++}});if(f){c.parent().parent().show()}}else{if(c.is(":empty")&&WH.addCompletionIcons(c.get(0),g_types[g_pageInfo.type],g_pageInfo.typeId)){c.parent().parent().show()}}}g.data("infobox-completion-info-added",true)}})};WH.enhanceTextarea=function(F,f){if(!(F instanceof jQuery)){F=$(F)}if(F.data("wh-enhanced")||F.prop("tagName")!="TEXTAREA"){return}if(typeof f!="object"){f={}}var l=(function(I){if(!I.dynamicResizeOption){return true}if(WH.LocalStorage.get("dynamic-textarea-resizing")==="true"){return true}if(WH.LocalStorage.get("dynamic-textarea-resizing")==="false"){return false}return!I.hasOwnProperty("dynamicSizing")||I.dynamicSizing}).bind(null,f);var t=F.height()||500;var B=$("<div/>",{"class":"enhanced-textarea-wrapper"}).insertBefore(F).append(F);if(!f.hasOwnProperty("color")){B.addClass("enhanced-textarea-dark")}else{if(f.color){B.addClass("enhanced-textarea-"+f.color)}}if(!f.hasOwnProperty("dynamicSizing")||f.dynamicSizing||f.dynamicResizeOption){var h=$("<div/>",{"class":"enhanced-textarea-expander"}).prependTo(B);h.css("width",h.parent().width()+"px");var c=function(N,K,J,M){if(!M()){return}var L=N.val()||N.attr("placeholder")||"";if(L){L=WH.htmlEntities(L)}K.html(L.replace(/\n/g,"<br>")+"<br>");var I=K.height()+(J?14:34);N.css("height",I+"px")};F.bind("keydown keyup change",c.bind(this,F,h,f.exactLineHeights,l));c(F,h,f.exactLineHeights,l);setTimeout(c.bind(this,F,h,f.exactLineHeights,l),100);if(!f.dynamicResizeOption||(f.dynamicResizeOption&&l())){B.addClass("enhanced-textarea-dynamic-sizing")}}if(!f.hasOwnProperty("focusChanges")||f.focusChanges){B.addClass("enhanced-textarea-focus-changes")}if(f.markup){var z=$("<div/>",{"class":"enhanced-textarea-markup-wrapper"}).prependTo(B);var D=$("<div/>",{"class":"enhanced-textarea-markup"}).appendTo(z);var C=$("<div/>",{"class":"enhanced-textarea-markup-segment"}).appendTo(D);var m=$("<div/>",{"class":"enhanced-textarea-markup-segment"}).appendTo(D);if(f.markup=="inline"){ar_AddInlineToolbar(F.get(0),C.get(0),m.get(0))}else{ar_AddToolbar(F.get(0),C.get(0),m.get(0))}if(f.dynamicResizeOption){var A=$("<div/>",{"class":"enhanced-textarea-markup-segment"}).appendTo(D);var G=$("<label/>").appendTo(A);var E=$("<input/>",{type:"checkbox",checked:l()}).appendTo(G);E.change((function(I,K,O,M,J,N){var L=this.is(":checked");WH.LocalStorage.set("dynamic-textarea-resizing",JSON.stringify(L));if(L){K.addClass("enhanced-textarea-dynamic-sizing");N(O,I.exactLineHeights,M)}else{K.removeClass("enhanced-textarea-dynamic-sizing");O.css("height",J+"px")}}).bind(E,f,B,F,l,t,c));$("<span/>",{text:WH.TERMS.autoresizetextbox}).appendTo(G)}if(f.scrollingMarkup){if(WH.enhanceTextarea.scrollerCount){WH.enhanceTextarea.scrollerCount++}else{WH.enhanceTextarea.scrollerCount=1}var H="fixable-markup-controls-"+WH.enhanceTextarea.scrollerCount;var r="fixed-markup-controls-"+WH.enhanceTextarea.scrollerCount;var d=function(I){var J=I.css("backgroundColor");if(J=="rgba(0, 0, 0, 0)"||J=="transparent"){return d(I.parent())}else{return J}};var u=d(D);for(var p,o=0;(p=window.document.styleSheets[o])&&p.href;o++){}if(!p){window.document.head.appendChild(document.createElement("style"));p=window.document.styleSheets[o]}var w="."+r+" ."+H+" .enhanced-textarea-markup";p.insertRule(w+" {background:"+u+";padding-bottom:5px;padding-top:10px;position:fixed;top:0;z-index:3}",p.cssRules.length);p.insertRule("body.has-mobile-zul-bar"+w+" {padding-top:50px}",p.cssRules.length);z.addClass(H);var v=function(J,K,I){var M=WH.Layout.Responsive.isZulInMobileMode()?40:0;var L=this.scrollY||this.pageYOffset||0;if(L>J.offset().top-10-M&&L<K.offset().top+K.height()-100-M){$("body").addClass(I)}else{$("body").removeClass(I)}};var q=$(window);q.scroll(v.bind(window,z,B,r));v.call(window,z,B,r);var g=(function(I,J){J.css("width",I.width()+"px");I.css("height",J.height()+"px")}).bind(null,z,D);g();q.on("resize",g);$(function(){setTimeout(g,2000)})}}F.data("wh-enhanced",true)};WH.createOptionsMenuWidget=function(f,r,u){var l=0;var q=1;var d=2;var h=3;var p=WH.createOptionsMenuWidget.chevron;if(u.noChevron){p=""}var t=WH.ce("span");t.id="options-menu-widget-"+f;t.className="options-menu-widget "+t.id;t.innerHTML=r+p;if(u.id){t.id=u.id}if(u.className){t.className+=" "+u.className}if(u.options instanceof Array){var g=[];for(var m=0,o;o=u.options[m];m++){var c=[m,o[q]];if((typeof u.selected=="number"||typeof u.selected=="string")&&u.selected==o[l]){t.innerHTML=o[q]+p;if(o[h]){switch(typeof o[h].className){case"string":$.data(t,"options-menu-widget-class",o[h].className);t.className+=" "+o[h].className;break;case"function":$.data(t,"options-menu-widget-class",o[h].className(o,true));t.className+=" "+o[h].className(o,true);break}}}if(o[d]){c.push((function(B,A,z,w){switch(typeof z[d]){case"string":window.location=z[d];break;case"function":if(typeof w.updateWidgetText=="undefined"||w.updateWidgetText){A.innerHTML=z[q]+B;var v=$.data(A,"options-menu-widget-class");if(v){A.className=A.className.replace(new RegExp(" *\\b"+v+"\\b"),"")}if(z[h]){switch(typeof z[h].className){case"string":$.data(A,"options-menu-widget-class",z[h].className);A.className+=" "+z[h].className;break;case"function":$.data(A,"options-menu-widget-class",z[h].className(z,true));A.className+=" "+z[h].className(z,true);break}}}z[d](A,z);break}}).bind(null,p,t,o,u))}else{if(!o[h]||!o[h].menu){c[0]=null}}c[MENU_IDX_OPT]={};if(o[h]){switch(typeof o[h].className){case"string":c[MENU_IDX_OPT].className=o[h].className;break;case"function":c[MENU_IDX_OPT].className=o[h].className.bind(null,o,false);break}switch(typeof o[h].column){case"number":case"string":c[MENU_IDX_OPT].column=o[h].column;break;case"function":c[MENU_IDX_OPT].column=o[h].column.bind(null,o);break}switch(typeof o[h].tinyIcon){case"string":c[MENU_IDX_OPT].tinyIcon=o[h].tinyIcon;break;case"function":c[MENU_IDX_OPT].tinyIcon=o[h].tinyIcon.bind(null,o);break}switch(typeof o[h].fontIcon){case"string":c[MENU_IDX_OPT].fontIcon=o[h].fontIcon;break;case"function":c[MENU_IDX_OPT].fontIcon=o[h].fontIcon.bind(null,o);break}if(typeof o[h].isChecked=="function"){c[MENU_IDX_OPT].checkedFunc=o[h].isChecked.bind(null,o)}if(typeof o[h].menu=="object"&&o[h].menu instanceof Array){Menu.setSubmenu(c,o[h].menu)}}g.push(c)}t.menu=g;if(u.menuOnClick){t.onmousedown=WH.rf;Menu.add(t,g,{showAtElement:true})}else{Menu.add(t,g)}}if(u.target){$(u.target).append(t)}else{return t}};WH.createOptionsMenuWidget.chevron=' <i class="fa fa-chevron-down fa-color-gray"></i>';WH.setupSmoothNavClicks=function(d){var c=$(".smooth-nav-inner > a",d);if(!c.length){setTimeout(WH.setupSmoothNavClicks.bind(null,d),9);return}c.each(function(){var f=this.href.replace(new RegExp("^"+location.href.replace(/#.*/,"")),"");if(f&&f.substr(0,1)==="#"){$(this).click(function(g,h){if(h.which===2){return}var l=g==="#top"?0:$(g).offset().top-20;if(isNaN(l)){return}if(Platform.isTouch()){l-=37}$("html, body").stop().animate({scrollTop:l},"500","swing");return false}.bind(null,f))}})};WH.countdownClock=function(A){var o=$(A.element||("#countdown-clock-"+A.id));if(!o.length){return}var c;if(A.url){c=$("<a/>",{href:A.url,target:"_blank"})}else{c=$("<div/>")}c.addClass("countdown-clock-content").css({"background-image":"url("+A.bg+")"});var z=$("<div/>",{"class":"countdown-clock-content-inner"}).appendTo(c);if(A.impressionImage){$("<img>",{src:A.impressionImage,css:{bottom:0,height:"1px",position:"absolute",right:0,width:"1px"}}).appendTo(c)}if(A.text){z.append($("<span/>",{"class":"countdown-clock-text",html:A.text}))}var f=$("<span/>",{"class":"countdown-clock-time"}).appendTo(z);var q=$("<table/>").appendTo(f);var r=$("<tr/>").appendTo(q);var p=$("<tr/>").appendTo(q);$("<td/>").appendTo(r);$("<td/>",{html:":"}).appendTo(r);$("<td/>").appendTo(r);$("<td/>",{html:":"}).appendTo(r);$("<td/>").appendTo(r);$("<td/>",{html:LANG.timeunitspl[3]}).appendTo(p);$("<td/>").appendTo(p);$("<td/>",{html:LANG.timeunitspl[4]}).appendTo(p);$("<td/>").appendTo(p);$("<td/>",{html:LANG.timeunitspl[5]}).appendTo(p);o.addClass("countdown-clock").append(c);var v={days:0,hours:0,minutes:0};var d=new Date().getTime();var m=d;if(typeof A.time==="string"){m=new Date(A.time).getTime()}else{if(typeof A.time==="object"){var w=new Date();if(!A.time.hasOwnProperty("year")){A.time.year=w.getFullYear()}if(!A.time.hasOwnProperty("month")){A.time.month=w.getMonth+1}if(!A.time.hasOwnProperty("day")){A.time.day=w.getDay()}if(!A.time.hasOwnProperty("hour")){A.time.hour=0}if(!A.time.hasOwnProperty("minute")){A.time.minute=0}if(!A.time.hasOwnProperty("second")){A.time.second=0}m=new Date(A.time.year,A.time.month-1,A.time.day,A.time.hour,A.time.minute,A.time.second).getTime()}}var l=parseInt((m-d)/1000);var g=60;var h=g*60;var u=h*24;v.days=parseInt(l/u);l=l-(v.days*24*60*60);v.hours=parseInt(l/h);l=l-(v.hours*60*60);v.minutes=parseInt(l/g);var t=function(D,B,C){if(B.days<=0&&B.hours<=0&&B.minutes<=0){D.html(C.completionText).parent().parent().addClass("countdown-clock-complete");return}$("tr:first-child > td:nth-child(1)",D).html(B.days);$("tr:last-child > td:nth-child(1)",D).html(B.days===1?LANG.timeunitssg[3]:LANG.timeunitspl[3]);$("tr:first-child > td:nth-child(3)",D).html(B.hours);$("tr:last-child > td:nth-child(3)",D).html(B.hours===1?LANG.timeunitssg[4]:LANG.timeunitspl[4]);$("tr:first-child > td:nth-child(5)",D).html(B.minutes);$("tr:last-child > td:nth-child(5)",D).html(LANG.timeunitsab[5]);B.minutes--;if(B.minutes<0){if(B.hours>0||B.days>0){B.minutes=59}else{B.minutes=0}B.hours--}if(B.hours<0){if(B.days>0){B.hours=23}else{B.hours=0}B.days--}if(B.days<0){B.days=0}setTimeout(t.bind(null,D,B,C),60000)};t(f,v,A)};WH.createTweetDiv=function(c){var f=new Date();if(!c.id||!c.text){return document.createTextNode("")}var w=WH.ce("div");w.className="full-tweet";if(c.repliedTo){var C=WH.createTweetDiv(c.repliedTo);C.className+=" replied";WH.ae(w,C)}if(c.quoted){var C=WH.createTweetDiv(c.quoted);C.className+=" replied quoted";WH.ae(w,C)}var t=WH.ce("div");WH.ae(w,t);t.className="tweet";var G=WH.ce("a");WH.ae(t,G);G.className="avatar";G.style.backgroundImage="url("+c.author.avatar.replace(/^http:/,"")+")";G.href="https://twitter.com/"+c.author.username;var h=WH.ce("div");WH.ae(t,h);h.className="main";var E=WH.ce("div");WH.ae(h,E);E.className="top";var G=WH.ce("a");WH.ae(E,G);G.href="https://twitter.com/"+c.author.username;var r=WH.ce("span");WH.ae(G,r);r.className="author-name";WH.st(r,c.author.name);var r=WH.ce("span");WH.ae(G,r);r.className="author-username";WH.st(r,"@"+c.author.username);let tweetUrl="https://twitter.com/"+c.author.username+"/status/"+c.id;var G=WH.ce("a");WH.ae(E,G);G.className="timestamp";G.href=tweetUrl;if(isNaN(Date.parse(c.timestamp))){c.timestamp=c.timestamp.replace(/^([A-Za-z]+ [A-Za-z]+ \d\d)( \d\d:\d\d:\d\d [-+]\d{4})( (?:19|20)\d\d)$/,"$1$3$2")}var F=(f.getTime()-Date.parse(c.timestamp))/1000;if(F<60){WH.st(G,""+F+"s")}else{if(F<60*60){WH.st(G,""+Math.floor(F/60)+"m")}else{if(F<60*60*24){WH.st(G,""+Math.floor(F/60/60)+"h")}else{if(F<60*60*24*3){WH.st(G,""+Math.floor(F/60/60/24)+"d")}else{F=(new Date(c.timestamp)).toString().split(" ");WH.st(G,""+F[1]+" "+F[2])}}}}var E=WH.ce("div");WH.ae(h,E);E.className="status";var v=c.text;var D,l,o,m,z;if(c.hasOwnProperty("entities")&&(c.entities!==null)){if(Array.isArray(c.entities.media)){let mediaGroup=(c.extended_entities&&c.extended_entities.media)||c.entities.media;for(let media,mediaIndex=0;media=mediaGroup[mediaIndex];mediaIndex++){v=v.replace(c.text.substr(media.indices[0],media.indices[1]-media.indices[0]),"");let gotVideo=(function(q,d){let extended=q.extended_entities&&q.extended_entities.media&&q.extended_entities.media[d];if(!extended||(extended.type!=="video"&&extended.type!=="animated_gif")){return false}if(extended.additional_media_info&&extended.additional_media_info.embeddable===false){return false}if(!extended.video_info||!extended.video_info.aspect_ratio){return false}let isGif=extended.type==="animated_gif";let variant;let variants=extended.video_info.variants;variants.sort(function(I,u){return(u.bitrate||0)-(I.bitrate||0)});for(let m=0;m<variants.length;m++){if(variants[m].bitrate){variant=variants[m];break}}if(!variant){if(isGif&&variants[0]){variant=variants[0]}else{return false}}let video=WH.ce("video");let ar=extended.video_info.aspect_ratio;video.width=Math.min(Platform.getViewportWidth()-102,375);video.height=Math.ceil(video.width/ar[0]*ar[1]);video.controls=true;video.poster=extended.media_url_https||(extended.media_url.replace(/^http:/,""));video.src=variant.url;if(isGif){video.loop=true}WH.ae(h,video);return true})(c,mediaIndex);if(!gotVideo&&media.type==="photo"){var g="",B=0;for(var p in media.sizes){if((media.sizes[p].w>=250)&&(B==0||media.sizes[p].w<B)){g=p;B=media.sizes[p].w}}if(g!=""){if(B>375){B=375}let imageLink=WH.ce("a",{href:tweetUrl+"/photo/"+(mediaIndex+1)});WH.ae(h,imageLink);var H=WH.ce("img");WH.ae(imageLink,H);H.className="photo";H.width=B;H.height=Math.floor(media.sizes[g].h*(B/media.sizes[g].w));H.src=media.media_url_https||(media.media_url.replace(/^http:/,"")+":"+g)}}}}if(Array.isArray(c.entities.urls)){D=[];z=c.quoted?WH.sprintf("https://twitter.com/$1/status/$2",c.quoted.author.username,c.quoted.id):false;for(m in c.entities.urls){o=c.entities.urls[m];l=c.text.substr(o.indices[0],o.indices[1]-o.indices[0]);if(WH.inArray(D,l)>=0){continue}D.push(l);if(z&&o.expanded_url.indexOf(z)==0){v=v.replace(l,"")}else{v=v.replace(l,'<a href="'+o.url+'" class="entity-url">'+o.display_url+"</a>","g")}}}if(Array.isArray(c.entities.user_mentions)){D=[];for(m in c.entities.user_mentions){o=c.entities.user_mentions[m];l=c.text.substr(o.indices[0],o.indices[1]-o.indices[0]).toLowerCase();if(WH.inArray(D,l)>=0){continue}D.push(l);v=v.replace(l,'<a href="https://twitter.com/'+o.screen_name+'" class="entity-mention">@'+o.screen_name+"</a>","gi")}}if(Array.isArray(c.entities.hashtags)){D=[];for(m in c.entities.hashtags){o=c.entities.hashtags[m];l=c.text.substr(o.indices[0],o.indices[1]-o.indices[0]).toLowerCase();if(WH.inArray(D,l)>=0){continue}D.push(l);v=v.replace(l,'<a href="https://twitter.com/search?q=#'+o.text+'" class="entity-hashtag">#'+o.text+"</a>","gi")}}}E.innerHTML=v;var A=WH.ce("div");WH.ae(h,A);A.className="bottom";var G=WH.ce("a");WH.ae(A,G);G.className="widget reply";G.href="https://twitter.com/intent/tweet?in_reply_to="+c.id;G.target="whtwitter";WH.st(G,"Reply");G.insertBefore(WH.ce("span"),G.firstChild);var G=WH.ce("a");WH.ae(A,G);G.className="widget retweet";G.href="https://twitter.com/intent/retweet?tweet_id="+c.id;G.target="whtwitter";WH.st(G,"Retweet");G.insertBefore(WH.ce("span"),G.firstChild);var G=WH.ce("a");WH.ae(A,G);G.className="widget favorite";G.href="https://twitter.com/intent/favorite?tweet_id="+c.id;G.target="whtwitter";WH.st(G,"Favorite");G.insertBefore(WH.ce("span"),G.firstChild);return w};WH.slashHashEvent=null;try{WH.slashHashEvent=new Event("slashhash")}catch(e){try{WH.slashHashEvent=document.createEvent("Event");WH.slashHashEvent.initEvent("slashhash",true,true)}catch(e){}}WH.getSlashHash=function(d){var f=""+location.href;var c=f.indexOf(d);if(c==-1){return location.hash?(""+location.hash).replace(/^#/,""):""}var g=f.substr(0,c+d.length);return f.substr(g.length+1)};WH.setSlashHash=function(g,m,f){var h=""+location.href;var d=h.indexOf(g);if(d==-1){alert("Bad hash update: No root found!");return}var l=h.substr(0,d+g.length);var o=h.substr(l.length+1);if(m.substr(0,1)=="#"){m=m.substr(1)}var c=m?"/"+m:"";if(f){if(window.history&&window.history.pushState){window.history.pushState({},"",l+c);if(WH.slashHashEvent&&window.dispatchEvent){window.dispatchEvent(WH.slashHashEvent)}}else{location.hash="#"+c}}else{if(window.history&&window.history.replaceState){window.history.replaceState({},"",l+c);if(WH.slashHashEvent&&window.dispatchEvent){window.dispatchEvent(WH.slashHashEvent)}}else{location.replace("#"+c)}}return o};WH.setHash=function(d,c){var f=""+location.hash;if(d.substr(0,1)!="#"){d="#"+d}if(d=="#."){WH.clearHash(c||false)}else{if(c){location.hash=d}else{location.replace(d)}}return f};WH.clearHash=function(c){var f=""+location.hash;var d=(""+location.href).replace(/#.*/,"");if(c){if(window.history&&window.history.pushState){window.history.pushState({},"",d)}else{location.hash="#."}}else{if(window.history&&window.history.replaceState){window.history.replaceState({},"",d)}else{location.replace("#.")}}return f};WH.selectText=function(d){var g=document,h=g.getElementById(d),c,f;if(g.body.createTextRange){c=document.body.createTextRange();c.moveToElementText(h);c.select()}else{if(window.getSelection){f=window.getSelection();c=document.createRange();c.selectNodeContents(h);f.removeAllRanges();f.addRange(c)}}};WH.ucfirst=function(c){return c.charAt(0).toUpperCase()+c.slice(1)};WH.loadAssets=function(q,o){var h=function(r){var t=WH.ce("link");t.rel="stylesheet";if(WH.PageMeta.scriptVersionQueryString){if(r.indexOf("?")<0){r+="?"+WH.PageMeta.scriptVersionQueryString}else{r=r.replace(/\?/,"?"+WH.PageMeta.scriptVersionQueryString+"&")}}t.href=r;WH.ae(document.getElementsByTagName("head")[0],t)};var f=function(t,v,r){var u=WH.ce("script");u.type="text/javascript";if(r&&WH.PageMeta.scriptVersionQueryString){if(t.indexOf("?")<0){t+="?"+WH.PageMeta.scriptVersionQueryString}else{t=t.replace(/\?/,"?"+WH.PageMeta.scriptVersionQueryString+"&")}}u.src=t;if(v){WH.aE(u,"load",v)}WH.ae(document.getElementsByTagName("head")[0],u)};switch(q){case"artifact-weapon-calc":if(WH.isSet("ArtifactCalc")){if(o){o()}return}h(WH.staticUrl+"/css/tools/artifact-calc.css?"+WH.getDataBuild());var c=WH.staticUrl+"/js/ArtifactCalc.js?"+WH.getDataBuild();if(WH.isSet("g_artifact_textures")){f(c,o,true)}else{var m=WH.Url.getDataPageUrl("artifact-calc");f(m,f.bind(null,c,o,true))}break;case"azerite-finder":if(WH.Wow.AzeriteFinder){if(o){o()}return}h(WH.staticUrl+"/css/tools/azerite-finder.css");f(WH.staticUrl+"/js/WH/Wow/AzeriteFinder.js",o,true);break;case"battle-pet-team-calc":if(WH.isSet("BattlePetTeamCalc")){if(o){o()}return}h(WH.staticUrl+"/css/tools/battle-pet-team-calc.css?"+WH.getDataBuild());var d=WH.staticUrl+"/js/BattlePetTeamCalcCore.js?"+WH.getDataBuild();if(WH.isSet("g_battlepets")){f(d,o,true)}else{f(WH.Url.getDataPageUrl("petspecies"),f.bind(null,d,o,true))}break;case"gear-planner":if(WH.Wow.GearPlanner){if(o){o()}break}WH.loadAssets("talent-calc-classic",function(){h(WH.staticUrl+"/css/tools/gear-planner.css");o=f.bind(null,WH.Url.getDataPageUrl("gear-planner"),o,false);o=f.bind(null,WH.staticUrl+"/js/WH/Wow/GearPlanner.js",o,true);o=f.bind(null,WH.staticUrl+"/js/WH/Listview/Templates/item.js",o,true);o()});break;case"heart-of-azeroth-calc":if(WH.Wow.HeartOfAzerothCalc){if(o){o()}break}h(WH.staticUrl+"/css/tools/heart-of-azeroth-calc.css");var l=f.bind(null,WH.staticUrl+"/js/WH/Wow/HeartOfAzerothCalc.js",o,true);if(!WH.Wow.AzeriteEssence){f(WH.staticUrl+"/js/WH/Wow/AzeriteEssence.js",f.bind(null,WH.Url.getDataPageUrl("azerite-essence"),l,false),true)}else{l()}break;case"mythic-damage-calc":if(WH.Wow.MythicDamageCalc){if(o){o()}break}h(WH.staticUrl+"/css/tools/mythic-damage-calc.css");f(WH.staticUrl+"/js/WH/Wow/MythicDamageCalc.js",function(){f(WH.Url.getDataPageUrl("mythic-damage-calc"),o)},true);break;case"pvp-talent-calc":if(WH.isSet("PvpTalentCalc")){if(o){o()}return}h(WH.staticUrl+"/css/tools/pvp-calc.css?"+WH.getDataBuild());var p=WH.staticUrl+"/js/talent-pvp.js?"+WH.getDataBuild();if(WH.isSet("g_talents_pvp")){f(p,o,true)}else{f(WH.Url.getDataPageUrl("talents-pvp"),f.bind(null,p,o,true))}break;case"soulbind-calc":if(WH.Wow.SoulbindCalc){if(o){o()}break}h(WH.staticUrl+"/css/tools/soulbind-calc.css");f(WH.staticUrl+"/js/WH/Wow/SoulbindCalc.js",o,true);break;case"talent-calc":if(WH.isSet("TalentCalc")){if(o){o()}return}h(WH.staticUrl+"/css/tools/talent-calc.css?"+WH.getDataBuild());var g=WH.staticUrl+"/js/WH/Wow/TalentCalc.js?"+WH.getDataBuild();if(WH.isSet("g_glyphs")){f(g,o,true)}else{f(WH.Url.getDataPageUrl("glyphs"),f.bind(null,g,o,true))}break;case"talent-calc-classic":if(WH.Wow.hasOwnProperty("TalentCalcClassic")){if(o){o()}return}h(WH.staticUrl+"/css/"+WH.Theme.getThemePath()+"tools/talent-calc-classic.css");f(WH.staticUrl+"/js/WH/Wow/TalentCalcClassic.js",function(){f(WH.Url.getDataPageUrl("talents-classic"),o)},true);break;default:alert('Tried to load unknown asset set "'+String(q)+'".')}};WH.isInt=function(c){return typeof c==="number"&&parseFloat(c)==parseInt(c)&&!isNaN(c)};WH.ensureObjectPath=function(c,d){var f=Array.prototype.slice.call(arguments,1);if(typeof f[0]!="string"){return c}if(typeof c[f[0]]!="object"){c[f[0]]={}}if(f[1]){c[f[0]]=WH.ensureObjectPath.apply(this,[c[f[0]]].concat(f.slice(1)))}return c};WH.preventDefault=function(c){if(c&&c.preventDefault){c.preventDefault()}};WH.preventTyping=function(f){if(f&&f.preventDefault){var g=("which"in f)?f.which:f.keyCode;var d=(g>=48&&g<=57)||(g>=65&&g<=90)||(g>=96&&g<=105)||(g>=106&&g<=111)||(g>=186&&g<=192)||(g>=219&&g<=222);var c=(f.altKey||f.ctrlKey||f.shiftKey||f.metaKey);if(d&&!c){f.preventDefault()}}};WH.leadingZeroes=function(f,d){var c=f+"";while(c.length<d){c="0"+c}return c};$(document).ready(function(){$("form.vote-comment input").click(function(){var d=$(this).attr("data-vote");var l=$(this).parent();var h=l.find(".ajax");var c=l.find("input");var f=l.attr("data-post");var g=l.attr("data-type");c.prop("disabled",true);h.show();$.post("/vote",{post:f,type:g,vote:d},function(m){if(m!="ok"){c.prop("disabled",false);h.hide();alert(WH.TERMS.voteerror_tip);return}l.remove()});return false})});$(document).ready(function(){$("a.wsach").each(function(){var f=$(this).text();var q=$(this).attr("title");var h=parseInt($(this).attr("data-earned"));var l=$(this).attr("data-user");var d=$(this).parent().parent().attr("id")=="user-achievement-list";var c=$(this).attr("data-progress");var p=$(this).attr("data-quality");var o=$(this).attr("data-count");$(this).attr("title","");var r=$("<div>");r.append('<table><tr><td style="padding-bottom: 0.35em"><b class="q" data-quality="'+p+'"></b></td></tr><tr><td><span></span></td></tr></table>');r.find("b").text(f);r.find("span").text(q);if(h){var m=null;var g=(new Date()).getTime()/1000;if(l){if(h>31*24*60*60){r.append('<span class="q0"><br />'+WH.sprintf(o>1?WH.TERMS.earnedwsafirsttime4_format:WH.TERMS.earnedwsatime4_format,l,WH.formatDateSimple(new Date((g-h)*1000)))+"</span>")}else{r.append('<span class="q0"><br />'+WH.sprintf(o>1?WH.TERMS.earnedwsafirsttime2_format:WH.TERMS.earnedwsatime2_format,l,WH.formatTimeElapsed(h))+"</span>")}}else{if(!d){if(h>31*24*60*60){r.append('<span class="q0"><br />'+WH.sprintf(o>1?WH.TERMS.earnedwsafirsttime3_format:WH.TERMS.earnedwsatime3_format,WH.formatDateSimple(new Date((g-h)*1000)))+"</span>")}else{r.append('<span class="q0"><br />'+WH.sprintf(o>1?WH.TERMS.earnedwsafirsttime_format:WH.TERMS.earnedwsatime_format,WH.formatTimeElapsed(h))+"</span>")}}}if(m){r.append('<span class="q0"><br />'+m+"</span>")}}else{if(!d&&c){r.append('<span class="q0"><br /><small></small>'+WH.TERMS.progress_format.replace("%s",c)+"</td></tr>")}}WH.Tooltip.simple(this,r.html())})});WH.User=new function(){const c=this;const d="TOMRUS";this.getCommentRoleClass=function(f,g){if(f&U_GROUP_ADMIN){return"comment-role-admin"}else{if((f&U_GROUP_GREEN_TEXT)&&g!==d){return"comment-role-moderator"}else{if(f&U_GROUP_VIP){return"comment-role-vip"}else{if(f&U_GROUP_PREMIUMISH){return"comment-role-premium"}}}}return null};this.getId=function(){return g_user.id};this.getPath=function(){if(!WH.User.isLoggedIn()){return null}return"/user="+encodeURIComponent(WH.User.getUsername())};this.getReputation=function(){return g_user.reputation||0};this.getUsername=function(){return g_user.name||""};this.hasRole=function(f){if(!f){return true}return!!(g_user.roles&f)};this.isLoggedIn=function(){return g_user.id>0};this.isPremium=function(){return!!g_user.premium};this.isUsernameValid=function(f){return f.match(/[^a-z0-9]/i)==null&&f.length>=4&&f.length<=16};this.saveOption=function(h,l,f){var g={method:"POST",data:{key:h,value:l}};if(typeof f==="function"){g.success=f}$.ajax("/account=save-option",g)}};var U_GROUP_TESTER=1;var U_GROUP_ADMIN=2;var U_GROUP_EDITOR=4;var U_GROUP_MOD=8;var U_GROUP_BUREAU=16;var U_GROUP_DEV=32;var U_GROUP_VIP=64;var U_GROUP_BLOGGER=128;var U_GROUP_PREMIUM=256;var U_GROUP_LOCALIZER=512;var U_GROUP_SALESAGENT=1024;var U_GROUP_SCREENSHOT=2048;var U_GROUP_VIDEO=4096;var U_GROUP_APIONLY=8192;var U_GROUP_PENDING=16384;var U_GROUP_STAFF=U_GROUP_ADMIN|U_GROUP_EDITOR|U_GROUP_MOD|U_GROUP_BUREAU|U_GROUP_DEV|U_GROUP_BLOGGER|U_GROUP_LOCALIZER|U_GROUP_SALESAGENT;var U_GROUP_EMPLOYEE=U_GROUP_ADMIN|U_GROUP_BUREAU|U_GROUP_DEV;var U_GROUP_GREEN_TEXT=U_GROUP_MOD|U_GROUP_BUREAU|U_GROUP_DEV;var U_GROUP_PREMIUMISH=U_GROUP_PREMIUM|U_GROUP_EDITOR;var U_GROUP_MODERATOR=U_GROUP_ADMIN|U_GROUP_MOD|U_GROUP_BUREAU;var U_GROUP_COMMENTS_MODERATOR=U_GROUP_MODERATOR|U_GROUP_LOCALIZER|U_GROUP_EDITOR;var U_GROUP_PREMIUM_PERMISSIONS=U_GROUP_PREMIUM|U_GROUP_STAFF|U_GROUP_VIP|U_GROUP_EDITOR;var g_users={};var g_completion={quest:{},spell:{},npc:{},achievement:{},title:{},item:{},follower:{},ship:{}};var g_favorites=[];WH.LocalStorage=new function(){this.clear=function(){if(!WH.LocalStorage.isSupported()){return}localStorage.clear()};this.isSupported=function(){var c;try{c="localStorage"in window&&window.localStorage!==null}catch(d){c=false}if(c){try{localStorage.setItem("test","123");c=localStorage.getItem("test")=="123";localStorage.removeItem("test")}catch(d){c=false}}WH.LocalStorage.isSupported=(function(f){return f}).bind(null,c);return c};this.jsonGet=function(c){if(!WH.LocalStorage.isSupported()){return undefined}try{return JSON.parse(localStorage.getItem(c))}catch(d){let value;try{value=localStorage.getItem(c)}catch(d){value="Error with getItem(): "+WH.getThrownErrorMessage(d)}WH.error("Failed to parse local storage data that should have been JSON.",c,value);return undefined}};this.jsonSet=function(c,d){if(!WH.LocalStorage.isSupported()){return}let jsonValue;try{jsonValue=JSON.stringify(d)}catch(f){WH.error("Failed to stringify local storage data.",WH.getThrownErrorMessage(f),c,d);return}localStorage.setItem(c,jsonValue)};this.set=function(c,d){if(!WH.LocalStorage.isSupported()){return}localStorage.setItem(c,d)};this.get=function(c){if(!WH.LocalStorage.isSupported()){return}return localStorage.getItem(c)};this.remove=function(c){if(!WH.LocalStorage.isSupported()){return}localStorage.removeItem(c)}};WH.SessionStorage=new function(){this.isSupported=function(){var c;try{c="sessionStorage"in window&&window.sessionStorage!==null}catch(d){c=false}if(c){try{sessionStorage.setItem("test","123");c=sessionStorage.getItem("test")=="123";sessionStorage.removeItem("test")}catch(d){c=false}}WH.SessionStorage.isSupported=(function(f){return f}).bind(null,c);return c};this.set=function(c,d){if(!WH.SessionStorage.isSupported()){return}sessionStorage.setItem(c,d)};this.get=function(c){if(!WH.SessionStorage.isSupported()){return}return sessionStorage.getItem(c)};this.remove=function(c){if(!WH.SessionStorage.isSupported()){return}sessionStorage.removeItem(c)}};WH.Time=new function(){const d=this;this.DAYS_PER_WEEK=7;this.MS_SEC=1000;this.MS_MIN=this.MS_SEC*60;this.MS_HOUR=this.MS_MIN*60;this.MS_DAY=this.MS_HOUR*24;this.SEC_MIN=60;this.SEC_HOUR=this.SEC_MIN*60;this.SEC_DAY=this.SEC_HOUR*24;const c={ABBR:{SECOND:LANG.timeunitsab[6],MINUTE:LANG.timeunitsab[5],HOUR:LANG.timeunitsab[4],DAY:LANG.timeunitsab[3],WEEK:LANG.timeunitsab[2],MONTH:LANG.timeunitsab[1],YEAR:LANG.timeunitsab[0]},PLURAL:{SECOND:LANG.timeunitspl[6],MINUTE:LANG.timeunitspl[5],HOUR:LANG.timeunitspl[4],DAY:LANG.timeunitspl[3],WEEK:LANG.timeunitspl[2],MONTH:LANG.timeunitspl[1],YEAR:LANG.timeunitspl[0]},SINGULAR:{SECOND:LANG.timeunitssg[6],MINUTE:LANG.timeunitssg[5],HOUR:LANG.timeunitssg[4],DAY:LANG.timeunitssg[3],WEEK:LANG.timeunitssg[2],MONTH:LANG.timeunitssg[1],YEAR:LANG.timeunitssg[0]},SYMBOL:{SECOND:LANG.timeunitsin[6],MINUTE:LANG.timeunitsin[5],HOUR:LANG.timeunitsin[4],DAY:LANG.timeunitsin[3],WEEK:LANG.timeunitsin[2],MONTH:LANG.timeunitsin[1],YEAR:LANG.timeunitsin[0]}};this.formatDeltaWithSymbols=function(f){let result;if(f<d.SEC_MIN){let f=Math.floor(f);result=f+c.SYMBOL.SECOND}else{if(f<d.SEC_HOUR){let minutes=Math.floor(f/60);result=minutes+c.SYMBOL.MINUTE}else{if(f<d.SEC_DAY){let hours=Math.floor(f/d.SEC_HOUR);let minutes=Math.floor((f-(hours*d.SEC_HOUR))/d.SEC_MIN);result=hours+c.SYMBOL.HOUR;if(minutes>0){result+=WH.TERMS.wordspace_punct+minutes+c.SYMBOL.MINUTE}}else{let days=Math.floor(f/d.SEC_DAY);let hours=Math.floor((f-(days*d.SEC_DAY))/d.SEC_HOUR);result=days+c.SYMBOL.DAY;if(hours>0){result+=WH.TERMS.wordspace_punct+hours+c.SYMBOL.HOUR}}}}return result};this.formatFutureTimeAndDay=function(f,g){let result;let now=new Date();let nowSec=now.getTime()/d.MS_SEC;let dateSec=f.getTime()/d.MS_SEC;if(dateSec-d.SEC_HOUR<nowSec){let minutes=Math.floor((dateSec-nowSec)/d.SEC_MIN);result=minutes+WH.TERMS.wordspace_punct+(minutes===1?c.SINGULAR.MINUTE:c.PLURAL.MINUTE)}else{if(dateSec-(d.SEC_HOUR*8)<nowSec){let minutes=Math.floor((dateSec-nowSec)/d.SEC_MIN);let hours=Math.floor(minutes/60);minutes-=hours*60;let timeStr=hours+WH.TERMS.wordspace_punct+(hours===1?c.SINGULAR.HOUR:c.PLURAL.HOUR);if(minutes>0){timeStr+=WH.TERMS.wordspace_punct+minutes+WH.TERMS.wordspace_punct+(minutes===1?c.SINGULAR.MINUTE:c.PLURAL.MINUTE)}result=timeStr+WH.TERMS.wordspace_punct+WH.TERMS.openparenthesis_punct+d.formatTimeOfDay(f,g)+WH.TERMS.closedparenthesis_punct}else{if(f.toDateString()===now.toDateString()){result=d.formatTimeOfDay(f,g)}else{let day;if(f<=(new Date(now.getFullYear(),now.getMonth(),now.getDate()+6,23,59))){day=f.getDate()-1===now.getDate()?WH.TERMS.tomorrow:LANG.date_days[f.getDay()]}else{day=LANG.date_days[f.getDay()]+WH.TERMS.wordspace_punct+LANG.date_months[f.getMonth()]+WH.TERMS.wordspace_punct+f.getDate()}result=d.formatTimeOfDay(f,g)+WH.TERMS.wordspace_punct+day}}}return result};this.formatTimeOfDay=function(f,g){let hours=f.getHours();let minutes=WH.leadingZeroes(f.getMinutes(),2);let time;if(g===true){time=hours+":"+minutes}else{let meridiem=hours>=12?WH.TERMS.pm:WH.TERMS.am;if(hours>12){time=hours-12}else{if(hours===0){time=12}else{time=hours}}time+=":"+minutes+WH.TERMS.wordspace_punct+meridiem}return time};this.unix=function(){return Math.floor((new Date()).getTime()/1000)}};WH.Admin=new function(){this.foo="test"};function Ajax(d,f){if(!d){return}var c;try{c=new XMLHttpRequest()}catch(g){try{c=new ActiveXObject("Msxml2.XMLHTTP")}catch(g){try{c=new ActiveXObject("Microsoft.XMLHTTP")}catch(g){if(window.createRequest){c=window.createRequest()}else{alert(WH.TERMS.upgradebrowser_tip);return}}}}this.request=c;WH.cO(this,f);this.method=this.method||(this.params&&"POST")||"GET";c.open(this.method,d,this.async==null?true:this.async);c.onreadystatechange=Ajax.onReadyStateChange.bind(this);if(this.method.toUpperCase()=="POST"){c.setRequestHeader("Content-Type",(this.contentType||"application/x-www-form-urlencoded")+"; charset="+(this.encoding||"UTF-8"))}c.send(this.params)}Ajax.onReadyStateChange=function(){if(this.request.readyState==4){if(this.request.status==0||(this.request.status>=200&&this.request.status<300)){this.onSuccess!=null&&this.onSuccess(this.request,this)}else{this.onFailure!=null&&this.onFailure(this.request,this)}if(this.onComplete!=null){this.onComplete(this.request,this)}}};var Announcement=function(c){if(WH.UserAgent.isWebCrawler()){return}if(!c){c={}}WH.cO(this,c);if(!this.hasOwnProperty("allowMarkup")){this.allowMarkup=true}if(!this.parentDiv){if(this.parent){this.parentDiv=WH.ge(this.parent)}else{return}}if(!this.parentDiv){return}this.parentDiv.setAttribute("data-announcement-id",Math.abs(this.id));if(this.wasMarkedRead()){return}this.initialize()};Announcement.prototype={initialize:function(){this.parentDiv.style.display="none";this.parentDiv.className=this.getClass();var m=this.innerDiv=WH.ce("div");m.className="announcement-inner text";this.setStyle(this.style);var c=null;var l=parseInt(this.id);if(g_user&&(g_user.roles&(U_GROUP_ADMIN|U_GROUP_BUREAU))>0&&Math.abs(l)>0){if(l<0){c=WH.ce("a");c.style.cssFloat=c.style.styleFloat="right";c.href="/admin=announcements&id="+Math.abs(l)+"&status=2";c.onclick=function(){return confirm("Are you sure you want to delete "+this.name+"?")};WH.ae(c,WH.ct("Delete"));var g=WH.ce("small");WH.ae(g,c);WH.ae(m,g);c=WH.ce("a");c.style.cssFloat=c.style.styleFloat="right";c.style.marginRight="10px";c.href="/admin=announcements&id="+Math.abs(l)+"&status="+(this.status==1?0:1);c.onclick=function(){return confirm("Are you sure you want to delete "+this.name+"?")};WH.ae(c,WH.ct((this.status==1?"Disable":"Enable")));var g=WH.ce("small");WH.ae(g,c);WH.ae(m,g)}var h=WH.ce("a",{className:"fa fa-pencil",href:"/admin=announcements&id="+Math.abs(l)+"&edit"});WH.Tooltip.simpleNonTouch(h,WH.TERMS.edit,"q2");WH.ae(m,h)}var f=WH.ce("div");f.id=this.parent+"-markup";f.className="announcement-markup";WH.ae(m,f);var d=WH.ce("div");d.id=this.parent+"-markup-responsive";d.className="announcement-markup-responsive";WH.ae(m,d);if(l>=0){c=WH.ce("a");c.id="closeannouncement";c.href="javascript:";c.className="fa fa-times announcement-close";if(this.nocookie){c.onclick=this.hide.bind(this)}else{c.onclick=this.markRead.bind(this)}WH.ae(m,c);if(l==195||l==200){$(c).removeClass("fa-times announcement-close").addClass("fa-square q1").text("I Accept")}else{WH.Tooltip.simpleNonTouch(c,WH.TERMS.close,"q2")}}WH.ae(m,WH.ce("div",{style:{clear:"both"}}));WH.ae(this.parentDiv,m);this.setText(this.text,this.mobiletext);setTimeout(this.show.bind(this),500)},show:function(){$(this.parentDiv).animate({opacity:"show",height:"show"},{duration:333});WH.Track.nonInteractiveEvent("Announcements","Show",""+this.name)},hide:function(){$(this.parentDiv).animate({opacity:"hide",height:"hide"},{duration:200})},getLocalStorageKey:function(){var c="announcements-closed";if(g_user&&g_user.id){c+="-"+g_user.id}return c},markRead:function(){WH.Track.interactiveEvent("Announcements","Close",""+this.name);if(!this.wasMarkedRead()){var c=WH.LocalStorage.get(this.getLocalStorageKey())||"";c=c.split(",").filter(function(d){return!!d});c.push(this.id);WH.LocalStorage.set(this.getLocalStorageKey(),c.join(","))}this.hide()},wasMarkedRead:function(){if(!this.id){return false}var c=(WH.LocalStorage.get(this.getLocalStorageKey())||"").split(",");return c.indexOf(this.id.toString())!==-1},forgetRead:function(){WH.LocalStorage.remove(Announcement.prototype.getLocalStorageKey());var c=WH.ge("announcetext");if(c){WH.ee(c);WH.ae(c,WH.ct(WH.TERMS.purgesuccess_tip));c.className="q2"}else{alert(WH.TERMS.purgesuccess_tip)}},getClass:function(){var d="announcement announcement-";switch(this.mode){case 2:d+="fixed";break;case 0:d+="pagetop";break;case 1:default:d+="contenttop"}if(this["class"]){var f=this["class"].split(" ");for(var c in f){if(f[c]){d+=" announcement-styling-"+f[c]}}}return d},setClass:function(c){this["class"]=c;this.parentDiv.className=this.getClass()},setStyle:function(c){this.style=c;this.innerDiv.setAttribute("style",c?WH.fixWowheadHttps(c):"")},setText:function(f,g){this.text=f;this.mobiletext=g;var c=WH.ge(this.parent+"-markup");if(this.allowMarkup){WH.markup.printHtml(this.text,c.id,{allow:WH.markup.CLASS.STAFF})}else{WH.st(c,this.text)}WH.Track.addClickEvents(c,{category:"Announcements",actions:{"Follow link":function(h){return true}}},this.id);if(!g){g=f}var d=WH.ge(this.parent+"-markup-responsive");if(this.allowMarkup){WH.markup.printHtml(g,d.id,{allow:WH.markup.CLASS.STAFF})}else{WH.st(d,this.text)}WH.Track.addClickEvents(d,{category:"Announcements",actions:{"Follow link":function(h){return true}}},this.id)}};var g_audiocontrols={__windowloaded:false,__rewardedAchievement:false};var g_audioplaylist={};if(!window.JSON){window.JSON={parse:function(sJSON){return eval("("+sJSON+")")},stringify:function(d){if(d instanceof Object){var g="";if(d.constructor===Array){for(var c=0;c<d.length;g+=this.stringify(d[c])+",",c++){}return"["+g.substr(0,g.length-1)+"]"}if(d.toString!==Object.prototype.toString){return'"'+d.toString().replace(/"/g,"\\$&")+'"'}for(var f in d){g+='"'+f.replace(/"/g,"\\$&")+'":'+this.stringify(d[f])+","}return"{"+g.substr(0,g.length-1)+"}"}return typeof d==="string"?'"'+d.replace(/"/g,"\\$&")+'"':String(d)}}}AudioControls=function(){const g=WH.Strings;const q={addAllTracks:false,list:undefined};var r=-1;var f=false;var l=false;var p=false;var u={};var o=[];function h(){if(g_audiocontrols.__rewardedAchievement){return}if(!(WH.isSet("g_user")&&g_user.id)){return}$.ajax({url:"/website-achievement-explored",data:{trigger:"playsound"},success:function(){AchievementCheck()},type:"POST"});g_audiocontrols.__rewardedAchievement=true}function t(z,v,B){var C=WH.ce("audio");C.preload="none";C.controls="true";$(C).click(function(D){D.stopPropagation()});WH.aE(C,"ended",h);C.style.marginTop="5px";u.audio.parentNode.replaceChild(C,u.audio);u.audio=C;WH.aE(u.audio,"ended",d.bind(z));if(B){C.preload="auto";p=true;WH.aE(u.audio,"canplaythrough",c.bind(this))}if(!f){u.table.style.visibility="visible"}var w;do{r+=v;if(r>o.length-1){r=0;if(!f){WH.de(u.table);WH.de('a[href="/sound&playlist"].btn');return}}if(r<0){r=o.length-1}w=o[r]}while(u.audio.canPlayType(w.type)=="");var A=WH.ce("source");A.src=w.url;A.type=w.type;WH.ae(u.audio,A);if(q.list){q.list.childNodes.forEach(function(D){D.dataset.current=JSON.stringify(D.dataset.track===w.title)})}if(u.hasOwnProperty("trackDisplay")){WH.st(u.trackDisplay,(r+1)+" / "+o.length)}if(!f){f=true;for(let i=r+1;i<=o.length-1;i++){if(u.audio.canPlayType(o[i].type)){WH.qsa("a",u.controls).forEach(function(D){delete D.dataset.disabled});break}}}if(u.hasOwnProperty("addbutton")){delete u.addbutton.dataset.disabled;WH.st(u.addbutton,WH.TERMS.playlist)}}function c(){if(!p){return}p=false;u.audio.play()}this.init=function(v,w,z){if(!Array.isArray(v)){return}if(v.length===0){return}if(w.id===""||g_audiocontrols.hasOwnProperty(w.id)){w.id=g.guid()}g_audiocontrols[w.id]=this;if(typeof z=="undefined"){z={}}q.list=z.list;l=!!z.loop;o=v;u.div=w;u.controls=WH.ce("div",{className:"audio-controls-controls"});if(!z.listview){var B=WH.ce("table",{className:"audio-controls"});u.table=B;u.table.style.visibility="hidden";WH.ae(u.div,B);var A=WH.ce("tr");WH.ae(B,A);var C=WH.ce("td");WH.ae(A,C);u.audio=WH.ce("div");WH.ae(C,u.audio);WH.ae(C,u.controls);let prevTrack=m(WH.TERMS.previous,"step-backward",true);WH.ae(u.controls,prevTrack);WH.aE(prevTrack,"click",this.btnPrevTrack.bind(this));u.trackDisplay=WH.ce("div",{className:"audio-controls-track"});WH.ae(u.controls,u.trackDisplay);let nextTrack=m(WH.TERMS.next,"step-forward",true);WH.ae(u.controls,nextTrack);WH.aE(nextTrack,"click",this.btnNextTrack.bind(this))}else{q.addAllTracks=true;let shortControlsTable=WH.ce("div",{className:"audio-controls"});u.table=shortControlsTable;WH.ae(u.div,shortControlsTable);u.audio=WH.ce("div");WH.ae(shortControlsTable,u.audio);u.trackDisplay=z.trackDisplay;WH.ae(shortControlsTable,u.controls)}u.table.dataset.tracks=""+o.length;u.trackDisplay.dataset.tracks=""+o.length;if(g_audioplaylist.isEnabled()&&!z.fromPlaylist){let addToPlaylist=m(WH.TERMS.playlist,"plus");WH.ae(u.controls,addToPlaylist);WH.aE(addToPlaylist,"click",this.btnAddToPlaylist.bind(this,addToPlaylist));u.addbutton=addToPlaylist}if(g_audiocontrols.__windowloaded){this.btnNextTrack()}};function d(){t(this,1,(l||(r<(o.length-1))))}this.btnNextTrack=function(){t(this,1,(f&&(u.audio.readyState>1)&&(!u.audio.paused)))};this.btnPrevTrack=function(){t(this,-1,(f&&(u.audio.readyState>1)&&(!u.audio.paused)))};this.btnAddToPlaylist=function(v){if(q.addAllTracks){for(let i=0;i<o.length;i++){g_audioplaylist.addSound(o[i])}}else{g_audioplaylist.addSound(o[r])}v.dataset.disabled="true";v.classList.remove("fa-plus");v.classList.add("fa-check");WH.st(v,WH.TERMS.added)};this.isPlaying=function(){return!u.audio.paused};this.removeSelf=function(){u.table.parentNode.removeChild(u.table);delete g_audiocontrols[u.div]};function m(z,w,v){let control=WH.ce("a",{className:"audio-controls-control page-action fa fa-"+w,href:"javascript:"},WH.ct(z));if(v){control.dataset.disabled="true"}return control}};WH.aE(window,"load",function(){g_audiocontrols.__windowloaded=true;for(var c in g_audiocontrols){if(c.substr(0,2)!="__"){g_audiocontrols[c].btnNextTrack()}}});AudioPlaylist=function(){var f=false;var l=[];var h,g;var d=false;this.init=function(){if(!WH.LocalStorage.isSupported()){return}f=true;var m=WH.LocalStorage.get("AudioPlaylist");if(m){l=JSON.parse(m)}};this.savePlaylist=function(){if(!f){return false}WH.LocalStorage.set("AudioPlaylist",JSON.stringify(l))};this.isEnabled=function(){return f};this.addSound=function(m){if(!f){return false}this.init();l.push(m);this.savePlaylist();c()};this.deleteSound=function(m){if(m<0){l=[]}else{l.splice(m,1)}this.savePlaylist();if(!h.isPlaying()){h.removeSelf();this.setAudioControls(g)}if(l.length==0){WH.Tooltip.hide()}};this.getList=function(){var o=[];for(var m=0;m<l.length;m++){o.push(l[m].title)}return o};this.setAudioControls=function(m){if(!f){return false}g=m;h=new AudioControls();h.init(l,g,{loop:true,fromPlaylist:true})};function c(){if(d){return}if(!(WH.isSet("g_user")&&g_user.id)){return}if(l.length<2){return}$.ajax({url:"/sound&playlist",data:{achievement:1},success:function(){AchievementCheck()},type:"POST"});d=true}};g_audioplaylist=(new AudioPlaylist);g_audioplaylist.init();WH.BlizzardApi=new function(){var d={us:"us.api.blizzard.com",eu:"eu.api.blizzard.com",kr:"kr.api.blizzard.com",tw:"tw.api.blizzard.com"};var f=false;var g={};var c=[];this.apiCall=function(q,p,m){q=q.toLowerCase();if(!d.hasOwnProperty(q)){WH.error("Invalid region passed to Blizzard API:",q);return}if(!g.token||(g.hasOwnProperty("expires")&&g.expires<(new Date()))){if(g.failed){var o=["error","complete"];for(var l,h=0;l=o[h];h++){if(typeof m[l]==="function"){m[l]=[m[l]]}if(Array.isArray(m[l])){while(m[l].length){(m[l].shift())({status:400},"abort")}}}}else{this.getNewToken(this.apiCall.bind(this,q,p,m))}return}m.url="https://"+d[q]+p;if(0){if(!m.hasOwnProperty("headers")){m.headers={}}m.headers.Authorization="Bearer "+g.token}else{if(!m.hasOwnProperty("data")){m.data={}}m.data.access_token=g.token}$.ajax(m)};this.characterExists=function(r,h,m,t){if(!WH.LocalStorage.isSupported()||!(JSON&&"stringify"in JSON)){t(true);return}var p=h.toLowerCase().replace(/[^\w -]/,"").replace(" ","-");var o=(r+"|"+p+"|"+m).toLowerCase();if(!f){f={};try{f=JSON.parse(WH.LocalStorage.get("BattleNetCharCache"));if(f==null){f={}}}catch(q){f={}}}if(f.hasOwnProperty(o)){if(parseInt(f[o].substr(1),10)>Math.floor((Date.now()-(1000*60*60*24*4))/1000)){t(f[o].substr(0,1)=="t");return}}var l=function(u){f[o]=((u&&u.is_valid)?"t":"f")+Math.floor(Date.now()/1000);WH.LocalStorage.set("BattleNetCharCache",JSON.stringify(f));t((u&&u.name))};WH.Wow.Realm.fetchData((function(){var u=WH.Wow.Realm.getSlugByName(r,h);if(!u){l(false)}else{this.apiCall(r,WH.Strings.sprintf("/profile/wow/character/%s/%s/status?namespace=profile-%s",encodeURIComponent(u),encodeURIComponent(m.toLocaleLowerCase()),r.toLowerCase()),{dataType:"json",method:"GET",success:l,error:l.bind(null,false)})}}).bind(this))};this.getCharacterThumbnailUrl=function(l,h){return"https://render-"+l.toLowerCase()+".worldofwarcraft.com/character/"+h};this.getNewToken=function(m){c.push(m);if(c.length>1){return}var l=$.ajax.bind($,{url:"/blizzard-api/token",dataType:"json",method:"GET",success:this.setToken,error:(function(o){WH.error("Could not get Blizzard API token from Wowhead",o);this.setToken(null)}).bind(this)});if(!g.hasOwnProperty("token")&&document.readyState=="loading"&&document.addEventListener){var h=function(){document.removeEventListener("readystatechange",h,false);if(!g.hasOwnProperty("token")){l()}};document.addEventListener("readystatechange",h,false)}else{l()}};this.getNotFoundMessage=function(){let df=document.createDocumentFragment();WH.ae(df,WH.ct(WH.TERMS.characterDoesNotExist_tip));let ul=WH.ce("ul");WH.ae(df,ul);WH.ae(ul,WH.ce("li",{},WH.ct(WH.TERMS.characterHasBeenAccessedRecently_tip)));WH.ae(ul,WH.ce("li",{innerHTML:WH.Strings.sprintf(WH.TERMS.yourBlizzardSettingsSetToEnabled_format,WH.ce("a",{href:"https://account.blizzard.com/privacy"},WH.ct(WH.TERMS.gameDataAndProfilePrivacy)).outerHTML)}));let feedbackLine=WH.ce("div",{innerHTML:WH.Strings.sprintf(WH.TERMS.furtherIssues_format,WH.ce("a",{href:"javascript:"},WH.ct(WH.TERMS.feedback)).outerHTML)});WH.aE(feedbackLine.querySelector("a"),"click",ContactTool.show.bind(ContactTool,undefined));while(feedbackLine.hasChildNodes()){WH.ae(df,feedbackLine.removeChild(feedbackLine.firstChild))}return df};this.setToken=function(h){if(!h||!h.hasOwnProperty("token")){g={failed:true};while(c.length){(c.shift())()}g={};return}g=h;g.expires=new Date(Date.now()+g.expires*1000);while(c.length){(c.shift())()}}};WH.CommentReplies=new function(){this.setupReplies=function(h,l,g){c(h,l,g,false);d(h,l,g);h.find(".comment-reply-row").each(function(){f($(this),l,g)});h.find(".comment-reply-row").hover(function(){$(this).find("span").attr("data-hover","true")},function(){$(this).find("span").attr("data-hover","false")})};function c(H,h,N,z){var q=null;var C=null;var F=null;var L=null;var A=null;var P=null;var t=null;var w=15;var J=600;var M=false;var I=false;var m=false;var D=false;var B=H.find(".comment-replies > table");var E=H.find(".add-reply");var o=h.replies.length;if(z){G()}else{E.click(function(){G()})}function u(){if(M){return}M=true;var Q=$("<tr/>");if(z){Q.addClass("comment-reply-row").addClass("reply-edit-row")}Q.html('<td style="width: 0"></td><td class="comment-form"><form><table><form><table><tr><td style="width: 600px"><textarea required="required" name="body" cols="68" rows="3"></textarea></td><td><input type="submit" value="'+(z?WH.TERMS.save:WH.TERMS.addreply)+'" /><img src="'+WH.staticUrl+'/images/icons/ajax.gif" class="ajax-loader" /></td></tr><tr><td colspan="2"><span class="text-counter">Text counter placeholder</span></td></tr></table></form></td>');C=Q.find(".comment-form textarea");F=Q.find(".comment-form input[type=submit]");L=Q.find(".comment-form span.text-counter");q=Q.find(".comment-form form");A=Q.find(".comment-form .ajax-loader");P=Q.find(".comment-form");q.submit(function(){r();return false});p();C.keyup(function(R){p()});C.keydown(function(R){if(R.keyCode==27){K();return false}});C.keypress(function(R){if(R.keyCode==13){r();return false}});if(z){H.after(Q);H.hide();q.find("textarea").text(h.replies[H.attr("data-idx")].body)}else{B.append(Q)}t=Q;WH.safeFocus(q.find("textarea"))}function G(){if(!M){u()}I=true;if(!z){E.hide();H.find(".comment-replies").show();P.show()}}function K(){I=false;if(z){if(t){t.remove()}H.show();return}E.show();P.hide();if(o==0){H.find(".comment-replies").hide()}}function r(){if(!I||D){return}if(C.val().length<w||C.val().length>J){if(!m){m=true;L.animate({opacity:"0.0"},150);L.animate({opacity:"1.0"},150,null,function(){m=false})}return false}g();$.ajax({type:"POST",url:z?"/comment/edit-reply":"/comment/add-reply",data:{commentId:h.id,replyId:(z?H.attr("data-replyid"):0),body:C.val()},success:function(Q){O(Q)},dataType:"json",error:function(Q){v(Q.responseText)}});return true}function g(){D=true;A.show();F.prop("disabled",true);P.find(".wh-message-box").remove()}function l(){D=false;A.hide();F.prop("disabled",false)}function O(Q){h.replies=Q;Listview.templates.comment.updateReplies.call(N,h)}function v(Q){l();MessageBox(P,Q)}function p(){var T="(error)";var Q="q0";var S=C.val().replace(/(\s+)/g," ").replace(/^\s*/,"").replace(/\s*$/,"").length;var R=J-S;if(S==0){T=WH.sprintf(WH.TERMS.replylength1_format,w)}else{if(S<w){T=WH.sprintf(WH.TERMS.replylength2_format,w-S)}else{T=WH.sprintf(R==1?WH.TERMS.replylength4_format:WH.TERMS.replylength3_format,R);if(R<120){Q="chars-left-none"}else{if(R<240){Q="chars-left-some"}else{if(R<360){Q="chars-left-many"}}}}}L.html(T).attr("class",Q)}}function d(m,q,l){var o=m.find(".show-more-replies");var g=m.find(".comment-replies");o.click(function(){h()});function h(){o.hide();g.append($("<img>",{"class":"ajax-loader",alt:"",src:WH.staticUrl+"/images/icons/ajax.gif"}));$.ajax({type:"GET",url:"/comment/show-replies",data:{id:q.id},success:function(r){q.replies=r;Listview.templates.comment.updateReplies.call(l,q)},dataType:"json",error:function(){p()}})}function p(){o.show();g.find(".ajax-loader").remove();MessageBox(g,"There was an error fetching the comments. Try refreshing the page.")}}function f(D,u,t){var B=D.attr("data-replyid");var o=D.find(".reply-upvote");var g=D.find(".reply-downvote");var v=D.find(".reply-report");var h=D.find(".reply-rating");var w=D.find(".reply-controls");var q=D.find(".reply-delete");var m=D.find(".reply-edit");var A=false;var C=false;m.click(function(){c(D,u,t,true)});v.click(function(){if(A||!confirm(WH.TERMS.replyreportwarning_tip)){return}A=true;$.ajax({type:"POST",url:"/comment/vote-reply",data:{id:B,action:"report"},success:function(){p()},error:function(E){l(E.responseText)}})});o.click(function(){if(o.attr("data-hasvoted")=="true"||o.attr("data-canvote")!="true"||A){return}A=true;$.ajax({type:"POST",url:"/comment/vote-reply",data:{id:B,action:"up"},success:function(){z(1)},error:function(E){l(E.responseText)}})});g.click(function(){if(g.attr("data-hasvoted")=="true"||g.attr("data-canvote")!="true"||A){return}A=true;$.ajax({type:"POST",url:"/comment/vote-reply",data:{id:B,action:"down"},success:function(){z(-1)},error:function(E){l(E.responseText)}})});q.click(function(){if(C){return}if(!confirm(WH.TERMS.deletereplyconfirmation_tip)){return}C=true;$.ajax({type:"POST",url:"/comment/delete-reply",data:{id:B},success:function(){r()},error:function(E){l(E.responseText)}})});function z(F){var E=parseInt(h.text());E+=F;h.text(E);if(F>0){o.attr("data-hasvoted","true")}else{g.attr("data-hasvoted","true")}o.attr("data-canvote","false");g.attr("data-canvote","false");if(F>0){v.remove()}A=false}function p(){A=false;v.remove()}function r(){D.remove();C=false}function l(E){A=false;C=false;if(!E){E="An error has occurred. Try refreshing the page."}MessageBox(w,E)}}};WH.Comments=new function(){const f=this;this.EDIT_MODE_EDIT_FORUM_POST=-1;this.EDIT_MODE_EDIT_COMMENT=0;this.EDIT_MODE_ADD_COMMENT=1;this.EDIT_MODE_USER_DESCRIPTION=2;this.EDIT_MODE_ADD_FORUM_REPLY=3;this.EDIT_MODE_USER_SIGNATURE=4;this.LOW_RATING_THRESHOLD=-4;var c=1;var m=2;this.appendImportedSubject=function(o,q){if(!q){return}var r=q.replace(/^\s*Re\b|\bRe\s*$/,"").replace(/\s/,"");if(!r||!r.match(/[^:]/)){return}var p=WH.ce("span");WH.st(p,'"'+q+'"');var t=WH.ce("span",{className:"comment-imported-subject"});WH.st(t,WH.TERMS.subject_colon);WH.ae(t,p);o.append(t)};this.getColorClass=function(r,p,o){switch(p){case f.EDIT_MODE_EDIT_FORUM_POST:var q=null;if(!o){q=r.divPost.childNodes[1].className.match(/comment-([a-z-]+)/)}else{q=r.divBody[0].className.match(/comment-([a-z-]+)/)}if(q!=null){return" comment-"+q[1]}break;case f.EDIT_MODE_ADD_FORUM_REPLY:if(r.roles&U_GROUP_PREMIUMISH){return" comment-role-premium"}case f.EDIT_MODE_USER_SIGNATURE:let roleClass=WH.User.getCommentRoleClass(r.roles,r.user);if(roleClass){return" "+roleClass}break}if(r.roles&U_GROUP_ADMIN){return" comment-role-admin"}if((r.commentv2&&r.sticky)||(r.roles&U_GROUP_GREEN_TEXT)||(r.rating>=10)){return" comment-high-rating"}if(r.rating&&r.rating<-2){return" comment-low-rating"}if(r.roles&U_GROUP_PREMIUMISH){return" comment-role-premium"}return""};this.edit=function(v,t,q){if(q){v.divBody.hide();v.divResponse.hide()}var u=$("<div/>");u.addClass("comment-edit");v.divEdit=u[0];if(t===f.EDIT_MODE_EDIT_FORUM_POST){if(g_users[v.user]!=null){v.roles=g_users[v.user].roles}}var p=f.editAppend(u,v,t,q);var o=$("<div/>");o.addClass("comment-edit-buttons");var r=$("<button/>",{text:WH.TERMS.save});r.click(h.bind(this,true,v,t,q));o.append(r);o.append(WH.ct(" "));r=$("<button/>",{text:WH.TERMS.cancel});r.click(h.bind(this,false,v,t,q));o.append(r);u.append(o);u.insertAfter(v.divBody);WH.safeFocus(p)};this.editAppend=function(Z,T,A,M,q,r){var R=f.getCharLimit(A);if(T.body===null){T.body=""}if(A===f.EDIT_MODE_ADD_COMMENT||A===f.EDIT_MODE_ADD_FORUM_REPLY||A===f.EDIT_MODE_USER_SIGNATURE){T.user=g_user.name;T.roles=g_user.roles;T.rating=1}else{if(A===f.EDIT_MODE_USER_DESCRIPTION){T.roles=g_user.roles;T.rating=1}}if(q){T.roles&=~U_GROUP_PENDING}if(A===f.EDIT_MODE_EDIT_FORUM_POST||A===f.EDIT_MODE_EDIT_COMMENT){var B=$("<div/>",{text:WH.TERMS.mode_colon});B.addClass("comment-edit-modes");var V=$("<a/>",{href:"javascript:",text:WH.TERMS.edit});V.click(d.bind(V[0],c,A,T));V.addClass("selected");B.append(V);B.append(WH.ct("|"));var o=$("<a/>",{href:"javascript:",text:WH.TERMS.preview});o.click(d.bind(o[0],m,A,T));B.append(o);Z.append(B)}var z=$("<div/>",{css:{display:"none"}});z.addClass("text comment-body"+f.getColorClass(T,A,M));var O=$("<div/>");O.addClass("comment-edit-body");var t=$('<div style="float: left" />');t.addClass("toolbar");var ab=$('<div style="float: left" />');ab.addClass("menu-buttons");var u=$("<textarea/>",{val:T.body,rows:10,css:{clear:"left"}});u.addClass("comment-editbox");switch(A){case f.EDIT_MODE_ADD_COMMENT:u.attr("name","commentbody");break;case f.EDIT_MODE_USER_DESCRIPTION:u.attr({name:"desc",originalValue:T.body});break;case f.EDIT_MODE_ADD_FORUM_REPLY:u.attr("name","body");break;case f.EDIT_MODE_USER_SIGNATURE:u.attr({name:"sig",originalValue:T.body,rows:3});u.css("height","auto");break}if(A!==f.EDIT_MODE_EDIT_FORUM_POST&&A!==f.EDIT_MODE_EDIT_COMMENT){var G=$("<a/>"),P=$("<div/>"),I=$("<div/>"),S=screen.availWidth<=480;var L=g.bind(f,T,A,u[0],P[0]);G.addClass("disclosure-"+(S?"off":"on"));G.text(WH.TERMS.livepreview);G.attr("href","javascript:");G.click(function(){L(1);var ac=WH.toggleDisplay(P);G.toggleClass("disclosure-on",ac);G.toggleClass("disclosure-off",!ac)});I.addClass("pad");z.append(WH.getMajorHeading(G,3,null,{classes:"first"}));z.append(P);z.append(I);WH.onAfterTyping(u[0],L,50);u.focus(function(){L();z.css("display",(S?"none":""));if(A!==f.EDIT_MODE_USER_SIGNATURE&&!r){u.css("height","22em")}})}else{if(A!==f.EDIT_MODE_USER_SIGNATURE&&!r){u.focus(function(){u.css("height","22em")})}}var Q=[{id:"b",icon:"bold",title:WH.TERMS.bold,pre:"[b]",post:"[/b]"},{id:"i",icon:"italic",title:WH.TERMS.italic,pre:"[i]",post:"[/i]"},{id:"u",icon:"underline",title:WH.TERMS.underline,pre:"[u]",post:"[/u]"},{id:"s",icon:"strikethrough",title:WH.TERMS.strikethrough,pre:"[s]",post:"[/s]"},{id:"small",icon:"text-height",title:WH.TERMS.smalltext_stc,pre:"[small]",post:"[/small]"},{id:"url",icon:"link",title:WH.TERMS.link,nopending:true,onclick:function(){var ac=prompt(WH.TERMS.linkurl_tip,"https://");if(ac){WH.insertTag(u[0],"[url="+ac+"]","[/url]")}}},{id:"quote",icon:"quote-left",title:WH.TERMS.quotebox_stc,pre:"[quote]",post:"[/quote]"},{id:"code",icon:"code",title:WH.TERMS.codebox_stc,pre:"[code]",post:"[/code]"},{id:"ul",icon:"list-ul",title:WH.TERMS.unorderedlistbullets_stc,pre:"[ul]\n[li]",post:"[/li]\n[/ul]",rep:function(ac){return ac.replace(/\n/g,"[/li]\n[li]")}},{id:"ol",icon:"list-ol",title:WH.TERMS.orderedlistnumbers_stc,pre:"[ol]\n[li]",post:"[/li]\n[/ol]",rep:function(ac){return ac.replace(/\n/g,"[/li]\n[li]")}},{id:"li",icon:"circle",title:WH.TERMS.listitem_stc,pre:"[li]",post:"[/li]"}];if(!M){for(var Y=0,K=Q.length;Y<K;++Y){var J=Q[Y];if(A===f.EDIT_MODE_USER_SIGNATURE&&J.id=="quote"){break}if((g_user.roles&U_GROUP_PENDING)&&J.nopending){continue}var E=$("<button/>",{click:function(ac,ad){ad.preventDefault();(ac.onclick!=null?ac.onclick:WH.insertTag.bind(0,u[0],ac.pre,ac.post,ac.rep))()}.bind(null,J)});E[0].setAttribute("type","button");E.attr("title",J.title);var F=$("<i/>",{"class":"fa fa-"+J.icon});E.append(F);t.append(E)}}else{for(var Y=0,K=Q.length;Y<K;++Y){var J=Q[Y];if((g_user.rolls&U_GROUP_PENDING)&&J.nopending){continue}var U="tb-"+J.id;var E=$("<button/>",{click:function(ac,ad){ad.preventDefault();(ac.onclick!=null?ac.onclick:WH.insertTag.bind(0,u[0],ac.pre,ac.post,ac.rep))()}.bind(null,J),"class":U,title:J.title});E[0].setAttribute("type","button");E.append("<ins/>");t.append(E)}t.addClass("formatting")}var w=function(ad,ac){var ae=prompt(WH.sprintf(WH.TERMS.pleaseenterid_format,ad),"");if(ae!=null){WH.insertTag(u[0],"["+ac+"="+(parseInt(ae)||0)+"]","")}};var C=[];var W;for(var X in WH.markup.tags){if(!WH.markup.tags.hasOwnProperty(X)){continue}if(W=WH.markup.tags[X].entityType){var D=[W,WH.Types.getUpperSingular(W)+WH.TERMS.ellipsis_punct,w.bind(null,WH.Types.getLowerSingular(W),X)];let requiredTrees=WH.Types.getRequiredTrees(W);if(requiredTrees){D.push(null,{requiredTrees:requiredTrees})}C.push(D)}}C.sort(function(ad,ac){return ad[1].localeCompare(ac[1])});var aa=[[0,WH.TERMS.links,,C]];O.append(t);O.append(ab);O.append($('<div style="clear: left" />'));O.append(u);O.append($("<br/>"));Menu.addButtons(ab[0],aa);if(A===f.EDIT_MODE_USER_SIGNATURE){O.append(WH.ct(WH.sprintf(WH.TERMS.uptoxcharactersorlines_format,R.toLocaleString(),3)))}else{O.append(WH.ct(WH.sprintf(WH.TERMS.uptoxcharacters_format,R.toLocaleString())))}var N=$('<span class="comment-remaining"> '+WH.sprintf(WH.TERMS.xcharactersremaining_format,(R-T.body.length).toLocaleString())+"</span>");O.append(N);u.keyup(l.bind(f,u,N,R));u.keydown(l.bind(f,u,N,R));if((A===f.EDIT_MODE_EDIT_FORUM_POST||A===f.EDIT_MODE_EDIT_COMMENT)&&(g_user.roles&U_GROUP_MODERATOR)){var H=$("<div/>",{"class":"pad"});var v=$("<div/>",{text:(g_user.roles&U_GROUP_ADMIN?"Admin":"Moderator")+" response"});var p=$("<textarea/>",{val:T.response,rows:3,css:{height:"6em"}});O.append(H);O.append(v);O.append(p)}Z.append(O);Z.append(z);$("<div/>").append('<div class="pad"/>').append(WH.getMajorHeading($('<a class="disclosure-off"/>').text(WH.TERMS.formattinghelp).click(function(){WH.disclose(this.parentNode.nextSibling,this)}),3,null,{classes:"first"})).append($('<div style="display: none"/>').append(WH.markup.getDomFragment("[markupdoc help=user]"))).insertAfter(Z.parent());return u};this.getCharLimit=function(o){if(o===f.EDIT_MODE_USER_DESCRIPTION){return 7500}if(o===f.EDIT_MODE_USER_SIGNATURE){return 250}if(g_user.roles&U_GROUP_STAFF){return 100000}var p=WH.User.isPremium()?3:1;switch(o){case f.EDIT_MODE_EDIT_COMMENT:case f.EDIT_MODE_ADD_COMMENT:return 7500*p;case f.EDIT_MODE_EDIT_FORUM_POST:case f.EDIT_MODE_ADD_FORUM_REPLY:return 15000*p}return 0};this.updateLastEdit=function(u){var t=u.divLastEdit;if(!t){return}if(u.lastEdit!=null){var r=u.lastEdit;t.childNodes[1].firstChild.nodeValue=r[2];t.childNodes[1].href="/user="+r[2];var q=new Date(r[0]);var o=(WH.getServerTime()-q)/1000;if(t.childNodes[3].firstChild){WH.de(t.childNodes[3].firstChild)}WH.formatDate(t.childNodes[3],o,q);var p="";if(u.rating!=null){p+=WH.sprintf(WH.TERMS.patchparens_format,WH.Wow.getVersionStringFromTimestamp(q))}if(r[1]>1){p+=LANG.dash+WH.sprintf(WH.TERMS.editcount_format,r[1])}t.childNodes[4].nodeValue=p;t.style.display=""}else{t.style.display="none"}};this.validate=function(r,q){q|=0;var o=q===f.EDIT_MODE_EDIT_FORUM_POST||q===f.EDIT_MODE_ADD_FORUM_REPLY;if(o){if(WH.trim(r.value).length<1){alert(WH.TERMS.postempty_tip);return false}}else{if(WH.trim(r.value).length<1){alert(WH.TERMS.messagetooshort_tip);return false}}var p=f.getCharLimit(q);if(r.value.length>p){return confirm(WH.sprintf(o?WH.TERMS.postlength_format:WH.TERMS.commentlength_format,p,r.value.substring(p-30,p)))}return true};function h(q,w,z,B){if(q){var v=WH.gE(w.divEdit,"textarea");var t=v[0];if(!f.validate(t,z)){return}if(t.value!=w.body||(v[1]&&v[1].value!=w.response)){var o=0;if(w.lastEdit!=null){o=w.lastEdit[1]}++o;w.lastEdit=[WH.getServerTime(),o,g_user.name];if(!w.commentv2){f.updateLastEdit(w)}var C=f.getCharLimit(z);var A=WH.markup.rolesToClass(w.roles);var u=WH.markup.getDomFragment((t.value.length>C?t.value.substring(0,C):t.value),{allow:A,mode:WH.markup.MODE.COMMENT,roles:w.roles});var D=(v[1]&&v[1].value.length>0)?WH.markup.getDomFragment("[div][/div][wowheadresponse="+g_user.name+" roles="+g_user.roles+"]"+v[1].value+"[/wowheadresponse]",{allow:WH.markup.CLASS.STAFF,mode:WH.markup.MODE.COMMENT,roles:g_user.roles}):document.createDocumentFragment();if(w.commentv2){w.body=t.value;if(g_user.roles&U_GROUP_MODERATOR&&v[1]){w.response=v[1].value}Listview.templates.comment.updateCommentCell.call(this,w)}else{if(!B){$(w.divBody).empty().append(u);$(w.divResponse).empty().append(D)}else{w.divBody.empty().append(u);w.divResponse.empty().append(D)}w.body=t.value;if(g_user.roles&U_GROUP_MODERATOR&&v[1]){w.response=v[1].value}}var r={postId:w.id,body:w.body};var p="body="+WH.urlEncode(w.body);if(w.response!==undefined){p+="&response="+WH.urlEncode(w.response);r.response=w.response}if(z===f.EDIT_MODE_EDIT_FORUM_POST){$.ajax({url:"/forums/edit-post",method:"post",data:r})}else{new Ajax("/comment=edit&id="+w.id,{method:"POST",params:p})}}}if(w.commentv2){Listview.templates.comment.updateCommentCell.call(this,w)}else{if(!B){w.divBody.style.display="";w.divResponse.style.display="";w.divLinks.firstChild.style.display=""}else{w.divBody.show();w.divResponse.show()}}if(!w.commentv2){WH.de(w.divEdit);w.divEdit=null}}function g(q,r,p,o){if(o.style.display=="none"){return}var z=f.getCharLimit(r);var u=p.value.length>z?p.value.substring(0,z):p.value;if(r===f.EDIT_MODE_USER_SIGNATURE){var v;if((v=u.indexOf("\n"))!=-1&&(v=u.indexOf("\n",v+1))!=-1&&(v=u.indexOf("\n",v+1))!=-1){u=u.substring(0,v)}}var w=WH.markup.rolesToClass(q.roles);var t=WH.markup.getDomFragment(u,{allow:w,mode:WH.markup.MODE.COMMENT,roles:q.roles});if(t.hasChildNodes()){$(o).empty().append(t)}else{o.innerHTML='<span class="q6">...</span>'}}function d(q,o,u){var D=f.getCharLimit(o);var p=WH.markup.MODE.COMMENT;WH.arrayWalk(WH.gE(this.parentNode,"a"),function(E){E.className=""});this.className="selected";var t=WH.gE(this.parentNode.parentNode,"textarea");var r=t[0];var B=r.parentNode;var w=$(".comment-body",B.parentNode)[0];if(o===f.EDIT_MODE_USER_SIGNATURE){p=WH.markup.MODE.SIGNATURE}switch(q){case c:B.style.display="";w.style.display="none";WH.safeFocus(B.firstChild);break;case m:B.style.display="none";var z=(r.value.length>D?r.value.substring(0,D):r.value);if(o===f.EDIT_MODE_USER_SIGNATURE){var A;if((A=z.indexOf("\n"))!=-1&&(A=z.indexOf("\n",A+1))!=-1&&(A=z.indexOf("\n",A+1))!=-1){z=z.substring(0,A)}}var C=WH.markup.rolesToClass(u.roles);var v=WH.markup.getDomFragment(z,{allow:C,mode:p,roles:u.roles});if(t[1]&&t[1].value.length>0){v.appendChild(WH.markup.getDomFragment("[div][/div][wowheadresponse="+g_user.name+" roles="+g_user.roles+"]"+t[1].value+"[/wowheadresponse]",{allow:WH.markup.CLASS.STAFF,mode:p,roles:g_user.roles}))}$(w).empty().append(v);w.style.display="";break}}function l(o,p,q){var r=$(o).val();if(r.length>q){$(o).val(r.substring(0,q))}else{$(p).html(" "+WH.sprintf(WH.TERMS.xcharactersremaining_format,(q-r.length).toLocaleString())).removeClass("q10");if(r.length===q){$(p).addClass("q10")}}}};function co_addYourComment(){tabsContribute.focus(0);var c=WH.gE(document.forms.addcomment,"textarea")[0];WH.safeFocus(c)}function co_validateForm(h){var g=WH.gE(h,"textarea")[0];var l=false;if(WH.isSet("tabsContribute")){for(var d=0;d<tabsContribute.tabs.length;d++){if(tabsContribute.tabs[d].id=="suggest-a-video"){l=d;break}}}if(l!==false&&g.value.length<350){var c;for(var d in vi_sitevalidation){if(!vi_sitevalidation.hasOwnProperty(d)){continue}if(c=vi_sitevalidation[d].exec(g.value)){break}}if(c&&!confirm(WH.TERMS.commentasvideo_tip)){tabsContribute.show(l);$('#tab-suggest-a-video input[name="videourl"]').attr("value",c[0]);return false}}return WH.Comments.validate(g)}$(document).ready(function(){WH.setupChangeWarning($("form[name=addcomment]"),[$("textarea[name=commentbody]")],WH.TERMS.messagestarted_tip)});WH.Cookies=new function(){const c=this;this.available=function(){if(!d()){return false}return f()};function d(){if(typeof window.OptanonActiveGroups!=="string"){return true}return window.OptanonActiveGroups.split(",").indexOf("C0001")!==-1}function f(){WH.setCookie("enabledTest",1,"1");let enabled=WH.getCookies("enabledTest")==="1";if(enabled){WH.deleteCookie("enabledTest")}f=function(){return enabled};return enabled}};var Dialog=function(){var l=this,f,C=null,v,d={},u,g=false,z=WH.ce("form"),h={};z.onsubmit=function(){A();return false};this.show=function(F,E){if(F){v=F;f=WH.cOr({},Dialog.templates[v]);l.template=f}else{return}if(f.onInit&&!g){(f.onInit.bind(l,z,E))()}if(E.onBeforeShow){d.onBeforeShow=E.onBeforeShow.bind(l,z)}if(f.onBeforeShow){f.onBeforeShow=f.onBeforeShow.bind(l,z)}if(E.onShow){d.onShow=E.onShow.bind(l,z)}if(f.onShow){f.onShow=f.onShow.bind(l,z)}if(E.onHide){d.onHide=E.onHide.bind(l,z)}if(f.onHide){f.onHide=f.onHide.bind(l,z)}if(E.onSubmit){d.onSubmit=E.onSubmit}if(f.onSubmit){C=f.onSubmit.bind(l,z)}if(E.data){g=false;u={};WH.cO(u,E.data)}l.data=u;Lightbox.show("dialog-"+v,{onShow:c,onHide:t})};this.getValue=function(E){return q(E)};this.setValue=function(F,E){p(F,E)};this.getSelectedValue=function(E){return B(E)};this.getCheckedValue=function(E){return D(E)};function c(E,F){if(F||!g){o(E)}if(f.onBeforeShow){f.onBeforeShow()}if(d.onBeforeShow){d.onBeforeShow()}Lightbox.setSize(f.width);E.className+=" dialog";w();if(f.onShow){f.onShow()}if(d.onShow){d.onShow()}window.setTimeout(r,5)}function r(){for(var E=0,G,F;G=f.fields[E];E++){if(WH.inArray(["text","number"],G.type)>=0){h[G.id].focus();break}}}function o(Q){WH.ee(Q);WH.ee(z);var R=WH.ce("div");R.className="lightbox-content text";WH.ae(Q,R);WH.ae(R,z);if(f.title){WH.ae(z,WH.getImitationHeading(WH.ct(f.title),1))}var S=WH.ce("table"),O=WH.ce("tbody"),J=false;var F;var K;var N;WH.ae(S,O);WH.ae(z,S);for(var Y=0,Z=f.fields.length;Y<Z;++Y){var G=f.fields[Y],H;if(!J){F=WH.ce("tr");K=WH.ce("th");N=WH.ce("td")}G.__tr=F;if(u[G.id]==null){u[G.id]=(G.value?G.value:"")}var I;if(G.options){I=[];if(G.optorder){WH.cO(I,G.optorder)}else{for(var X in G.options){I.push(X)}}if(G.sort){I.sort(function(ae,ad){return G.sort*WH.stringCompare(G.options[ae],G.options[ad])})}}switch(G.type){case"caption":K.colSpan=2;K.style.textAlign="left";K.style.padding=0;if(G.compute){(G.compute.bind(l,null,u[G.id],z,K,F))()}else{if(G.label){WH.ae(K,WH.ct(G.label))}}WH.ae(F,K);WH.ae(O,F);continue;break;case"textarea":var aa=H=WH.ce("textarea");aa.name=G.id;if(G.disabled){aa.disabled=true}aa.rows=G.size[0];aa.cols=G.size[1];N.colSpan=2;if(G.label){K.colSpan=2;K.style.textAlign="left";K.style.padding=0;N.style.padding=0;WH.ae(K,WH.ct(G.label));WH.ae(F,K);WH.ae(O,F);F=WH.ce("tr")}WH.ae(N,aa);break;case"select":var aa=H=WH.ce("select");aa.name=G.id;if(G.size){aa.size=G.size}if(G.disabled){aa.disabled=true}if(G.multiple){aa.multiple=true}if(G.onchange){aa.onchange=G.onchange.bind(l,aa)}for(var X=0,M=I.length;X<M;++X){var U=WH.ce("option");U.value=I[X];WH.ae(U,WH.ct(G.options[I[X]]));WH.ae(aa,U)}WH.ae(N,aa);break;case"dynamic":N.colSpan=2;N.style.textAlign="left";N.style.padding=0;if(G.compute){(G.compute.bind(l,null,u[G.id],z,N,F))()}WH.ae(F,N);WH.ae(O,F);H=N;break;case"checkbox":case"radio":var W=0;H=[];for(var X=0,M=I.length;X<M;++X){var T=WH.ce("span"),aa,V,P="sdfler46"+G.id+"-"+I[X];if(X>0&&!G.noInputBr){WH.ae(N,WH.ce("br"))}V=WH.ce("label");V.setAttribute("for",P);V.onmousedown=WH.rf;aa=WH.ce("input");aa.setAttribute("type",G.type);aa.name=G.id;aa.value=I[X];aa.id=P;if(G.disabled){aa.disabled=true}if(G.onchange){aa.onchange=G.onchange.bind(l,aa)}if(G.submitOnDblClick){V.ondblclick=aa.ondblclick=function(ad){A()}}if(G.compute){(G.compute.bind(l,aa,u[G.id],z,N,F,V))()}WH.ae(V,aa);WH.ae(V,WH.ct(G.options[I[X]]));WH.ae(N,V);H.push(aa)}break;default:var aa=H=WH.ce("input");aa.name=G.id;if(G.size){aa.size=G.size}if(G.disabled){aa.disabled=true}if(G.submitOnEnter){aa.onkeypress=function(ad){ad=WH.normalizeEvent(ad);if(ad.keyCode==13){A()}}}aa.setAttribute("type",G.type);WH.ae(N,aa);break}if(G.label){if(G.type=="textarea"){if(G.labelAlign){N.style.textAlign=G.labelAlign}N.colSpan=2}else{if(G.labelAlign){K.style.textAlign=G.labelAlign}WH.ae(K,WH.ct(G.label));WH.ae(F,K)}}if(G.placeholder){aa.placeholder=G.placeholder}if(G.type!="checkbox"&&G.type!="radio"){if(G.width){aa.style.width=G.width}if(G.compute&&G.type!="caption"&&G.type!="dynamic"){(G.compute.bind(l,aa,u[G.id],z,N,F))()}}if(G.caption){var T=WH.ce("small");if(G.type!="textarea"){T.style.paddingLeft="2px"}WH.ae(T,WH.ct(G.caption));WH.ae(N,T)}if(G.style&&typeof aa!=="undefined"){for(var L in G.style){aa.style[L]=G.style[L]}}WH.ae(F,N);WH.ae(O,F);J=G.mergeCell;h[G.id]=H}var ac={arrow:"external-link",check:"check",question:"question",x:"times"};for(var Y=f.buttons.length;Y>0;--Y){var E=f.buttons[Y-1],ab=WH.ce("a");ab.onclick=A.bind(ab,E[0]);ab.className="dialog-option fa fa-"+(ac[E[0]]||"circle fa-size-xs");ab.href="javascript:";WH.ae(ab,WH.ct(E[1]));WH.ae(Q,ab)}g=true}function w(){for(var F=0,E=f.fields.length;F<E;++F){var H=f.fields[F],G=h[H.id];switch(H.type){case"caption":break;case"select":for(let j=0,len2=G.options.length;j<len2;j++){G.options[j].selected=(G.options[j].value==u[H.id]||(u[H.id]instanceof Array&&WH.inArray(u[H.id],G.options[j].value)!==-1))}break;case"checkbox":case"radio":for(let j=0,len2=G.length;j<len2;j++){G[j].checked=G[j].value==u[H.id]||(Array.isArray(u[H.id])&&WH.inArray(u[H.id],G[j].value)!=-1)}break;default:G.value=u[H.id];break}if(H.update){(H.update.bind(l,null,u[H.id],z,G))()}}}function t(){if(f.onHide){f.onHide()}if(d.onHide){d.onHide()}}function A(G){if(G=="x"){return Lightbox.hide()}for(var F=0,E=f.fields.length;F<E;++F){var I=f.fields[F],H;switch(I.type){case"caption":continue;case"select":H=B(I.id);break;case"checkbox":case"radio":H=D(I.id);break;case"dynamic":if(I.getValue){H=I.getValue(I,u,z);break}default:H=q(I.id);break}if(I.validate){if(!I.validate(H,u,z)){return}}if(H&&typeof H=="string"){H=WH.trim(H)}u[I.id]=H}m(G)}function m(F){var E;if(C){E=C(u,F,z)}if(d.onSubmit){E=d.onSubmit(u,F,z)}if(E===undefined||E){Lightbox.hide()}return false}function q(E){return h[E].value}function p(F,E){h[F].value=E}function B(I){var F=[],H=h[I];for(var G=0,E=H.options.length;G<E;G++){if(H.options[G].selected){F.push(parseInt(H.options[G].value)==H.options[G].value?parseInt(H.options[G].value):H.options[G].value)}}if(F.length==1){F=F[0]}return F}function D(I){var F=[],H=h[I];for(var G=0,E=H.length;G<E;G++){if(H[G].checked){F.push(parseInt(H[G].value)==H[G].value?parseInt(H[G].value):H[G].value)}}return F}};Dialog.templates={};Dialog.extraFields={};WH.DOM=new function(){this.addScriptOnce=function(d,f){if(WH.qs('script[src="'+d+'"]')){return}f=f||{};f.src=d;let ele=WH.ce("script",f);WH.ae(document.head,ele);return ele};this.createImitationSelect=function(d){d=d||{};let select=WH.ce("a",{className:"imitation-select",href:"javascript:",tabIndex:0},WH.ct(d.text||""));if(d.menu){Menu.add(select,d.menu,{showAtElement:true})}return select};this.dispatchEvent=function(f,d){let event;if(typeof Event==="function"){event=new Event(d)}else{event=document.createEvent("Event");event.initEvent(d,true,true)}f.dispatchEvent(event)};this.getHeight=function(d){return parseFloat(getComputedStyle(d,null).height.replace("px",""))};this.getWidth=function(d){return parseFloat(getComputedStyle(d,null).width.replace("px",""))};this.isVisible=function(d){return!(d.offsetWidth===0&&d.offsetHeight===0)};this.setLoading=function(d,f){d.dataset.loading=f?"true":"false"};this.setTemporaryIcon=function(g,d,f){if(f){g.classList.remove("fa-"+f)}else{g.classList.add("fa")}g.classList.add("fa-"+d);clearTimeout(g.temporaryIconTimer);g.temporaryIconTimer=setTimeout(function(){g.classList.remove("fa-"+d);if(f){g.classList.add("fa-"+f)}else{g.classList.remove("fa")}},2500)};this.styleRangeElement=function(d){if(!d.style.setProperty){return}let updateCssVars=function(){d.style.setProperty("--min",d.min);d.style.setProperty("--max",d.max);d.style.setProperty("--val",d.value)};WH.aE(d,"input",updateCssVars);let proto=Object.getPrototypeOf(d);["value","min","max"].forEach(function(f){let desc=Object.getOwnPropertyDescriptor(proto,f);Object.defineProperty(d,f,{get:function(){return desc.get.apply(this,arguments)},set:function(){desc.set.apply(this,arguments);updateCssVars();return this[f]}})});updateCssVars()};function c(){WH.aE(document,"selectstart",function(d){let target=d.target;while(target){if(target.nodeName==="LABEL"||(target.dataset&&target.dataset.preventSelectStart==="true")){d.preventDefault();break}target=target.parentNode}})}c()};WH.addCss=function(d){var f=WH.ce("style");f.type="text/css";if(f.styleSheet){f.styleSheet.cssText=d}else{WH.ae(f,WH.ct(d))}var c=document.getElementsByTagName("head")[0];WH.ae(c,f)};WH.setTextNodes=function(f,d){if(f.nodeType==3){f.nodeValue=d}else{for(var c=0;c<f.childNodes.length;++c){WH.setTextNodes(f.childNodes[c],d)}}};WH.setInnerHtml=function(g,f,c){if(g.nodeName.toLowerCase()==c){g.innerHTML=f}else{for(var d=0;d<g.childNodes.length;++d){WH.setInnerHtml(g.childNodes[d],f,c)}}};WH.getFirstTextContent=function(f){for(var d=0;d<f.childNodes.length;++d){if(f.childNodes[d].nodeName=="#text"){return f.childNodes[d].nodeValue}var c=WH.getFirstTextContent(f.childNodes[d]);if(c){return c}}return false};WH.getTextContent=function(f){var c="";for(var d=0;d<f.childNodes.length;++d){if(f.childNodes[d].nodeValue){c+=f.childNodes[d].nodeValue}else{if(f.childNodes[d].nodeName=="BR"){c+="\n"}}c+=WH.getTextContent(f.childNodes[d])}return c};WH.toggleDisplay=function(g,d){var f=$(g);var c=f.is(":visible");if(d){f.slideToggle(150)}else{f.toggle()}if(!c){WH.Tools.Bloodmallet.updateChartsSizes(g)}return!c};WH.preventScroll=function(d,c){if(d){if(typeof c==="string"){c=WH.qs(c)}WH.preventScroll.allowedScrollArea=c;WH.aE(document,"wheel",WH.preventScroll.cancelScroll,{passive:false,capture:false});WH.aE(document.body,"touchmove",WH.preventScroll.cancelScroll)}else{WH.dE(document,"wheel",WH.preventScroll.cancelScroll,{passive:false,capture:false});WH.dE(document.body,"touchmove",WH.preventScroll.cancelScroll)}};WH.preventScroll.cancelScroll=function(c){if(WH.preventScroll.allowedScrollArea&&WH.preventScroll.allowedScrollArea.contains(c.target)){return}c.preventDefault();c.stopPropagation()};WH.safeFocus=function(c){if(!Platform.isTouch()){$(c).focus()}};WH.safeSelect=function(c){if(!Platform.isTouch()){$(c).select()}};WH.setCaretPosition=function(f,d){if(!f){return}if(f.createTextRange){var c=f.createTextRange();c.move("character",d);c.select()}else{if(f.selectionStart!=undefined){f.focus();f.setSelectionRange(d,d)}else{f.focus()}}};WH.insertTag=function(h,o,c,q){var f=WH.ge(h);f.focus();if(f.selectionStart!=null){var r=f.selectionStart,m=f.selectionEnd,p=f.scrollLeft,g=f.scrollTop;var d=f.value.substring(r,m);if(typeof q=="function"){d=q(d)}f.value=f.value.substr(0,r)+o+d+c+f.value.substr(m);f.selectionStart=f.selectionEnd=m+o.length;f.scrollLeft=p;f.scrollTop=g}else{if(document.selection&&document.selection.createRange){var l=document.selection.createRange();if(l.parentElement()!=f){return}var d=l.text;if(typeof q=="function"){d=q(d)}l.text=o+d+c}}if(f.onkeyup){f.onkeyup()}};WH.onAfterTyping=function(d,f,c){let timerId;WH.aE(d,"keyup",function(){if(timerId){clearTimeout(timerId)}timerId=setTimeout(f,c)})};WH.isLeftClick=function(c){c=WH.normalizeEvent(c);return(c&&c._button==1)};WH.preventEmptyFormSubmission=function(){if(!$.trim(this.elements[0].value)){return false}};var Draggable=new function(){var c={},p={},t,h;function q(z){z=WH.normalizeEvent(z);if(this._handle){var u=z._target,w=false,v=0;while(u&&v<=3){if(u==this._handle){w=true;break}u=u.parentNode;++v}if(!w){return false}}t=this;c=WH.getCursorPos(z);WH.aE(document,"mousemove",f);WH.aE(document,"mouseup",m);if(t.onClick){t.onClick(z,t)}return false}function f(z){z=WH.normalizeEvent(z);var A=WH.getCursorPos(z);if(t){if(Math.abs(A.x-c.x)>5||Math.abs(A.y-c.y)>5){d(z,t);t=null}}if(!h||!h._bounds){return false}var w=o(h),v=A.x-c.x,u=A.y-c.y;v=Math.max(h._bounds.x1-p.x,Math.min(h._bounds.x2-p.x-(w.x2-w.x1),v));u=Math.max(h._bounds.y1-p.y,Math.min(h._bounds.y2-p.y-(w.y2-w.y1),u));r(v,u);return false}function m(u){u=WH.normalizeEvent(u);t=null;if(h){g(u)}}function d(v,u){if(h){g(v)}var w=WH.ac(u);p.x=w[0];p.y=w[1];if(u._targets.length){h=u.cloneNode(true);h._orig=u;WH.ae(document.body,h);r(-2323,-2323)}else{h=u}WH.Tooltip.disabled=true;WH.Tooltip.hide();if(u.onDrag){u.onDrag(v,h,u)}h._bounds=o(u._container);h.className+=" dragged"}function g(B){var A=false,C=WH.getCursorPos(B);if(h._orig&&h._orig._targets.length){l();var D={x1:h._x,x2:h._x+parseInt(h.offsetWidth),y1:h._y,y2:h._y+parseInt(h.offsetHeight)};WH.de(h);h=h._orig;for(var v=0,u=h._targets.length;v<u;++v){var z=h._targets[v],w=o(z);if(D.x2>=w.x1&&D.x1<w.x2&&D.y2>=w.y1&&D.y1<w.y2){A=true;if(h.onDrop){h.onDrop(B,h,z,(C.x>=w.x1&&C.x<=w.x2&&C.y>=w.y1&&C.y<=w.y2))}else{WH.ae(z,h)}}}}if(!A&&h.onDrop){h.onDrop(B,h,null)}WH.dE(document,"mousemove",f);WH.dE(document,"mouseup",m);WH.Tooltip.disabled=false;h.className=h.className.replace(/dragged/,"");h=null}function r(v,u){h.style.position="absolute";h.style.left=p.x+v+"px";h.style.top=p.y+u+"px";h._x=p.x+v;h._y=p.y+u}function l(){h.style.left="-2323px";h.style.top="-2323px"}function o(u){var v=WH.ac(u);return{x1:v[0],x2:v[0]+parseInt(u.offsetWidth),y1:v[1],y2:v[1]+parseInt(u.offsetHeight)}}this.init=function(z,w){z.onmousedown=q;if(!z._targets){z._targets=[]}if(!z._container){z._container=document.body}if(w!=null){if(w.targets){for(var v=0,u=w.targets.length;v<u;++v){z._targets.push(WH.ge(w.targets[v]))}}if(w.container){z._container=WH.ge(w.container)}if(w.onClick){z.onClick=w.onClick}if(w.onDrop){z.onDrop=w.onDrop}if(w.onDrag){z.onDrag=w.onDrag}}}};WH.DynamicFixedElement=new function(){var h={elements:{}};this.checkAll=function(){for(var m in h.elements){if(h.elements.hasOwnProperty(m)){g(m,true)}}};this.init=function(p,r,o){o=o||{};var m=$(r);if(!m.length){WH.error("Could not find element to set up a dynamic fixed position.",p,r,o);return}var t="dynamic-fixed-element-initialized";if(m.data(t)){WH.error("Element is already set up for a dynamic fixed position.",p,r,o);return}var q=["left","right"].indexOf(o.side)>=0?o.side:"right";h.elements[p]={defaultSide:parseInt(m.css(q))||0,defaultTop:parseInt(m.css("top"))||0,element:m,elementWrapper:m.parent(),fixed:false,minWidth:o.minWidth,offset:false,side:q};$(window).scroll(g.bind(null,p)).resize(g.bind(null,p,true));g(p);m.data(t,true)};function g(o,u){if(h.elements[o].minWidth&&Platform.getViewportWidth()<h.elements[o].minWidth){f(o);c(o);return}var t=h.elements[o].elementWrapper.get(0).getBoundingClientRect();var m=10;if(WH.Layout.Responsive.isZulInMobileMode()){m+=40}else{var r=WH.Layout.getElement("header-wrapper");if(r){m+=r.getBoundingClientRect().height}}if(t.top<m-h.elements[o].defaultTop){var p=(h.elements[o].elementWrapper.height()||0)-(h.elements[o].element.height()||0);var q=(t.top*-1)+m;if(q<p){c(o);l(o,m,u)}else{f(o);p=(h.elements[o].elementWrapper.height()||0)-(h.elements[o].element.height()||0);d(o,Math.min(q,p),u)}}else{f(o);c(o)}}function f(m){if(h.elements[m].fixed){h.elements[m].element.removeClass("fixed-"+m).removeClass("scrollable-"+m).css(h.elements[m].side,"").css("top","");h.elements[m].fixed=false}}function c(m){if(h.elements[m].offset){h.elements[m].element.css("margin-top","");h.elements[m].offset=false}}function l(p,o,r){var q=h.elements[p].elementWrapper.offset();if(!h.elements[p].fixed||r===true){c(p);var m=h.elements[p].side==="left"?(q.left+h.elements[p].defaultSide):($(window).width()-q.left-h.elements[p].elementWrapper.width()+h.elements[p].defaultSide);h.elements[p].element.addClass("fixed-"+p).css(h.elements[p].side,m+"px").css("top",o+"px");if(h.elements[p].element.outerHeight()+10>$(window).height()){h.elements[p].element.addClass("scrollable-"+p)}h.elements[p].fixed=true}}function d(m,o,p){if(!h.elements[m].offset||p===true){h.elements[m].element.css("margin-top",o-h.elements[m].defaultTop+"px");h.elements[m].offset=true}}};WH.Entity=new function(){const d=this;var g=[WH.Types.ADVENTURE_COMBATANT_ABILITY,WH.Types.AZERITE_ESSENCE,WH.Types.AZERITE_ESSENCE_POWER,WH.Types.GEAR_SET,WH.Types.RESOURCE,WH.Types.STORYLINE];this.getLink=function(h,l){let name=WH.Gatherer.getName(h,l);let link=WH.ce("a",{href:WH.Entity.getPath(h,l,name||false)},WH.ct(name||d.getUnknownName(h,l)));let data=WH.Gatherer.get(h,l);if(data){if(data.icon){link.classList.add("icontinyl");link.style.backgroundImage="url("+WH.Icon.getIconUrl(data.icon,WH.Icon.TINY)+")"}if(data.quality!=null&&data.quality!==-1){link.classList.add("q"+data.quality)}}return link};this.getPath=function(p,o,m,l){var q;var h;switch(p){case WH.Types.CLASS:h=WH.Wow.PlayerClass.getSlug(o);break;case WH.Types.RACE:h=WH.Wow.Race.getSlug(o);break}if(h){q="/"+h}else{if(g.indexOf(p)!==-1){q=c(p,o,m)}else{q=f(p,o,m)}}if(typeof l==="string"){if(l!==""){q+="?"+l}}else{if(l&&typeof l==="object"){l=WH.Url.buildQuery(l);if(l){q+="?"+l}}}return q};this.getUnknownName=function(h,l){return WH.term("unknownEntityName_format",WH.Types.getUpperSingular(h),l)};this.isReference=function(h){return/^[a-z-]+=-?\d+$/.test(h)};function f(m,l,h){var o="/"+g_types[m]+"="+l;if(!h&&h!==false){h=WH.Gatherer.getName(m,l)}if(h){o+="/"+WH.Strings.slug(h,true)}return o}function c(m,l,h){var o="/"+g_types[m]+"/";if(!h&&h!==false){h=WH.Gatherer.getName(m,l)}if(h){o+=WH.Strings.slug(h,true)+"-"+l}else{o+=l}return o}};var Facebook={getCurrentOpenGraphUrl:function(){return $("head meta[property='og:url']").attr("content")},createLikeButton:function(d,f){if(!f){f={}}var h,g,c;if(f.simple){g=90;c=21;h="button_count"}else{g=400;c=23;h="standard"}return $("<iframe/>",{src:"//www.facebook.com/plugins/like.php?href="+WH.urlEncode(d)+"&locale=en_US&layout="+h+"&show_faces=false&action=like&font=arial&colorscheme=dark&width="+g+"&height="+c,scrolling:"no",frameborder:"0",allowtransparency:"true",css:{border:"none",overflow:"hidden",width:g+"px",height:c+"px",display:"none"}}).on("load",function(){$(this).show()})}};var Favorites=new function(){var l=null;var f=null;var r=null;this.pageInit=function(v,u,w){if(typeof v=="string"){if(!document.querySelector){return}v=document.querySelector(v)}if(!v||typeof u!="number"||typeof w!="number"){return}l=u;f=w;o(v)};function m(){var u=typeof g_pageInfo=="object"&&typeof g_pageInfo.type=="number"&&typeof g_pageInfo.typeId=="number"?document.querySelector("#main-contents .heading-size-1"):null;if(!u){if(document.readyState!=="complete"){setTimeout(m,9)}return}l=g_pageInfo.type;f=g_pageInfo.typeId;o(u)}this.hasFavorites=function(){return!!g_favorites.length};this.getMenu=function(){var C=[];var I=0;var w=0;for(var D=0,B;B=g_favorites[D];D++){if(!B.entities.length){continue}I++;var J=[];for(var H=0,A;A=B.entities[H];H++){let url=A[2]||WH.Entity.getPath(B.id,A[0]);J.push([A[0],A[1],url]);w++}Menu.sort(J);C.push([B.id,WH.Types.getUpperPlural(B.id),,J])}Menu.sort(C);if((I==1&&w<=45)||(I==2&&I+w<=30)||(I>2&&I+w<=15)){var G=[];for(var F=0;J=C[F];F++){G.push([,J[MENU_IDX_LABEL]]);var v=Menu.getSubmenu(J);for(var E=0,u;u=v[E];E++){var z=[u[MENU_IDX_NAME],u[MENU_IDX_LABEL],u[MENU_IDX_URL]];if(u[MENU_IDX_OPT]){z[MENU_IDX_OPT]=u[MENU_IDX_OPT]}G.push(z)}}C=G}if(C.length&&WH.Theme.isStandardType()){C.unshift([0,WH.TERMS.favorites,null,null,{heading:true}])}return C};this.refreshMenu=function(){var u=WH.qs(".header-user-favorites");if(!u){return}var v=Favorites.getMenu();if(!v.length){u.style.display="none";return}Menu.add(u,v,{padded:true});u.style.display=""};function o(u){r=$("<span/>",{"class":"fav-star fa"}).appendTo(u);if(WH.userIsLoggedIn()&&g_user.sessionKey){r.addClass("fa-star"+(t(l,f)?"":"-o")).click((function(w,z,v){h(w,z,v);q(w,z);WH.Tooltip.hide()}).bind(null,l,f,u.textContent.trim().replace(/(.+)<.*/,"$1")));WH.Tooltip.simpleNonTouch(r.get(0),function(){var v=this.className.match(/\bfa-star-o\b/)?WH.TERMS.addtofavorites:WH.TERMS.removefromfavorites;return'<div class="no-wrap">'+v+"</div>"},"q2",true)}else{r.addClass("fa-star-o").click(function(){WH.goToLoginPage()});WH.Tooltip.simpleNonTouch(r.get(0),WH.TERMS.logintosavefavorites_tip+'<div class="q2" style="margin-top:10px">'+WH.TERMS.clicktologin_stc+"</span>",null,true)}}function q(v,z){if(r){var u="fa-star-o";var w="fa-star";if(!t(v,z)){u="fa-star";w="fa-star-o"}r.removeClass(u).addClass(w)}}function t(w,A){var v=d(w);if(v==-1){return false}for(var u=0,z;z=g_favorites[v].entities[u];u++){if(z[0]==A){return true}}return false}function h(v,w,u){if(t(v,w)){c(v,w,u)}else{g(v,w,u)}}function g(A,C,w,z){var v=d(A,true);if(v==-1){WH.error("Invalid type when adding entity to favorites! Type was:",A);return}for(var u=0,B;B=g_favorites[v].entities[u];u++){if(!z&&(B[0]==C)){alert(WH.TERMS.entityalreadyfavorited_format.replace("%s",WH.Types.getLowerSingular(A)));return}}g_favorites[v].entities.push([C,w]);Favorites.refreshMenu();if(!z){p("add",A,C,c.bind(null,A,C,w,true))}}function c(A,C,w,z){var v=d(A);if(v==-1){return}for(var u=0,B;B=g_favorites[v].entities[u];u++){if(B[0]==C){g_favorites[v].entities.splice(u,1);if(!g_favorites[v].entities.length){g_favorites.splice(v,1)}Favorites.refreshMenu();if(!z){p("remove",A,C,g.bind(null,A,C,w,true))}break}}}function d(w,u){for(var v=0,z;z=g_favorites[v];v++){if(z.id==w){return v}}if(!u){return-1}g_favorites.push({id:w,entities:[]});g_favorites.sort(function(B,A){return WH.stringCompare(WH.Types.getUpperPlural(B.id),WH.Types.getUpperPlural(A.id))});for(v=0;z=g_favorites[v];v++){if(z.id==w){return v}}return-1}function p(w,v,z,u){$.ajax({url:"/account=favorites",method:"POST",data:{action:w,type:v,id:z,sessionKey:g_user.sessionKey},error:function(C,A,B){u();WH.error("Error executing favorites action:",w,v,z,A,B);q(v,z)}})}if(document.querySelector&&WH.LocalStorage.isSupported()){m()}};var ContactTool=new function(){const c=this;this.general=0;this.comment=1;this.post=2;this.screenshot=3;this.video=5;this.guide=6;var d;var h={0:[[1,true],[9,true],[2,true],[8,true],[3,true],[4,true],[5,true],[6,true],[7,true]],1:[[15,function(l){return((l.roles&U_GROUP_MODERATOR)==0)}],[16,true],[18,function(l){return((l.roles&U_GROUP_MODERATOR)==0)}],[19,function(l){return((l.roles&U_GROUP_MODERATOR)==0)}],[20,function(l){return((l.roles&U_GROUP_MODERATOR)==0)}]],2:[[30,function(l){return(g_users&&g_users[l.user]&&(g_users[l.user].roles&U_GROUP_MODERATOR)==0)}],[37,function(l){return((l.roles&U_GROUP_MODERATOR)==0&&g_users&&g_users[l.user]&&(g_users[l.user].roles&U_GROUP_MODERATOR)==0&&g_users[l.user].avatar==2)}],[31,true],[32,true],[33,function(l){return(g_users&&g_users[l.user]&&(g_users[l.user].roles&U_GROUP_MODERATOR)==0)}],[34,function(l){return(g_users&&g_users[l.user]&&(g_users[l.user].roles&U_GROUP_MODERATOR)==0&&l.op&&!l.sticky)}],[35,function(l){return(g_users&&g_users[l.user]&&(g_users[l.user].roles&U_GROUP_MODERATOR)==0)}],[36,function(l){return(g_users&&g_users[l.user]&&(g_users[l.user].roles&U_GROUP_MODERATOR)==0)}]],3:[[45,true],[46,true],[47,function(l){return(g_users&&g_users[l.user]&&(g_users[l.user].roles&U_GROUP_MODERATOR)==0)}],[48,function(l){return(g_users&&g_users[l.user]&&(g_users[l.user].roles&U_GROUP_MODERATOR)==0)}]],5:[[45,true],[46,true],[47,function(l){return(g_users&&g_users[l.user]&&(g_users[l.user].roles&U_GROUP_MODERATOR)==0)}],[48,function(l){return(g_users&&g_users[l.user]&&(g_users[l.user].roles&U_GROUP_MODERATOR)==0)}]],6:[[45,true],[46,true],[48,true]]};var g={1:WH.TERMS.captchaerror_tip,2:WH.TERMS.shortdescription_tip,3:WH.TERMS.contactreason_tip,7:WH.TERMS.alreadyreported_tip};var f=null;this.displayError=function(m,l){alert(l)};this.onShow=function(){if(location.hash&&location.hash!="#contact"){f=location.hash}if(this.data.mode==0){location.replace("#contact")}};this.onHide=function(){if(f&&(f.indexOf("screenshots:")==-1||f.indexOf("videos:")==-1)){WH.setHash(f)}else{WH.clearHash()}};this.onSubmit=function(w,A,q){if(w.submitting){return false}for(var z=0;z<q.elements.length;++z){q.elements[z].disabled=true}var u=["contact=1","mode="+WH.urlEncode(w.mode),"reason="+WH.urlEncode(w.reason),"desc="+WH.urlEncode(w.description),"ua="+WH.urlEncode(navigator.userAgent),"appname="+WH.urlEncode(navigator.appName),"page="+WH.urlEncode(w.currenturl)];if(w.mode==0){if(w.relatedurl){u.push("relatedurl="+WH.urlEncode(w.relatedurl))}if(w.email){u.push("email="+WH.urlEncode(w.email))}}else{if(w.mode==1){u.push("id="+WH.urlEncode(w.comment.id))}else{if(w.mode==2){u.push("id="+WH.urlEncode(w.post.id))}else{if(w.mode==3){u.push("id="+WH.urlEncode(w.screenshot.id))}else{if(w.mode==5){u.push("id="+WH.urlEncode(w.video.id))}else{if(w.mode==6){u.push("id="+WH.urlEncode(w.guide))}}}}}}if(w.reason===1||w.reason===9){var B="";if(!WH.WAS){B="Ads class not found. User may have ad blocking enabled. No ad log available."}else{var o=WH.WAS.getDfpLog();if(o&&o.length){B+="<br><b><i>DFP LOG</i></b><br>";for(var t=0,D;D=o[t];t++){B+="<br><b>"+D._time+"</b><br>";B+="<b>Unit:</b> "+D._env+" "+D._slot+"<br>";B+="<b>Channel:</b> "+D._channelName+" ("+D._channelGroup+")<br>";if(D._error){B+='<span style="color:'+WH.Wow.Item.getQualityColor(WH.Wow.Item.QUALITY_FAIL)+'"><b>Error:</b> '+D._error+"</span><br>"}delete D._time;delete D._env;delete D._slot;delete D._channelName;delete D._channelGroup;delete D._error;var v=WH.objectToArray(D,"property");for(var r=0,C;C=v[r];r++){B+="<b>"+C.property+":</b> "+JSON.stringify(C.value)+"<br>"}}}}if(!B){B="No ad data. Probably blocked by user."}u.push("adinfo="+encodeURIComponent(B));let zafusr=WH.LocalStorage.get("zafusr");if(zafusr){u.push("zafusr="+encodeURIComponent(zafusr))}}w.submitting=true;var p="/contactus";new Ajax(p,{method:"POST",params:u.join("&"),onSuccess:function(E,l){var m=E.responseText;if(m==0){if(g_user.name){alert(WH.sprintf(WH.TERMS.contactreceived_format,g_user.name))}else{alert(WH.TERMS.contactthanks_tip)}Lightbox.hide()}else{if(g[m]){alert(g[m])}else{alert("Error: "+m)}}},onFailure:function(m,l){alert("Failure submitting contact request: "+m.statusText)},onComplete:function(E,m){for(var l=0;l<q.elements.length;++l){q.elements[l].disabled=false}w.submitting=false}});return false};this.show=function(l){if(!l){l={}}var o={mode:0};WH.cO(o,l);o.reasons=h[o.mode];if(location.href.indexOf("#contact")!=-1){o.currenturl=location.href.substr(0,location.href.indexOf("#contact"))}else{o.currenturl=location.href}var m="contactus";if(o.mode!=0){m="reportform"}if(!d){c.init()}d.show(m,{data:o,onShow:c.onShow,onHide:c.onHide,onSubmit:c.onSubmit})};this.checkPound=function(){if(location.hash&&location.hash=="#contact"){ContactTool.show()}};this.init=function(){d=new Dialog();Dialog.templates.contactusEmailOnly={title:WH.TERMS.contactwowhead,width:550,buttons:[["x",WH.TERMS.cancel]],fields:[{id:"noemailwarning",type:"caption",compute:function(o,m,l,p){$(p).html('<b id="contact-emailwarn">'+WH.TERMS.contactDialogEmailOnly_tip.replace("%1$s",'<a href="mailto:feedback@wowhead.com">').replace("%2$s","</a>")+"</b>").css("white-space","normal").css("padding","0 4px")}}],onInit:function(l){},onShow:function(l){setTimeout(Lightbox.reveal,250)}};Dialog.templates.contactus={title:WH.TERMS.contactwowhead,width:550,buttons:[["check",WH.TERMS.ok],["x",WH.TERMS.cancel]],fields:[{id:"reason",type:"select",label:WH.TERMS.reason_colon,required:1,options:[],compute:function(v,w,p,t){WH.ee(v);for(var u=0;u<this.data.reasons.length;++u){var m=this.data.reasons[u][0];var q=this.data.reasons[u][1];var l=false;if(typeof q=="function"){l=q(this.extra)}else{l=q}if(!l){continue}var r=WH.ce("option");r.value=m;if(w&&w==m){r.selected=true}WH.ae(r,WH.ct(g_contact_reasons[m]));WH.ae(v,r)}v.onchange=function(){if(this.value==1||this.value==2||this.value==3){p.currenturl.parentNode.parentNode.style.display="";p.relatedurl.parentNode.parentNode.style.display=""}else{if(this.value==9){p.currenturl.parentNode.parentNode.style.display="";p.relatedurl.parentNode.parentNode.style.display="none"}else{p.currenturl.parentNode.parentNode.style.display="none";p.relatedurl.parentNode.parentNode.style.display="none"}}}.bind(v);t.style.width="98%"},validate:function(p,o,m){var l="";if(!p||p.length==0){l=WH.TERMS.contactreason_tip}if(l==""){return true}ContactTool.displayError(m.reason,l);WH.safeFocus(m.reason);return false}},{id:"currenturl",type:"text",disabled:true,label:WH.TERMS.currenturl_colon,size:40},{id:"relatedurl",type:"text",label:WH.TERMS.relatedurl_colon,caption:WH.TERMS.optional,size:40,validate:function(q,p,o){var m="";var l=/^(http(s?)\:\/\/|\/)?([\w]+:\w+@)?([a-zA-Z]{1}([\w\-]+\.)+([\w]{2,5}))(:[\d]{1,5})?((\/?\w+\/)+|\/?)(\w+\.[\w]{3,4})?((\?\w+=\w+)?(&\w+=\w+)*)?/;q=q.trim();if(q.length>=250){m=WH.TERMS.relatedurl_tip}else{if(q.length>0&&!l.test(q)){m=WH.TERMS.entervalidurl_tip}}if(m==""){return true}ContactTool.displayError(o.relatedurl,m);WH.safeFocus(o.relatedurl);return false}},{id:"email",type:"text",label:WH.TERMS.emailaddress_colon,caption:WH.TERMS.emailcontact_tip,compute:function(q,p,m,r,o){var l=function(){$("#contact-emailwarn").css("display",WH.isEmailValid($(m.email).val())?"none":"");Lightbox.reveal()};$(q).keyup(l).blur(l)},validate:function(p,o,m){var l="";p=p.trim();if(p.length>=100){l=WH.TERMS.emailaddresslength_tip}else{if(p.length>0&&!WH.isEmailValid(p)){l=WH.TERMS.entervalidemail_tip}}if(l==""){return true}ContactTool.displayError(m.email,l);WH.safeFocus(m.email);return false}},{id:"description",type:"textarea",caption:WH.TERMS.bespecific_tip,width:"98%",required:1,size:[10,30],validate:function(p,o,m){var l="";p=p.trim();if(p.length==0||p.length>100000){l=WH.TERMS.shortdescription_tip}if(l==""){return true}ContactTool.displayError(m.description,l);WH.safeFocus(m.description);return false}},{id:"noemailwarning",type:"caption",compute:function(o,m,l,p){$(p).html('<span id="contact-emailwarn" class="q10">'+WH.TERMS.noemailwarning_tip+"</span>").css("white-space","normal").css("padding","0 4px")}}],onInit:function(l){},onShow:function(l){if(this.data.focus&&l[this.data.focus]){setTimeout(WH.setCaretPosition.bind(null,l[this.data.focus],l[this.data.focus].value.length),100)}else{if(l.reason&&!l.reason.value){setTimeout(l.reason.focus.bind(l.reason),10)}else{if(l.relatedurl&&!l.relatedurl.value){setTimeout(l.relatedurl.focus.bind(l.relatedurl),10)}else{if(l.email&&!l.email.value){setTimeout(l.email.focus.bind(l.email),10)}else{if(l.description&&!l.description.value){setTimeout(l.description.focus.bind(l.description),10)}}}}}setTimeout(Lightbox.reveal,250)}};Dialog.templates.reportform={title:WH.TERMS.report,width:550,buttons:[["check",WH.TERMS.ok],["x",WH.TERMS.cancel]],fields:[{id:"reason",type:"select",label:WH.TERMS.reason_colon,options:[],compute:function(w,A,q,u){switch(this.data.mode){case 1:q.firstChild.innerHTML=WH.sprintf(WH.TERMS.reportcomment_format,'<a href="/user='+this.data.comment.user+'">'+this.data.comment.user+"</a>");break;case 2:var z='<a href="/user='+this.data.post.user+'">'+this.data.post.user+"</a>";if(this.data.post.op){q.firstChild.innerHTML=WH.sprintf(WH.TERMS.reporttopic_format,z)}else{q.firstChild.innerHTML=WH.sprintf(WH.TERMS.reportpost_format,z)}break;case 3:q.firstChild.innerHTML=WH.sprintf(WH.TERMS.screenshotreport_format,'<a href="/user='+this.data.screenshot.user+'">'+this.data.screenshot.user+"</a>");break;case 5:q.firstChild.innerHTML=WH.sprintf(WH.TERMS.videoreport_format,'<a href="/user='+this.data.video.user+'">'+this.data.video.user+"</a>");break;case 6:q.firstChild.innerHTML="Report guide";break}q.firstChild.setAttribute("style","");WH.ee(w);var t;if(this.data.mode==1){t=this.data.comment}else{if(this.data.mode==2){t=this.data.post}else{if(this.data.mode==3){t=this.data.screenshot}else{if(this.data.mode==5){t=this.data.video}else{if(this.data.mode==6){t=this.data.guide}}}}}WH.ae(w,WH.ce("option",{selected:(!A),value:-1}));for(var v=0;v<this.data.reasons.length;++v){var p=this.data.reasons[v][0];var m=this.data.reasons[v][1];var l=false;if(typeof m=="function"){l=m(t)}else{l=m}if(!l){continue}var r=WH.ce("option");r.value=p;if(A&&A==p){r.selected=true}WH.ae(r,WH.ct(g_contact_reasons[p]));WH.ae(w,r)}u.style.width="98%"},validate:function(p,o,m){var l="";if(!p||p==-1||p.length==0){l=WH.TERMS.contactreason_tip}if(l==""){return true}ContactTool.displayError(m.reason,l);WH.safeFocus(m.reason);return false}},{id:"description",type:"textarea",caption:WH.TERMS.bespecific_tip,width:"98%",required:1,size:[10,30],validate:function(p,o,m){var l="";p=p.trim();if(p.length==0||p.length>10000){l=WH.TERMS.shortdescription_tip}if(l==""){return true}ContactTool.displayError(m.description,l);WH.safeFocus(m.description);return false}}],onInit:function(l){},onShow:function(m){var o=$(m).find("*[name=reason]")[0];var l=$(m).find("*[name=description]")[0];if(this.data.focus&&m[this.data.focus]){setTimeout(WH.setCaretPosition.bind(null,m[this.data.focus],m[this.data.focus].value.length),100)}else{if(!o.value){setTimeout(o.focus.bind(o),10)}else{if(!l.value){setTimeout(l.focus.bind(l),10)}}}}}};$(document).ready(this.checkPound)};WH.Gatherer=new function(){var requested={};this.addData=function(entityType,dataEnv,source){var out=g_gathered_types[entityType];for(var id in source){if(!source.hasOwnProperty(id)){continue}if(dataEnv===WH.getDataEnv()){if(!out.hasOwnProperty(id)){out[id]=source[id]}else{WH.cO(out[id],source[id])}}else{var envKey=getEnvKey(dataEnv);if(!out.hasOwnProperty(id)){out[id]=source[id];out[id][envKey]=WH.cO({},source[id])}else{if(!out[id].hasOwnProperty(envKey)){out[id][envKey]={}}WH.cO(out[id][envKey],source[id]);for(var key in source[id]){if(!source[id].hasOwnProperty(key)){continue}if(!out[id].hasOwnProperty(key)){out[id][key]=source[id][key]}}}}}};this.fetchItems=function(itemIDs,options){fetchData("items",itemIDs,options)};this.fetchSpells=function(spellIDs,options){fetchData("spells",spellIDs,options)};this.get=function(entityType,entityId,dataEnv,forceDataEnv){if(!g_gathered_types.hasOwnProperty(entityType)){return undefined}var ent=g_gathered_types[entityType][entityId];if(ent===undefined||!dataEnv||dataEnv===WH.getDataEnv()){return ent}var envKey=getEnvKey(dataEnv);var fallback=forceDataEnv?undefined:ent;return ent.hasOwnProperty(envKey)?ent[envKey]:fallback};this.getIconName=function(entityType,entityId){return g_gathered_types[entityType]&&g_gathered_types[entityType][entityId]&&g_gathered_types[entityType][entityId].icon||WH.Icon.UNKNOWN};this.getName=function(entityType,entityId){if(!g_gathered_types[entityType]||!g_gathered_types[entityType][entityId]){switch(entityType){case WH.Types.RACE:return(window.g_chr_races&&g_chr_races[entityId])||null;case WH.Types.CLASS:return(window.g_chr_classes&&g_chr_classes[entityId])||null;case WH.Types.CURRENCY:return(window.g_currencies&&g_currencies[entityId]&&g_currencies[entityId][0])||null;case WH.Types.ZONE:return(window.g_zones&&g_zones[entityId])||null;case WH.Types.PET:return(window.g_pet_families&&g_pet_families[entityId])||null;case WH.Types.SKILL:return(window.g_spell_skills&&g_spell_skills[entityId])||null}return null}if(g_gathered_types[entityType][entityId].name){return g_gathered_types[entityType][entityId].name}return g_gathered_types[entityType][entityId]["name_"+Locale.getName()]||null};function fetchData(type,entityIDs,options){if(!options){options={}}var entityArray=prepareEntityArray(type,entityIDs,options);if(!entityArray.length){switch(typeof options.onSuccess){case"string":eval(options.onSuccess+"()");break;case"function":options.onSuccess();break}return}entityArray.sort();var url="/gatherer?"+type+"="+entityArray.join(",");if(typeof options.onSuccess=="string"){url+="&callback="+options.onSuccess}var callback=typeof options.onSuccess=="function"?options.onSuccess:null;$.getScript(url,callback)}function getEnvKey(dataEnv){return"_dataEnv_"+WH.dataEnvTerm[dataEnv]}function prepareEntityArray(type,entityIDs,options){if(!requested[type]){requested[type]={}}if(entityIDs instanceof Array){var entityArray=[];for(var i=0,entityID;entityID=entityIDs[i];i++){if(validateID(entityID)){if(requested[type][entityID]&&!options.forceRequest){}else{requested[type][entityID]=true;entityArray.push(entityID)}}}return entityArray}else{if(validateID(entityIDs)){if(requested[type][entityIDs]&&!options.forceRequest){return[]}else{requested[type][entityIDs]=true;return[entityIDs]}}else{WH.error("Gatherer requires an array of IDs or single ID.");return[]}}}function validateID(id){return typeof id=="number"||(typeof id=="string"&&!id.match(/[^0-9]/))}};WH.GlobalStrings=WH.GlobalStrings||{};(function(){if(typeof Proxy!=="function"){return}var c=WH.GlobalStrings;WH.GlobalStrings=new Proxy(c,{get:function(d,f){return d[f]||f}})})();WH.Guide=new function(){const c=WH.getPageData("WH.Guides.statusNames");this.getStatusName=function(d){return(c||[])[d]};this.initInteriorSidebar=function(){var f=$(".interior-sidebar-collapse");f.click(WH.Layout.collapseInteriorSidebar);WH.Tooltip.simpleNonTouch(f.get(0),WH.TERMS.hidesidebar,"q2");var g=$(".interior-sidebar-expand");g.click(WH.Layout.expandInteriorSidebar);WH.Tooltip.simpleNonTouch(g.get(0),WH.TERMS.showsidebar,"q2");var d=Platform.getViewportWidth();if(d>=WH.Responsive.CONSTANTS.INTERIOR_SIDEBAR_REMOVAL_BREAKPOINT&&(d<950||(d<1350&&$(".sidebar").is(":visible")))){WH.Layout.collapseInteriorSidebar()}}};function GetStars(c,p,u,t){var o=5;var m=c;if(u){c=u}c=Math.round(c*2)/2;var r=Math.round(c);var q=$("<span>").addClass("stars").addClass("max-"+o).addClass("stars-"+r);if(!g_user.id){p=false}if(p){q.addClass("ratable")}if(u){q.addClass("rated")}var d="<span>";var h=c;for(var g=1;g<=o;++g){if(h<1&&h>0){d+='<b class="stars-half">'}else{if(h<=0){d+='<b class="stars-empty">'}else{d+='<b class="stars-full">'}}h--;d+='<i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star-half"></i>'}for(var g=1;g<=o;++g){d+="</b>"}d+="</span>";q.append(d);if(p){var f=0;$("b",q).each(function(){var v=++f;$("> i",this).click(function(){VoteGuide(t,m,v);return false})})}if(u){var l=$("<span>").addClass("clear fa fa-times-circle").click(function(){VoteGuide(t,m,0)});q.append(l)}if(c>=0){q.mouseover(function(v){WH.Tooltip.showAtCursor(v,"Rating:&nbsp;"+c+"&nbsp;/&nbsp;"+o,0,0,"q")}).mousemove(function(v){WH.Tooltip.cursorUpdate(v)}).mouseout(function(){WH.Tooltip.hide()})}return q}function VoteGuide(guideId,oldRating,newRating){$("#guiderating").html(GetStars(oldRating,true,newRating,guideId));$.ajax({cache:false,url:"/guide=vote",type:"POST",error:function(){$("#guiderating").html(GetStars(oldRating,true,0,guideId));alert("Voting failed. Try again later.")},success:function(json){var data=eval("("+json+")");$("#guiderating-value").text(data.rating);$("#guiderating-votes").text(WH.getN5(data.nvotes))},data:{id:guideId,rating:newRating}})}function applyGuideStyles(){var c=$("#guide-body");if(c.length){$("table[border]",c).not("[class]").not('[border="0"]').addClass("grid");c.addClass("guide-styles")}}WH.Highlight=function(c,h,g,p){const m={buttonSize:undefined,"class":undefined,closeButtonText:undefined,contents:undefined,elements:{target:undefined,wrapper:undefined},extraButtons:[],fixedPosition:false,position:undefined,storageKey:"highlight-"+c,useLocalStorage:true};function o(u,r,q){q=q||{};if(q.hasOwnProperty("useLocalStorage")){m.useLocalStorage=q.useLocalStorage}if(m.useLocalStorage){let closed=WH.LocalStorage.get(m.storageKey);if(closed){try{closed=JSON.parse(closed)}catch(t){}if(closed===true){return}}}else{let currentHighlight=WH.qs(".element-highlight#"+m.storageKey);if(currentHighlight){WH.de(currentHighlight)}}m.elements.target=$(u);if(!m.elements.target.length||!m.elements.target.is(":visible")){return}m.fixedPosition=WH.isElementFixedPosition(m.elements.target[0]);if(typeof q.buttonSize==="string"){m.buttonSize=q.buttonSize}if(q.extraButtons instanceof Array){m.extraButtons=q.extraButtons}if(typeof q["class"]==="string"){m["class"]=q["class"]}m.contents=r;m.closeButtonText=q.closeButtonText||WH.TERMS.gotIt_exclamation;m.position=["bottom","left","right","top"].indexOf(q.position)!==-1?q.position:"bottom";l();d()}function d(){$(window).resize(function(){var t=document.querySelectorAll(".element-highlight");for(var r=0,q=t.length;r<q;r++){WH.de(t[r])}});d=function(){}}function l(){var w=m.fixedPosition?m.elements.target[0].getBoundingClientRect():m.elements.target.offset();var E=m.elements.target.outerHeight();var r=m.elements.target.outerWidth();m.elements.wrapper=$("<div/>",{"class":"element-highlight",css:{left:w.left+"px",top:w.top+"px"},id:m.storageKey});if(m.fixedPosition){m.elements.wrapper.css("position","fixed")}$("<div/>",{"class":"element-highlight-highlighter",css:{height:E+"px",width:r+"px","border-radius":m.elements.target.css("border-radius")}}).appendTo(m.elements.wrapper);var A={};switch(m.position){case"bottom":A.left=(r/2)+"px";A.top=E+"px";break;case"left":A.right="0px";A.top=(E/2)+"px";break;case"right":A.left=r+"px";A.top=(E/2)+"px";break;case"top":A.bottom="0px";A.left=(r/2)+"px";break}var v=$("<div/>",{"class":"element-highlight-dialog",css:A,"data-position":m.position}).appendTo(m.elements.wrapper);var D=$("<div/>",{"class":"element-highlight-dialog-content","data-buttons":m.extraButtons.length+1}).appendTo(v);if(m["class"]){m.elements.wrapper.addClass(m["class"])}if(typeof m.contents==="string"){D.text(m.contents)}else{$(m.contents).appendTo(D)}var t=$("<div/>",{"class":"element-highlight-dialog-content-buttons"}).appendTo(D);if(m.extraButtons.length){for(var z=0,B=m.extraButtons.length;z<B;z++){var C=m.extraButtons[z];if(!C.url&&!C.action){continue}var q=$("<a/>",{"class":"element-highlight-dialog-content-button btn btn-site",text:C.text}).appendTo(t);if(C.url){q.attr("href",C.url)}if(C.action){q.click(C.action)}if(m.buttonSize){q.addClass("btn-"+m.buttonSize)}}}var u=$("<a/>",{"class":"element-highlight-dialog-content-close btn btn-site",text:m.closeButtonText,click:f}).appendTo(t);if(m.buttonSize){u.addClass("btn-"+m.buttonSize)}m.elements.wrapper.appendTo(document.body);switch(m.position){case"left":case"right":setTimeout(function(){D.css("top","-"+(D.outerHeight()/2)+"px")},0);break}}function f(){m.elements.wrapper.fadeOut(function(){$(this).remove()});if(m.useLocalStorage){WH.LocalStorage.set(m.storageKey,JSON.stringify(true))}}o(h,g,p)};WH.Icon=new function(){const c=this;this.TINY="tiny";this.SMALL="small";this.MEDIUM="medium";this.LARGE="large";this.BLIZZARD="blizzard";this.LEGACY_IDS={0:this.SMALL,1:this.MEDIUM,2:this.LARGE,3:this.BLIZZARD};this.UNKNOWN="inv_misc_questionmark";this.UNKNOWN_ZONE="inv_misc_map08";const d=[this.TINY,this.SMALL,this.MEDIUM,this.LARGE,this.BLIZZARD];this.create=function(h,l,g,f){if(l===WH.Icon.TINY){return WH.ce("img",{className:"icontiny",src:WH.staticUrl+"/images/wow/icons/tiny/"+h.toLowerCase()+".gif"})}f=f||{};return Icon.create(h,Icon.sizeIds.hasOwnProperty(l)?Icon.sizeIds[l]:Icon.sizeIds.medium,null,g===null?false:g,f.num,f.quantity,f.hasOwnProperty("border")?!f.border:undefined,f.rel,f.span)};this.getIconUrl=function(g,f){if(d.indexOf(f)===-1){f=c.MEDIUM}return WH.staticUrl+"/images/wow/icons/"+f+"/"+g.toLowerCase()+(f===c.TINY?".gif":".jpg")};this.getLink=function(f){return f.querySelector("a")};this.isValidSize=function(f){return d.indexOf(f)!==-1};this.setLinkUrl=function(g,f){let link=c.getLink(g);if(link){link.href=f}};this.setName=function(h,g,f){if(!f){c.setTexture(h,null);return}if(g===c.BLIZZARD){g=c.LARGE}c.setTexture(h,WH.staticUrl+"/images/wow/icons/"+g+"/"+f.toLowerCase()+".jpg")};this.setTexture=function(f,g){f.firstChild.style.backgroundPosition="";f.firstChild.style.backgroundImage=g?'url("'+g+'")':""}};var Icon={questionMarkIcon:WH.Icon.UNKNOWN,sizes:["small","medium","large","blizzard"],sizes2:[18,36,56,64],sizeIds:{small:0,medium:1,large:2,blizzard:3},premiumOffsets:[[-56,-36],[-56,0],[0,0],[0,0]],premiumBorderClasses:["-premium","-gold","","-premiumred","-red",""],STANDARD_BORDER:2,privilegeBorderClasses:{uncommon:"-q2",rare:"-q3",epic:"-q4",legendary:"-q5"},idLookupCache:{},create:function(d,w,p,f,l,u,c,v,r){var o=WH.ce(r?"span":"div");var h=WH.ce("ins");var m=WH.ce("del");if(w==null){w=Icon.sizeIds.medium}o.className="icon"+Icon.sizes[w];WH.ae(o,h);if(!c){WH.ae(o,m)}if(d){Icon.setTexture(o,w,d)}if(f){var q=WH.ce("a");q.href=f;if(f.indexOf("wowhead.com")==-1&&f.substr(0,5)=="http:"){q.target="_blank"}WH.ae(o,q)}else{if(d){var t=o.firstChild.style;var g=(t.backgroundImage.indexOf("/avatars/")!=-1);if(!g){if(f!==false){var q=WH.ce("a");q.href="javascript:";WH.ae(o,q);o.onclick=Icon.onClick}}}}if(v&&typeof q!="undefined"){q.rel=v}Icon.setNumQty(o,l,u);return o},createUser:function(f,o,h,d,g,m,c){if(f==2){o=WH.staticUrl+"/uploads/avatars/"+o+".jpg"}var l=Icon.create(o,h,null,d,null,null,m);if(g!=Icon.STANDARD_BORDER){if(Icon.premiumBorderClasses[g]){l.className+=" "+l.className+Icon.premiumBorderClasses[g]}}else{if(c&&Icon.privilegeBorderClasses.hasOwnProperty(c)){l.className+=" "+l.className+Icon.privilegeBorderClasses[c]}}if(f==2){Icon.moveTexture(l,h,Icon.premiumOffsets[h][0],Icon.premiumOffsets[h][1],true)}l.classList.add("icon"+Icon.sizes[h]+"-sprite");return l},getIdFromName:function(c,d){if(Icon.idLookupCache.hasOwnProperty(c)){window.requestAnimationFrame(function(){d(Icon.idLookupCache[c]||undefined)});return}$.ajax({url:"/icon/get-id-from-name",data:{name:c},dataType:"json",success:function(f){Icon.idLookupCache[c]=f;d(f||undefined)}})},getPrivilegeBorder:function(d){var c=false;if(d>=5000){c="uncommon"}if(d>=10000){c="rare"}if(d>=15000){c="epic"}if(d>=25000){c="legendary"}return c},setUrl:function(d,c){if(!c){c="javascript:"}Icon.getLink(d).href=c},setTexture:function(g,f,d){var c=g.firstChild.style;c.backgroundSize="";c.backgroundPosition="";if(!d){c.backgroundImage=null;return}if(d.indexOf("/")!==-1){c.backgroundImage="url("+d+")";c.backgroundSize="contain"}else{let sizeDir=Icon.sizes[f];if(sizeDir==="blizzard"){sizeDir="large"}c.backgroundImage="url("+WH.staticUrl+"/images/wow/icons/"+sizeDir+"/"+d.toLowerCase()+".jpg)"}},moveTexture:function(h,f,c,l,g){var d=h.firstChild.style;d.backgroundSize="";if(c||l){if(g){d.backgroundPosition=c+"px "+l+"px"}else{d.backgroundPosition=(-c*Icon.sizes2[f])+"px "+(-l*Icon.sizes2[f])+"px"}}else{if(d.backgroundPosition){d.backgroundPosition=""}}},setNumQty:function(h,f,l){var d=WH.gE(h,"span");for(var g=0,c=d.length;g<c;++g){if(d[g]){WH.de(d[g])}}if(f!=null&&((f>1&&f<2147483647)||(f.length&&f!="0"&&f!="1"))){d=WH.createTextGlow(f,"q1");d.style.right="0";d.style.bottom="0";d.style.position="absolute";WH.ae(h,d)}if(l!=null&&l>0){d=WH.createTextGlow("("+l+")","q");d.style.left="0";d.style.top="0";d.style.position="absolute";WH.ae(h,d)}},getLink:function(c){return WH.gE(c,"a")[0]},showIconName:function(c){if(c.firstChild){var f=c.firstChild.style;if(f.backgroundImage.length&&(f.backgroundImage.indexOf(WH.staticUrl)>=4||WH.staticUrl=="")){var g=f.backgroundImage.lastIndexOf("/"),d=f.backgroundImage.indexOf(".jpg");if(g!=-1&&d!=-1){Icon.displayIcon(f.backgroundImage.substring(g+1,d))}}}},onClick:function(){Icon.showIconName(this)},displayIcon:function(c){if(!Dialog.templates.icondisplay){Dialog.templates.icondisplay={title:WH.TERMS.icon,width:500,buttons:[["arrow",WH.TERMS.original],["x",WH.TERMS.close]],fields:[{id:"icon",label:WH.TERMS.name_colon,required:1,type:"text",labelAlign:"left",compute:function(g,f,d,l){l.classList.add("icon-dialog-content");var h=this.iconDiv=WH.ce("div");h.update=function(){setTimeout(function(){WH.safeSelect(g)},10);WH.ee(h);WH.ae(h,Icon.create(g.value,2))};WH.ae(h,Icon.create(f,2));WH.ae(l,h);WH.ae(l,g)}},{id:"iconId",label:WH.TERMS.id+WH.TERMS.colon_punct,type:"text",labelAlign:"left",compute:function(g,f,d,h){h.classList.add("icon-dialog-content");g.value="";this.iconIdField=g}},{id:"location",label:" ",required:1,type:"caption",compute:function(l,h,f,d,g){WH.ee(d);d.classList.add("icon-dialog-caption");var m=WH.TERMS.seeallusingicon_format;m=m.replace("$1",'<a href="/items?filter=142;0;'+this.data.icon+'">'+WH.Types.getLowerPlural(WH.Types.ITEM)+"</a>");m=m.replace("$2",'<a href="/spells?filter=15;0;'+this.data.icon+'">'+WH.Types.getLowerPlural(WH.Types.SPELL)+"</a>");m=m.replace("$3",'<a href="/achievements?filter=10;0;'+this.data.icon+'">'+WH.Types.getLowerPlural(WH.Types.ACHIEVEMENT)+"</a>");d.innerHTML=m}}],onInit:function(d){this.updateIcon=this.template.updateIcon.bind(this,d)},onShow:function(d){this.updateIcon();if(location.hash&&location.hash.indexOf("#icon")==-1){this.oldHash=location.hash}else{this.oldHash=""}var f="#icon";var g=(WH.isSet("g_pageInfo")&&g_pageInfo.type&&WH.inArray([3,6,10],g_pageInfo.type)==-1);if(!g){f+=":"+this.data.icon}location.hash=f},onHide:function(d){if(this.oldHash){WH.setHash(this.oldHash)}else{WH.clearHash()}},updateIcon:function(d){this.iconDiv.update();var f=this.iconIdField;Icon.getIdFromName(d.icon.value,function(g){f.value=g||""})},onSubmit:function(d,h,f,g){if(f=="arrow"){var l=window.open(WH.staticUrl+"/images/wow/icons/large/"+h.icon.toLowerCase()+".jpg","_blank");l.focus();return false}return true}}}if(!Icon.icDialog){Icon.icDialog=new Dialog()}Icon.icDialog.show("icondisplay",{data:{icon:c}})},checkPound:function(){if(location.hash&&location.hash.indexOf("#icon")==0){var d=location.hash.split(":");var c=false;if(d.length==2){c=d[1]}else{if(d.length==1&&WH.isSet("g_pageInfo")){switch(g_pageInfo.type){case 3:c=g_items[g_pageInfo.typeId].icon.toLowerCase();break;case 6:c=g_spells[g_pageInfo.typeId].icon.toLowerCase();break;case 10:c=g_achievements[g_pageInfo.typeId].icon.toLowerCase();break}}}if(c){Icon.displayIcon(c)}}}};if(!WH.wowheadRemote){$(document).ready(Icon.checkPound)}WH.jQuery=new function(){this.formatJqxhrMessage=function(c){let messages=[];if(c.status){messages.push("status: ["+c.status+"]")}if(c.statusText){messages.push("statusText: ["+c.statusText+"]")}if(c.responseJSON&&c.responseJSON.error){messages.push("responseJSON.error: ["+c.responseJSON.error+"]")}else{if(c.responseText){messages.push("responseText: ["+c.responseText+"]")}}return messages.join(", ")}};WH.Layout=new function(){const A=this;const D=WH.DOM;var v={vkontakte:"vk",reddit:"reddit-alien"};var w={activeNavItem:null,autoSearchFocus:true,breadcrumb:null,checkedMenuItems:[],elements:{$breadcrumb:$('<div class="breadcrumb"/>'),header:undefined,headerNav:undefined,"header-wrapper":undefined,"main-contents":undefined,"page-content":undefined},forcedFullscreenMode:false,fullscreenMode:undefined,fullscreenModeDefault:false,fullscreenModeNamespace:null,initialized:false,pageName:null};A.addShareLinks=function(J,K){var N=$("<div>",{"class":"share-links"}).prependTo(J);var M=A.getShareServices(K);for(var L=0,I=M.length;L<I;L++){$("<a>",{"class":"fa fa-"+M[L].fontIcon,href:M[L].url,rel:"np",text:WH.Strings.sprintf(WH.TERMS.shareon_format,M[L].name),target:"_blank"}).appendTo(N)}};A.collapseInteriorSidebar=function(){$(".interior-sidebar-wrapper").addClass("collapsed")};A.expandContent=function(){let mainContents=WH.qs(".main-contents");if(mainContents){mainContents.style.minHeight=""}$(".sidebar").closest(".sidebar-wrapper").remove();document.body.dataset.sidebar="false"};A.expandInteriorSidebar=function(){$(".interior-sidebar-wrapper").removeClass("collapsed")};A.expandSite=function(){var J=333;WH.WAS.removeAll();$(".header-expand-site").remove();var K=WH.qs(".main-contents");if(K){K.style.minHeight=""}var I=$(".sidebar");if(I.is(":empty")){I.closest(".sidebar-wrapper").remove();document.body.dataset.sidebar="false"}document.body.classList.add("no-ads-breadcrumb");setTimeout(function(){document.body.classList.remove("has-ads");document.body.classList.add("no-ads")},J+1)};A.expandVideo=function(){WH.de("#main > .blocks");document.body.classList.add("no-horizontal")};A.getBreadcrumb=function(){return w.elements.$breadcrumb};this.getElement=function(I){if(!w.elements.hasOwnProperty(I)){WH.error("Requested unsupported element.",I);return null}if(w.elements[I]===undefined){w.elements[I]=WH.qs("."+I);if(!w.elements[I]){if(document.readyState!=="complete"){w.elements[I]=undefined}else{w.elements[I]=null}}}return w.elements[I]};A.getFullscreenMode=function(){if(w.forcedFullscreenMode){return true}if(w.fullscreenMode===undefined){w.fullscreenMode=o()}return w.fullscreenMode};this.getHeaderHeight=function(){if(WH.Layout.Responsive.isZulInMobileMode()){return 40}var I=WH.Layout.getElement("header-wrapper");if(I){return I.getBoundingClientRect().height}return 0};A.getPageName=function(){return w.pageName||null};A.getShareTypes=function(){var I=["twitter","facebook","reddit"];if(Locale.get().id===LOCALE_RURU){I.unshift("vk")}return I};A.getShareServices=function(K){var N=[];var M=["vkontakte","twitter","facebook","reddit"];for(var L=0,J=M.length;L<J;L++){var I=M[L];if(I==="vkontakte"&&Locale.getId()!==LOCALE_RURU){continue}N.push({type:I,name:WH.TERMS[I],url:A.getShareUrl(I,K),fontIcon:v[I]||I})}return N};A.getShareUrl=function(I,J){var K=encodeURIComponent(J);switch(I){case"facebook":return"https://www.facebook.com/sharer/sharer.php?u="+K;case"reddit":return"//www.reddit.com/submit?url="+K+"&r=wow";case"twitter":return"https://twitter.com/intent/tweet?text=%20"+K+"%20via%20@Wowhead";case"vk":return"https://vk.com/share.php?url="+K;case"link":return J}WH.error("Tried to get the URL to share to an unknown service.",I);return""};A.init=function(){l();var I=h();z();d();WH.Layout.Responsive.init(I);q();w.initialized=true};A.initSidebar=function(){WH.DynamicFixedElement.init("sidebar",".sidebar")};A.locateBreadcrumb=function(){var L=Menu.getFullPath(Menu.getMenu(),w.breadcrumb);if(!L.length){return}if((!g_pageInfo)||(!g_pageInfo.hasOwnProperty("typeId"))){return}var M=new RegExp("\\b"+g_types[g_pageInfo.type]+"="+g_pageInfo.typeId+"\\b");var J=WH.cO(w.breadcrumb);J.pop();var I=false;var K=function(O){J.push(O[0]);if(O[3]&&O[3].length){for(var N=0;N<O[3].length&&!I;N++){K(O[3][N])}}else{I|=(O.length>2)&&M.test(O[2])}if(!I){J.pop()}};K(L.pop());if(I){w.breadcrumb=J;A.updateBreadcrumb()}};A.set=function(I){if(!I){return}var K=false;if(I.hasOwnProperty("activeTab")&&w.activeNavItem!==I.activeTab){w.activeNavItem=typeof I.activeTab==="string"&&I.activeTab.match(/^\d+$/)?parseInt(I.activeTab):I.activeTab;K=true}var J=false;if(I.hasOwnProperty("breadcrumb")&&JSON.stringify(w.breadcrumb)!==JSON.stringify(I.breadcrumb)){w.breadcrumb=I.breadcrumb;J=true}if(I.hasOwnProperty("pageName")){w.pageName=I.pageName}if(I.hasOwnProperty("autoSearchFocus")){w.autoSearchFocus=I.autoSearchFocus}if(w.initialized){if(K){G()}if(J){A.updateBreadcrumb()}}};A.setBodyAttributes=function(){document.body.dataset.env=WH.getDataEnvTerm();document.body.dataset.locale=Locale.getName();document.body.dataset.sidebar=JSON.stringify(!!WH.PageMeta.hasSidebar);document.body.dataset.theme=WH.Theme.getTheme();document.body.dataset.themeType=WH.Theme.getThemeType();document.body.dataset.tree=WH.getDataTreeTerm();document.body.dataset.width=WH.PageMeta.fullWidth?"full":"standard";if(WH.PageMeta.event){document.body.dataset.event=WH.PageMeta.event}if(WH.PageMeta.page){document.body.dataset.page=WH.Strings.slug(WH.PageMeta.page)}t()};A.setForcedFullscreenMode=function(I){let previousSetting=A.getFullscreenMode();w.forcedFullscreenMode=I;if(A.getFullscreenMode()!==previousSetting){t()}else{document.body.dataset.forcedFullscreenMode=JSON.stringify(I)}};A.setFullscreenMode=function(I){let previousSetting=A.getFullscreenMode();w.fullscreenMode=I;let changeName=I?(w.fullscreenModeDefault===false&&r()===false?"Re-enabled":"Enabled"):(w.fullscreenModeDefault===true&&r()===true?"Re-disabled":"Disabled");WH.LocalStorage.set(B(),JSON.stringify(!!I));WH.Track.interactiveEvent("Changed Option","Fullscreen Mode",changeName);if(A.getFullscreenMode()!==previousSetting){t()}};A.setFullscreenModeNamespace=function(J,I){let previousSetting=A.getFullscreenMode();w.fullscreenModeNamespace=J;w.fullscreenModeDefault=(J===null||typeof I!=="boolean")?false:I;w.fullscreenMode=undefined;if(A.getFullscreenMode()!==previousSetting){t()}};A.setTitle=function(I){if(I.indexOf(WH.TERMS.wowhead)===-1){I+=WH.TERMS.hyphen_punct+WH.TERMS.worldofwarcraft}document.title=I};A.showClassicLinkOrRedirect=function(){if(u()){c();return}if(!WH.PageMeta.classicLinkSelector||F()){return}H()};A.toggleFullscreenMode=function(){A.setFullscreenMode(!o())};A.updateBreadcrumb=function(){if(!w.breadcrumb||!w.breadcrumb.length){w.elements.$breadcrumb.detach();setTimeout(function(){if(w.elements.$breadcrumb.is(":empty")){w.elements.$breadcrumb.detach()}},0);return}w.elements.$breadcrumb.empty();if(w.checkedMenuItems.length){$.each(w.checkedMenuItems,function(){this.checked=false;Menu.updateItem(this)});w.checkedMenuItems=[]}var T=Menu.getFullPath(Menu.getMenu(),w.breadcrumb);if(!T.length){return}var Q=T.length-1;var R=[];for(var S=0,O=T.length;S<O;S++){var J=T[S];var N=Menu.getItemOptions(J);J.checked=true;if((J[Menu.ITEM_OPTIONS]&&J[Menu.ITEM_OPTIONS].breadcrumbParent)||(T[S+1]&&T[S+1][Menu.ITEM_OPTIONS]&&T[S+1][Menu.ITEM_OPTIONS].breadcrumbParent)){if(!J[Menu.ITEM_OPTIONS]){J[Menu.ITEM_OPTIONS]={}}J[Menu.ITEM_OPTIONS].checkedFunc=function(V){var U=$("#main-precontents .breadcrumb span a.open");return U.text()===V[Menu.ITEM_LABEL]}}w.checkedMenuItems.push(J);Menu.updateItem(J);var P=f();var L=P;var K;if(typeof Menu.getItemUrl(J)==="string"){K=WH.ensureUrlProtocol(Menu.getItemUrl(J));L=$("<a/>",{href:K,rel:"np"}).appendTo(P)}let text=Menu.getLabel(J,true);L.text(text);Menu.add(L,J.parentMenu);P.appendTo(w.elements.$breadcrumb);R.push({name:text,url:K,image:N.tinyIcon?WH.ensureUrlProtocol(WH.Icon.getIconUrl(N.tinyIcon,WH.Icon.MEDIUM)):undefined});if(N.onBreadcrumbDisplay){N.onBreadcrumbDisplay(w.breadcrumb)}var I=Menu.getSubmenu(J);if(S===Q&&I){P.addClass("breadcrumb-arrow");var M=$('<span class="breadcrumb-ellipsis">...</span>');Menu.add(M,I);M.appendTo(w.elements.$breadcrumb)}}WH.Seo.addJsonLdBreadcrumb(R);w.elements.$breadcrumb.trigger("update");if(!w.elements.$breadcrumb.is(":empty")){w.elements.$breadcrumb.appendTo("#main-precontents");w.elements.$breadcrumb.show()}ZUL.regenerateMenu()};A.updateSearchWidth=function(K){if(!WH.Theme.isStandard()){return}var M=WH.qs(".header");var N=WH.qs(".header-right");var P=WH.qs(".header-user");var Q=WH.qs(".header-search");var I=WH.qs(".header-search form");var R=WH.qs('.header-search input[type="text"]');var O=WH.qs(".header-search-button");if(M&&N&&P&&Q&&I&&R&&O){var J=Q.getBoundingClientRect().left-M.getBoundingClientRect().left;var L=window.getComputedStyle(N).getPropertyValue("left");I.style.position="absolute";I.style.top=O.style.top="10px";I.style.left=O.style.left=(J-parseInt(L))+"px";I.style.right=(N.getBoundingClientRect().right-P.getBoundingClientRect().left)+"px";R.style.width="100%"}if(K!==false){WH.Layout.Responsive.check()}};function g(){let classicSubdomain=WH.Url.getSubdomain(WH.dataEnv.CLASSIC,Locale.getId());let path=location.pathname+location.search;let prefix=(path.indexOf("?")!==-1||path.indexOf("&")!==-1)?"&":"?";path+=prefix+"classicRedirect";path+=location.hash;location.href=WH.Url.generate(path,{subdomain:classicSubdomain})}function F(){return WH.LocalStorage.get("fromClassic")==="true"}function B(){return"fullscreenMode"+(w.fullscreenModeNamespace?"."+w.fullscreenModeNamespace:"")}function p(L){var I=WH.ce("a",{className:L[Menu.ITEM_OPTIONS]&&L[Menu.ITEM_OPTIONS].headerNavIcon?"header-nav-icon":"header-nav-text",href:L[Menu.ITEM_URL],rel:"np"});if(!L[Menu.ITEM_URL]){I.href="javascript:";I.className+=" unlinked"}if(L[Menu.ITEM_OPTIONS]&&L[Menu.ITEM_OPTIONS].className){I.className+=" "+L[Menu.ITEM_OPTIONS].className}if(L[Menu.ITEM_OPTIONS]&&L[Menu.ITEM_OPTIONS].title){I.title=L[Menu.ITEM_OPTIONS].title}var K=Menu.getSubmenu(L);var J=WH.ce("span");WH.ae(I,J);if(L[Menu.ITEM_OPTIONS]&&L[Menu.ITEM_OPTIONS].headerNavIcon){J.classList.add("header-nav-icon-image");if(L[Menu.ITEM_OPTIONS].headerNavIconClass){J.classList.add(L[Menu.ITEM_OPTIONS].headerNavIconClass)}else{if(L[Menu.ITEM_OPTIONS].headerNavIcon.indexOf("/")>-1){J.style.background="url("+WH.staticUrl+L[Menu.ITEM_OPTIONS].headerNavIcon+")"}else{J.style.background="url("+WH.staticUrl+"/images/wow/icons/medium/"+L[Menu.ITEM_OPTIONS].headerNavIcon+".jpg)"}}if(L[Menu.ITEM_OPTIONS].headerNavIconWithName){var M=WH.ce("span",{className:"header-nav-icon-text"});WH.st(M,L[Menu.ITEM_LABEL]);WH.ae(I,M)}}else{WH.st(J,L[Menu.ITEM_LABEL]);if(K&&WH.isClassicTree()){WH.ae(I,WH.ce("span",{className:"fa fa-caret-down"}))}}if(K){Menu.add(I,K,{padded:true})}return I}function f(){w.elements.$breadcrumb.children("span:last").addClass("breadcrumb-arrow");return $("<span/>").appendTo(w.elements.$breadcrumb)}function r(){try{let result=JSON.parse(WH.LocalStorage.get(B()));return typeof result==="boolean"?result:undefined}catch(I){return undefined}}function o(){let mode=r();return mode===undefined?w.fullscreenModeDefault:mode}function H(){let mainContents=WH.ge("main-contents");let target=WH.qs(WH.PageMeta.classicLinkSelector);let position="bottom";if(!target||!D.isVisible(target)){target=WH.qs(".main-contents > .text > .heading-size-1");if(!target||!D.isVisible(target)){if(WH.Layout.Responsive.check()){return}target=mainContents;position="top";if(!target||!D.isVisible(target)){return}}}let targetWidth=D.getWidth(target);if(targetWidth&&targetWidth+230<(D.getWidth(mainContents)||Platform.getViewportWidth())){position="right"}let type=window.g_pageInfo&&g_pageInfo.type?g_pageInfo.type:null;let typeName=WH.Types.hasName(type)?WH.Types.getLowerSingular(type):WH.TERMS.page_lc;let url=WH.Url.generate(location.pathname,{subdomain:WH.Url.getSubdomain(WH.dataEnv.CLASSIC)});let messageFormat=WH.TERMS.classicVersionLink_format;let messageDiv=WH.ce("div",{className:"highlight-classic-link-content"});messageDiv.innerHTML=WH.Strings.sprintf(messageFormat,typeName,'<a href="'+url+'">',"</a>");setTimeout(function(){let highlightId="classic-link-type-"+(type||"other");new WH.Highlight(highlightId,target,messageDiv,{buttonSize:"small","class":"highlight-classic-link",closeButtonText:WH.TERMS.close,extraButtons:[{text:WH.TERMS.wowheadClassic,url:url}],position:position})},250)}function d(){A.updateBreadcrumb()}function m(){if(!WH.Theme.isStandard()){return}requestAnimationFrame(A.updateSearchWidth);if(typeof MutationObserver!=="undefined"){var J=WH.qs(".header");if(J){var I=new MutationObserver(A.updateSearchWidth);I.observe(J,{characterData:true,childList:true,subtree:true})}}}function l(){$(".header-expand-site").attr("href","javascript:").click(WH.Layout.expandSite);WH.qsa(".data-env-links a[title]").forEach(function(I){let linkDataEnv=WH.getDataEnvFromTerm(I.dataset.env);if(WH.getDataEnv()!==linkDataEnv){WH.aE(I,"click",C.bind(I,I,linkDataEnv));WH.aE(I,"mouseover",C.bind(I,I,linkDataEnv));C(I,linkDataEnv)}let title=I.title;if(WH.PageMeta.page==="home"||(WH.PageMeta.page||"").indexOf("news")===0){let newsTypes=linkDataEnv===WH.dataEnv.MAIN?WH.TERMS.newsTypes+WH.TERMS.colon_punct+WH.TERMS.all:WH.TERMS.newsType+WH.TERMS.colon_punct+WH.TERMS[I.dataset.env];title+='<div style="margin-top:10px">'+newsTypes+"</div>"}WH.Tooltip.simple(I,'<span class="no-wrap">'+title+"</span>",I.href?"q2":"q");I.title=""});$(".header-theme-switcher a").click(function(){if(this.classList.contains("current")){return}this.classList.remove("fa-square");this.classList.add("fa-refresh");this.classList.add("fa-spin");if(!WH.User.isLoggedIn()){window.location="/account=signin?next="+encodeURIComponent(window.location.pathname+(window.location.hash?"#"+window.location.hash:""));return}WH.Theme.set(this.dataset.theme)})}function h(){var X=A.getElement("header");if(!X){return}var Z=WH.ce("div",{className:"header-nav-wrapper"});WH.ae(X,Z);w.elements.headerNav=WH.ce("div",{className:"header-nav"});WH.ae(Z,w.elements.headerNav);var K=Menu.getMenu();var J=[];var L=[];for(var W=0,N;N=K[W];W++){if(N[Menu.ITEM_OPTIONS]&&(N[Menu.ITEM_OPTIONS].breadcrumbOnly||N[Menu.ITEM_OPTIONS].hide)){continue}var V=WH.ce("a",{dataset:{id:N[Menu.ITEM_NAME]}});WH.st(V,N[Menu.ITEM_LABEL]);if(N[Menu.ITEM_OPTIONS]){if(N[Menu.ITEM_OPTIONS].collapseOrder){V.dataset.collapseOrder=N[Menu.ITEM_OPTIONS].collapseOrder;L.push(V)}if(N[Menu.ITEM_OPTIONS].rel){V.rel=N[Menu.ITEM_OPTIONS].rel}}var T=$(V);Menu.linkifyItem(N,T);V.menuItem=N;T.data("menuItem",N);J.push(V);WH.ae(w.elements.headerNav,V)}G();var M=p([null,"",null,null,{className:"header-nav-ellipsis"}]);var aa=WH.ce("span",{className:"fa fa-ellipsis-h"});WH.ae(M.firstElementChild,aa);WH.ae(w.elements.headerNav,M);var Y=WH.ce("div",{className:"header-nav-features"});WH.ae(Z,Y);var O=Menu.getFeaturedNavigationMenu();var R=[];for(var U=0,Q;Q=O[U];U++){var S=p(Q);S.menuItem=Q;R.push(S);WH.ae(Y,S)}var P=p([null,"",null,null,{className:"header-nav-ellipsis"}]);var I=WH.ce("span",{className:"fa fa-ellipsis-h"});WH.ae(P.firstElementChild,I);WH.ae(Y,P);L.sort(function(ac,ab){return ac.menuItem[Menu.ITEM_OPTIONS].collapseOrder-ab.menuItem[Menu.ITEM_OPTIONS].collapseOrder});return{headerWrapper:X.parentNode,navWrapper:Z,nav:w.elements.headerNav,navEllipsis:M,navLinks:J,collapsibleNavLinks:L,featuredNav:Y,featuredLinks:R,featuredEllipsis:P}}function z(){var M=$(".header-search");if(M.length){var L=$('input[type="text"]',M).focus(function(){WH.qs(".header-search").dataset.hasFocus=true}).blur(function(){WH.qs(".header-search").dataset.hasFocus=false});var K=$("body");if(K.hasClass("home")){WH.safeFocus(L)}if(WH.LocalStorage.get("showRandomWidget")==="true"){WH.LocalStorage.remove("showRandomWidget");var N=WH.qs(".header-nav dl");if(N){var J=WH.ce("a",{className:"header-search-random fa fa-random fa-no-padding",href:"/random"});WH.Tooltip.simple(J,WH.TERMS.anotherrandompage_exclamation,"q2");var I=WH.ce("dt");WH.ae(I,J);WH.ae(N,I)}}$("<a/>",{"class":"header-search-button fa fa-search",href:"javascript:"}).click(E).appendTo(M);$("form",M).submit(WH.preventEmptyFormSubmission);LiveSearch.attach(L);if(Array.prototype.indexOf&&w.autoSearchFocus){K.keydown((function(P,O){if(!O.ctrlKey&&!O.metaKey&&!O.altKey&&WH.keyPressIsAlphaNumeric(O)&&(!document.activeElement||(["INPUT","SELECT","TEXTAREA"].indexOf(document.activeElement.tagName)==-1&&!document.activeElement.isContentEditable))){if(P.offset().top>=(window.scrollY||window.pageYOffset)){P.focus()}}}).bind(null,L))}m()}}function q(){if(WH.getGets().hasOwnProperty("classicRedirect")&&!WH.isRetailTree()){if(window.history&&window.history.replaceState){window.history.replaceState({},"",location.pathname.replace(/[?&]classicRedirect$/,"")+location.search.replace(/[?&]classicRedirect$/,"")+location.hash)}setTimeout(function(){let liveSelector='.data-env-links [data-env="live"]';new WH.Highlight("highlight-retail",liveSelector,WH.Strings.sprintf(WH.TERMS.returnToRetail_tip,WH.TERMS[WH.getDataTreeTerm()]),{extraButtons:[{text:WH.Strings.sprintf(WH.TERMS.backTo_format,WH.qs(liveSelector).textContent.trim()),url:WH.qs(liveSelector).href}],position:"bottom"})},250)}}function E(){var I=$(this).siblings("form").submit().children("input");WH.safeFocus(I)}function u(){if(!(WH.isRetailTree()&&WH.getGets().hasOwnProperty("fromClassic"))){return false}if(window.history&&window.history.replaceState){window.history.replaceState({},"",location.pathname.replace(/[?&]fromClassic$/,"")+location.search.replace(/[?&]fromClassic$/,"")+location.hash)}return true}function c(){WH.LocalStorage.set("fromClassic",JSON.stringify(true))}function C(I,J){if(I.classList.contains("disabled")){delete I.href;return}let url=location.pathname+location.search;if(WH.isClassicTree()&&location.pathname!=="/"){url+=(url.match(/[?&]/)?"&":"?")+"fromClassic"}if(WH.isBurningCrusadeTree()&&location.pathname!=="/"){url+=(url.match(/[?&]/)?"&":"?")+"fromBurningCrusade"}url+=location.hash;I.href=WH.Url.generate(url,{dataEnv:J})}function t(){let fullscreenMode=A.getFullscreenMode();let fullscreenModeJson=JSON.stringify(fullscreenMode);let modeChanged=document.body.dataset.fullscreenMode&&document.body.dataset.fullscreenMode!==fullscreenModeJson;document.body.dataset.fullscreenMode=fullscreenModeJson;document.body.dataset.forcedFullscreenMode=JSON.stringify(w.forcedFullscreenMode);let headerToggleText=WH.qs(".header-user-fullscreen span");if(headerToggleText){WH.st(headerToggleText,fullscreenMode?WH.TERMS.exitFullscreen:WH.TERMS.fullscreen)}if(modeChanged){Menu.hide(true);WH.Tooltip.hide();if(fullscreenMode){WH.Layout.Responsive.disableNavScrollLimit()}}WH.Layout.Responsive.check(true);WH.WAS.updateSkinPosition()}function G(){if(!w.elements.headerNav){return}var O=Menu.getMenu();for(var L=0,I=O.length;L<I;L++){var N=O[L];var K=WH.qs('a[data-id="'+N[Menu.ITEM_NAME]+'"]',w.elements.headerNav);if(!K){return}var J=Platform.isTouch();if(N[Menu.ITEM_NAME]===w.activeNavItem){K.classList.add(J?"active-touch":"active")}else{K.classList.remove(J?"active-touch":"active")}var M=Menu.getSubmenu(N);if(M){if(J){Menu.addTouch(K,M)}else{Menu.add(K,M,{padded:true})}}}}};window.Lightbox=new function(){const p=this;const o=WH.DOM;const g=WH.Tooltip;this.UI_HEIGHT=52;this.UI_WIDTH=20;const l={callbacks:{onHide:undefined,onResize:undefined,onShow:undefined},elements:{frames:{},inner:undefined,outer:undefined},initialized:false,lastId:undefined};this.hide=function(){if(!l.initialized||!p.isVisible()){return}d();if(l.callbacks.onHide){l.callbacks.onHide()}WH.displayNone(l.elements.outer);l.elements.inner.style.width="";Menu.hide(true);g.hide();WH.WAS.restoreHidden();PoundChecker.resume();WH.preventScroll(false)};this.isVisible=function(){return!!l.elements.outer&&o.isVisible(l.elements.outer)};this.reveal=function(){WH.displayDefault(l.elements.frames[l.lastId]);WH.displayDefault(l.elements.outer)};this.setSize=function(q){l.elements.inner.style.width=q+"px"};this.show=function(t,q,r){q=q||{};l.callbacks.onHide=q.onHide;l.callbacks.onResize=q.onResize;l.callbacks.onShow=q.onShow;Menu.hide(true);g.hide();WH.WAS.hideAll();PoundChecker.pause();m();f();if(l.lastId!==t&&l.elements.frames[l.lastId]){WH.displayNone(l.elements.frames[l.lastId])}l.lastId=t;let frame=l.elements.frames[t];let first=!frame;if(first){frame=WH.ce("div",{className:"lightbox-frame"});WH.ae(l.elements.inner,frame);l.elements.frames[t]=frame}if(l.callbacks.onShow){l.callbacks.onShow(frame,first,r)}p.reveal();WH.preventScroll(true,".lightbox-content")};this.showPicker=function(r,q,t){r+="-picker";Lightbox.show(r,{onShow:function(u,v){Lightbox.setSize(800);let listview;if(v){u.classList.add(r);WH.ae(u,WH.ce("div",{className:"lightbox-content listview",id:"lv-"+r}));let a=WH.ce("a",{className:"dialog-option fa fa-times",href:"javascript:"},WH.ct(WH.TERMS.close));WH.aE(a,"click",Lightbox.hide);WH.ae(u,a);q.id=r;listview=new Listview(q)}if(t){t(u,v,listview)}}})};function f(){WH.aE(document,"keydown",h);WH.aE(window,"resize",c)}function m(){if(l.initialized){return}l.initialized=true;l.elements.inner=WH.ce("div",{className:"lightbox-inner"});l.elements.outer=WH.ce("div",{className:"lightbox-outer",style:{display:"none"}},l.elements.inner);WH.ae(document.body,l.elements.outer);let preventHide=false;let innerClicked=false;let outerClicked=false;WH.aE(l.elements.inner,"mousedown",function(){innerClicked=true;preventHide=true});WH.aE(l.elements.inner,"mouseup",function(){innerClicked=false;preventHide=true});WH.aE(l.elements.outer,"mousedown",function(){outerClicked=true;if(innerClicked){innerClicked=false;preventHide=true}else{preventHide=false}});WH.aE(l.elements.outer,"mouseup",function(q){if(!outerClicked){return}outerClicked=false;if(!preventHide&&q.target===l.elements.outer){p.hide()}})}function h(q){if(q.key==="Escape"){p.hide()}}function c(){if(l.callbacks.onResize){l.callbacks.onResize()}}function d(){WH.dE(document,"keydown",h);WH.dE(window,"resize",c)}};WH.Links=new function(){this.show=function(u,t,r){u.blur();if(u.addedLinksMenu){return}let links=[];if(WH.User.hasRole(U_GROUP_STAFF)){var v=WH.Strings.sprintf(WH.TERMS.parens_format,WH.TERMS.clickToCopy,WH.TERMS.staffemployees);links.push([0,v,null,null,{heading:true}]);if(u.dataset.displayId){links.push([0,"Display ID",function(){let viewIn3dButton=WH.ge("wh-mv-view-in-3d-button");let displayId=viewIn3dButton&&viewIn3dButton.dataset.mvDisplayId||u.dataset.displayId;WH.copyToClipboard(displayId,true)}])}if(u.dataset.modelMarkup){links.push([0,"Model Markup",WH.copyToClipboard.bind(null,u.dataset.modelMarkup,true)])}}links.push([0,WH.TERMS.clickToCopy,null,null,{heading:true}]);links.push([0,WH.TERMS.link,WH.copyToClipboard.bind(null,location.href,true),null,{fontIcon:"link"}]);let markupTag=c(t);if(markupTag){links.push([0,WH.TERMS.wowheadMarkupTag,WH.copyToClipboard.bind(null,markupTag,true),null,{icon:"/images/logos/favicon-16.png"}])}let linkCommand=f(t);if(linkCommand){links.push([0,WH.TERMS.inGameLink,WH.copyToClipboard.bind(null,linkCommand,true),null,{icon:"/images/icons/wow.png"}])}let dressingRoomCommand=h(t);if(dressingRoomCommand){links.push([0,WH.TERMS.inGameDressingRoomCommand,WH.copyToClipboard.bind(null,dressingRoomCommand,true),null,{icon:"/images/icons/wow.png"}])}let soundCommand=l(t);if(soundCommand){links.push([0,WH.TERMS.inGameSoundCommand,WH.copyToClipboard.bind(null,soundCommand,true),null,{icon:"/images/icons/wow.png"}])}let mogItImportString=g(t);if(mogItImportString){links.push([0,WH.TERMS.mogItImportString,WH.copyToClipboard.bind(null,mogItImportString,true),null,{fontIcon:"code"}])}let simCraftImportString=m(t);if(simCraftImportString){links.push([0,WH.TERMS.simulationCraftImportString,WH.copyToClipboard.bind(null,simCraftImportString,true),null,{fontIcon:"code"}])}if(t.typeId){links.push(Menu.createItem({name:"",label:WH.TERMS.id,url:WH.copyToClipboard.bind(null,t.typeId,true),options:{fontIcon:"hashtag"}}))}links.push([0,WH.TERMS.share,null,null,{heading:true}]);var q=WH.Layout.getShareServices(location.href);for(var p=0,o=q.length;p<o;p++){links.push([0,q[p].name,q[p].url,null,{fontIcon:q[p].fontIcon,newWindow:true}])}u.addedLinksMenu=true;Menu.add(u,links,{showAtElement:true,showImmediately:true},r)};function h(r){if(!r.dressup||!r.dressup.length){return null}var t='/run local function f(i,b)DressUpItemLink("item:"..i.."::::::::::::9:"..b);end;';for(var q=0,p=r.dressup.length;q<p;q++){var o=r.dressup[q].slice(0);while(o.length<2){o.push(0)}t+="f("+o.shift()+","+(o.length>1?('"'+o.join(":")+'"'):o.shift())+");"}return t}function f(p){if(!(p.linkColor&&p.linkId&&p.linkName)){return null}var o=p.linkName.replace(/:+$/,"").replace(/"/g,'\\"');return'/script DEFAULT_CHAT_FRAME:AddMessage("\\124c'+p.linkColor+"\\124H"+p.linkId+"\\124h["+o+']\\124h\\124r");'}function l(o){return o.sound?"/script PlaySound("+o.sound+")":null}function c(p){if(!(p.type&&p.typeId)){return null}var o=WH.markup.getTagByEntityType(p.type);if(!o){return null}return"["+o+"="+p.typeId+(p.bonuses&&p.bonuses.length?" bonus="+p.bonuses.join(":"):"")+(p.spec?" spec="+p.spec:"")+"]"}function g(t){if(!t.dressup||!t.dressup.length){return null}var r="";for(var q=0,p=t.dressup.length;q<p;q++){var o=t.dressup[q];if(o[0]){r+=(r?":":"compare?items=")+o[0];if(o[1]){r+=".0.0.0.0.0.0.0.0.0."+o[1]}}}return r||null}function m(p){if(p.type!==WH.Types.ITEM||!p.slot){return null}var o=d(parseInt(p.slot));if(!o){return null}var q=o+"="+p.linkName.toLowerCase().replace(/['.]/g,"").replace(/\W/g,"_")+",id="+p.typeId;if(p.bonuses&&p.bonuses.length&&p.bonuses[0]!=0){q+=",bonus_id="+p.bonuses.join("/")}if(p.dropLevel){q+=",drop_level="+p.dropLevel}return q}function d(p){for(var o in g_character_slots_data){if(g_character_slots_data.hasOwnProperty(o)&&g_character_slots_data[o].itemSlots.indexOf(p)!==-1){return g_character_slots_data[o].simCraftName||g_character_slots_data[o].name}}return null}};window.g_listviews={};function Listview(c){if(!this.initialSetupComplete){WH.cO(this,c);if(typeof this.tabs==="string"){this.tabs=window[this.tabs]}if(this.id){let divId=(this.tabs?"tab-":"lv-")+this.id;if(this.parent){this.container=WH.ce("div",{id:divId});WH.ae(WH.ge(this.parent),this.container)}else{this.container=WH.ge(divId)}if(this.tabs){this.container.style.display="none"}}else{return}g_listviews[this.id]=this;if(this.tabs){this.tabIndex=this.tabs.add(this.getTabName(),$.extend({id:this.id,onLoad:this.initialize.bind(this),onShow:(function(){this.updateTileSizes();this.writeHash()}).bind(this)},this.tabOpts));this.tabClick=Tabs.trackClick.bind(this.tabs,this.tabs.tabs[this.tabIndex])}this.initialSetupComplete=true}if(!this.template){WH.error("Every listview requires a template");return}if(typeof this.template==="string"){this.loadingTemplate=true;Listview.loadTemplate(this.template,(function(){this.template=Listview.templates[this.template];delete this.loadingTemplate;Listview.call(this,c)}).bind(this));return}if((WH.getGets().debug!=null||g_user.debug)&&g_user.roles&U_GROUP_STAFF){this.debug=true}if(this.data==null){this.data=[]}if(!this.hasOwnProperty("hash")){if(this.template.hasOwnProperty("hash")){this.hash=this.template.hash}else{this.hash=Listview.HASH_FULL}}this.lockHash=true;if(this.searchable==null){if(this.template.searchable!=null){this.searchable=this.template.searchable}else{this.searchable=false}}if(this.filtrable==null){if(this.template.filtrable!=null){this.filtrable=this.template.filtrable}else{this.filtrable=false}}if(this.sortable==null){if(this.template.sortable!=null){this.sortable=this.template.sortable}else{this.sortable=true}}this.specialHashes={};if(this.data.length===1){this.filtrable=false;this.searchable=false;this.sortable=false}if(this.searchable&&this.searchDelay==null){if(this.template.searchDelay!=null){this.searchDelay=this.template.searchDelay}else{this.searchDelay=333}}if(this.clickable==null){if(this.template.clickable!=null){this.clickable=this.template.clickable}else{this.clickable=true}}if(this.hideBands==null){this.hideBands=this.template.hideBands}if(this.hideNav==null){this.hideNav=this.template.hideNav}if(this.hideHeader==null){this.hideHeader=this.template.hideHeader}if(this.hideCount==null){this.hideCount=this.template.hideCount}if(this.computeDataFunc==null&&this.template.computeDataFunc!=null){this.computeDataFunc=this.template.computeDataFunc}if(this.createCbControls==null&&this.template.createCbControls!=null){this.createCbControls=this.template.createCbControls}if(this.createTooltipToggle==null&&this.template.createTooltipToggle!=null){this.createTooltipToggle=this.template.createTooltipToggle}if(this.template.onBeforeCreate!=null){if(this.onBeforeCreate==null){this.onBeforeCreate=this.template.onBeforeCreate}else{this.onBeforeCreate=[this.template.onBeforeCreate,this.onBeforeCreate]}}if(this.onAfterCreate==null&&this.template.onAfterCreate!=null){this.onAfterCreate=this.template.onAfterCreate}if(this.onNoData==null&&this.template.onNoData!=null){this.onNoData=this.template.onNoData}if(this.createNote==null&&this.template.createNote!=null){this.createNote=this.template.createNote}if(this.template.sortOptions){this.sortOptions=[];WH.cOr(this.sortOptions,this.template.sortOptions)}if(this.customFilter==null&&this.template.customFilter!=null){this.customFilter=this.template.customFilter}if(this.onSearchSubmit==null&&this.template.onSearchSubmit!=null){this.onSearchSubmit=this.template.onSearchSubmit}if(this.getItemLink==null&&this.template.getItemLink!=null){this.getItemLink=this.template.getItemLink}if(this.noRowClick==null&&this.template.noRowClick!=null){this.noRowClick=this.template.noRowClick}if(this.forceBandTop==null&&this.template.forceBandTop!=null){this.forceBandTop=this.template.forceBandTop}if(this.completionText==null&&this.template.completionText!=null){this.completionText=this.template.completionText}if(this.completionText==null){this.completionText=LANG.lvcompletion}if(this.clip==null&&this.template.clip!=null){this.clip=this.template.clip}if(this.clip||this.template.compute||this.id==="topics"||this.id==="recipes"||this.template.noDebug){this.debug=false}if(this.mode==null){this.mode=this.template.mode}if(this.alternateVersions==null){this.alternateVersions=this.template.alternateVersions}if(this.template.noStyle!=null){this.noStyle=this.template.noStyle}if(this.nItemsPerPage==null){if(this.template.nItemsPerPage!=null){this.nItemsPerPage=this.template.nItemsPerPage}else{this.nItemsPerPage=50}}this.nItemsPerPage|=0;if(this.nItemsPerPage<=0){this.nItemsPerPage=0}if(this.validateHashPagination==null){this.validateHashPagination=true}this.resetRowVisibility();if(this.mode===Listview.MODE_CALENDAR){this.dates=[];this.nItemsPerPage=1;this.nDaysPerMonth=[];if(this.template.startOnMonth!=null){this.startOnMonth=this.template.startOnMonth}else{this.startOnMonth=new Date()}this.startOnMonth.setDate(1);this.startOnMonth.setHours(0,0,0,0);if(this.nMonthsToDisplay==null){if(this.template.nMonthsToDisplay!=null){this.nMonthsToDisplay=this.template.nMonthsToDisplay}else{this.nMonthsToDisplay=1}}let year=this.startOnMonth.getFullYear();let month=this.startOnMonth.getMonth();for(let i=0;i<this.nMonthsToDisplay;++i){let date=new Date(year,month+i,32);this.nDaysPerMonth[i]=32-date.getDate();for(let j=1;j<=this.nDaysPerMonth[i];++j){this.dates.push({date:new Date(year,month+i,j)})}}if(this.template.rowOffset!=null){this.rowOffset=this.template.rowOffset}}this.columns=[];for(let i=0,len=this.template.columns.length;i<len;++i){let col={};WH.cO(col,this.template.columns[i]);this.columns.push(col)}if(this.extraCols!=null){for(let i=0,len=this.extraCols.length;i<len;++i){let pos=null;let col=this.extraCols[i];if(typeof col==="string"){if(!Listview.extraCols.hasOwnProperty(col)){WH.error("Unknown extraCol ["+col+"].");continue}col=Listview.extraCols[col]}if(!col){WH.error("Could not find the requested listview column:",this.extraCols[i]);continue}if(col.after||col.before){let index=WH.inArray(this.columns,col.after?col.after:col.before,function(d){return d.id});if(index!==-1){pos=(col.after?index+1:index)}}if(pos==null){pos=this.columns.length}if(col.id===Listview.COLUMN_ID_DEBUG_ID){this.columns.splice(0,0,WH.cO({},col))}else{this.columns.splice(pos,0,WH.cO({},col))}if(!this.sortOptions){continue}pos=null;if(col.hasOwnProperty("sortOptionsPosition")){switch(col.sortOptionsPosition){case Listview.SORT_OPTIONS_FIRST:pos=0;break}}else{if(col.after||col.before){let index=WH.inArray(this.sortOptions,col.after?col.after:col.before,function(d){return d.id});if(index!==-1){pos=col.after?index+1:index}}}if(pos==null){pos=this.sortOptions.length}if(col.id===Listview.COLUMN_ID_DEBUG_ID){this.sortOptions.splice(0,0,col)}else{this.sortOptions.splice(pos,0,col)}}}this.visibility=[];let visibleCols=[];let hiddenCols=[];if(this.visibleCols!=null){WH.arrayWalk(this.visibleCols,function(d){visibleCols[d]=1})}if(this.hiddenCols!=null){WH.arrayWalk(this.hiddenCols,function(d){hiddenCols[d]=1})}if(Array.isArray(this.sortOptions)){for(let i=0,len=this.sortOptions.length;i<len;++i){let col=this.sortOptions[i];col.__index=i;if(visibleCols[col.id]!=null||(!col.hidden&&hiddenCols[col.id]==null)){this.visibility.push(i)}}}else{for(let i=0,len=this.columns.length;i<len;++i){let col=this.columns[i];col.__index=i;if(visibleCols[col.id]!=null||(!col.hidden&&hiddenCols[col.id]==null)){this.visibility.push(i)}}}if(this.sort==null&&this.template.sort){this.sort=this.template.sort.slice(0)}if(this.sort!=null){let sortParam=this.sort;this.sort=[];for(let i=0,len=sortParam.length;i<len;++i){let col=parseInt(sortParam[i]);if(isNaN(col)){let desc=0;if(sortParam[i].charAt(0)==="-"){desc=1;sortParam[i]=sortParam[i].substring(1)}let index=WH.inArray(this.columns,sortParam[i],function(d){return d.id});if(index!==-1){if(desc){this.sort.push(-(index+1))}else{this.sort.push(index+1)}}}else{this.sort.push(col)}}}else{this.sort=[]}if(this.debug){this.columns.splice(0,0,{id:Listview.COLUMN_ID_DEBUG_ID,name:WH.TERMS.id,width:"5%",compute:function(d,f){if(d.id){let pre=WH.ce("pre",{style:{display:"inline",margin:"0"}},WH.ct(d.id));WH.clickToCopy(pre);WH.ae(f,pre)}},getVisibleText:function(d){return d.id||""},getValue:function(d){return d.id||0},sortFunc:function(f,d,g){if(f.id==null){return-1}else{if(d.id==null){return 1}}return WH.stringCompare(f.id,d.id)}});for(let i=0,column;column=this.columns[i];i++){column.__index=i}this.visibility.splice(0,0,-1);for(let i=0,len=this.visibility.length;i<len;++i){this.visibility[i]=this.visibility[i]+1}for(let i=0,len=this.sort.length;i<len;++i){if(this.sort[i]<0){this.sort[i]=this.sort[i]-1}else{this.sort[i]=this.sort[i]+1}}}this.originalSort=JSON.parse(JSON.stringify(this.sort));for(let colIndex=0,column;column=this.columns[colIndex];++colIndex){column.actions=column.actions||[]}this.Filters=new Listview.Filters(this);if(!this.tabs||this.tabsCalledInitialize){this.initialize()}}Listview.COLUMN_ID_COMPLETION="completed";Listview.COLUMN_ID_DEBUG_ID="debug-id";Listview.COLUMN_ID_POPULARITY="popularity";Listview.COLUMN_TYPE_NUMBER="number";Listview.COLUMN_TYPE_RANGE="range";Listview.COLUMN_TYPE_TEXT="text";Listview.HASH_DISABLED=0;Listview.HASH_FULL=1;Listview.HASH_SIMPLE=2;Listview.SORT_OPTIONS_FIRST=0;Listview.MODE_DEFAULT=0;Listview.MODE_CHECKBOX=1;Listview.MODE_DIV=2;Listview.MODE_TILED=3;Listview.MODE_CALENDAR=4;Listview.prototype={addOptions:function(d,c){c=c||{};c.className="listview-note-options";let wrapper=WH.ce("div",c);WH.ae(this.getNoteTopDiv(),wrapper);for(let i=0,option;option=d[i];i++){let optionDiv=WH.ce("div",{className:"listview-note-options-option"});let label=WH.ce("label",undefined,WH.ct(option.label));if(option.option.nodeType===Node.ELEMENT_NODE&&/^(input|select|textarea|button|object)$/.test(option.option.tagName.toLowerCase())){if(!option.option.id){option.option.id="listview-option-"+WH.Strings.guid()}label.htmlFor=option.option.id}else{label.style.cursor="default"}WH.ae(optionDiv,label);WH.ae(optionDiv,WH.ce("div",undefined,option.option));WH.ae(wrapper,optionDiv)}},initialize:function(){const c=this;if(this.loadingTemplate){this.tabsCalledInitialize=true;return}delete this.tabsCalledInitialize;if(this.data.length){if(this.computeDataFunc!=null){for(let i=0,len=this.data.length;i<len;++i){this.computeDataFunc(this.data[i])}}}let obcResult;if(this.onBeforeCreate!=null){if(typeof this.onBeforeCreate=="function"){obcResult=this.onBeforeCreate()}else{for(let i=0;i<this.onBeforeCreate.length;++i){(this.onBeforeCreate[i].bind(this))()}}}this.noData=WH.ce("div");this.noData.className="listview-nodata text";this.createMainContainer();this.createBands();if(this.customFilter!=null){this.Filters.applyDataOnly()}if(this.tabs){if(this.tabs.poundedTab===this.tabIndex){this.readHash()}}else{this.readHash()}this.applySort();this.updateNav();this.refreshRows(true);this.updateBrowseSession();if(!c.clip&&c.scrollerVertical&&c.bandTop&&c.bandBot){c.updateScrollEnhancements();WH.aE(window,"resize",c.updateScrollEnhancements.bind(c));WH.aE(window,"scroll",c.updateScrollEnhancements.bind(c))}if(this.onAfterCreate){this.onAfterCreate(obcResult)}this.lockHash=false},createHeader:function(){let tr=WH.ce("tr");if(this.mode===Listview.MODE_CHECKBOX){let th=WH.ce("th",{style:{width:"33px"}});WH.ae(tr,th);let div=WH.ce("div");WH.ae(th,div);let a=WH.ce("a",{className:"listview-cb"},WH.ct(WH.Strings.nbsp));WH.ae(div,a)}for(let i=0,len=this.visibility.length;i<len;++i){let realI=this.visibility[i];let col=this.sortOptions?this.sortOptions[realI]:this.columns[realI];let th=WH.ce("th");let outerSpan=WH.ce("span");let innerSpan=WH.ce("span");let div=WH.ce("div");let a=WH.ce("a");col.__th=th;if(this.Filters.isColumnFiltered(col)){th.classList.add("q5")}if(col.actions&&col.actions.length){a.href="javascript:";a.onclick=a.oncontextmenu=Listview.onColumnHeaderClick.bind(this,col,realI)}else{if(this.sortable&&(col.sortable==null||col.sortable)){a.href="javascript:";a.onclick=this.sortBy.bind(this,realI+1,false)}}if(a.onclick){if(!Platform.isTouch()){a.onmouseover=Listview.onColumnHeaderHover.bind(this,a,col);a.onmouseout=WH.Tooltip.hide}}else{a.className="static"}if(col.width!=null){th.style.width=col.width}if(col.align!=null){th.style.textAlign=col.align}if(col.span!=null){th.colSpan=col.span}WH.ae(innerSpan,WH.ct(col.name?col.name:WH.Strings.nbsp));WH.ae(outerSpan,innerSpan);WH.ae(a,outerSpan);WH.ae(div,a);WH.ae(th,div);WH.ae(tr,th)}if(this.hideHeader){this.thead.style.display="none"}WH.ae(this.thead,tr)},createSortOptions:function(c){if(!Array.isArray(this.sortOptions)){return}let currentSort=null;if(Array.isArray(this.sort)){currentSort=this.sort[0]}let links=[];for(let i=0;i<this.sortOptions.length;i++){if(this.sortOptions[i].hidden){continue}let a=WH.ce("a",{href:"javascript:"});a.innerHTML=this.sortOptions[i].name;a.onclick=this.sortGallery.bind(this,a,i+1);if(currentSort===i+1){a.className="active"}links.push(a)}let choices=WH.ce("span",{className:"listview-sort-options-choices"});for(let i=0;i<links.length;i++){WH.ae(choices,links[i])}let options=WH.ce("div",{className:"listview-sort-options"},WH.ct(WH.TERMS.sortby_colon));WH.ae(options,choices);WH.aef(c,options)},getSpecialHash:function(c){let prefix=c+":";let hashParts=location.hash.substr(1).split(";");for(let i=0,len=hashParts.length;i<len;i++){if(hashParts[i].indexOf(prefix)===0){return hashParts[i].substr(prefix.length)}}return undefined},getSpecialHashesString:function(){let specialHashes=[];for(let namespace in this.specialHashes){if(this.specialHashes.hasOwnProperty(namespace)){specialHashes.push(namespace+":"+this.specialHashes[namespace])}}return specialHashes.join(";")},isColumnVisible:function(c){return this.visibility.indexOf(c.__index)!==-1},removeSpecialHash:function(c){delete this.specialHashes[c];let prefix=c+":";let hashParts=location.hash.substr(1).split(";").filter(function(d){return d.substr(0,prefix.length)!==prefix});location.hash=hashParts.join(";")},setSpecialHash:function(c,d){this.specialHashes[c]=d},sortGallery:function(c,d){let $a=$(c);$a.siblings("a").removeClass("active");$a.addClass("active");this.sortBy(d)},createBands:function(){let bandTop=WH.ce("div");let bandBot=WH.ce("div");let noteTop=WH.ce("div");let noteBot=WH.ce("div");this.bandTop=bandTop;this.bandBot=bandBot;this.noteTop=noteTop;this.noteBot=noteBot;bandTop.className="listview-band-top";bandBot.className="listview-band-bottom";this.navTop=this.createNav(true);this.navBot=this.createNav(false);noteTop.className=noteBot.className="listview-note";if(this.note){noteTop.innerHTML=this.note}else{if(this.createNote){this.createNote(noteTop,noteBot)}}this.createSortOptions(noteTop);if(this.debug){let copyIdsLink=WH.ce("a",undefined,WH.ct("CSV"));WH.clickToCopy(copyIdsLink,(function(c){return c.data.map(function(d){if(!d.__hidden){return d.id}}).join(", ")}).bind(null,this));if(noteTop.innerHTML){WH.ae(noteTop,WH.ct(" ("));WH.ae(noteTop,copyIdsLink);WH.ae(noteTop,WH.ct(")"))}else{WH.ae(noteTop,copyIdsLink)}}if(this._errors){let b=WH.ce("b",{className:"q10 fa fa-exclamation-triangle fa-size-s"},WH.ct(WH.TERMS.error));if(noteTop.innerHTML){b.style.marginLeft="10px"}let small=WH.ce("small");WH.Tooltip.simple(small,WH.TERMS.invalidfilters_tip,"q");WH.ae(small,b);WH.ae(noteTop,small)}if(!noteTop.firstChild&&!(this.createCbControls||this.mode===Listview.MODE_CHECKBOX)){WH.ae(noteTop,WH.ct(WH.Strings.nbsp))}if(!(this.createCbControls||this.mode===Listview.MODE_CHECKBOX)){WH.ae(noteBot,WH.ct(WH.Strings.nbsp))}WH.ae(bandTop,this.navTop);let filterOptionsLink=this.Filters.getOptionsToggle();if(filterOptionsLink){WH.ae(bandTop,filterOptionsLink)}WH.ae(bandTop,noteTop);if(this.showLootSpecs){this.classSelectorDiv=WH.ce("div");this.classSelectorDiv.id="class-selector";this.classSelectorDiv.style.paddingLeft="3px";let classSelectors="";classSelectors+='<div id="class-selector-c0" class="iconmedium active"><ins><span style="text-align: center; line-height: 30px; height: 30px; width: 30px;">'+WH.TERMS.all+'</span></ins><span><img src="'+WH.staticUrl+'/images/Icon/medium/border/default.png" /></span><a href="javascript:" data-classid="0"></a></div>';for(let classId in g_file_classes){classSelectors+='<div id="class-selector-c'+classId+'" class="iconmedium"><ins><img src="'+WH.staticUrl+"/images/wow/icons/medium/class_"+g_file_classes[classId]+'.jpg" /></ins><span><img src="'+WH.staticUrl+'/images/Icon/medium/border/default.png" /></span><a href="javascript:" data-classid="'+classId+'"></a></div>'}this.classSelectorDiv.innerHTML=classSelectors;$("div.iconmedium a",this.classSelectorDiv).bind("mouseover",function(c){let id=parseInt($(c.target).attr("data-classid"));if(id){let text=g_chr_classes[id];WH.Tooltip.showAtCursor(c,text,0,0,"q")}});$("div.iconmedium",this.classSelectorDiv).bind("mouseout",function(c){WH.Tooltip.hide()});let lv=this;$("div.iconmedium a",this.classSelectorDiv).bind("contextmenu",function(c){return false});let filterByClass=function(c){if(c){WH.LocalStorage.set("dynamic_quest_class",c);this.classFilter=function(d){for(let i in d.specs){if(WH.inArray(g_chr_specs_by_class[c],d.specs[i])!==-1){return true}}return false};if(!WH.isSet("g_filterByClassAchievement")){if(!(WH.isSet("g_user")&&g_user.id)){return}$.ajax({url:"/website-achievement-explored",data:{trigger:"bosslootfilter"},success:function(){AchievementCheck()},type:"POST"});window.g_filterByClassAchievement=true}}else{WH.LocalStorage.remove("dynamic_quest_class");this.classFilter=null;this.deleteRowCaches()}this.Filters.apply();this.applySort();this.refreshRows(true)};$("div.iconmedium a",this.classSelectorDiv).bind("mousedown",function(c){let classId=parseInt($(c.target).attr("data-classid"));switch(c.which){case 3:if(classId&&$(c.target).parent().hasClass("active")){$(c.target).parent().removeClass("active");filterByClass.call(lv,null);$("#class-selector-c0").addClass("active")}break;default:$(".iconmedium",lv.classSelectorDiv).removeClass("active");$(c.target).parent().addClass("active");filterByClass.call(lv,classId);break}});$(bandTop).append(this.classSelectorDiv);$(bandTop).append('<div class="pad" style="clear: left;"></div>');if(WH.LocalStorage.get("dynamic_quest_class")){classId=WH.LocalStorage.get("dynamic_quest_class");$("#class-selector-c"+classId+" a",this.classSelectorDiv).trigger("mousedown")}}WH.ae(bandBot,this.navBot);WH.ae(bandBot,noteBot);if(this.createCbControls||this.mode===Listview.MODE_CHECKBOX){if(this.note&&!this.showLootSpecs){noteTop.style.paddingBottom="5px"}this.cbBarTop=this.createCbBar(true);this.cbBarBot=this.createCbBar(false);WH.ae(bandTop,this.cbBarTop);WH.ae(bandBot,this.cbBarBot);if(!this.noteTop.firstChild&&!this.cbBarTop.firstChild){this.noteTop.innerHTML="&nbsp;"}if(!this.noteBot.firstChild&&!this.cbBarBot.firstChild){this.noteBot.innerHTML="&nbsp;"}if(this.noteTop.firstChild&&this.cbBarTop.firstChild&&!this.showLootSpecs){this.noteTop.style.paddingBottom="6px"}if(this.noteBot.firstChild&&this.cbBarBot.firstChild){this.noteBot.style.paddingBottom="6px"}}if(this.hideBands&1){bandTop.style.display="none"}if(this.hideBands&2){bandBot.style.display="none"}WH.ae(this.container,this.bandTop);this.scrollerHorizontal=WH.ce("div");this.scrollerHorizontal.className="listview-scroller-horizontal";WH.ae(this.container,this.scrollerHorizontal);this.scrollerVertical=WH.ce("div");this.scrollerVertical.className="listview-scroller-vertical";if(this.clip){this.scrollerVertical.style.width=this.clip.w+"px";this.scrollerVertical.style.height=this.clip.h+"px"}if(this.containVerticalScrolling){WH.aE(this.scrollerVertical,"wheel",WH.pickerWheel)}WH.ae(this.scrollerVertical,this.mainContainer);WH.ae(this.scrollerVertical,this.noData);WH.ae(this.scrollerHorizontal,this.scrollerVertical);WH.ae(this.container,this.bandBot)},createMainContainer:function(){let originalMainContainer=this.mainContainer;if(this.mode===Listview.MODE_DIV){this.mainContainer=this.mainDiv=WH.ce("div");if(!this.noStyle){this.mainContainer.className="listview-mode-div"}}else{if(this.mode===Listview.MODE_TILED){this.mainContainer=this.mainDiv=WH.ce("div",{className:"listview-mode-tiled"});if(this.clickable){this.mainContainer.className+=" clickable"}if(this.sortOptions){setTimeout(this.updateSortArrow.bind(this),0)}WH.aE(window,"resize",this.updateTileSizes.bind(this))}else{this.mainContainer=this.table=WH.ce("table");this.thead=WH.ce("thead");this.tbody=WH.ce("tbody");if(this.clickable){this.tbody.className="clickable"}if(this.mode===Listview.MODE_CALENDAR){this.table.className="listview-mode-calendar";let width=(100/WH.Time.DAYS_PER_WEEK)+"%";let colGroup=WH.ce("colgroup");for(let i=0;i<WH.Time.DAYS_PER_WEEK;++i){let col=WH.ce("col");col.style.width=width;WH.ae(colGroup,col)}WH.ae(this.mainContainer,colGroup);if(this.sortOptions){setTimeout(this.updateSortArrow.bind(this),0)}}else{this.table.className="listview-mode-default";this.createHeader();this.updateSortArrow()}WH.ae(this.table,this.thead);WH.ae(this.table,this.tbody)}}if(originalMainContainer){originalMainContainer.after(this.mainContainer);WH.de(originalMainContainer);this.deleteRowCaches()}},createNav:function(c){let div=WH.ce("div");div.firstLink=WH.ce("a");div.previousLink=WH.ce("a");div.nextLink=WH.ce("a");div.lastLink=WH.ce("a");div.statusText=WH.ce("span");div.firstIndex=WH.ce("b");div.lastIndex=WH.ce("b");div.totalCount=WH.ce("b");div.className="listview-nav";div.firstLink.href=div.previousLink.href=div.nextLink.href=div.lastLink.href="javascript:";WH.ae(div.firstLink,WH.ct(WH.Strings.laquo+" "+WH.TERMS.first));WH.ae(div.previousLink,WH.ct(WH.Strings.lsaquo+" "+WH.TERMS.previous));WH.ae(div.nextLink,WH.ct(WH.TERMS.next+" "+WH.Strings.rsaquo));WH.ae(div.lastLink,WH.ct(WH.TERMS.last+" "+WH.Strings.raquo));div.firstLink.onclick=this.firstPage.bind(this);div.previousLink.onclick=this.previousPage.bind(this);div.nextLink.onclick=this.nextPage.bind(this);div.lastLink.onclick=this.lastPage.bind(this);if(this.mode===Listview.MODE_CALENDAR){WH.ae(div.firstIndex,WH.ct("a"));WH.ae(div.statusText,div.firstIndex)}else{WH.ae(div.firstIndex,WH.ct("a"));WH.ae(div.lastIndex,WH.ct("a"));WH.ae(div.totalCount,WH.ct("a"));WH.ae(div.statusText,div.firstIndex);WH.ae(div.statusText,WH.ct(WH.TERMS.hyphen_punct));WH.ae(div.statusText,div.lastIndex);WH.ae(div.statusText,WH.ct(WH.TERMS.of_lc));WH.ae(div.statusText,div.totalCount)}WH.ae(div,div.firstLink);WH.ae(div,div.previousLink);WH.ae(div,div.statusText);WH.ae(div,div.nextLink);WH.ae(div,div.lastLink);if(c){if(this.hideNav&1){div.style.display="none"}}else{if(this.hideNav&2){div.style.display="none"}}if(this.tabClick){$("a",div).click(this.tabClick)}if(c){this.resetSortLink=WH.ce("a",{className:"listview-reset-sort fa fa-times-circle",href:"javascript:",style:{display:"none"}},WH.ct(WH.TERMS.resetSort));WH.aE(this.resetSortLink,"click",this.resetSort.bind(null,this));WH.aef(div,this.resetSortLink)}return div},createCbBar:function(c){let div=WH.ce("div");if(this.createCbControls){this.createCbControls(div,c)}if(this.createTooltipToggle){this.createTooltipToggle(div,c)}if(div.firstChild){div.className="listview-withselected"+(c?"":"2");WH.ae(div,this.createToggleAll())}return div},createToggleAll:function(){let toggleAll=WH.ce("a");toggleAll.className="listview-toggleall";let updateToggleAllTooltip=function(c){let text=$("td:first-child input:checkbox:not(:checked)",$(this).parents(".listview")).length?WH.TERMS.selectall_stc:WH.TERMS.deselectall_stc;WH.Tooltip.showAtCursor(c,text,0,0,"q")};toggleAll.onclick=(function(c,d,f){let $checkboxCells=$("td:first-child",$(this).parents(".listview"));if($("input:checkbox:not(:checked)",$checkboxCells).length){Listview.cbSelect.call(c,true)}else{Listview.cbSelect.call(c,false)}d.call(this,f)}).bind(toggleAll,this,updateToggleAllTooltip);toggleAll.onmousedown=WH.rf;toggleAll.onmouseover=updateToggleAllTooltip;toggleAll.onmousemove=WH.Tooltip.cursorUpdate;toggleAll.onmouseout=WH.Tooltip.hide;return toggleAll},deleteRowCaches:function(){for(let i in this.data){this.data[i].__tr=null}},refreshRows:function(c){let target;switch(this.mode){case Listview.MODE_DIV:target=this.mainContainer;break;case Listview.MODE_TILED:target=this.mainDiv;break;default:target=this.tbody}if(!target){return}WH.ee(target);if(this.nRowsVisible===0){if(!this.filtered&&!this.forceBandTop){this.bandTop.style.display=this.bandBot.style.display="none";this.mainContainer.style.display="none"}this.noData.style.display="";this.showNoData();return}let iStart;let iEnd;if(!(this.hideBands&1)){this.bandTop.style.display=""}if(!(this.hideBands&2)){this.bandBot.style.display=""}if(this.nDaysPerMonth&&this.nDaysPerMonth.length){iStart=0;for(let i=0;i<this.rowOffset;++i){iStart+=this.nDaysPerMonth[i]}iEnd=iStart+this.nDaysPerMonth[this.rowOffset]}else{if(this.nItemsPerPage>0){iStart=this.rowOffset;iEnd=Math.min(iStart+this.nRowsVisible,iStart+this.nItemsPerPage);if(this.filtered&&this.rowOffset>0){for(let i=0,count=0;i<this.data.length&&count<this.rowOffset;++i){let row=this.data[i];if(row.__hidden||row.__deleted){iStart++}else{count++}}iEnd+=(iStart-this.rowOffset)}}else{iStart=0;iEnd=this.nRowsVisible}}let nItemsToDisplay=iEnd-iStart;if(this.mode===Listview.MODE_DIV){for(let i=0;i<nItemsToDisplay;++i){let realIndex=iStart+i;let row=this.data[realIndex];if(!row){break}if(row.__hidden||row.__deleted){++nItemsToDisplay;continue}WH.ae(this.mainDiv,this.getDiv(realIndex))}}else{if(this.mode===Listview.MODE_TILED){for(let i=0;i<nItemsToDisplay;++i){let realIndex=iStart+i;let cell=this.data[realIndex];if(!cell){break}if(cell.__hidden||cell.__deleted){++nItemsToDisplay;continue}WH.ae(this.mainDiv,this.getDiv(realIndex))}this.updateTileSizes();let images=WH.qsa("img",this.mainDiv);for(let i=0,image;image=images[i];i++){WH.aE(image,"load",this.updateTileSizesAfterDelay.bind(this))}}else{if(this.mode===Listview.MODE_CALENDAR){let tr=WH.ce("tr");for(let headerDay=0;headerDay<7;++headerDay){WH.ae(tr,WH.ce("th",undefined,WH.ct(LANG.date_days[headerDay])))}WH.ae(this.tbody,tr);tr=WH.ce("tr");let firstDay=this.dates[iStart].date.getDay();for(let previousMonthDay=0;previousMonthDay<firstDay;previousMonthDay++){WH.ae(tr,WH.ce("td",{className:"empty-cell"}))}let day=firstDay;for(let i=iStart;i<iEnd;++i){WH.ae(tr,this.getEvent(i));if(++day===7){WH.ae(this.tbody,tr);tr=WH.ce("tr");day=0}}if(day!==0){for(;day<7;++day){WH.ae(tr,WH.ce("td",{className:"empty-cell"}))}WH.ae(this.tbody,tr)}}else{for(let i=0;i<nItemsToDisplay;++i){let realI=iStart+i;let row=this.data[realI];if(!row){break}if(row.__hidden||row.__deleted){++nItemsToDisplay;continue}WH.ae(this.tbody,this.getRow(realI,c))}}}}this.mainContainer.style.display="";this.noData.style.display="none";$WowheadPower.attachTouchTooltips(target)},showNoData:function(){let div=this.noData;WH.ee(div);let result=-1;if(this.onNoData){result=(this.onNoData.bind(this,div))()}if(result===-1){if(this.noDataElement){WH.ae(this.noData,this.noDataElement)}else{if(this.noDataText){WH.ae(this.noData,WH.ct(this.noDataText))}else{WH.ae(this.noData,WH.ct(this.filtered?WH.TERMS.nomatches_tip:WH.TERMS.nodata_tip))}}}},getColumn:function(c){for(let i=0,column;column=this.columns[i];i++){if(column.id===c){return column}}return undefined},getDiv:function(c){let row=this.data[c];if(row.__div==null||this.minPatchVersion!=row.__minPatch){this.createDiv(row,c)}return row.__div},createDiv:function(d,c){let div=WH.ce("div");d.__div=div;if(this.minPatchVersion){d.__minPatch=this.minPatchVersion}if(this.onItemClick){WH.aE(div,"click",this.onItemClick.bind(this,d))}else{if(this.getItemLink&&this.clickable){WH.aE(div,"click",this.onStandardClickableRowClick.bind(this,d))}}(this.template.compute.bind(this,d,div,c))()},getCell:function(d,c){let row=this.data[d];if(c||row.__td==null){this.createCell(row,d)}return row.__td},createCell:function(d,c){let td=WH.ce("td");d.__td=td;(this.template.compute.bind(this,d,td,c))()},getEvent:function(c){let row=this.dates[c];if(row.__td==null){this.createEvent(row,c)}return row.__td},createEvent:function(d,c){d.events=WH.arrayFilter(this.data,function(f){if(f.__hidden||f.__deleted||f.name.match(/^\[#/)){return false}if(!WH.Wow.Event){return false}let date=WH.Wow.Event.getNextEvent(f.occurrences,d.date);if(date){let start=new Date(date.start);let end=new Date(date.end);start.setHours(0,0,0,0);end.setHours(0,0,0,0);return start<=d.date&&end>d.date}return false});let td=WH.ce("td");d.__td=td;if(d.date.getFullYear()===WH.getServerTime().getFullYear()&&d.date.getMonth()===WH.getServerTime().getMonth()&&d.date.getDate()===WH.getServerTime().getDate()){td.className="calendar-today"}let div=WH.ce("div",{className:"calendar-date"});WH.st(div,d.date.getDate());WH.ae(td,div);div=WH.ce("div");div.className="calendar-event";WH.ae(td,div);(this.template.compute.bind(this,d,div,c))();if(this.onItemClick){WH.aE(td,"click",this.onItemClick.bind(this,d))}else{if(this.getItemLink){WH.aE(td,"click",this.onStandardClickableRowClick.bind(this,d))}}},getRow:function(d,c){let row=this.data[d];if(c||row.__tr==null){this.createRow(row)}return row.__tr},setRow:function(c){if(this.data[c.pos]){this.data[c.pos]=c;this.data[c.pos].__tr=c.__tr;this.createRow(this.data[c.pos]);this.refreshRows()}},createRow:function(c){let tr=WH.ce("tr",{className:"listview-row"});c.__tr=tr;if(this.mode===Listview.MODE_CHECKBOX){let td=WH.ce("td");if(!c.__nochk){td.className="listview-cb";td.onclick=Listview.cbCellClick;let cb=WH.ce("input",{type:"checkbox"});cb.onclick=Listview.cbClick;if(c.__chk){cb.checked=true}c.__cb=cb;WH.ae(td,cb)}WH.ae(tr,td)}for(let i=0,len=this.visibility.length;i<len;++i){let realI=this.visibility[i];let col=this.sortOptions?this.sortOptions[realI]:this.columns[realI];let td=WH.ce("td");let result;if(col.align!=null){td.style.textAlign=col.align}if(col.compute){result=(col.compute.bind(this,c,td,tr,realI))()}else{if(c[col.value]!=null){result=c[col.value]}else{result=-1}}if(result!==-1&&result!=null){td.insertBefore(WH.ct(result),td.firstChild)}WH.ae(tr,td)}if(this.mode===Listview.MODE_CHECKBOX&&c.__chk){tr.className="checked"}if(c.frommerge){tr.className+=" mergerow"}if(this.onItemClick){WH.aE(tr,"click",this.onItemClick.bind(this,c))}else{if(this.getItemLink){WH.aE(tr,"click",this.onStandardClickableRowClick.bind(this,c))}}},onStandardClickableRowClick:function(d,c){if(this.noRowClick){return}if(c.target&&WH.closest(c.target,"a")){return}location.href=this.getItemLink(d)},submitSearch:function(c){if(!this.onSearchSubmit||c.keyCode!==13){return}for(let i=0,len=this.data.length;i<len;++i){if(this.data[i].__hidden){continue}(this.onSearchSubmit.bind(this,this.data[i]))()}},validatePage:function(c){if(c===true&&!this.validateHashPagination){return}if(this.rowOffset<0){this.rowOffset=0}else{if(this.mode===Listview.MODE_CALENDAR){this.rowOffset=Math.min(this.rowOffset,this.nDaysPerMonth.length-1)}else{this.rowOffset=this.getRowOffset(this.rowOffset+this.nItemsPerPage>this.nRowsVisible?this.nRowsVisible-1:this.rowOffset)}}},getRowOffset:function(c){return this.nItemsPerPage>0&&c>0?Math.floor(c/this.nItemsPerPage)*this.nItemsPerPage:0},resetRowVisibility:function(c){for(let i=0,len=this.data.length;i<len;++i){this.data[i].__hidden=false}this.filtered=false;if(c!==true){this.rowOffset=0}this.nRowsVisible=this.data.length},changePage:function(){this.refreshRows();this.updateNav();this.writeHash();this.updateBrowseSession();let scroll=WH.getScroll();let offset=WH.ac(this.container);if(scroll.y>offset[1]){scrollTo(scroll.x,offset[1])}},firstPage:function(){if(this.rowOffset>0){this.rowOffset=0;this.changePage()}return false},previousPage:function(){if(this.rowOffset>0){this.rowOffset-=this.nItemsPerPage;this.validatePage();this.changePage()}return false},nextPage:function(){let originalOffset=this.rowOffset;this.rowOffset+=this.nItemsPerPage;this.validatePage();if(this.rowOffset!==originalOffset){this.changePage()}return false},lastPage:function(){let originalOffset=this.rowOffset;this.rowOffset=99999999;this.validatePage();if(this.rowOffset!==originalOffset){this.changePage()}return false},addSort:function(c,d){let index=WH.inArray(c,Math.abs(d),function(f){return Math.abs(f)});if(index!==-1){d=c[index];c.splice(index,1)}c.splice(0,0,d)},sortBy:function(d,c){let columns=this.sortOptions||this.columns;if(d<=0||d>columns.length){return}this.searchSort=false;if(Math.abs(this.sort[0])==d&&!c){this.sort[0]=-this.sort[0]}else{let defaultSort=-1;if(columns[d-1].type===Listview.COLUMN_TYPE_TEXT){defaultSort=1}this.addSort(this.sort,defaultSort*d)}if(this.data[0]&&!this.data[0].__originalIndex){for(let i in this.data){if(this.data.hasOwnProperty(i)&&this.data[i]){this.data[i].__originalIndex=i}}}if(this.resetSortLink){this.resetSortLink.style.display=""}this.applySort();this.refreshRows();this.updateSortArrow();this.writeHash()},applySort:function(){if(!this.sort.length){return}Listview.sort=this.sort;Listview.columns=this.columns;Listview.sortOptions=this.sortOptions;if(this.template.beforeSort){this.template.beforeSort.call(this)}if(this.indexCreated){this.data.sort(Listview.sortIndexedRows.bind(this))}else{this.data.sort(Listview.sortRows.bind(this))}this.updateSortIndex();this.updateBrowseSession()},resetSort:function(c){if(c.originalSort&&c.data[0]&&c.data[0].hasOwnProperty("__originalIndex")){c.sort=JSON.parse(JSON.stringify(c.originalSort));c.data.sort(function(f,d){return(f.__originalIndex||0)-(d.__originalIndex||0)});c.indexCreated=false;c.applySort();c.refreshRows();c.removeSortArrow();c.writeHash(true)}else{WH.error("Could not revert to default sort.",c.id,!c.originalSort?"No original sort":(!c.data[0]?"No first row":"No original indexes"))}if(c.resetSortLink){c.resetSortLink.style.display="none"}},setSort:function(c,d,f){this.searchSort=false;if(this.sort.toString()!==c.toString()){this.sort=c;this.applySort();if(d){this.refreshRows()}if(f){this.writeHash()}}},readHash:function(){if(!this.hash||!location.hash.length){return}const c=this;location.hash.substr(1).split(/[;:]/).forEach(function(d){if(/^\d+([+-]\d+)*$/.test(d)){let num=parseInt(d);if(isNaN(num)){return}c.rowOffset=num;c.validatePage(true);if(c.hash!==Listview.HASH_SIMPLE){let sort=[];let matches=d.match(/([+-])[0-9]+/g);if(matches){let columnCount=(c.sortOptions||c.columns).length;for(let i=matches.length-1;i>=0;i--){let colNo=parseInt(matches[i])||0;let colNoAbs=Math.abs(colNo);if(colNoAbs<=0||colNoAbs>columnCount){break}c.addSort(sort,colNo)}c.setSort(sort,false,false)}}if(c.tabs){c.tabs.setTabPound(c.tabIndex,c.buildHash())}}else{c.Filters.readHashPart(d)}});c.Filters.apply();c.updateSortArrow()},setHashMode:function(c){this.hash=c},updateBrowseSession:function(){if(!window.JSON||!WH.LocalStorage.isSupported()){return}if(typeof Filter=="undefined"&&location.pathname!=="/search"){return}if(this.data.length<3){return}if(typeof this.getItemLink!="function"){return}let browseHistoryLength=5;let here=location.pathname+location.search;let old=(new Date(WH.getServerTime().getTime()-1000*60*60*24*3)).getTime();let b=WH.LocalStorage.get("lvBrowse");if(b){b=window.JSON.parse(b);for(let i=0;i<b.length;i++){if((b[i].path===here)||(b[i].when<old)){b.splice(i--,1)}}if(b.length>=browseHistoryLength){b.splice(browseHistoryLength-1,b.length-browseHistoryLength-1)}}else{b=[]}let urls=[];let result;let regExp=/^\/[-a-z]+=\d+/i;for(let i=0;i<this.data.length;i++){if(result=regExp.exec(this.getItemLink(this.data[i]))){urls.push(result[0])}}if(urls.length<3){return}b.unshift({path:here,hash:location.hash,when:WH.getServerTime().getTime(),urls:urls});WH.LocalStorage.set("lvBrowse",window.JSON.stringify(b))},updateScrollEnhancements:function(){if(!this.bandTop.offsetParent){return}const c=200;let viewportHeight=Platform.getViewportHeight();let maxHeight=viewportHeight-this.scrollerVertical.getBoundingClientRect().top-this.bandBot.offsetHeight;maxHeight=Math.max(maxHeight,c);if(maxHeight<this.scrollerVertical.scrollHeight){if(!this.container.dataset.fixedBottom){this.container.dataset.fixedBottom="true"}this.bandBot.style.width=this.bandBot.parentNode.offsetWidth+"px";this.container.style.paddingBottom=this.bandBot.offsetHeight+"px";if(this.scrollerVertical.scrollWidth>this.scrollerVertical.clientWidth){this.scrollerHorizontal.style.minHeight=this.scrollerVertical.scrollHeight+"px";this.scrollerVertical.style.maxHeight=maxHeight+"px"}else{if(this.scrollerHorizontal.style.minHeight){this.scrollerHorizontal.style.minHeight="";this.scrollerVertical.style.maxHeight=""}}if(maxHeight===c){let offsetParent=this.bandTop.offsetParent;let top=maxHeight+this.scrollerVertical.getBoundingClientRect().top-offsetParent.getBoundingClientRect().top-parseInt(getComputedStyle(offsetParent).getPropertyValue("border-top-width"));this.bandBot.dataset.atTop="true";this.bandBot.style.top=top+"px"}else{if(this.bandBot.dataset.atTop){delete this.bandBot.dataset.atTop;this.bandBot.style.top=""}}}else{if(this.container.dataset.fixedBottom){delete this.container.dataset.fixedBottom;this.bandBot.style.width="";this.container.style.paddingBottom="";if(this.bandBot.dataset.atTop){delete this.bandBot.dataset.atTop;this.bandBot.style.top=""}this.scrollerHorizontal.style.minHeight="";this.scrollerVertical.style.maxHeight=""}}},removeSortArrow:function(){if(this.lsa){this.lsa.classList.remove("listview-sort-desc","listview-sort-asc");this.lsa.classList.remove("active")}},updateSortArrow:function(){if(!this.sort.length||!this.thead||this.mode===Listview.MODE_CALENDAR||this.searchSort){return}let index=WH.inArray(this.visibility,Math.abs(this.sort[0])-1);if(index===-1){return}if(this.mode===Listview.MODE_TILED){if(!this.sortOptions){return}let link=$(".listview-sort-options a",this.noteTop).get(index);if(this.lsa&&this.lsa!=link){this.lsa.className=""}link.className=this.sort[0]<0?"active listview-sort-desc":"active listview-sort-asc";this.lsa=link;return}if(this.mode===Listview.MODE_CHECKBOX&&index<this.thead.firstChild.childNodes.length-1){index+=1}let span=this.thead.firstChild.childNodes[index].firstChild.firstChild.firstChild;if(this.lsa&&this.lsa!=span){this.lsa.className=""}span.className=(this.sort[0]<0?"listview-sort-desc":"listview-sort-asc");this.lsa=span},updateSortIndex:function(){let _=this.data;for(let i=0,len=_.length;i<len;++i){_[i].__si=i}this.indexCreated=true},updateTabName:function(){if(this.tabs&&this.tabIndex!=null){this.tabs.setTabName(this.tabIndex,this.getTabName())}},updateTileSizes:function(){if(this.mode!==Listview.MODE_TILED||!this.mainDiv||!this.mainDiv.offsetParent){return}this.mainDiv.dataset.widthTesting="true";let highestWidth=0;for(let i=0,cell;cell=this.mainDiv.childNodes[i];i++){highestWidth=Math.max(highestWidth,cell.offsetWidth)}if(highestWidth>30){this.mainDiv.style.gridTemplateColumns="repeat(auto-fit, minmax("+highestWidth+"px, 1fr))"}delete this.mainDiv.dataset.widthTesting;clearTimeout(this.updateTileSizesDelay)},updateTileSizesAfterDelay:function(){if(!this.updateTileSizesDelay){this.updateTileSizesDelay=setTimeout(this.updateTileSizes.bind(this),100)}},writeHash:function(c){if(!this.hash||this.lockHash||!this.Filters){return}function d(f){let specialHashes=[];f=";"+f;let hashParts=location.hash.substr(1).split(";");for(let i=0,len=hashParts.length;i<len;i++){let specialTypeMatch=hashParts[i].match(/^[a-zA-Z0-9_]+:/);if(specialTypeMatch&&f.indexOf(";"+specialTypeMatch[0])===-1){specialHashes.push(hashParts[i])}}return specialHashes}let hashSettings=c===true?"":this.buildHash();if(this.tabs){this.tabs.setTabPound(this.tabIndex,hashSettings)}let specialHashes=this.getSpecialHashesString();let hashParts=[];let specialHashesDiff=d(specialHashes);if(this.tabs){if(specialHashesDiff.length&&specialHashesDiff[0].indexOf(this.id+":")===0){hashParts.push(specialHashesDiff.shift())}else{hashParts.push(this.id)}}hashParts.push(specialHashes);hashParts=hashParts.concat(specialHashesDiff);hashParts.push(hashSettings);let hash=hashParts.filter(Boolean).join(";");if(this.tabs&&hash===this.id&&this.tabs.selectedTab===-1&&!location.hash){hash=""}if(hash){location.replace("#"+hash)}else{WH.clearHash()}},updateNav:function(){let arr=[this.navTop,this.navBot];let hasPrevious=false;let hasNext=false;let date=new Date();if(this.nRowsVisible>0){if(!(this.hideNav&1)){arr[0].style.display=""}if(!(this.hideNav&2)){arr[1].style.display=""}}else{arr[0].style.display=arr[1].style.display="none"}if(this.mode===Listview.MODE_CALENDAR){for(let i=0;i<this.nDaysPerMonth.length;++i){if(i===this.rowOffset){if(i>0){hasPrevious=true}if(i<this.nDaysPerMonth.length-1){hasNext=true}}}date.setTime(this.startOnMonth.valueOf());date.setMonth(date.getMonth()+this.rowOffset)}else{if(this.nItemsPerPage){if(this.rowOffset>0){hasPrevious=true}if(this.rowOffset+this.nItemsPerPage<this.nRowsVisible){hasNext=true}}}for(let i=0;i<2;++i){let nav=arr[i];nav.firstLink.dataset.active=hasPrevious?"yes":"no";nav.previousLink.dataset.active=hasPrevious?"yes":"no";nav.nextLink.dataset.active=hasNext?"yes":"no";nav.lastLink.dataset.active=hasNext?"yes":"no";if(this.mode===Listview.MODE_CALENDAR){nav.firstIndex.firstChild.nodeValue=LANG.date_months[date.getMonth()]+" "+date.getFullYear()}else{nav.firstIndex.firstChild.nodeValue=this.rowOffset+1;nav.lastIndex.firstChild.nodeValue=this.nItemsPerPage?Math.min(this.rowOffset+this.nItemsPerPage,this.nRowsVisible):this.nRowsVisible;nav.totalCount.firstChild.nodeValue=this.nRowsVisible}}if(!hasPrevious&&!hasNext){$(arr[0]).addClass("listview-nav-nocontrols");$(arr[1]).addClass("listview-nav-nocontrols")}else{$(arr[0]).removeClass("listview-nav-nocontrols");$(arr[1]).removeClass("listview-nav-nocontrols")}},getTabName:function(){let name=this.name;let n=this.data.length;for(let i=0,len=this.data.length;i<len;++i){if(this.data[i].__hidden||this.data[i].__deleted){--n}}if(typeof this.forceQuantity=="number"||typeof this.forceQuantity=="string"){n=this.forceQuantity}if((n>0||typeof this.forceQuantity=="string")&&!this.hideCount){name+=WH.sprintf(WH.TERMS._paren,n)}return name},buildHash:function(){let hashParts=[];let baseHash="";baseHash+=this.rowOffset;if(this.hash===Listview.HASH_FULL&&this.sort.length&&JSON.stringify(this.originalSort)!==JSON.stringify(this.sort)){baseHash+=("+"+this.sort.join("+")).replace(/\+-/g,"-")}if(baseHash!=="0"){hashParts.push(baseHash)}hashParts=hashParts.concat(this.Filters.getHashParts());return hashParts.join(";")},getCheckedRows:function(){let checkedRows=[];for(let i=0,len=this.data.length;i<len;++i){let row=this.data[i];if((row.__cb&&row.__cb.checked)||(!row.__cb&&row.__chk)){checkedRows.push(row)}}return checkedRows},resetCheckedRows:function(){for(let i=0,len=this.data.length;i<len;++i){let row=this.data[i];if(row.__cb){row.__cb.checked=false}else{if(row.__chk){row.__chk=null}}if(row.__tr){row.__tr.className=row.__tr.className.replace("checked","")}}},deleteRows:function(c){if(!c||!c.length){return}for(let i=0,len=c.length;i<len;++i){let row=c[i];if(!row.__hidden&&!row.__hidden){this.nRowsVisible-=1}row.__deleted=true}this.updateTabName();if(this.rowOffset>=this.nRowsVisible){this.previousPage()}else{this.refreshRows();this.updateNav();this.updateBrowseSession()}},setData:function(c){this.data=c;this.indexCreated=false;this.resetCheckedRows();this.resetRowVisibility();if(this.tabs){if(this.tabs.poundedTab===this.tabIndex){this.readHash()}}else{this.readHash()}this.applySort();this.updateSortArrow();if(this.customFilter!=null||this.classFilter!=null){this.Filters.applyDataOnly()}this.updateNav();this.refreshRows();this.updateBrowseSession()},getNoteTopDiv:function(){return this.noteTop},getNoDataDiv:function(){return this.noData},createIndicator:function(f,c,g,d){if(!this.noteIndicators){this.noteIndicators=WH.ce("div");this.noteIndicators.className="listview-indicators";$(this.noteIndicators).insertBefore($(this.noteTop))}let $indicator=$('<span class="indicator"></span>').html(f).append(!c?"":$('<a class="indicator-x">[x]</a>').attr("href",c).click(function(){if(this.tabClick){this.tabClick()}})).css("cursor",(typeof g=="function"?"pointer":null)).click(function(){if(this.tabClick){this.tabClick()}if(typeof g==="function"){g()}});if(d){WH.Tooltip.simple($indicator.get(0),d,"q")}$(this.noteIndicators).append($indicator);$(this.noteTop).css("padding-top","7px");if(!this.showLootSpecs){$(this.noteTop).css("padding-bottom","11px")}return $indicator[0]},removeIndicators:function(){if(this.noteIndicators){$(this.noteIndicators).remove();this.noteIndicators=null}$(this.noteTop).css("padding-top","")},createProgressBar:function(l,d,h,f,g,c){if(!this.noteProgressBars){this.noteProgressBars=WH.ce("table");this.noteProgressBars.className="listview-progressbars";$(this.noteProgressBars).insertBefore($(this.noteTop))}let maxCols=4;if(isNaN(g)||g<1){g=1}if(g>maxCols){g=maxCols}let tr=this.noteProgressBars.lastChild;let numCols=g;if(tr&&tr.childNodes){for(let i=0;i<tr.childNodes.length;++i){numCols+=(tr.childNodes[i].colSpan||1)}}if(!tr||numCols>maxCols){tr=WH.ce("tr");WH.ae(this.noteProgressBars,tr)}let td=WH.ce("td");if(g>1){td.colSpan=g}if(h){td.className="clickable";td.onclick=function(){h.apply(this,f)}}if(l){WH.ae(td,WH.ce("div",{className:"heading"},WH.ct(l)))}let barWrap=WH.ce("div",{className:"bar-wrap"});let barBg=WH.ce("div",{className:"bar-bg"});WH.ae(barWrap,barBg);if(d[2]){let progressBar=WH.ce("div",{className:"bar yellow"});progressBar.style.width=Math.round(((d[1]+d[2]+d[5])/d[0])*1000)/10+"%";WH.ae(barWrap,progressBar)}let bar=WH.ce("div",{className:"bar"});bar.style.width=Math.round(((d[1]+d[5])/d[0])*1000)/10+"%";if(c){bar.className+=" "+c}WH.ae(barWrap,bar);if(d[5]){let auxiliaryBar=WH.ce("div",{className:"bar gray"});auxiliaryBar.style.width=Math.round((d[5]/d[0])*1000)/10+"%";WH.ae(barWrap,auxiliaryBar)}else{d[5]=0}let barText=WH.ce("span");WH.st(barText,(d[1]+d[5])+(d[2]||d[3]?" ("+(d[3]||d[2])+")":"")+" / "+d[0]);WH.ae(barWrap,barText);WH.ae(td,barWrap);WH.ae(tr,td);$(this.noteTop).css("padding-top","")},removeProgressBars:function(){if(this.noteProgressBars){$(this.noteProgressBars).remove();this.noteProgressBars=null}$(this.noteTop).css("padding-top","")},addTooltipToggle:function(d,c){if(!WH.User.isPremium()){return}let foundScreenshot=false;for(let i=0;i<this.data.length;i++){if(c[this.data[i].id]&&c[this.data[i].id].hasOwnProperty("screenshot")){foundScreenshot=true;break}}if(!foundScreenshot){return}WH.Tooltip.hideScreenshots=true;if(WH.LocalStorage.isSupported()){WH.Tooltip.hideScreenshots=WH.LocalStorage.get("tooltipScreenshots")!=="1"}let toggle=function(){WH.Tooltip.hideScreenshots=!this.checked;if(WH.LocalStorage.isSupported()){if(this.checked){WH.LocalStorage.set("tooltipScreenshots","1")}else{WH.LocalStorage.remove("tooltipScreenshots")}}$("input[type=checkbox].tooltipToggle").prop("checked",!!this.checked)};let label=WH.ce("label");let checkbox=WH.ce("input",{checked:!WH.Tooltip.hideScreenshots,className:"tooltipToggle",type:"checkbox"});WH.aE(checkbox,"click",toggle.bind(checkbox));WH.ae(label,checkbox);WH.ae(label,WH.ct(WH.TERMS.screenshotsontooltips_stc));WH.ae(d,label)},noteTopFormIsEmpty:function(){let formIsEmpty=true;$("input, select",this.noteTop).each(function(){switch(this.tagName){case"INPUT":if(this.value){formIsEmpty=false;return false}break;case"SELECT":if($(this).val()){formIsEmpty=false;return false}break}});return formIsEmpty}};Listview.sortRows=function(d,c){let sort=Listview.sort;let cols=Listview.sortOptions||Listview.columns;if(this.searchSort&&d.hasOwnProperty("searchpopularity")&&c.hasOwnProperty("searchpopularity")&&((d.searchpopularity>0)||(c.searchpopularity>0))){return WH.stringCompare(c.searchpopularity,d.searchpopularity)}for(let i=0,len=sort.length;i<len;++i){let res;let col=cols[Math.abs(sort[i])-1];if(!col){col=this.template}if(col.sortFunc){res=col.sortFunc.call(this,d,c,sort[i])}else{res=WH.stringCompare(d[col.value],c[col.value])}if(res){return res*sort[i]}}return 0};Listview.sortIndexedRows=function(d,c){let sort=Listview.sort;let cols=Listview.sortOptions||Listview.columns;let res;if(this.searchSort&&d.hasOwnProperty("searchpopularity")&&c.hasOwnProperty("searchpopularity")&&(d.searchpopularity>0||c.searchpopularity>0)){return WH.stringCompare(c.searchpopularity,d.searchpopularity)}for(let idx in sort){let col=cols[Math.abs(sort[idx])-1];if(!col){col=this.template}if(col.sortFunc){res=col.sortFunc.call(this,d,c,sort[0])}else{let name=col.stat||col.value;res=WH.stringCompare(d[name],c[name])}if(res){return res*sort[idx]}}return(d.__si-c.__si)};Listview.cbSelect=function(c){for(let i=0,len=this.data.length;i<len;++i){let row=this.data[i];let v2=c;if(row.__hidden){continue}if(!row.__nochk&&row.__cb){let checkbox=row.__cb,tr=checkbox.parentNode.parentNode;if(v2==null){v2=!checkbox.checked}if(checkbox.checked!==v2){checkbox.checked=v2;tr.className=(checkbox.checked?tr.className+" checked":tr.className.replace("checked",""))}}else{if(v2==null){v2=true}}row.__chk=v2}};Listview.cbClick=function(c){setTimeout(Listview.cbUpdate.bind(0,0,this,this.parentNode.parentNode),1);WH.sp(c)};Listview.cbCellClick=function(c){setTimeout(Listview.cbUpdate.bind(0,1,this.firstChild,this.parentNode),1);WH.sp(c)};Listview.cbUpdate=function(d,c,f){if(d){c.checked=!c.checked}f.className=(c.checked?f.className+" checked":f.className.replace("checked",""))};Listview.onColumnHeaderClick=function(d,g,f){const c=this;f=WH.normalizeEvent(f);if(this.tabClick){this.tabClick()}if(f._button===3||f.shiftKey||f.ctrlKey){WH.Tooltip.hide();requestAnimationFrame(function(){if(d.actions.length===1||f.ctrlKey){let action=d.actions[0];if(action.menu){Menu.show(action.menu,WH.closest(f.target,"th"))}else{action.action.apply(c,d,g)}}else{let menu=[];for(let actionIndex=0,action;action=d.actions[actionIndex];actionIndex++){if(action.heading){menu.push(Menu.createItem({label:action.name,options:{heading:true}}))}else{menu.push(Menu.createItem({name:0,label:action.name,submenu:action.menu,url:action.menu?undefined:action.action.bind(c,d,g)}))}}Menu.show(menu,WH.closest(f.target,"th"))}})}else{this.sortBy(g+1)}return false};Listview.onColumnHeaderHover=function(c,d){if(!((this.sortable&&(d.sortable==null||d.sortable))||d.actions.length)){return}let tooltipElements=WH.ce("div");if(d.tooltipElement){WH.ae(tooltipElements,d.tooltipElement)}else{WH.ae(tooltipElements,WH.ce("b",{className:"q1"},WH.ct(d.tooltip||d.name)))}let filterAdditions=this.Filters.getColumnTooltipAdditions(d);if(filterAdditions){WH.ae(tooltipElements,filterAdditions)}WH.ae(tooltipElements,WH.ce("div",{className:"q2 no-wrap"},WH.ct(WH.TERMS.clicktosort_stc)));if(d.actions.length){let actionText=d.actions.length>1?WH.TERMS.rightClickForMoreActions_stc:(d.actions[0].tooltipText||WH.TERMS.rightClickTo_format.replace("%s",d.actions[0].name));WH.ae(tooltipElements,WH.ce("div",{className:"q2 no-wrap"},WH.ct(actionText)))}WH.Tooltip.show(c,tooltipElements.innerHTML,0,0,"q")};(function(){let templateCallbacks={};Listview.loadTemplate=function(c,d){if(Listview.templates.hasOwnProperty(c)){if(d){d()}return}let fileName=c;if(fileName.indexOf(".")>0){fileName=fileName.substr(0,fileName.indexOf("."))}let wasRequested=templateCallbacks.hasOwnProperty(fileName);if(!wasRequested){templateCallbacks[fileName]=[]}if(d){templateCallbacks[fileName].push(d)}if(!wasRequested){let script=WH.ce("script");let url=WH.staticUrl+"/js/WH/Listview/Templates/"+fileName+".js";if(WH.PageMeta.scriptVersionQueryString){url+="?"+WH.PageMeta.scriptVersionQueryString}script.src=url;WH.aE(script,"load",function(){if(!Listview.templates.hasOwnProperty(c)){WH.error('Loaded listview template file "'+fileName+'", but template "'+c+'" still not defined!')}else{while(templateCallbacks[fileName].length){templateCallbacks[fileName].shift()()}}});WH.aE(script,"error",function(){WH.error('Could not load listview template "'+c+'" from file "'+fileName+'"!')});WH.ae(WH.qs("head"),script)}}})();Listview.extraCols={id:{id:"id",name:"ID",width:"5%",compute:function(c,d){if(c.id){WH.ae(d,WH.ct(c.id))}},sortFunc:function(d,c){let aId=parseInt(d.id||0);let bId=parseInt(c.id||0);if(aId===bId){return 0}return aId<bId?-1:1}},patch:{id:"obj-patch",name:WH.TERMS.patch,compute:function(c,d){if(typeof c.patch!="undefined"){let version=parseInt(c.patch);if(version===0||version===-1){WH.ae(d,WH.ct("???"))}else{let major=Math.floor(version/10000);let minor=Math.floor(version/100)%100;let patch=version%100;let finalVersion=WH.sprintf("$1.$2.$3",major,minor,patch);WH.ae(d,WH.ct(finalVersion))}}},sortFunc:function(d,c,f){if(d.patch===c.patch){return 0}else{if(d.patch<c.patch){return-1}else{return 1}}}},date:{id:"obj-date",name:WH.TERMS.added,compute:function(c,d){if(c.date){if(c.date<=86400){WH.ae(d,WH.ct("???"))}else{let added=new Date(c.date*1000);let elapsed=(WH.getServerTime()-added)/1000;return WH.formatDate(d,elapsed,added,null,true)}}},sortFunc:function(d,c,f){if(d.date===c.date){return 0}else{if(d.date<c.date){return-1}else{return 1}}}},cost:{id:"cost",name:WH.TERMS.cost,getValue:function(c){if(c.cost){return(c.cost[2]&&c.cost[2][0]?c.cost[2][0][1]:0)||(c.cost[1]&&c.cost[1][0]?c.cost[1][0][1]:0)||c.cost[0]}},compute:function(c,d){if(c.cost){WH.ae(d,WH.Wow.buildMoney({copper:c.cost[0],currencies:c.cost[1],items:c.cost[2]}))}},sortFunc:function(d,c,f){if(d.cost==null){return-1}else{if(c.cost==null){return 1}}let lena=0,lenb=0,lenc=0,lend=0;if(d.cost[2]!=null){WH.arrayWalk(d.cost[2],function(g,h,m,l){lena+=Math.pow(10,l)+g[1]})}if(c.cost[2]!=null){WH.arrayWalk(c.cost[2],function(g,h,m,l){lenb+=Math.pow(10,l)+g[1]})}if(d.cost[1]!=null){WH.arrayWalk(d.cost[1],function(g,h,m,l){lenc+=Math.pow(10,l)+g[1]})}if(c.cost[1]!=null){WH.arrayWalk(c.cost[1],function(g,h,m,l){lend+=Math.pow(10,l)+g[1]})}return WH.stringCompare(lena,lenb)||WH.stringCompare(lenc,lend)||WH.stringCompare(d.cost[0],c.cost[0])}},count:{id:"count",name:WH.TERMS.count,value:"count",compute:function(c,d){if(c.outof){WH.ae(d,WH.ce("div",{className:"small q0"},WH.ct(WH.sprintf(WH.TERMS.outof_format,c.outof))))}return c.count>0?c.count:"??"},getVisibleText:function(c){let buff=c.count;if(c.outof){buff+=" "+c.outof}return buff},sortFunc:function(d,c,f){if(d.count==null){return-1}else{if(c.count==null){return 1}}return WH.stringCompare(d.count,c.count)}},percent:{id:"percent",name:"%",value:"percent",compute:function(row,td){let personalLootDifficulty=this.selectedDifficulty==WH.Wow.Difficulty.ID_LEGACY_RAID_FINDER||this.selectedDifficulty==WH.Wow.Difficulty.ID_RAID_FINDER;if((row.modes&&personalLootDifficulty)||(g_pageInfo&&g_pageInfo.type===WH.Types.NPC&&g_world_bosses[g_pageInfo.typeId])||(g_pageInfo&&g_pageInfo.type===WH.Types.ITEM&&(g_world_bosses[row.id]||row.personal_loot))){$(td).addClass("tip").mouseover(function(event){WH.Tooltip.showAtCursor(event,WH.TERMS.personal_loot_tip,0,0,"q")}).mousemove(function(event){WH.Tooltip.cursorUpdate(event)}).mouseout(function(){WH.Tooltip.hide()});return WH.TERMS.personal_loot_abbrev}if(row.hasOwnProperty("percentOverride")){let value=row.percentOverride;return parseFloat(value.toFixed(value>=1.95?0:(value>=0.195?1:2)))}if(row.count<=0||(!this._totalCount&&!row.outof)){return"??"}if(row.pctstack){let text="";let data=eval("("+row.pctstack+")");for(let amount in data){let percent=(data[amount]*row.percent)/100;if(percent>=1.95){percent=parseFloat(percent.toFixed(0))}else{if(percent>=0.195){percent=parseFloat(percent.toFixed(1))}else{percent=parseFloat(percent.toFixed(2))}}text+=WH.sprintf(WH.TERMS.stackof_format,amount,percent)+"<br />"}$(td).addClass("tip").mouseover(function(event){WH.Tooltip.showAtCursor(event,text,0,0,"q")}).mousemove(function(event){WH.Tooltip.cursorUpdate(event)}).mouseout(function(){WH.Tooltip.hide()})}let value=parseFloat(row.percent.toFixed(row.percent>=1.95?0:(row.percent>=0.195?1:2)));if(row.pctstack){$(td).append($("<span>").addClass("tip").text(value))}else{return value}},getVisibleText:function(c){let value=c.percent;if(c.hasOwnProperty("percentOverride")){value=c.percentOverride}else{if(c.count<=0){return"??"}}if(value>=1.95){return value.toFixed(0)}else{if(value>=0.195){return parseFloat(value.toFixed(1))}else{return parseFloat(value.toFixed(2))}}},sortFunc:function(d,c,f){let aPercent=d.percent;let bPercent=c.percent;if(d.count==null){aPercent=0}if(c.count==null){bPercent=0}if(d.hasOwnProperty("percentOverride")){aPercent=d.percentOverride}if(c.hasOwnProperty("percentOverride")){bPercent=c.percentOverride}let aValue;if(aPercent>=1.95){aValue=aPercent.toFixed(0)}else{if(aPercent>=0.195){aValue=parseFloat(aPercent.toFixed(1))}else{aValue=parseFloat(aPercent.toFixed(2))}}let bValue;if(bPercent>=1.95){bValue=bPercent.toFixed(0)}else{if(bPercent>=0.195){bValue=parseFloat(bPercent.toFixed(1))}else{bValue=parseFloat(bPercent.toFixed(2))}}return WH.stringCompare(aValue,bValue)}},stock:{id:"stock",name:WH.TERMS.stock,width:"10%",value:"stock",compute:function(c,d){if(c.stock>0){return c.stock}else{return String.fromCharCode(8734)}},getVisibleText:function(c){if(c.stock>0){return c.stock}else{return String.fromCharCode(8734)+" infinity"}}},currency:{id:"currency",name:WH.TERMS.currency,getValue:function(c){if(c.currency){return(c.currency[0]?c.currency[0][1]:0)}},compute:function(c,d){if(c.currency){WH.ae(d,WH.Wow.buildMoney({currencies:c.currency}))}},sortFunc:function(d,c,f){if(d.currency==null){return-1}else{if(c.currency==null){return 1}}let lena=0,lenb=0;WH.arrayWalk(d.currency,function(g,h,m,l){lena+=Math.pow(10,l)+g[1]});WH.arrayWalk(c.currency,function(g,h,m,l){lenb+=Math.pow(10,l)+g[1]});return WH.stringCompare(lena,lenb)}},mode:{id:"mode",name:"Mode",after:"name",type:"text",compute:function(c,d){if(c.modes&&c.modes.mode){if(this.validateBonuses){for(let i in this.validateBonuses){if(WH.inArray(c.bonustrees,this.validateBonuses[i])!==-1){if(this.diffLangref&&this.diffLangref[this.selectedDifficulty]){return this.diffLangref[this.selectedDifficulty]}else{break}}}}if(c.bonustrees&&this.diffLangref&&this.diffLangref[this.selectedDifficulty]){return this.diffLangref[this.selectedDifficulty]}let Diff=WH.Wow.Difficulty;let hasAllDifficulties=function(f){for(let x=0;x<Diff.GROUPS[f].length;x++){if(c.modes.mode.indexOf(Diff.GROUPS[f][x])<0){return false}}return true};let useAll=false;useAll=useAll||hasAllDifficulties(Diff.GROUP_RAID);useAll=useAll||hasAllDifficulties(Diff.GROUP_LEGACY_RAID);useAll=useAll||(c.modes.mode.indexOf(Diff.ID_DUNGEON_NORMAL)>=0&&c.modes.mode.indexOf(Diff.ID_DUNGEON_HEROIC)>=0);return useAll?WH.TERMS.all:Listview.extraCols.mode.getVisibleText(c)}},getVisibleText:function(c){let Diff=WH.Wow.Difficulty;let has=c.modes.mode.includes.bind(c.modes.mode);if(has(Diff.ID_RAID_NORMAL)){return WH.TERMS.normal}if(has(Diff.ID_RAID_HEROIC)){return WH.TERMS.heroic}if(has(Diff.ID_RAID_MYTHIC)){return WH.TERMS.mythic}if(has(Diff.ID_RAID_FINDER)){return WH.TERMS.raidfinder}let modeNormal=has(Diff.ID_DUNGEON_NORMAL)||has(Diff.ID_LEGACY_10_PLAYER)||has(Diff.ID_LEGACY_25_PLAYER);let modeHeroic=has(Diff.ID_DUNGEON_HEROIC)||has(Diff.ID_LEGACY_10_PLAYER_HEROIC)||has(Diff.ID_LEGACY_25_PLAYER_HEROIC);let modeMythicD=has(Diff.ID_DUNGEON_MYTHIC);let modeTw=has(Diff.ID_DUNGEON_TIMEWALKING);let player10=has(Diff.ID_LEGACY_10_PLAYER)||has(Diff.ID_LEGACY_10_PLAYER_HEROIC);let player25=has(Diff.ID_LEGACY_25_PLAYER)||has(Diff.ID_LEGACY_25_PLAYER_HEROIC);let raidFinder=has(Diff.ID_LEGACY_RAID_FINDER);let raidFinder25Only=raidFinder;Diff.GROUPS[Diff.GROUP_DUNGEON].concat(Diff.GROUPS[Diff.GROUP_LEGACY_RAID]).forEach(function(d){raidFinder25Only=raidFinder25Only&&!has(d)});let flexible=has(Diff.ID_RAID_NORMAL);let flexibleOnly=flexible;Diff.GROUPS[Diff.GROUP_DUNGEON].concat(Diff.GROUPS[Diff.GROUP_LEGACY_RAID]).forEach(function(d){flexibleOnly=flexibleOnly&&!has(d)});let specificPlayers;if(player10&&!player25){specificPlayers=10}else{if(player25&&!player10){specificPlayers=25}}let specificMode;if(modeNormal&&!modeHeroic&&!modeMythicD&&!modeTw){specificMode="normal"}else{if(modeHeroic&&!modeNormal&&!modeMythicD&&!modeTw){specificMode="heroic"}else{if(modeMythicD&&!modeNormal&&!modeHeroic&&!modeTw){specificMode="mythic"}}}if(specificMode&&!raidFinder&&!flexible){if(specificPlayers&&!modeMythicD){return WH.sprintf(LANG["tab_"+specificMode+"X"],specificPlayers)}else{return LANG["tab_"+specificMode]}}if(specificPlayers&&!raidFinder&&!flexible){return WH.sprintf(WH.TERMS.dungeonplayer_format,specificPlayers)}if(raidFinder25Only){return WH.TERMS.raidfinder}if(flexibleOnly){return WH.TERMS.flexible}return WH.TERMS.all},sortFunc:function(d,c,f){return-WH.stringCompare(Listview.extraCols.mode.compute.call(this,d),Listview.extraCols.mode.compute.call(this,c))}},requires:{id:"requires",name:WH.TERMS.requires,type:"text",compute:function(c,d){let achievement=c.achievement?WH.Gatherer.get(WH.Types.ACHIEVEMENT,c.achievement):null;if(achievement){WH.noWrap(d);d.className="small";d.style.lineHeight="18px";let a=WH.ce("a",{className:"icontiny tinyspecial",href:WH.Entity.getPath(WH.Types.ACHIEVEMENT,c.achievement),style:{backgroundImage:"url("+WH.Icon.getIconUrl(achievement.icon,WH.Icon.TINY)+")",whiteSpace:"nowrap"}},WH.ct(achievement["name_"+Locale.getName()]));WH.ae(d,a)}},getVisibleText:function(c){return WH.Gatherer.getName(WH.Types.ACHIEVEMENT,c.achievement)},sortFunc:function(d,c,f){return WH.stringCompare(this.getVisibleText(d),this.getVisibleText(c))}},reqskill:{id:"reqskill",name:WH.TERMS.skill,width:"10%",value:"reqskill",before:"yield"},yield:{id:"yield",name:WH.TERMS.yields,type:"text",align:"left",span:2,value:"name",compute:function(d,f,c){if(d.yield&&g_items[d.yield]){let cell=WH.ce("td");cell.style.width="1px";cell.style.paddingRight="0";cell.style.borderRight="none";WH.ae(cell,g_items.createIcon(d.yield,1));WH.ae(c,cell);f.style.borderLeft="none";let wrapper=WH.ce("div");let a=WH.ce("a",{className:"q"+g_items[d.yield].quality,href:WH.Entity.getPath(WH.Types.ITEM,d.yield)});WH.ae(a,WH.ct(g_items[d.yield]["name_"+Locale.getName()]));WH.ae(wrapper,a);WH.ae(f,wrapper)}},getVisibleText:function(c){if(c.yield&&g_items[c.yield]){return g_items[c.yield]["name_"+Locale.getName()]}},sortFunc:function(d,c,f){if(!d.yield||!g_items[d.yield]||!c.yield||!g_items[c.yield]){return d.yield&&g_items[d.yield]?1:(c.yield&&g_items[c.yield]?-1:0)}return-WH.stringCompare(g_items[d.yield].quality,g_items[c.yield].quality)||WH.stringCompare(g_items[d.yield]["name_"+Locale.getName()],g_items[c.yield]["name_"+Locale.getName()])}},compare:{id:"compare",name:WH.TERMS.completion,getValue:function(c){return Math.floor(c.compare.progress*100)},compute:function(d,f,c){let span=WH.ce("span",{className:"compare-text"});if(!this.completionMode){span.style.display="block";span.style.margin="0 auto";span.style.textAlign="left";span.style.width="53px"}if(!this.completionText){this.completionText=LANG.lvcompletion}let progressAmount=d.compare.hasOwnProperty("progressAmount")?d.compare.progressAmount:d.compare.progress;if(progressAmount<0){progressAmount=0}let progress=WH.ce("span",{className:"progress-icon progress-"+(progressAmount===1?"8":Math.min(Math.round(progressAmount*8),7))});let percentage=WH.ce("span");if(this.completionMode){if(d.compare.progress===1){WH.st(percentage,this.completionText.identical)}else{if(d.compare.progress===-1){WH.st(percentage,this.completionText.duplicate)}else{if(!d.compare.progress&&d.compare.primary==this.dataSource){WH.st(percentage,this.completionText.extra)}else{if(!d.compare.progress){WH.st(percentage,this.completionText.missing)}else{WH.ae(percentage,WH.ct(this.completionText.similar+" ("));WH.ae(percentage,WH.ce("span",{className:"tip"},WH.ct(Math.floor(d.compare.progress*100)+"%")));WH.ae(percentage,WH.ct(")"))}}}}}else{WH.st(percentage,Math.floor(d.compare.progress*100)+"%")}let showTooltips=true;for(let i in d.compare.tooltip){showTooltips=showTooltips&&d.compare.tooltip[i].length!==d.compare.data.length}if(d.compare.tooltip.length&&showTooltips){span.onmouseover=(function(m,l,o,h,g){let buff='<table class="compare"><tr>';let langKey;buff+="<tr>";for(let i=0;i<m.data.length;++i){langKey=(m.data[i].status==o?"this":"other");buff+="<td><b>"+(l?h[langKey]:LANG["lvcomparison_"+langKey])+"</b></td>"}buff+="</tr>";for(let i=0;i<m.tooltip.length;++i){let allEqual=1;if(m.progress<1){allEqual=(m.tooltip[i][m.data[0].status]?1:0);for(let j=1;allEqual&&j<m.data.length;++j){let tooltip=m.tooltip[i];let tooltipStatus=tooltip[m.data[j].status];if(tooltipStatus==="&lt;"+WH.TERMS.any+"&gt;"){continue}if(!tooltipStatus||tooltipStatus!==tooltip[m.data[0].status]){allEqual=0}}}buff+="<tr>";for(let j=0;j<m.data.length;++j){buff+='<td class="q'+allEqual+'">'+m.tooltip[i][m.data[j].status]+"</td>"}buff+="</tr>"}buff+="</table>";WH.Tooltip.showAtCursor(g,buff,0,0,"q")}).bind(span,d.compare,this.completionMode,this.dataSource,this.completionText);span.onmousemove=WH.Tooltip.cursorUpdate;span.onmouseout=WH.Tooltip.hide;if(!this.completionMode){percentage.className="tip"}}percentage.insertBefore(WH.ct(" "),percentage.firstChild);percentage.insertBefore(progress,percentage.firstChild);percentage.style.whiteSpace="nowrap";WH.ae(span,percentage);WH.ae(f,span)},sortFunc:function(d,c,f){return d.compare.progress-c.compare.progress}},modify:{id:"modify",sortable:0,filtrable:0,compute:function(d,f,c){if(this.createModifyButton){f.style.cursor="default";$(f).click(function(g){g.stopPropagation()});let a=WH.ce("a",{className:"icon-edit",href:"javascript:"},WH.ct(WH.TERMS.modify));WH.ae(f,this.createModifyButton(d,a))}}},bpetquality:{id:"quality",name:WH.TERMS.quality,compute:function(d,f,c){let qualityName=(d.compare.data[0].bpet&&d.compare.data[0].bpet.id)?WH.Wow.Item.getQualityName(d.compare.data[0].bpet.quality):"";WH.ae(f,WH.ct(qualityName))},sortFunc:function(d,c,f){let aQuality=(d.compare.data[0].bpet&&d.compare.data[0].bpet.id)?d.compare.data[0].bpet.quality:-1;let bQuality=(c.compare.data[0].bpet&&c.compare.data[0].bpet.id)?c.compare.data[0].bpet.quality:-1;return aQuality-bQuality}},popularity:{id:Listview.COLUMN_ID_POPULARITY,name:WH.TERMS.popularity_abbrev,sortOptionsPosition:Listview.SORT_OPTIONS_FIRST,tooltip:WH.TERMS.popularity,max:null,value:"popularity",compute:function(f,g,d,c){let col=this.columns[c];if(col.max===null){col.initMax.call(this,col)}let pop=f.hasOwnProperty("popularity")?f.popularity:0;let scaledPopularity=col.max===0?0:(pop/col.max);scaledPopularity=Math.round(scaledPopularity*8);WH.ae(g,WH.ce("span",{className:"popularity-icon popularity-"+scaledPopularity}))},initMax:function(c){c.max=0;for(let i=0;i<this.data.length;i++){if(this.data[i].hasOwnProperty("popularity")){c.max=Math.max(c.max,this.data[i].popularity||0)}}},sortFunc:function(d,c,f){let aPop=d.hasOwnProperty("popularity")?d.popularity:0;let bPop=c.hasOwnProperty("popularity")?c.popularity:0;return bPop-aPop}},contentPhase:{id:"contentPhase",name:WH.TERMS.phase,tooltip:WH.TERMS.contentPhase,value:"contentPhase",width:"5%",getVisibleText:function(c){if(typeof c.contentPhase==="number"){return c.contentPhase.toFixed(2).replace(/\D?0*$/,"")}return c.contentPhase||""}}};Listview.templates={};Listview.funcBox={getCurrentItemBonuses:function(g){var o=[];var m=g.bonuses?g.bonuses:(this.itemBonusesFromDD?this.itemBonusesFromDD:null);var h=!g.bonuses&&this.itemBonusesFromDD;var f=h?this.validateBonuses:[];if((!m||!m.length)&&g.context){var d=Listview.funcBox.getBonusDataForContext.call(this,g.context);if(d.length==2){m=d[0];f=d[1];h=true}}if(m){for(var c in m){var l=m[c];if((WH.inArray(o,l)==-1)&&(!h||(WH.inArray(g.bonustrees,f[c])!=-1))){o.push(l)}}}return o},getItemLevelWithBonuses:function(r){var m=r.level;var g=false;var f=false;var d=Listview.funcBox.getCurrentItemBonuses.call(this,r);if(d.length>0&&WH.isSet("g_itembonuses")){for(var q in d){var h=d[q];if(g_itembonuses[h]){WH.arrayWalk(g_itembonuses[h],function(u){switch(u[0]){case 1:m+=u[1];break;case 11:case 13:g=u[1];break;case 14:f=u[1];break}})}}}if(g){var c=WH.convertScalingFactor.SD;var l=c?c[g]:null;if(l&&l[21]){var p=l[21];var t=((WH.maxLevel<=p)?WH.maxLevel:p);var o=Math.round(WH.getCurveValue(l[22],t));if(o){return o}}}if(f&&(m==r.level)&&(f<600)){return f}return m},createSimpleCol:function(f,g,c,d){return{id:f,name:WH.TERMS[g]||g,width:c,value:d}},initLootTable:function(d){var c;if(this._totalCount!=null){c=this._totalCount}else{c=d.outof}if(c==0){if(d.count!=-1){d.percent=d.count}else{d.percent=0}}else{d.percent=d.count/c*100}(Listview.funcBox.initModeFilter.bind(this,d))()},initModeFilter:function(c){if(this._lootModes==null){this._lootModes={}}if(this._distinctModes==null){this._distinctModes={}}if(c.modes){let difficulties=WH.Wow.Difficulty.getIds();for(let x=0;x<difficulties.length;x++){let diff=difficulties[x];if(this._lootModes[diff]==null){this._lootModes[diff]=0}if(c.modes.mode.indexOf(diff)>=0){this._lootModes[diff]++}}let modeHash=c.modes.mode.join(",");if(this._distinctModes[modeHash]==null){this._distinctModes[modeHash]=0}this._distinctModes[modeHash]++}},addModeIndicator:function(){const d=this;const c=WH.Wow.Difficulty;let nModes=0;for(let modeHash in this._distinctModes){if(this._distinctModes.hasOwnProperty(modeHash)&&this._distinctModes[modeHash]){nModes++}}if(this._distinctModes[c.GROUPS[c.GROUP_NONE].join(",")]&&nModes<2){return}let order=[c.ID_NONE,c.ID_DUNGEON_NORMAL,c.ID_DUNGEON_HEROIC,c.ID_DUNGEON_MYTHIC,c.ID_DUNGEON_TIMEWALKING,c.ID_LEGACY_RAID_FINDER,c.ID_LEGACY_10_PLAYER,c.ID_LEGACY_10_PLAYER_HEROIC,c.ID_LEGACY_25_PLAYER,c.ID_LEGACY_25_PLAYER_HEROIC,c.ID_CLASSIC_RAID_20_PLAYER,c.ID_RAID_40_PLAYER,c.ID_RAID_FINDER,c.ID_RAID_NORMAL,c.ID_RAID_HEROIC,c.ID_RAID_MYTHIC];let langref={};langref[c.ID_DUNGEON_HEROIC]=WH.TERMS.heroic;langref[c.ID_DUNGEON_NORMAL]=WH.TERMS.normal;langref[c.ID_NONE]=WH.TERMS.normal;langref[c.ID_LEGACY_10_PLAYER]=WH.sprintf(WH.TERMS.normal_format,10);langref[c.ID_LEGACY_25_PLAYER]=WH.sprintf(WH.TERMS.normal_format,25);langref[c.ID_LEGACY_10_PLAYER_HEROIC]=WH.sprintf(WH.TERMS.heroic_format,10);langref[c.ID_LEGACY_25_PLAYER_HEROIC]=WH.sprintf(WH.TERMS.heroic_format,25);langref[c.ID_LEGACY_RAID_FINDER]=WH.TERMS.raidfinder;langref[c.ID_RAID_40_PLAYER]=WH.GlobalStrings.RAID_DIFFICULTY_40PLAYER;langref[c.ID_RAID_NORMAL]=WH.TERMS.normal;langref[c.ID_RAID_HEROIC]=WH.TERMS.heroic;langref[c.ID_RAID_MYTHIC]=WH.TERMS.mythic;langref[c.ID_RAID_FINDER]=WH.TERMS.raidfinder;langref[c.ID_DUNGEON_MYTHIC]=WH.TERMS.mythic;langref[c.ID_DUNGEON_TIMEWALKING]=WH.TERMS.timewalking;langref[c.ID_CLASSIC_RAID_20_PLAYER]=WH.GlobalStrings.RAID_DIFFICULTY_20PLAYER;let tooltipref={};this.diffLangref={};$.extend(this.diffLangref,langref);if(WH.WAS.showAds()){tooltipref[c.ID_LEGACY_10_PLAYER]=langref[c.ID_LEGACY_10_PLAYER];tooltipref[c.ID_LEGACY_25_PLAYER]=langref[c.ID_LEGACY_25_PLAYER];tooltipref[c.ID_LEGACY_10_PLAYER_HEROIC]=langref[c.ID_LEGACY_10_PLAYER_HEROIC];tooltipref[c.ID_LEGACY_25_PLAYER_HEROIC]=langref[c.ID_LEGACY_25_PLAYER_HEROIC];tooltipref[c.ID_LEGACY_RAID_FINDER]=langref[c.ID_LEGACY_RAID_FINDER];langref[c.ID_LEGACY_10_PLAYER]=WH.TERMS.normal_abbrev+10;langref[c.ID_LEGACY_25_PLAYER]=WH.TERMS.normal_abbrev+25;langref[c.ID_LEGACY_10_PLAYER_HEROIC]=WH.TERMS.horde_abbrev+10;langref[c.ID_LEGACY_25_PLAYER_HEROIC]=WH.TERMS.horde_abbrev+25;langref[c.ID_LEGACY_RAID_FINDER]=WH.TERMS.lookingforraid_abbrev;langref[c.ID_RAID_NORMAL]=WH.TERMS.normal_abbrev;langref[c.ID_RAID_HEROIC]=WH.TERMS.horde_abbrev;langref[c.ID_RAID_MYTHIC]=WH.TERMS.mythic_abbrev;langref[c.ID_RAID_FINDER]=WH.TERMS.lookingforraid_abbrev;langref[c.ID_DUNGEON_MYTHIC]=WH.TERMS.mythic_abbrev;langref[c.ID_DUNGEON_TIMEWALKING]=WH.TERMS.timewalking_abbrev}let modes=[];let selectDifficulty=function(f){WH.setSelectedLink(this,"lootmode-"+d.tabIndex);d.selectedDifficulty=f;let bonusFromDD=Listview.funcBox.getItemBonusesForDifficulty.call(d,f);d.itemBonusesFromDD=bonusFromDD[0];d.validateBonuses=bonusFromDD[1];if(f!=null){d.setSpecialHash("mode",WH.Strings.slug(langref[f].replace(" ","")))}else{d.removeSpecialHash("mode")}d.customFilter=function(g){return Listview.funcBox.filterMode(g,d._totalCount,f)};d.Filters.apply();d.applySort();d.refreshRows(true)};let firstCallback;let mode=d.getSpecialHash("mode");for(let orderIndex=0;orderIndex<order.length;orderIndex++){let difficulty=order[orderIndex];if(!this._lootModes[difficulty]){continue}let a=WH.ce("a");WH.ae(a,WH.ce("span",{},WH.ct(langref[difficulty])));WH.ae(a,WH.ct(WH.Strings.sprintf(WH.TERMS.parens_format,"",this._lootModes[difficulty])));a._clickAction=selectDifficulty.bind(a,difficulty);WH.aE(a,"click",a._clickAction);let iconClass=c.getIconClass(difficulty);if(iconClass){a.classList.add(iconClass)}modes.push({indicator:$('<span class="indicator-mode"></span>').append(a).append($("<b"+(iconClass?' class="'+iconClass+'"':"")+">"+langref[difficulty]+" ("+this._lootModes[difficulty]+")</b>")),tooltip:tooltipref[difficulty]});if(modes.length===1){firstCallback=selectDifficulty.bind(a[0],difficulty)}if(mode===WH.Strings.slug(langref[difficulty].replace(" ",""))){(a._clickAction)()}}if(firstCallback&&(!WH.setSelectedLink.groups||!WH.setSelectedLink.groups["lootmode-"+d.tabIndex])){firstCallback()}let showNoteworthy=false;for(let modeIndex=0;modeIndex<modes.length;++modeIndex){let a=$("a",modes[modeIndex].indicator);if(!$("span",a).html()&&modes.length==3){showNoteworthy=true}else{this.createIndicator(modes[modeIndex].indicator,null,a[0]._clickAction,modes[modeIndex].tooltip)}}if(showNoteworthy){firstCallback()}if(this.showLootSpecs){this.classSelectorDiv.style.marginTop="0px"}$(this.noteTop).append($('<div class="clear"></div>'))},filterMode:function(g,d,f){if(d!=null&&g.count!=null){if(g._count==null){g._count=g.count}var c=g._count;if(f!=null&&g.modes[f]){c=g.modes[f].count;d=g.modes[f].outof}g.__tr=null;g.count=c;g.outof=d;if(d){g.percent=c/d*100}else{g.percent=c}}if(f==null){return true}return g.modes&&g.modes.mode&&(g.modes.mode.indexOf(f)>=0)},getItemBonusesForDifficulty:function(d){var c=[];if(d&&WH.isSet("g_pageInfo")){var g=d<0?-d:d;var h=0;var l=g_pageInfo.typeId;switch(g_pageInfo.type){case 1:h=(g_npcs[l]&&g_npcs[l].hasOwnProperty("location"))?g_npcs[l].location[0]:0;break;case 7:h=l;break;default:break}var f=0;if(WH.isSet("g_mapdifficulties")&&g_mapdifficulties[h]&&g_mapdifficulties[h][g]){f=g_mapdifficulties[h][g]}else{if(WH.isSet("g_difficulties")&&g_difficulties[g]){f=g_difficulties[g].context||0}}c=Listview.funcBox.getBonusDataForContext.call(this,f)}return c},getItemUrl:function(f){var d;if(f.baseName){d=f.baseName}else{if(typeof f.name==="string"&&f.name!==""){d=f.name}}var c={};var g=Listview.funcBox.getCurrentItemBonuses.call(this,f);if(g.length>0){c.bonus=g.join(":")}if(this.ilvlOverride){c[this.ilvlOverride.name]=""}else{if(this.addIlvlToLinks){c.ilvl=Listview.funcBox.getItemLevelWithBonuses(f)}}return WH.Wow.Item.getPath(f.id,d,c)},getBonusDataForContext:function(h){var d=[];if(h&&WH.isSet("g_item_bonuscontexts")&&g_item_bonuscontexts[h]){var l=[];var f=[];for(var g in g_item_bonuscontexts[h]){var c=g_item_bonuscontexts[h][g];l.push(c[1]);f.push(c[0])}d=[l,f]}return d},assocArrCmp:function(f,d,c){if(f==null){return-1}else{if(d==null){return 1}}var l=Math.max(f.length,d.length);for(var h=0;h<l;++h){if(f[h]==null){return-1}else{if(d[h]==null){return 1}}var g=WH.stringCompare(c[f[h]],c[d[h]]);if(g!=0){return g}}return 0},assocBinFlags:function(c,g){var f=[];for(var d in g){if(!isNaN(d)&&d<=32&&(c&(1<<(d-1)))){f.push(d)}}f.sort(function(l,h){return WH.stringCompare(g[l],g[h])});return f},location:function(p,d,f){if(p.location==null){return-1}var h=f?f:3;var m=p.location.slice(0,h);if(m.length<p.location.length){m.push(-1)}for(var g=0,l=m.length;g<l;++g){if(g>0){WH.ae(d,WH.ct(WH.TERMS.comma_punct))}var c=m[g];if(c==-1){WH.ae(d,WH.ct(WH.TERMS.ellipsis_punct))}else{var o=WH.ce("a");o.className="q1";o.href=WH.Entity.getPath(WH.Types.ZONE,c,g_zones[c]);WH.ae(o,WH.ct(g_zones[c]||WH.Gatherer.getName(WH.Types.ZONE,c)));WH.ae(d,o)}}},arrayText:function(d,g){if(d==null){return}else{if(!Array.isArray(d)){return g[d]}}var h="";for(var f=0,c=d.length;f<c;++f){if(f>0){h+=" "}if(!g[d[f]]){continue}h+=g[d[f]]}return h},createCenteredIcons:function(f,o,q,t,g,u,c){if(f!=null){var l=0;var E=WH.ce("div"),G=WH.ce("div");WH.ae(document.body,E);if(q&&(f.length!=1||!c)){var A=WH.ce("div");A.style.position="relative";A.style.width="1px";var H=WH.ce("div");H.className="q0";H.style.position="absolute";H.style.right="2px";H.style.lineHeight="26px";H.style.fontSize="11px";H.style.whiteSpace="nowrap";WH.ae(H,WH.ct(q));WH.ae(A,H);WH.ae(E,A);E.style.paddingLeft=$(H).width()+"px"}var C=g_items;if(t==WH.Types.SPELL){C=g_spells}else{if(t==WH.Types.PET_ABILITY){C=g_petabilities}}for(var w=0,z=f.length;w<z;++w){if(u&&l%u==0){WH.ae(E,WH.ce("div",{className:"clear-left"}))}l++;var B;if(f[w]==null){B=WH.ce("div");B.style.width=B.style.height="26px"}else{var r=undefined;var m=undefined;var h=undefined;if(typeof f[w]=="object"){r=f[w][0];m=f[w][1];h=f[w][2]}else{r=f[w]}if(typeof r=="string"){B=Icon.create(r,0,null,h)}else{if(r){B=C.createIcon(r,0,m)}else{B=Icon.create("inventoryslot_empty",0,null,"javascript:")}}if(g){B.children[2].rel=g[w]}}if(f.length==1&&c){if(r&&g_items[r]){WH.ee(E);var D=g_items[r],F=WH.ce("a"),v=WH.ce("span");v.style.paddingTop="4px";F.href=WH.Entity.getPath(WH.Types.ITEM,r);F.className="q"+D.quality+" icontiny tinyspecial";F.style.backgroundImage="url("+WH.staticUrl+"/images/wow/icons/tiny/"+D.icon.toLowerCase()+".gif)";F.style.whiteSpace="nowrap";WH.st(F,WH.Gatherer.getName(WH.Types.ITEM,r));WH.ae(v,F);if(m>1){WH.ae(v,WH.ct(" ("+m+")"))}if(q){var A=WH.ce("span");A.className="q0";A.style.fontSize="11px";A.style.whiteSpace="nowrap";WH.ae(A,WH.ct(q));WH.ae(E,A);if($(H).length>0){v.style.paddingLeft=$(H).width()+"px"}}WH.ae(E,v)}}else{B.style.cssFloat=B.style.styleFloat="left";WH.ae(E,B);E.style.margin="0 auto";E.style.textAlign="left";var p=f.length;if(u&&u<f.length){p=u}E.style.width=(26*p)+"px"}}G.className="clear";WH.ae(o,E);WH.ae(o,G);return true}},createSocketedIcons:function(q,g,f,l,t){var u=0,p=WH.ce("div"),c=WH.ce("div");for(var h=0,m=q.length;h<m;++h){var r,o=f[h];if(g_items&&g_items[o]){r=g_items.createIcon(o,0)}else{if(WH.isSet("g_gems")&&g_gems&&g_gems[o]){r=Icon.create(g_gems[o].icon,0,null,"/item="+o)}else{r=Icon.create(null,0,null,"javascript:")}}r.className+=" iconsmall-socket-"+g_file_gems[q[h]]+(!f||!o?"-empty":"");r.style.cssFloat=r.style.styleFloat="left";if(l&&l[h]){r.insertBefore(WH.ce("var"),r.childNodes[1]);++u}WH.ae(p,r)}p.style.margin="0 auto";p.style.textAlign="left";p.style.width=(26*q.length)+"px";c.className="clear";WH.ae(g,p);WH.ae(g,c);if(t&&u==q.length){p=WH.ce("div");p.style.paddingTop="4px";WH.ae(p,WH.ct(t));WH.ae(g,p)}}};var LiveSearch=new function(){var z,A={},K,r,F,u,v,E,m,L,g=500;function G(N,M){N.value=M;N.selectionStart=N.selectionEnd=M.length}function o(N,M){if(K){K.className=K.className.replace("live-search-selected","")}K=N;K.className+=" live-search-selected";L=N.i;if(!M){J();setTimeout(G.bind(0,z,WH.getTextContent(N.firstChild.firstChild.childNodes[1])),1);v=1}}function I(){o(this.parentNode.parentNode,1)}function B(){if(!u){return false}return u.style.display!="none"}function C(M){if(M==1&&!B()){return}if(z==null){return}var N=WH.ac(z);u.style.left=(N[0])+"px";u.style.top=(N[1]+z.offsetHeight)+"px";u.style.width=(z.offsetWidth-4)+"px"}function c(M){if(F){if(M){u.className+=" live-search-mobile"}else{u.className=u.className.replace(/ *live-search-mobile\b/g,"")}return}F=1;u=WH.ce("div");u.className="live-search"+(M?" live-search-mobile":"");u.style.display="none";WH.ae(document.body,u);WH.aE(window,"resize",C.bind(0,1));if(!M){WH.aE(document,"click",q)}}function J(){if(u&&!B()){C();if(z){z.setAttribute("data-has-live-search","true")}$(u).css({opacity:"0"}).show().animate({opacity:"1"},"fast",null,p)}}function p(M){$(this).css("opacity","")}function q(M){if(M&&!WH.isLeftClick(M)){return}if(u){u.style.display="none"}if(z){z.setAttribute("data-has-live-search","false")}}function l(N,M){return(M?N:"<b><u>"+N+"</u></b>")}function D(W,S,X){var V=WH.Layout.Responsive.isZulInMobileMode();c(V);J();E=1;L=null;while(u.firstChild){WH.de(u.firstChild)}S=S.replace(/[^a-z0-9\-]/gi," ");S=WH.trim(S.replace(/\s+/g," "));var N=WH.createOrRegex(S,(S==="s"?"[%]":null));if(V){var R=WH.ce("div");R.className="live-search-zul-closer";var Q=WH.ce("div");var ad=WH.ce("a");ad.innerHTML='<i class="fa fa-times"></i><span class="q10">'+WH.TERMS.closesearch+"</span>";ad.onclick=q;ad.onmouseover=I;WH.ae(Q,ad);WH.ae(R,Q);WH.ae(u,R)}for(var aa=0;aa<X.length;aa++){var T=X[aa];var O=T.type;var P=T.id;var ac=WH.ce("a");var ab=WH.ce("i");var Y=WH.ce("span");var U=WH.ce("div");var M=WH.ce("div");U.i=aa;ac.onmouseover=I;ac.href=WH.Entity.getPath(O,P,T.name);if(W._append){ac.rel+=W._append}if(O===WH.Types.NPC&&T.boss){U.className+=" live-search-icon-boss"}else{if(O===WH.Types.ITEM&&T.quality!==null){ac.className+=" q"+T.quality}else{if(O===WH.Types.ITEM_SET&&T.quality!==null){ac.className+=" q"+T.quality}else{if(O===WH.Types.CLASS){ac.className+=" c"+P}}}}if(T.icon){U.className+=" live-search-icon";U.style.backgroundImage="url("+WH.staticUrl+"/images/wow/icons/"+(V?"medium":"small")+"/"+T.icon.toLowerCase()+".jpg)"}else{if((O===WH.Types.QUEST||O===WH.Types.TITLE)&&T.side>=1&&T.side<=2){U.className+=" live-search-icon-quest-"+(T.side===1?"alliance":"horde")}}WH.ae(ab,WH.ct(WH.Types.getUpperSingular(O)));WH.ae(ac,ab);var Z=T.name;Z=Z.replace(N,l);if(O===WH.Types.TITLE){Z=Z.replace("%s",'<span class="q0">&lt;'+WH.TERMS.name+"&gt;</span>")}if(O===WH.Types.SPELL&&T.rank){Y.innerHTML=WH.Strings.sprintf(WH.TERMS.parens_format,Z,T.rank)}else{Y.innerHTML=Z}WH.ae(ac,Y);WH.ae(M,ac);WH.ae(U,M);WH.ae(u,U)}}function w(M,N){WH.fetch("/search/suggestions-template",{cookies:false,query:{q:N},success:function(O){if(O.search===N){if(O.results){D(M,O.search,O.results)}else{q()}}}})}function H(M,N){if(v){v=0;return}E=0;if(r>0){clearTimeout(r);r=0}r=setTimeout(w.bind(0,M,N),g)}function t(M){if(!B()){if(E){J()}return}var O=(u.childNodes[0].nodeName=="EM"?u.childNodes[3]:u.firstChild);var N=M?O:u.lastChild;if(K==null){o(N)}else{var P=M?K.nextSibling:K.previousSibling;if(P){if(P.nodeName=="STRONG"){P=u.lastChild}o(P)}else{o(N)}}}function d(O){O=WH.normalizeEvent(O);var M=O._target;var N=WH.trim(M.value.replace(/\s+/g," "));if(N==A[M.id]){return}A[M.id]=N;if(M!=document){z=M}if(N.length){H(M,N)}else{q()}}function f(M){M=WH.normalizeEvent(M);switch(M.keyCode){case 27:q();break;case 38:t(0);break;case 40:t(1);break}}function h(N){N=WH.normalizeEvent(N);var M=N._target;if(M!=document){z=M}}this.attach=function(M){M=$(M);if(!M.length){return}M=M[0];if(M.getAttribute("autocomplete")=="off"){return}M.setAttribute("autocomplete","off");WH.aE(M,"focus",h);WH.aE(M,"keyup",d);WH.aE(M,"keydown",f)};this.reset=function(M){A[M.id]=null;M.value="";E=0;q()};this.hide=function(){q()}};var LOCALE_ENUS=0;var LOCALE_KOKR=1;var LOCALE_FRFR=2;var LOCALE_DEDE=3;var LOCALE_ZHCN=4;var LOCALE_ESES=6;var LOCALE_RURU=7;var LOCALE_PTBR=8;var LOCALE_ITIT=9;var Locale={current:{},locales:{0:{id:LOCALE_ENUS,name:"enus",code:"en",domain:"www.wowhead.com",description:"English",descriptionEnglish:"English"},1:{id:LOCALE_KOKR,name:"kokr",code:"ko",domain:"ko.wowhead.com",description:"한국어",descriptionEnglish:"Korean"},2:{id:LOCALE_FRFR,name:"frfr",code:"fr",domain:"fr.wowhead.com",description:"Français",descriptionEnglish:"French"},3:{id:LOCALE_DEDE,name:"dede",code:"de",domain:"de.wowhead.com",description:"Deutsch",descriptionEnglish:"German"},4:{id:LOCALE_ZHCN,name:"zhcn",code:"zh",domain:"cn.wowhead.com",description:"简体中文",descriptionEnglish:"Simplified Chinese"},6:{id:LOCALE_ESES,name:"eses",code:"es",domain:"es.wowhead.com",description:"Español",descriptionEnglish:"Spanish"},7:{id:LOCALE_RURU,name:"ruru",code:"ru",domain:"ru.wowhead.com",description:"Русский",descriptionEnglish:"Russian"},8:{id:LOCALE_PTBR,name:"ptbr",code:"pt",domain:"pt.wowhead.com",description:"Português Brasileiro",descriptionEnglish:"Brazilian Portuguese"},9:{id:LOCALE_ITIT,name:"itit",code:"it",domain:"it.wowhead.com",description:"Italiano",descriptionEnglish:"Italian"}},exists:function(c){return Locale.locales.hasOwnProperty(c)},getAll:function(){var c=[];for(var d in Locale.locales){c.push(Locale.locales[d])}return c},getAllByName:function(){var c=Locale.getAll();c.sort(function(f,d){return WH.stringCompare(f.description,d.description)});return c},getCode:function(c){return(Locale.locales[c]||Locale.locales[Locale.getId()]).code},getDataEnvForcedLocale:function(c){switch(c){case WH.dataEnv.PTR:case WH.dataEnv.BETA:return LOCALE_ENUS}return undefined},getDescription:function(c){if(typeof c!=="number"&&typeof c!=="string"){c=Locale.getId()}return Locale.locales[c].description},getEnglishDescription:function(c){if(typeof c!=="number"&&typeof c!=="string"){c=Locale.getId()}return Locale.locales[c].descriptionEnglish},getId:function(){return Locale.current.id},getName:function(c){if(!Locale.locales[c]){c=Locale.getId()}return Locale.locales[c].name},get:function(){var c=Locale.getId();return Locale.locales[c]},isLocaleName:function(c){for(var d in Locale.locales){if(Locale.locales.hasOwnProperty(d)&&Locale.locales[d].name===c){return true}}return false},set:function(c){$.extend(Locale.current,Locale.locales[c]);if(c!==LOCALE_ENUS){Menu.sortGlobalMenus()}},formatList:function(m,o,l){var d=o==="or"?(m.length===2?WH.TERMS.wordspace_punct+WH.TERMS.or_lc+WH.TERMS.wordspace_punct:WH.TERMS.finalenumerationseparatoror_punct):(m.length===2?WH.TERMS.and_lc:WH.TERMS.finalenumerationseparator_punct);if(l){var h=Math.max((WH.TERMS.wordspace_punct+WH.TERMS.ellipsis_punct+WH.TERMS.wordspace_punct).length,d.length);var c=(""+m[m.length-1]).length;l-=h+c}var p="";for(var f=0,g=m.length;f<g;f++){if(f>0){p+=f===g-1?d:WH.TERMS.enumerationseparator_punct}p+=m[f];if(l&&p.length>=l&&f<m.length-2){p+=WH.TERMS.wordspace_punct+WH.TERMS.ellipsis_punct+WH.TERMS.wordspace_punct+m[m.length-1];break}}return p},hasSentenceSpaces:function(c){return c!==LOCALE_ZHCN},hasWordSpaces:function(c){return c!==LOCALE_ZHCN}};Locale.set(LOCALE_ENUS);function Mapper(d,f){WH.cO(this,d);if(this.parent&&!this.parent.nodeName){this.parent=WH.ge(this.parent)}else{if(!this.parent){return}}var c;this.mouseX=0;this.mouseY=0;this.editable=this.editable||false;this.overlay=this.overlay||false;this.dataEnv=this.dataEnv||WH.getDataEnv();if(WH.isClassicTree(this.dataEnv)){this.rootMapDir="/images/wow/classic/maps"}else{if(WH.isBurningCrusadeTree(this.dataEnv)){this.rootMapDir="/images/wow/tbc/maps"}else{if(this.legacy){this.rootMapDir="/images/wow/maps/legacy"}else{this.rootMapDir="/images/wow/maps"}}}this.localeDir=Locale.getName();if(this.dataEnv===WH.dataEnv.PTR){this.localeDir="ptr"}else{if(this.dataEnv===WH.dataEnv.BETA){this.localeDir="beta"}}if(this.editable){this.zoomable=this.toggle=false;this.show=this.mouse=true}else{this.zoomable=(this.zoomable==null?true:this.zoomable);this.toggle=(this.toggle==null?true:this.toggle);this.show=(this.show==null?true:this.show);this.mouse=(this.mouse==null?false:this.mouse)}this.buttons=(this.buttons==null?true:this.buttons);this.zoneLink=(this.zoneLink==null?true:this.zoneLink);if(location.href.indexOf("zone=")!=-1){this.zoneLink=false}this.zoom=this.zoom||0;this.zone=this.zone||0;this.level=this.level==null?(Mapper.zoneDefaultLevel[this.zone]||0):this.fixLevel(this.level,this.zone);this.phase=0;if(Mapper.zoneDefaultPhase){this.phase=Mapper.zoneDefaultPhase[this.zone]||0}this.pins=[];this.nCoords=0;this.tempWidth=null;this.tempHeight=null;this.parent.className="mapper";this.parent.appendChild(this.span=WH.ce("span",{className:"mapper-map"}));this.overlaySpan=c=WH.ce("div",{className:"mapper-overlay"});this.overlaySpan.appendChild(WH.ce("div",{className:"mapper-overlay-expander"}));this.span.appendChild(c);this.buttonDiv=c=WH.ce("div");c.style.position="absolute";c.style.top=c.style.right="3px";if(this.buttons){this.parent.appendChild(c)}if(this.editable){this.span.onmouseup=this.addPin.bind(this);c=WH.createTextGlow(WH.TERMS.clickmappins_tip);c.style.fontSize="13px";c.style.position="absolute";c.style.bottom=c.style.right="0";this.parent.appendChild(c)}else{this.sToggle=c=WH.createButton(WH.TERMS.hidepins_stc,null,{click:this.toggleShow.bind(this)});c.style["float"]="right";c.style.display="none";this.buttonDiv.appendChild(c)}if(this.zoomable){this.span.onclick=this.toggleZoom.bind(this);this.span.id="sjdhfkljawelis"+(this.unique!==undefined?this.unique:"");this.sZoom=c=WH.createTextGlow(WH.TERMS.clickmapzoom_tip,"mapper-zoomtip");c.style.fontSize="13px";c.style.position="absolute";c.style.bottom=c.style.right="0";this.span.appendChild(c)}this.sZoneLink=c=WH.createTextGlow("");c.style.display="none";c.style.position="absolute";c.style.top=c.style.left="0";this.parent.appendChild(c);if(this.mouse){this.parent.onmouseout=(function(){this.timeout=setTimeout((function(){this.sMouse.style.display="none"}).bind(this),1)}).bind(this);this.parent.onmouseover=(function(){clearTimeout(this.timeout);this.sMouse.style.display=""}).bind(this);this.span.onmousemove=this.updateMouseCoords.bind(this);this.span.onmousedown=this.updateMouseCoords.bind(this);this.sMouse=c=WH.createTextGlow("(0.0, 0.0)");c.style.display="none";c.style.position="absolute";c.style.bottom=c.style.left="0";c.onmouseup=WH.sp;this.span.appendChild(c)}this.floorPins={};if(d.coords!=null){this.setCoords(d.coords,this.level,d.uiMapId,d.uiMapName)}else{if(d.link!=null){this.setLink(d.link)}}if(d.objectives){this.setObjectives(d.objectives)}if(d.zoneparent&&d.zones){this.setZones(d.zoneparent,d.zones)}this.onlyPhases=false;if(Mapper.multiLevelZones.hasOwnProperty(this.zone)){this.onlyPhases=(Mapper.multiLevelZones[this.zone].length==Mapper.multiLevelZones[this.zone].filter(function(g){return g.indexOf("_")!=-1}).length+1)}this.updateMap(f)}Mapper.sizes=[[488,325,"normal"],[772,515,"zoom"],[1002,668,"original"],[224,149,"small"]];Mapper.zoneLevelOffset={};Mapper.multiLevelZones={};Mapper.zonePhased={};Mapper.garrisonLevelsToMapTiers={};Mapper.zoneDefaultLevel={};Mapper.remappedLevels={};Mapper.prototype={getMap:function(){return this.parent},update:function(g,m){if(g.zoom!=null){this.zoom=g.zoom}if(g.zone!=null){this.zone=g.zone}if(g.show!=null){this.show=g.show}this.pins=[];this.nCoords=0;for(var l in this.floorPins){if(this.floorPins[l].parentNode){WH.de(this.floorPins[l])}}this.floorPins={};if(this.floorButton){WH.de(this.floorButton);this.floorButton=null}var c=(g.level===undefined?0:this.fixLevel(parseInt(g.level),this.zone));if(!g.preservelevel){this.level=c}else{c=this.level}var f=WH.isSet("g_mapperData")?g_mapperData:false;if(f&&f[this.zone]&&!g.coords){var p=f[this.zone];var h=-1;for(var l in p){if(!p.hasOwnProperty(l)){continue}var d=this.fixLevel(parseInt(l),this.zone);if(g.level===undefined&&p[l].count>h){c=parseInt(d);h=p[l].count}if(p[l].coords){this.setCoords(p[l].coords,d,p[l].uiMapId,p[l].uiMapName)}}this.level=c;if(this.floorPins[this.level]){WH.ae(this.span,this.floorPins[this.level])}}else{if(g.coords!=null){var o=999;for(var l in g.coords){if(!g.coords.hasOwnProperty(l)){continue}var d=this.fixLevel(parseInt(l),this.zone);this.setCoords(g.coords[l],d,g.uiMapId,g.uiMapName);if(d<o){o=d}}if(o!=999&&!g.preservelevel){this.level=o}if(this.floorPins[this.level]){WH.ae(this.span,this.floorPins[this.level])}}else{if(g.link!=null){this.setLink(g.link)}}}this.updateMap(m)},fixLevel:function(h,g){if(Mapper.remappedLevels[g]&&Mapper.remappedLevels[g].hasOwnProperty(h)){return Mapper.remappedLevels[g][h]}if(Mapper.multiLevelZones.hasOwnProperty(g)){var f=parseInt(Mapper.multiLevelZones[g][0].substr((""+g).length+1));var d;for(var c=1;c<Mapper.multiLevelZones[g].length;c++){d=parseInt(Mapper.multiLevelZones[g][c].substr((""+g).length+1));if(Math.abs(h-d)<Math.abs(h-f)){f=d}}return f}return h},getZone:function(){return this.zone},setZone:function(c,f,d){this.pins=[];this.nCoords=0;if(this.floorPins[this.level]){WH.de(this.floorPins[this.level])}this.floorPins={};if(this.floorButton){WH.de(this.floorButton);this.floorButton=null}this.zone=c;this.level=f||0;this.updateMap(d);return true},getFloorsMenu:function(){if(!Mapper.multiLevelZones[this.zone]){return null}var h=[];var o=Mapper.multiLevelZones[this.zone];var c=(Mapper.zonePhased[this.zone]?g_zone_phases:g_zone_areas);var q=(function(u){return u[MENU_IDX_NAME]==this.mapName||(this.level===undefined&&u[MENU_IDX_NAME]==0)}).bind(this);var f,p,d;for(var t=0;p=o[t];t++){var r=0;var m=p.indexOf("-");var l=p.indexOf("_");if(m<0){f=t}else{if(l>=0){f=p.substring(m+1,l);r=p.substr(l+1)}else{f=p.substr(m+1)}}var g=this.getMapDisplayName(p,this.zone,f,r);d=[p,g,this.setMap.bind(this,p,f,r,true)];d[MENU_IDX_OPT]={checkedFunc:q};h.push(d)}return h},getMapDisplayName:function(l,f,m,d){var h="";var g;if(Mapper.zonePhased[f]&&g_zone_phases[f]){var c=Mapper.multiLevelZones[f].indexOf(l);if(g_zone_phases[f].hasOwnProperty(c)){g=g_zone_phases[f][c]}}if(g_zone_areas[f]&&g_zone_areas[f].hasOwnProperty(m)){h=g_zone_areas[f][m]}else{if(g_zone_playerconditions[f]&&g_zone_playerconditions[f].hasOwnProperty(d)){h=g_zone_playerconditions[f][d]}else{if(g){h=g}else{if(this.onlyPhases){h=WH.Strings.sprintf(WH.TERMS.zonePhase_format,d)}else{if(Mapper.multiLevelZones[f].filter(function(o){return o.indexOf("-"+m+"_")!=-1}).length+(m==0?1:0)>1){h=WH.Strings.sprintf(WH.TERMS.zoneLevelPhase_format,m,d)}else{h=WH.Strings.sprintf(WH.TERMS.zoneLevel_format,m)}}}}}return h},setMap:function(f,d,o,m){if(d!=this.level){if(this.floorPins[this.level]){WH.de(this.floorPins[this.level])}if(this.floorPins[d]){WH.ae(this.span,this.floorPins[d])}this.level=d}this.mapName=f;this.phase=o;this.span.style.background="url("+WH.staticUrl+this.rootMapDir+"/"+this.localeDir+"/"+Mapper.sizes[this.zoom][2]+"/"+f+".jpg?"+WH.getDataBuild()+")";if(this.overlay){this.overlaySpan.style.background="url("+WH.staticUrl+this.rootMapDir+"/overlay/"+Mapper.sizes[this.zoom][2]+"/"+f+".png?"+WH.getDataBuild()+")"}if(this.sZoneLink&&!this.noZoneName){var l="";var g=parseInt(this.zone);var p=g_zones[g]!=null;var c=(Mapper.zonePhased[this.zone]?g_zone_phases:g_zone_areas);if(p){if(this.zoneLink){l+='<a href="/zone='+g+'">'+g_zones[g]+"</a>"}if(Mapper.multiLevelZones[g]){if(this.zoneLink){l+=": "}l+=this.getMapDisplayName(f,g,d,o)}WH.setInnerHtml(this.sZoneLink,l,"div");if(this.zoneLink){for(var h=0;h<9;++h){if(h==4){continue}this.sZoneLink.childNodes[h].firstChild.style.color="black"}}}this.sZoneLink.style.display=p?"":"none"}if(m){this.onMapUpdate&&this.onMapUpdate(this)}},setObjectives:function(m){var d={start:1,end:1,startend:1,sourcestart:1,sourceend:1};for(var q in m){var p=m[q];if(g_mapperData[q]===undefined){g_mapperData[q]={}}for(var f in p.levels){var c=p.levels[f];var o=ShowOnMap.combinePins(c);var g=o[0];g_mapperData[q][f]={count:g.length,coords:[]};for(var h=0;h<g.length;++h){var r=ShowOnMap.buildTooltip(g[h].list);g_mapperData[q][f].coords.push([g[h].coord[0],g[h].coord[1],{type:r[1],url:r[2],menu:r[3],label:r[0]}])}}}},setZones:function(t,u){t=$("#"+t);if(!t||!u||u.length==0||!this.objectives){return}var z=function(K,J,H,O){var I=[false,-1];for(var M=0;M<H.length;++M){if(M>0){A.append((M==H.length-1?WH.TERMS.and_lc:WH.TERMS.comma_punct))}var N=null;if(K.objectives[H[M][0]].mappable>0){N=$("<a/>",{href:"javascript:",text:K.objectives[H[M][0]].zone});N.click(function(Q,P){K.update({zone:P});WH.setSelectedLink(Q,"mapper")}.bind(K,N[0],H[M][0]));N.isLink=true}else{N=$("<a/>",{href:"/zone="+H[M][0],text:K.objectives[H[M][0]].zone});WH.Tooltip.simple(N[0],WH.TERMS.zonelink_tip,"q")}if(u.length>1){var L=O[H[M][0]];if(L.start&&L.end){N.addClass("icontiny");N.css("background-image","url("+WH.staticUrl+"/images/wow/icons/tiny/quest_startend.gif)");N.css("padding-left","20px")}else{if(L.start){N.addClass("icontiny");N.css("background-image","url("+WH.staticUrl+"/images/wow/icons/tiny/quest_start.gif)");N.css("padding-left","14px")}else{if(L.end){N.addClass("icontiny");N.css("background-image","url("+WH.staticUrl+"/images/wow/icons/tiny/quest_end.gif)");N.css("padding-left","16px")}}}}J.append(N);if(H[M][1]>I[1]){I=[N,H[M][1]]}}return I[0]};var g=function(H,L,K){var I=[];for(var J=0;J<H.length;++J){if(L[H[J][0]][K]){I.push(H[J])}}return I};var l={};var p={start:[],end:[],objective:[]};for(var q in this.objectives){if(l[q]===undefined){l[q]={}}var C=this.objectives[q];for(var G in C.levels){var d=C.levels[G];for(var B=0;B<d.length;++B){if(d[B].point=="start"||d[B].point=="sourcestart"){p.start.push(q);l[q].start=true}else{if(d[B].point=="end"||d[B].point=="sourceend"){p.end.push(q);l[q].end=true}else{if(d[B].point=="requirement"||d[B].point=="sourcerequirement"){p.objective.push(q);l[q].objective=true}}}}}}t.append(WH.getMajorHeading(WH.TERMS.relevantlocations,2,3));if(u.length==1&&this.missing==0){var A=$("<span/>",{html:WH.TERMS.questobjectives1zone_tip.replace("$$","<b>"+this.objectives[u[0][0]].zone+"</b>.")});t.append(A);this.update({zone:u[0][0]})}else{if(this.missing>0){var m=function(J,I){if(J.length!=I.length){return false}var H={};for(var L=J.length;L>=0;--L){H[J[L]]=true}for(var K=I.length;K>=0;--K){if(H[I[K]]===undefined){return false}}return true};var A=$("<span/>");var c=false,f=false,w=false;p.objective=WH.arrayUnique(p.objective);p.start=WH.arrayUnique(p.start);p.end=WH.arrayUnique(p.end);var D=p.start.length>0&&m(p.start,p.end);var h=p.start.length>0&&m(p.start,p.objective);var F=p.end.length>0&&m(p.end,p.objective);var E=g(u,l,"objective");var r=g(u,l,"start");var o=g(u,l,"end");switch(true){case!!(D&&h):var v=WH.TERMS.partofquesthappensin_format.split("$$");A.text(v[0]);c=z(this,A,u,l);A.append(v[1]);break;case!!(D&&p.objective.length==0):var v=LANG.mapper_objectives.sex.split("$$");A.text(v[0]);c=z(this,A,u,l);A.append(v[1]);break;case!!(D):var v=LANG.mapper_objectives.ox_sey.split("$$");A.text(v[0]);c=z(this,A,r,l);A.append(v[1]);f=z(this,A,E,l);A.append(v[2]);break;case!!(h&&p.end.length==0):var v=LANG.mapper_objectives.osx.split("$$");A.text(v[0]);c=z(this,A,u,l);A.append(v[1]);break;case!!(h):var v=LANG.mapper_objectives.osx_ey.split("$$");A.text(v[0]);c=z(this,A,E,l);A.append(v[1]);f=z(this,A,o,l);A.append(v[2]);break;case!!(F&&p.start.length==0):var v=LANG.mapper_objectives.oex.split("$$");A.text(v[0]);c=z(this,A,u,l);A.append(v[1]);break;case!!(F):var v=LANG.mapper_objectives.oex_sy.split("$$");A.text(v[0]);c=z(this,A,r,l);A.append(v[1]);f=z(this,A,E,l);A.append(v[2]);break;case!!(p.start.length>0&&p.end.length>0&&p.objective.length>0):var v=LANG.mapper_objectives.ox_sy_ez.split("$$");A.text(v[0]);c=z(this,A,r,l);A.append(v[1]);f=z(this,A,E,l);A.append(v[2]);w=z(this,A,o,l);A.append(v[3]);break;case!!(p.start.length>0&&p.end.length>0):var v=LANG.mapper_objectives.sx_ey.split("$$");A.text(v[0]);c=z(this,A,r,l);A.append(v[1]);f=z(this,A,o,l);A.append(v[2]);break;case!!(p.start.length>0&&p.objective.length>0):var v=LANG.mapper_objectives.ox_sy.split("$$");A.text(v[0]);c=z(this,A,r,l);A.append(v[1]);f=z(this,A,E,l);A.append(v[2]);break;case!!(p.end.length>0&&p.objective.length>0):var v=LANG.mapper_objectives.ox_ey.split("$$");A.text(v[0]);c=z(this,A,E,l);A.append(v[1]);f=z(this,A,o,l);A.append(v[2]);break;case(p.start.length>0):var v=LANG.mapper_objectives.sx.split("$$");A.text(v[0]);c=z(this,A,u,l);A.append(v[1]);break;case(p.end.length>0):var v=LANG.mapper_objectives.ex.split("$$");A.text(v[0]);c=z(this,A,u,l);A.append(v[1]);break;case(p.objective.length>0):var v=LANG.mapper_objectives.ox.split("$$");A.text(v[0]);c=z(this,A,u,l);A.append(v[1]);break;default:var v=WH.TERMS.partofquesthappensin_format.split("$$");A.text(v[0]);c=z(this,A,u,l);A.append(v[1]);break}t.append(A);if(c&&c.isLink){c.click()}else{if(f&&f.isLink){f.click()}else{if(w&&w.isLink){w.click()}}}}else{var v=WH.TERMS.partofquesthappensin_format.split("$$");var A=$("<span/>",{text:v[0]});var c=z(this,A,u,l);A.append(v[1]);t.append(A);if(c&&c.isLink){c.click()}}}},setSize:function(c,d){this.tempWidth=c;this.tempHeight=d;this.updateMap(true)},getZoom:function(){return this.zoom},setZoom:function(c,d){this.zoom=c;this.tempWidth=this.tempHeight=null;this.updateMap(d)},toggleZoom:function(d){this.zoom=1-this.zoom;this.zoom++;this.updateMap(true);if(d){this.updateMouseCoords(d)}if(this.sZoom){if(this.sZoom.style.display=="none"){this.sZoom.style.display=""}else{this.sZoom.style.display="none"}}if(this.zoom){var c=Platform.getViewportSize();if(c.width>=900){MapViewer.show({mapper:this,zoom:this.zoom})}}},getShow:function(){return this.show},setShow:function(c){this.show=c;var g=this.show?"":"none";for(var f in this.floorPins){this.floorPins[f].style.display=g}this.sToggle.innerHTML=this.show?WH.TERMS.hidepins_stc:WH.TERMS.showpins_stc},toggleShow:function(){this.setShow(!this.show)},getCoords:function(){var c=[];for(var d in this.pins){if(!this.pins[d].free){c.push([this.pins[d].x,this.pins[d].y])}}return c},clearPins:function(){for(var c in this.pins){this.pins[c].style.display="none";this.pins[c].free=true}},setCoords:function(u,f,B,z){var h;var c,g;if(f===undefined){this.clearPins();if(u.length){g=true;c=0}else{for(let i in u){c=i;break}if(c==null){return}u=u[c]}c=parseInt(c);if(!g){c=this.fixLevel(c,this.zone);this.level=c}}else{c=f;if(!u.length){u=u[c]&&u[c].length?u[c]:[]}}this.nCoords=u.length;B=B||this.uiMapId;z=z||this.uiMapName;for(let i in u){var t=u[i],d=t[2];if(t[0]===undefined||t[1]===undefined){continue}if(t[0]===null||t[1]===null){var w=this.parent.id?this.parent.id.replace(/^mapper-parent-/,""):this.parent;if(g_zones[w]){w=g_zones[w]}WH.error("Bad coordinates for",w,"-- Pin Coords:",t);continue}h=this.getPin(c);h.x=t[0];h.y=t[1];h.style.left=h.x+"%";h.style.top=h.y+"%";let pinHasAction=false;if(this.editable&&!(d&&d.locked)){h.a.onmouseup=this.delPin.bind(this,h);pinHasAction=true}else{if(d&&d.url){h.a.href=WH.markup.getFixedUrl(d.url);h.a.rel="np"+(d.rel?"&"+d.rel:"");h.a.style.cursor="pointer";pinHasAction=true}}if(d&&d.tooltip){h.a.tt="";var A=false;for(var C in d.tooltip){if(h.a.tt!=""){h.a.tt+="<br />"}h.a.tt+='<b class="q">'+C+"</b> ($)<br />";for(var m in d.tooltip[C].info){h.a.tt+="<div>"+d.tooltip[C].info[m]+"</div>"}if(!A&&d.tooltip[C].footer){h.a.tt+=d.tooltip[C].footer+"<br />";A=true}}}else{if(d&&d.label){h.a.tt=d.label}else{if(d&&d.fixTooltip){h.a.rel=h.a.rel.replace(/^np&?/,"");WH.dE(h.a,"mouseover",this.pinOver);WH.dE(h.a,"mouseout",WH.Tooltip.hide);h.a.tt="";if(typeof d.fixTooltip=="function"){h.a._fixTooltip=d.fixTooltip}}else{h.a.tt="$";if(!pinHasAction){WH.dE(h.a,"mouseover",this.pinOver);let options={getAllCoords:(function(){let u=[];WH.qsa("div.pin a",this.floorPins[c]).forEach(function(p){if(typeof p.tt==="string"){u.push(p.tt.split(", "))}});return u}).bind(this)};if(B){options.uiMapId=B}if(z){options.uiMapName=z}if(this.name){options.name=this.name}WH.Wow.UiMap.clickToCopyCoordinates(h.a,(function(){return this.tt.split(", ")}).bind(h.a),options)}}}}if(d&&d.menu){h.a.menu=d.menu;Menu.add(h.a,h.a.menu,{showAtCursor:true})}if(d&&d.type){h.className+=" pin-"+d.type}if(d&&d.mapicon){h.className+=" pin-object";h.a.style.backgroundPosition=(((d.mapicon+2)%8)*-16)+"px "+(Math.floor((d.mapicon+2)/8)*-16)+"px"}h.a.tt=WH.stringReplace(h.a.tt,"$",h.x.toFixed(1)+", "+h.y.toFixed(1));if(d&&d.lines){for(var r=0,l=d.lines.length;r<l;++r){if(t[0]==d.lines[r][0]&&t[1]==d.lines[r][1]){continue}for(var o=0,v=Mapper.sizes.length;o<v;++o){var q=Mapper.sizes[o];h=this.line(t[0]*q[0]/100,t[1]*q[1]/100,d.lines[r][0]*q[0]/100,d.lines[r][1]*q[1]/100,d.type);h.className+=" "+q[2];WH.ae(this.floorPins[c],h)}}}if(d&&d.dataset){WH.cO(h.dataset,d.dataset)}}this.onPinUpdate&&this.onPinUpdate(this)},getLink:function(){var d="";for(var c in this.pins){if(!this.pins[c].free&&this.pins[c].floor==this.level){d+=(this.pins[c].x<10?"0":"")+(this.pins[c].x<1?"0":"")+(this.pins[c].x*10).toFixed(0)+(this.pins[c].y<10?"0":"")+(this.pins[c].y<1?"0":"")+(this.pins[c].y*10).toFixed(0)}}return(this.zone?this.zone:"")+(Mapper.multiLevelZones[this.zone]&&this.level!=0?"."+this.level:"")+(d?":"+d:"")},setLink:function(m,g,q){var p=[];m=m.split(":");var h=m[0];var c=0;if(h.indexOf(".")!=-1){var d=h.split(".");h=d[0];c=parseInt(d[1])}c=(q&&q!=-1&&!c)?q:c;if(!this.setZone(h,c,g)){return false}if(m.length==2){for(var f=0;f<m[1].length;f+=6){var o=m[1].substr(f,3)/10;var l=m[1].substr(f+3,3)/10;if(isNaN(o)||isNaN(l)){break}p.push([o,l])}}this.setCoords(p,c);return true},updateMap:function(f){this.parent.style.width=this.span.style.maxWidth=(this.tempWidth?this.tempWidth:Mapper.sizes[this.zoom][0])+"px";this.span.style.maxHeight=(this.tempHeight?this.tempHeight:Mapper.sizes[this.zoom][1])+"px";this.parent.setAttribute("data-mapsize",Mapper.sizes[this.zoom][2]);if(!this.editable){this.parent.style.cssFloat=this.parent.style.styleFloat="left"}if(this.zone=="0"){this.span.style.background="black"}else{var h=this.level;var c=this.phase;var g=this.zone+(h?"-"+h:"");if(Mapper.multiLevelZones[this.zone]&&Mapper.multiLevelZones[this.zone][h]){g=Mapper.multiLevelZones[this.zone][h];if(c!=0){g+="_"+c}}else{if(Mapper.garrisonLevelsToMapTiers[this.zone]&&Mapper.garrisonLevelsToMapTiers[this.zone][h]){g=this.zone+"__"+Mapper.garrisonLevelsToMapTiers[this.zone][h]}}this.setMap(g,h,c);if(!this.floorButton&&Mapper.multiLevelZones[this.zone]){var d;this.floorButton=d=WH.createButton((Mapper.zonePhased[this.zone]?WH.TERMS.changephase_ellipsis:WH.TERMS.changefloor_ellipsis));d.menu=this.getFloorsMenu();if(d.menu&&d.menu.length){Menu.add(d,d.menu,{showAtElement:true})}d.style["float"]="right";this.buttonDiv.appendChild(d)}else{if(this.floorButton){this.floorButton.style.display=Mapper.multiLevelZones[this.zone]?"":"none"}}}if(this.sToggle){this.sToggle.style.display=(this.toggle&&this.nCoords?"":"none")}$(".line",this.floorPins[h]).hide();$(".line."+Mapper.sizes[this.zoom][2],this.floorPins[h]).show();this.onMapUpdate&&this.onMapUpdate(this)},cleanPin:function(f,g){var d=this.pins[f];d.style.display="";d.free=false;d.className="pin";for(var c in d.dataset){if(d.dataset.hasOwnProperty(c)){delete d.dataset[c]}}d.a.onmousedown=WH.rf;d.a.onmouseup=WH.rf;d.a.href="javascript:";d.a.style.cursor="default";d.floor=g;return d},getPin:function(g){for(var f=0;f<this.pins.length;++f){if(this.pins[f].free){return this.cleanPin(f,g)}}var d=WH.ce("div"),c=WH.ce("a");d.className="pin";d.appendChild(c);d.a=c;d.floor=g;WH.aE(c,"mouseover",this.pinOver);WH.aE(c,"mouseout",WH.Tooltip.hide);c.onclick=WH.sp;this.pins.push(d);this.cleanPin(this.pins.length-1,g);if(!this.floorPins[g]){this.floorPins[g]=WH.ce("div");this.floorPins[g].style.display=this.show?"":"none";if(g==this.level){WH.ae(this.span,this.floorPins[g])}}WH.ae(this.floorPins[g],d);return d},addPin:function(d){d=WH.normalizeEvent(d);if(d._button>=2){return}this.updateMouseCoords(d);var c=this.getPin(this.level);c.x=this.mouseX;c.y=this.mouseY;c.style.left=c.x.toFixed(1)+"%";c.style.top=c.y.toFixed(1)+"%";c.a.onmouseup=this.delPin.bind(this,c);c.a.tt=c.x.toFixed(1)+", "+c.y.toFixed(1);this.onPinUpdate&&this.onPinUpdate(this);return false},delPin:function(c,d){d=WH.normalizeEvent(d);c.style.display="none";c.free=true;WH.sp(d);WH.Tooltip.hide();this.onPinUpdate&&this.onPinUpdate(this)},pinOver:function(){WH.Tooltip.show(this,this.tt,4,0)},updateMouseCoords:function(c){let offset=WH.getOffset(this.parent);let scroll=WH.getScroll();this.mouseX=Math.floor((c.clientX+scroll.x-offset.left-3)/Mapper.sizes[this.zoom][0]*1000)/10;this.mouseY=Math.floor((c.clientY+scroll.y-offset.top-3)/Mapper.sizes[this.zoom][1]*1000)/10;if(this.mouseX<0){this.mouseX=0}else{if(this.mouseX>100){this.mouseX=100}}if(this.mouseY<0){this.mouseY=0}else{if(this.mouseY>100){this.mouseY=100}}if(this.mouse){WH.setTextNodes(this.sMouse,"("+this.mouseX.toFixed(1)+", "+this.mouseY.toFixed(1)+")")}},line:function(h,u,f,t,p){var m=Math.min(h,f);var w=Math.max(h,f);var r=Math.min(u,t);var c=Math.max(u,t);var g=(w-m);var z=(c-r);var l=Math.sqrt(Math.pow(g,2)+Math.pow(z,2));var q=Math.atan2(z,g);var d=Math.sin(q);var o=Math.cos(q);var v=$('<span class="line" />').css({top:r.toFixed(2)+"px",left:m.toFixed(2)+"px",width:g.toFixed(2)+"px",height:z.toFixed(2)+"px"}).append($("<var />").css({width:l.toFixed(2)+"px","-o-transform":"rotate("+q+"rad)","-moz-transform":"rotate("+q+"rad)","-webkit-transform":"rotate("+q+"rad)",filter:"progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand', M11="+o+", M12="+(-1*d)+", M21="+d+", M22="+o+")"}));if(!(h==m&&u==r)&&!(f==m&&t==r)){v.addClass("flipped")}if(p!=null){v.addClass("line-"+p)}return v[0]}};var g_zone_areas={};var MapViewer=new function(){var u,C,F,c,B,g,q,o,d,r,v,f,A,D;function t(){var G=Math.max(50,Math.min(618,WH.getWindowSize().h-72));c=1;F=1;if(c>1){c=1}if(F>1){F=1}u=Math.round(F*Mapper.sizes[MapViewer.getZoom()][0]);C=Math.round(F*Mapper.sizes[MapViewer.getZoom()][1]);if(f){$(".mapviewer-screen-sizer",f).remove();var H=WH.ce("div",{className:"mapviewer-screen-sizer"});H.style.paddingTop=C/u*100+"%";WH.ae(f,H)}var I=Math.max(480,u);Lightbox.setSize(I+Lightbox.UI_WIDTH)}function h(G){var H=function(K,J){J+=":"+K.zone;if(K.level){J+="."+K.level}return J};var I="#map";if(d){I+="="+B.getLink()}else{if(Mapper.zoneDefaultLevel[B.zone]){if(Mapper.zoneDefaultLevel[B.zone]!=B.level){I=H(B,I)}}else{if(B.level!=0){I=H(B,I)}else{if((!WH.isSet("g_mapperData")||!g_mapperData[B.zone])&&(!WH.isSet("g_mapper_data")||!g_mapper_data[B.zone])){I=H(B,I)}}}}return I}function z(){if(q){q(B)}location.replace(h(true))}function E(G){if(G&&(F==c)&&WH.getWindowSize().h>v.offsetHeight){return}v.style.visibility="hidden";t(0);if(!G){if(!r){r=WH.ce("div");r.style.height="325px";r.style.padding="3px";r.style.marginTop="10px"}B.parent.style.borderWidth="0px";B.parent.style.marginTop="0px";B.span.style.cursor="pointer";if(B.span.onclick){g=B.span.onclick}B.span.onclick=Lightbox.hide;B.span.onmouseover=function(){D.style.display="block"};B.span.onmouseout=function(){setTimeout(function(){if(!D.hasMouse){D.style.display="none"}},10)};if(B.onMapUpdate){q=B.onMapUpdate}B.onMapUpdate=z;if(!d){o=B.parent.parentNode;o.insertBefore(r,B.parent);WH.de(B.parent);WH.ae(A,B.parent)}else{WH.de(d);WH.ae(A,d)}if(location.hash.indexOf("#show")==-1){location.replace(h(false))}else{if(WH.isSet("mapShower")){mapShower.onExpand()}}}Lightbox.reveal();v.style.visibility="visible"}function m(){E(1)}function l(){if(g){B.span.onclick=g}else{B.span.onclick=null}g=null;if(q){B.onMapUpdate=q}else{B.onMapUpdate=null}q=null;B.span.style.cursor="";B.span.onmouseover=null;B.span.onmouseout=null;if(!d){WH.de(B.parent);B.parent.style.borderWidth="";B.parent.style.marginTop="";if(r){if(!r.parentNode){return}o.insertBefore(B.parent,r)}else{WH.ae(o,B.parent)}WH.de(r);o=null}else{WH.de(d);d=null}B.toggleZoom();if(location.hash.indexOf("#show")==-1){WH.clearHash()}else{if(WH.isSet("mapShower")){mapShower.onCollapse()}}}function w(H,K,I){B=I.mapper;v=H;if(K){H.className+=" mapviewer";f=WH.ce("div");f.style.width=Mapper.sizes[MapViewer.getZoom()][0]+"px";f.style.height=Mapper.sizes[MapViewer.getZoom()][1]+"px";f.className="lightbox-content mapviewer-screen";D=WH.ce("a");D.className="mapviewer-cover";D.href="javascript:";D.onclick=Lightbox.hide;D.onmouseover=function(){D.hasMouse=true};D.onmouseout=function(){D.hasMouse=false};var L=WH.ce("span");var G=WH.ce("b");WH.ae(G,WH.ct(WH.TERMS.close));WH.ae(L,G);WH.ae(D,L);WH.ae(f,D);A=WH.ce("div");WH.ae(f,A);WH.ae(H,f);var J=WH.ce("a");J.className="dialog-option fa fa-times";J.href="javascript:";J.onclick=Lightbox.hide;WH.ae(J,WH.ct(WH.TERMS.close));WH.ae(H,J)}p()}function p(){E()}this.checkPound=function(){if(location.hash&&location.hash.indexOf("#map")==0){var K=location.hash.split("=");if(K.length==2){var I=K[1];if(I){MapViewer.show({link:I})}}else{K=location.hash.split(":");var J=WH.ge("sjdhfkljawelis");if(J){J.onclick()}if(K.length==2){if(!J){MapViewer.show({link:K[1]})}var G=K[1].split(".");var H={zone:G[0]};if(G.length==2){H.level=parseInt(G[1])+1}B.update(H)}}}};this.getZoom=function(){if(typeof this.zoom=="number"){return this.zoom}return 1};this.show=function(G){this.zoom=G.zoom;WH.Track.interactiveEvent("Zone Maps","Show",(G.link?G.link:"General"));if(G.link){d=WH.ce("div");d.id="fewuiojfdksl";WH.ae(document.body,d);var H=new Mapper({parent:d.id});H.setLink(G.link,true);H.toggleZoom()}else{Lightbox.show("mapviewer",{onShow:w,onHide:l,onResize:m},G)}};$(document).ready(this.checkPound)};WH.markup=new function(){var c="abc";var f;var d;this.MODE={COMMENT:1,ARTICLE:2,QUICK_FACTS:3,SIGNATURE:4,REPLY:5};this.CLASS={ADMIN:40,STAFF:30,PREMIUM:20,USER:10,PENDING:1};this.modes={};this.modes[this.MODE.COMMENT]="comment";this.modes[this.MODE.REPLY]="reply";this.modes[this.MODE.ARTICLE]="article";this.modes[this.MODE.QUICK_FACTS]="quickfacts";this.modes[this.MODE.SIGNATURE]="signature";this.globalAttributes={id:{req:false,valid:/^[a-z0-9_-]+$/i},title:{req:false,valid:/[\S ]+/},"class":{req:false,valid:/\S+/}};this.regex={cssUnitOrInt:/\d+(%|px|em)?/,domain:/^((www|classic|ptr|beta|mop|wod|legion|bfa|shadowlands|sl)$|((ko|fr|de|cn|es|ru|pt|it)($|\.(classic|ptr|beta|shadowlands|sl)$)))/,isInt:/^[0-9]+$/,intCsv:/^[0-9,]+$/,noWhitespace:/^\S+$/,subdomainEnv:{PTR:/(^|\.)ptr\./,BETA:/(^|\.)(?:beta|shadowlands|sl|bfa|legion|wod|mop)\./}};this.mode=this.MODE.ARTICLE;this.allow=this.CLASS.STAFF;this.root=undefined;this.dbPage=false;this.isPreview=false;this.inNewsType=0;this.mediaUid=c;this.tags={};this.initialized=false;this.disabledEnvironments={BETA:false,PTR:false};this.firstTags={};this.postTags=[];this.collectTags={};this.excludeTags={};this.tooltipTags={};this.tooltipTagsWithRawText={};this.applyCommonAttributes=function(m,h){if(WH.markup.allow<this.CLASS.STAFF){return}if(h.id){m.id=h.id}if(h.title){m.title=h.title}if(h["class"]){if(m.className){m.className+=" "+h["class"]}else{m.className=h["class"]}}if(h.style){var l=m.getAttribute("style");if(l){m.setAttribute("style",l+"; "+h.style)}else{m.setAttribute("style",h.style)}}if(h["data-highlight"]){m.setAttribute("data-highlight",h["data-highlight"])}};this.getTagByEntityType=function(l){if(!l){return null}let requiredTrees=WH.Types.getRequiredTrees(l);if(requiredTrees&&!requiredTrees.includes(WH.getDataTree())){return null}for(var h in WH.markup.tags){if(WH.markup.tags.hasOwnProperty(h)&&WH.markup.tags[h].entityType===l){return h}}return null};this.init=function(){if(this.initialized){return}var p=[],l=[],o=[];for(var h in WH.markup.tags){if(!WH.markup.tags.hasOwnProperty(h)){continue}if(WH.markup.tags[h].block){WH.markup.firstTags[h]=true}if(WH.markup.tags[h].exclude){for(var m in WH.markup.tags[h].exclude){if(!WH.markup.tags[h].exclude.hasOwnProperty(m)){continue}if(!this.excludeTags[m]){this.excludeTags[m]={}}this.excludeTags[m][h]=WH.markup.tags[h].exclude[m]}}if(WH.markup.tags[h].post){this.postTags.push(h)}if(WH.markup.tags[h].trim){o.push(h)}if(WH.markup.tags[h].ltrim){p.push(h)}if(WH.markup.tags[h].rtrim){l.push(h)}}if(p.length>0){this.ltrimRegex=new RegExp("\\s*\\[("+p.join("|")+")([^a-z0-9]+.*)?]","ig")}if(l.length>0){this.rtrimRegex=new RegExp("\\[/("+l.join("|")+")\\]\\s*","ig")}if(o.length>0){this.trimRegex=new RegExp("\\s*\\[("+o.join("|")+")([^\\[]*)?\\]\\s*","ig")}this.initialized=true;$(function(){$("body").delegate("[data-highlight]","mouseenter",function(){var q=$(this).attr("data-highlight").split(":");if(q.length!=2){return}var r=$("#"+q[0]).get(0),v=parseInt(q[1]),u=$(r).val();if(!r||!v||!u){return}var t=$(r).val(u.substr(0,v))[0].scrollHeight;$(r).val(u).animate({scrollTop:t},250);r.selectionStart=v;r.selectionEnd=v})})};this.assembleDomNode=function(h,m){if(h===null){return document.createDocumentFragment()}if(!(h instanceof Node)){WH.Track.nonInteractiveEvent("Markup","Legacy HTML",JSON.stringify(h));if((g_user.roles&U_GROUP_ADMIN)&&!this.convertToDomNodeWarned){this.convertToDomNodeWarned=true;alert("Some markup on this page returned something other than a node!")}var o=document.createDocumentFragment();o.appendChild(WH.ct(h));return o}if(m){var l;if(h instanceof Element&&h.dataset.markupContentTarget){l=h}else{if(h.querySelector&&h.querySelector("[data-markup-content-target]")){l=h.querySelector("[data-markup-content-target]")}else{l=h;while(l.hasChildNodes()&&l.firstChild instanceof Element){l=l.firstChild}}}l.appendChild(m)}return h};this.getDatabaseDomainInfo=function(m){var o=function(v){var w={};v=(v||"").split(".");if(v.length>2){WH.warn("Markup trying to parse long domain",v)}var u=v.length?v[v.length-1]:"";if(u){if((new RegExp("^"+WH.Url.getBetaSubdomain()+"$")).test(u)){w.dataEnv=WH.dataEnv.BETA}else{for(var t in WH.dataEnv){if(!WH.dataEnv.hasOwnProperty(t)||!WH.dataEnvTerm.hasOwnProperty(WH.dataEnv[t])){continue}if((new RegExp("^"+WH.dataEnvTerm[WH.dataEnv[t]]+"$")).test(u)){w.dataEnv=WH.dataEnv[t];break}}}}var z=v[0];if(z){if(WH.getLocaleFromDomain.L.hasOwnProperty(z)){w.locale=WH.getLocaleFromDomain.L[z]}else{if(z==="www"){w.locale=LOCALE_ENUS}}if(!w.hasOwnProperty("dataEnv")){w.dataEnv=WH.dataEnv.MAIN}}return w};var r=o(m.domain||m.site);var l=r.locale;if(l===undefined&&d!==undefined){l=d}if(l===null){l=Locale.getId()}var q=r.dataEnv||f||WH.getDataEnv();if(q===WH.dataEnv.PTR&&WH.markup.disabledEnvironments.PTR){q=WH.dataEnv.MAIN}if(q===WH.dataEnv.BETA&&WH.markup.disabledEnvironments.BETA){q=WH.dataEnv.MAIN}var p=WH.Url.getSubdomain(q,l);var h={host:WH.Url.generate("",{subdomain:p}).replace(/\/$/,""),nameKey:"name_"+Locale.getName(l),subdomain:p||"www",dataEnv:q,localeId:l};return h};this.getEscapedHtml=function(h){h=h.replace(/&nbsp;/g,WH.Strings.nbsp).replace(/&ndash;/g,"\u2013").replace(/&mdash;/g,"\u2014");return WH.Strings.escapeHtml(h)};this.getFixedUrl=function(h){if(!h){return""}var l=h.charAt(0);if(l==="/"||l==="?"){h=h.replace(/^[\/\?]+/,"");h="/"+h}return h};this.getDomFragment=function(l,o){if(!o){o={}}if(!o.allow){if(o.roles){o.allow=this.rolesToClass(o.roles)}else{o.allow=this.CLASS.STAFF}}try{var h=g(l,o);var p=h.toNode()}catch(m){var p=WH.ce("div",{className:"q10"},WH.ct("Whoops, markup engine error!"));WH.ae(p,WH.ce("br"));WH.ae(p,WH.ct(m));WH.error(m)}if(o.prepend){$(p).prepend($.parseHTML(o.prepend))}if(o.append){$(p).append($.parseHTML(o.append))}return p};this.getImageUploadIds=function(l,m){var h=g(l,m);return h.imageUploadIds()};this.getMarkupFromHtml=function(l,o){var m=l.replace(/\n+/g,"");m=m.replace(/\s+/g," ");m=m.replace(/> </g,"><");m=m.replace(/&amp;/gi,"&");m=m.replace(/(&#160;|$nbsp;)/gi," ");for(var h in WH.markup.tags){if(WH.markup.tags.hasOwnProperty(h)&&WH.markup.tags[h].fromHtml){m=WH.markup.tags[h].fromHtml(m,o)}}m=m.replace(/<style\b[\s\S]*?>[\s\S]*?<\/style>/g,"");m=m.replace(/<\/?[a-z][a-z0-9]*\b[\s\S]*?>/g," ");m=m.replace(/<!--(.*?)-->/g,"");m=m.replace(/\n[\n]+/g,"\n\n");m=m.replace(/[ ]+/g," ");m=m.replace(/\t/g,"  ");return WH.trim(m)};this.isUrlExternal=function(l){if(!l){return false}var h=WH.ce("a");h.href=l;return!(!h.hostname||/(^|\.)wowhead\.com$/.test(h.hostname))};this.isUrlSafe=function(l,m){if(!l){return true}if(l==="javascript:"){return true}var h=l.match(/^([^:\\./]+):/i);if(h&&h[1]){var o=h[1];if(o==="http"||o==="https"){return true}if(m&&(o==="mailto"||o==="irc")){return true}return false}return true};this.matchOuterTags=function(w,q,B,o){var u=o.indexOf("g")>-1,v=o.replace(/g/g,""),A=new RegExp(q+"|"+B,"g"+v),r=new RegExp(q,v),z=[],C,D,p,h;do{C=0;while(p=A.exec(w)){if(r.test(p[0])){if(!C++){D=A.lastIndex;h=p}}else{if(C){if(!--C){z.push([w.slice(D,p.index),h[0],p[0]]);if(!u){return z}}}}}}while(C&&(A.lastIndex=D));return(z.length?z:false)};this.printHtml=function(l,h,m){var o=WH.ge(h);if(m&&m.removeTableTags){l=l.replace(/\[\/?(td|tr|table)[^\]]*]/g,"")}$(o).empty().append(WH.markup.getDomFragment(l,m));if($(o).find("div.full-tweet").length&&typeof twttr==="object"&&twttr.hasOwnProperty("widgets")){twttr.widgets.load(o)}};this.rolesToClass=function(h){if(h&(U_GROUP_ADMIN|U_GROUP_VIP|U_GROUP_DEV)){return this.CLASS.ADMIN}else{if(h&U_GROUP_STAFF){return this.CLASS.STAFF}else{if(h&U_GROUP_PREMIUM){return this.CLASS.PREMIUM}else{if(h&U_GROUP_PENDING){return this.CLASS.PENDING}else{return this.CLASS.USER}}}}};this.setDataEnv=function(h){switch(h){case WH.dataEnvTerm[WH.dataEnv.PTR]:f=WH.markup.disabledEnvironments.PTR?WH.dataEnv.MAIN:WH.dataEnv.PTR;break;case WH.dataEnvTerm[WH.dataEnv.BETA]:case WH.Url.getBetaSubdomain():f=WH.markup.disabledEnvironments.BETA?WH.dataEnv.MAIN:WH.dataEnv.BETA;break;case WH.dataEnvTerm[WH.dataEnv.CLASSIC]:f=WH.dataEnv.CLASSIC;break;case"tbc":case"bc":f=WH.dataEnv.TBC;break;default:f=WH.dataEnv.MAIN}};this.stripTags=function(l,m){var h=g(l,m);return h.tagless()};function g(J,q){d=undefined;if(q&&q.hasOwnProperty("locale")){d=q.locale}var B=(J||"").replace(/\r/g,"");if(!q){q={}}if(!q.skipReset){WH.markup.mediaUid=q.uid||c;WH.markup.root=q.root;WH.markup.isPreview=q.isPreview||false;WH.markup.dbPage=q.dbPage||false;f=WH.getDataEnv();if(Locale.getDataEnvForcedLocale(f)!==undefined){d=Locale.getDataEnvForcedLocale(f)}WH.markup.disabledEnvironments={BETA:(!WH.isBetaActive()||(q.disabledEnvironments&&q.disabledEnvironments.beta))&&!WH.isBeta(),PTR:(!WH.isPtrActive()||(q.disabledEnvironments&&q.disabledEnvironments.ptr))&&!WH.isPtr()};if(WH.markup.mediaUid!=c){g_screenshots[WH.markup.mediaUid]=[]}}if(q.roles&&(q.roles&(U_GROUP_ADMIN|U_GROUP_EDITOR|U_GROUP_MOD|U_GROUP_BUREAU|U_GROUP_DEV|U_GROUP_BLOGGER))&&q.mode!=WH.markup.MODE.SIGNATURE){q.mode=WH.markup.MODE.ARTICLE}WH.markup.mode=q.mode||WH.markup.MODE.ARTICLE;WH.markup.allow=q.allow||WH.markup.CLASS.STAFF;WH.markup.inNewsType=q.inNewsType?q.inNewsType:0;if(q.stopAtBreak){var H=B.indexOf("[break]");if(H!=-1){B=B.substring(0,H)}}else{B=B.replace("[break]","")}var u=new WH.markup.tree();B=B.trim();if(WH.markup.postTags.length){for(var G in WH.markup.postTags){var P=WH.markup.postTags[G];if(B.indexOf("["+P)!=-1){if(!(WH.markup.tags[P].allowedModes&&WH.markup.tags[P].allowedModes[WH.markup.modes[q.mode]]==undefined)){for(var t in WH.markup.tags[P].collect){WH.markup.collectTags[t]=true}}}}}B=B.replace(/\n(\s*)\n/g,"\n\n");var I=B.length;var F=0,w=0,p=-1,v=-1,m=true,D=false;var l=function(U){var R,T,S;if(U.charAt(0)=='"'||U.charAt(0)=="'"){R=U.charAt(0);var Q=U.indexOf(R,1);if(Q>-1){S=U.substring(1,Q);U=U.substring(Q+1).trim();return{value:S,str:U}}}T=U.indexOf(" ");if(T>-1){S=U.substring(0,T);U=U.substring(T+1).trim()}else{S=U;U=""}return{value:S,str:U}};var K=/^\s*[a-z0-9-]+\s*=/;while(w<I){p=B.indexOf("[",w);if(p>-1){w=p+1;if(p>0&&B.charAt(p-1)=="\\"){m=false;p=-1}else{v=B.indexOf("]",w)}}else{w=I}var h,z={};if(q.highlight&&$(q.highlight)){z["data-highlight"]=q.highlight+":"+p}if(v>-1){var C=B.substring(p+1,v);if(C.charAt(0)=="/"){D=true;h=C.substr(1).trim().toLowerCase()}if(!D){var L=C.indexOf(" "),E=C.indexOf("=");var M;if((E<L||L==-1)&&E>-1){h=C.substring(0,E).toLowerCase();C=C.substring(E+1).trim();var O=l(C);C=O.str;if(WH.markup.tags[h]==undefined||WH.markup.tags[h].attr==undefined||WH.markup.tags[h].attr.unnamed==undefined){m=false}else{z.unnamed=O.value}}else{if(L>-1){h=C.substring(0,L).toLowerCase();C=C.substring(L+1).trim();if(C.indexOf("=")==-1){if(WH.markup.tags[h]==undefined||WH.markup.tags[h].attr==undefined||WH.markup.tags[h].attr.unnamed==undefined){m=false}else{z.unnamed=C}C=""}}else{h=C.toLowerCase();C=""}}if(WH.markup.tags[h]==undefined){m=false}else{if(m){var P=WH.markup.tags[h];while(C!=""){var A="";if(!K.test(C)){A="unnamed"}else{E=C.indexOf("=");if(E==-1){m=false;break}A=C.substring(0,E).trim().toLowerCase();C=C.substring(E+1).trim()}var O=l(C);C=O.str;if(P.attr==undefined||P.attr[A]==undefined){if(WH.markup.globalAttributes[A]==undefined||(WH.markup.globalAttributes[A].valid!=undefined&&!WH.markup.globalAttributes[A].valid.test(O.value))){m=false;break}}z[A]=O.value}if(m&&P.attr){for(var N in P.attr){if(P.attr[N].req&&z[N]==undefined){m=false;break}else{if(z[N]==undefined){continue}}if(P.attr[N].valid!=undefined&&!P.attr[N].valid.test(z[N])){m=false;break}}if(m&&P.validate!=undefined){m=P.validate(z)}}}}}else{if(WH.markup.tags[h]==undefined){m=false}}}else{m=false}if(m){if(F!=p){var r=B.substring(F,p).replace(/\\\[/g,"[");var o={_rawText:r};u.openTag("<text>",o)}if(D){m=u.closeTag(h)}else{m=u.openTag(h,z)}if(m){F=w=v+1}else{F=p}}m=true;D=false;p=v=-1}if(F<I){var r=B.substr(F).replace(/\\\[/g,"[");var o={_rawText:r};u.openTag("<text>",o)}return u}};WH.markup.tags.artifactcalc={empty:true,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},toNode:function(){return null}};WH.markup.tags["azerite-finder"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{"class":{req:true,valid:/.+/},spec:{req:false,valid:/.+/},selectmultiple:{req:false,valid:/^true|false$/},showtiers:{req:false,valid:/^true|false$/},spells:{req:false,valid:/^\d+(,\d+){0,19}$/}},callbacks:[],toNode:function(c){let div=WH.ce("div",{className:"clear azerite-finder-markup-parent",style:{display:"none"}});let createCalc=function(){let query={embed:WH.Strings.guid(),"class":c["class"]};if(c.spec){query.spec=c.spec}if(c.selectmultiple){query.multiselect=c.selectmultiple==="true"?1:0}if(c.showtiers){query.showtier=c.showtiers==="true"?1:0}if(c.spells){query.spellids=c.spells}$(div).load("/azerite-finder?"+WH.Url.buildQuery(query))};if(!WH.Wow.AzeriteFinder){this.callbacks.push(createCalc);if(this.callbacks.length===1){WH.loadAssets("azerite-finder",function(){let callback;while(callback=WH.markup.tags["azerite-finder"].callbacks.shift()){callback()}})}}else{createCalc()}return div}};WH.markup.tags["bloodmallet-chart"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{axiscolor:{req:false,valid:/.+/},azeritetier:{req:false,valid:/.+/},backgroundcolor:{req:false,valid:/.+/},"class":{req:true,valid:/.+/},chartmode:{req:false,valid:/.+/},corruptionrepresentation:{req:false,valid:/.+/},covenant:{req:false,valid:/.+/},entries:{req:false,valid:/^\d+$/},fontcolor:{req:false,valid:/.+/},fightstyle:{req:false,valid:/.+/},spec:{req:true,valid:/.+/},type:{req:false,valid:/.+/}},toNode:function(d){WH.Tools.Highcharts.loadScript(function(){clearTimeout(WH.markup.tags["bloodmallet-chart"].loadScriptsTimeout);WH.markup.tags["bloodmallet-chart"].loadScriptsTimeout=setTimeout(WH.Tools.Bloodmallet.loadCharts,0)});var g=WH.ce("div",{className:"bloodmallet_chart",textContent:WH.TERMS.loading_ellipsis,id:WH.Strings.guid()});g.setAttribute("data-wow-class",d["class"].replace("-","_"));g.setAttribute("data-wow-spec",d.spec.replace("-","_"));if(!d.backgroundcolor){d.backgroundcolor="#242424"}if(!d.axiscolor){d.axiscolor=WH.Wow.Item.getQualityColor(WH.Wow.Item.QUALITY_POOR)}if(!d.fontcolor){d.fontcolor="#ccc"}var f={axiscolor:"axis-color",azeritetier:"azerite-tier",backgroundcolor:"background-color",chartmode:"chart-mode",corruptionrepresentation:"corruption-representation",covenant:"covenant",entries:"entries",fontcolor:"font-color",fightstyle:"fight-style",type:"type"};for(var c in f){if(d[c]){g.setAttribute("data-"+f[c],d[c].replace("-","_"))}}return g}};WH.markup.tags.bluetweet={empty:true,ltrim:true,attr:{id:{req:true,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){if(g_bluetweets[c.id]&&g_bluetweets[c.id].id){return WH.createTweetDiv(g_bluetweets[c.id])}return WH.ce("a",{href:"https://twitter.com/wowheadtweets/status/"+c.id,className:"full-tweet"},WH.ct("Tweet #"+c.id))}};WH.markup.tags.chart={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{id:{req:true,valid:/^[0-9a-zA-Z-]+$/},type:{req:true,valid:/^barpercent|pie|rank|rankpercent$/},width:{req:false,valid:/^\d+$/},height:{req:false,valid:/^\d+$/},credits:{req:false,valid:/^profiler|none$/},sort:{req:false,valid:/^asc|desc$/}},toNode:function(K){var E;if(!g_charts.hasOwnProperty(K.id)){E=WH.ce("div",{className:"highchart "+K.type,style:{border:"1px solid #CCC"}},WH.ct("(Chart "+K.id+" not found)"));if(K.width){E.style.width=""+K.width+"px"}if(K.height){E.style.height=""+K.height+"px"}return E}var t=WH.markup.getDatabaseDomainInfo(K);var g=t.nameKey;var O={};if(!K.credits||K.credits=="profiler"){O.href="/list";O.text=WH.TERMS.poweredbyprofiler_tip}if(K.credits=="none"){O.enabled=false}switch(K.type){case"rank":case"rankpercent":var d=g_charts[K.id];var m=d[0].keyType;var r;var B;var h;var l;var q=[];for(var M in d[0].data){q.push(M)}q.sort(function(P,o){return WH.stringCompare(d[0].data[P],d[0].data[o])});if(K.sort=="desc"){q.reverse()}else{if(!K.sort){if(d[1].data){if(d[0].data[q[0]]/d[1].data>0.5){q.reverse()}}}}E=WH.ce("div",{style:{display:"inline-block"}});if(K.width){E.style.width=""+K.width+"px"}var N;var C;var A=WH.ce("ol");WH.ae(E,A);for(var w=0;w<q.length;w++){M=q[w];l=false;r=M;B="";h="";if(l=WH.Gatherer.get(d[0].keyType,parseInt(M,10),t.dataEnv)){r=l.hasOwnProperty(g)?l[g]:M;B=l.hasOwnProperty("quality")?l.quality:"";h=l.hasOwnProperty("icon")?l.icon:""}C=WH.ce("li");WH.ae(A,C);if(h){var D=document.createDocumentFragment();WH.ae(D,WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+h+".gif",style:{verticalAlign:"middle"}}));WH.ae(D,WH.ct(WH.Strings.nbsp))}if(m){N=WH.ce("a",{href:WH.Entity.getPath(m,M),className:"q"+B+(h?" icontiny":"")})}else{N=WH.ce("span",{className:"q"+B})}WH.ae(C,N);if(h){WH.ae(N,D)}WH.ae(N,WH.ct(r));if(K.type=="rankpercent"&&d[1].data){WH.ae(C,WH.ct(" "));WH.ae(C,WH.ce("small",{className:"q0"},WH.ct(WH.sprintf(WH.TERMS._paren,(d[0].data[M]/d[1].data*100).toFixed(4)+"%"))))}}if(O.text){var p=WH.ce("div",{style:{position:"relative",top:"-12px",textAlign:"right",fontSize:"10px"}});WH.ae(E,p);if(O.href){N=WH.ce("a",{href:O.href,className:"q0"},WH.ct(O.text))}else{N=WH.ce("span",{className:"q0"},WH.ct(O.text))}WH.ae(p,N)}return E;break}if(!WH.isSet("g_highcharts")){WH.Tools.Highcharts.loadScript();g_highcharts={charts:[],divIndex:0,pending:undefined};g_highcharts.ShowCharts=function(Q){if(Q){g_highcharts.pending=undefined}else{if(typeof g_highcharts.pending!="undefined"){return}}var P=false;if(WH.isSet("Highcharts")){for(var o=0;o<g_highcharts.charts.length;o++){if(g_highcharts.charts[o].rendered){continue}if($(g_highcharts.charts[o].container).length==0){P=true;continue}$(g_highcharts.charts[o].container).highcharts(g_highcharts.charts[o].chart);g_highcharts.charts[o].rendered=true}}else{P=true}if(P){g_highcharts.pending=window.setTimeout(g_highcharts.ShowCharts,250,true);return}}}E=WH.ce("div",{className:"highcharts-wowhead-style highchart "+K.type});if(K.width){E.style.width=""+K.width+"px"}if(K.height){E.style.height=""+K.height+"px"}switch(K.type){case"barpercent":var d=g_charts[K.id];var z=(d[0].keyType&&g_types.hasOwnProperty(d[0].keyType))?g_types[d[0].keyType]:false;var F={container:E,chart:{}};F.chart={credits:O,chart:{type:"bar",styledMode:true,plotBorderWidth:0,style:{fontFamily:"Open Sans"}},plotOptions:{bar:{borderWidth:0,dataLabels:{style:{textShadow:"none"}}}},xAxis:{categories:[]},yAxis:{min:0,max:100,title:{enabled:false}},legend:{enabled:false},title:{text:""},tooltip:{formatter:function(){var R=this.x+": "+this.y+"%";if(z){var P=(z in g_completion)?g_completion[z]:false;for(var S in g_user.lists){var o=g_user.lists[S];if(!(o.id in P)){continue}var Q=(WH.inArray(P[o.id],this.point.id)!=-1);R+='<br><span class="progress-icon '+(Q?"progress-8":"progress-0")+'"></span> ';R+=o.character+" - "+o.realm+" "+o.region}}return R},useHTML:true},series:[{data:[],events:{click:function(o){if(g_charts[K.id][0].keyType){location.href=WH.Entity.getPath(g_charts[K.id][0].keyType,o.point.series.data[o.point.x].id)}}}}]};var c;var H=[];if(z&&WH.isSet("g_completion")&&g_completion.hasOwnProperty(z)&&g_user.hasOwnProperty("lists")&&g_user.lists&&g_user.lists.length){for(var w=0;w<g_user.lists.length;w++){c=""+g_user.lists[w].id;if((g_user.lists[w].pinned>0)&&g_completion[z].hasOwnProperty(c)){H=g_completion[z][c];if(g_user.lists[w].pinned>1){break}}}}var I=[];for(var M in d[0].data){if(!d[0].data.hasOwnProperty(M)){continue}I.push({k:M,v:d[0].data[M]})}I.sort(function(P,o){return WH.stringCompare(o.v,P.v)});if(K.sort=="asc"){I.reverse()}for(var w=0;w<I.length;w++){var L=I[w];var l=WH.Gatherer.get(d[0].keyType,L.k,t.dataEnv);l=l?l[g]:L.k;var G={id:L.k,y:Math.round(L.v/d[1].data*100)};if(H.indexOf(parseInt(G.id,10))!=-1){G.colorIndex=6}F.chart.xAxis.categories.push(l);F.chart.series[0].data.push(G)}g_highcharts.charts.push(F);break;case"pie":var F={container:E,chart:{}};F.chart={credits:O,chart:{type:"pie",styledMode:true,plotBorderWidth:0,style:{fontFamily:"Open Sans"}},plotOptions:{pie:{dataLabels:{style:{textShadow:"none"}}}},legend:{enabled:false},title:{text:""},tooltip:{formatter:function(){return this.point.name+": "+Math.round(this.y)+"%"}},series:[{data:[]}]};var d=g_charts[K.id];var I=[];var v=0;var J=true;var l;var u={};if(d[0].keyType==WH.Types.RACE){var u={24:WH.TERMS.neutral,25:WH.TERMS.alliance,26:WH.TERMS.horde};for(var f in u){if(u.hasOwnProperty(f)){u[f]=WH.TERMS.wordspace_punct+WH.TERMS.openparenthesis_punct+u[f]+WH.TERMS.closedparenthesis_punct}}}for(var M in d[0].data){if(!d[0].data.hasOwnProperty(M)){continue}v+=d[0].data[M];J&=!isNaN(M)&&(M!="0");l=(WH.Gatherer.get(d[0].keyType,M,t.dataEnv)||{})[g]||M;l+=u[M]||"";I.push({k:M,keyName:l,v:d[0].data[M]})}if(!isNaN(d[1].data)&&(v/d[1].data<0.98)){I.push({k:J?0:"Other",v:d[1].data-v})}if(g_gathered_types.hasOwnProperty(d[0].keyType)){I.sort(function(P,o){return WH.stringCompare(o.v,P.v)||WH.stringCompare(P.keyName,o.keyName)})}else{I.sort(function(P,o){return WH.stringCompare(P.keyName,o.keyName)||WH.stringCompare(o.v,P.v)})}for(var w=0;w<I.length;w++){var L=I[w];F.chart.series[0].data.push({id:L.k,name:L.keyName,y:(L.v/d[1].data*100)})}g_highcharts.charts.push(F);break;default:return WH.ce("div",{},WH.ct("(Chart type "+K.type+" unknown)"));break}g_highcharts.ShowCharts();return E}};WH.markup.tags.countdown={empty:true,attr:{bg:{req:true,valid:/^(https?:)?\/\/[^\/]+\/.+/},time:{req:true,valid:/^[A-Za-z0-9 :,-]+$/},text:{req:false,valid:/.*/},completion:{req:false,valid:/.*/},url:{req:false,valid:/^(https?:)?\/\/[^\/]+\/.+/}},toNode:function(c){var f=WH.ce("div");var d={element:f,bg:c.bg,completionText:c.completion,time:c.time};if(c.text){d.text=c.text}if(c.url){d.url=c.url}WH.countdownClock(d);return f}};WH.markup.tags["dps-rankings"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^[a-z0-9-]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){let domainInfo=WH.markup.getDatabaseDomainInfo(c);let dataTree=WH.getDataTree(domainInfo.dataEnv);let data=WH.getPageData(["WH.Markup.dpsRankings",dataTree,c.unnamed].join("."));return!!data},toNode:function(c){let domainInfo=WH.markup.getDatabaseDomainInfo(c);let dataTree=WH.getDataTree(domainInfo.dataEnv);let wclDomain=dataTree===WH.dataTree.CLASSIC?"classic.warcraftlogs.com":"www.warcraftlogs.com";let data=WH.getPageData(["WH.Markup.dpsRankings",dataTree,c.unnamed].join("."));let rowsData=data.data;let note=data.info;let result=document.createDocumentFragment();if(note){WH.ae(result,WH.ce("div",{style:{fontSize:"90%"}},WH.ct(note)))}var d=WH.ce("div",{className:"highchart bar highcharts-wowhead-style"});WH.ae(result,d);WH.Tools.Highcharts.loadScript(function(){var h={credits:{href:"https://"+wclDomain+"/",text:WH.TERMS.warcraftlogs_site},chart:{type:"bar",height:Math.max(400,Math.min(600,rowsData.length*30)),styledMode:true,plotBorderWidth:0,style:{fontFamily:"Open Sans"}},plotOptions:{bar:{borderWidth:0,dataLabels:{style:{textShadow:"none"}}}},xAxis:{categories:[]},yAxis:{min:0,title:{enabled:false}},legend:{enabled:false},title:{text:""},tooltip:{formatter:function(){var o=Math.ceil(Math.min(2,Math.max(0,4-Math.log10(this.y))));var p=WH.ce("div");WH.ae(p,WH.ct(this.x+WH.TERMS.colon_punct));WH.ae(p,WH.ce("b",{},WH.ct(WH.Strings.formatNumber(this.y,false,o,o))));WH.ae(p,WH.ct(WH.TERMS.wordspace_punct+WH.GlobalStrings.DPS));return p.innerHTML},useHTML:true},series:[{data:[]}]};rowsData.sort(function(p,o){return o.dps-p.dps});for(var l,m=0;l=rowsData[m];m++){var g=g_chr_classes[l.classId];if(l.spec==="DPS"){g=WH.Strings.sprintf(WH.TERMS.dpsRoleClass_format,g)}else{g=WH.Strings.sprintf(WH.TERMS.specclass_format,dataTree===WH.getDataTree()?WH.Wow.PlayerClass.Specialization.getName(l.specId):l.spec,g)}h.xAxis.categories.push(g);var f={id:g,y:l.dps,colorIndex:"c"+l.classId};h.series[0].data.push(f)}Highcharts.chart(d,h)});return result}};WH.markup.tags["heart-of-azeroth-calc"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},callbacks:[],counter:0,toNode:function(c){var g=WH.markup.getDatabaseDomainInfo(c);var h=WH.ce("div",{id:"markup-heart-of-azeroth-calc-"+this.counter++});var d=function(){new WH.Wow.HeartOfAzerothCalc(h,{embedded:true,hash:c.unnamed.replace(/^#+/,""),editable:c.editable=="true"})};if(!WH.Wow.HeartOfAzerothCalc){this.callbacks.push(d);if(this.callbacks.length==1){WH.loadAssets("heart-of-azeroth-calc",function(){for(var m,l=0;m=WH.markup.tags["heart-of-azeroth-calc"].callbacks[l];l++){m()}})}}else{d()}return h}};WH.markup.tags.galleryupload={empty:false,allowedClass:WH.markup.CLASS.ADMIN,attr:{unnamed:{req:true,valid:/^[0-9]+$/},submittext:{req:false,valid:/.+/}},toNode:function(c){var d="";var h=document.createDocumentFragment();var g=WH.ce("form",{method:"POST",action:"/gallery-upload",enctype:"multipart/form-data"});WH.aE(g,"submit",WH.markup.tags.galleryupload._validateForm.bind(null,g));WH.ae(h,g);WH.ae(h,WH.ce("div",{style:{display:"none"},dataset:{markupContentTarget:1}}));WH.ae(g,WH.ce("input",{type:"hidden",name:"gallery",value:c.unnamed}));WH.ae(g,WH.ce("input",{type:"hidden",name:"message",value:""}));WH.ae(g,WH.ce("input",{type:"hidden",name:"from",value:location.pathname+location.search}));WH.ae(g,WH.ce("input",{type:"file",name:"incoming",accept:".jpg,.jpeg,.png,image/jpeg,image/png",required:true}));WH.ae(g,WH.ct(" "));WH.ae(g,WH.ce("button",{type:"submit",className:"btn btn-primary"},WH.ct(c.submittext||WH.TERMS.submit)));return h},_validateForm:function(d){var c=3;var g=d.incoming;if(!g||g.value==""){return false}if(g.files&&g.files.length){if(g.files.length>1){alert("Too many files");return false}if(g.files[0].size>c*1048576){alert(WH.TERMS.filesizelimit_format.replace("%d",c).replace("&gt;",">"));return false}}d.message.value=d.nextSibling.textContent;return true}};WH.markup.tags["gear-planner"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},callbacks:[],counter:0,toNode:function(c){var g=WH.markup.getDatabaseDomainInfo(c);if(!WH.isClassicTree()){return WH.ce("div",{className:"q10"},WH.ct("[gear-planner] "+WH.TERMS.errorClassicOnly_tip))}var h=WH.ce("div",{id:"markup-gear-planner-calc-"+this.counter++});var d=function(){new WH.Wow.GearPlanner(h,{embedded:true,hash:c.unnamed.replace(/^#+/,""),editable:c.editable=="true"})};if(!WH.Wow.GearPlanner){this.callbacks.push(d);if(this.callbacks.length==1){WH.loadAssets("gear-planner",function(){for(var m,l=0;m=WH.markup.tags["gear-planner"].callbacks[l];l++){m()}})}}else{d()}return h}};WH.markup.tags["guide-content"]={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},toNode:function(c){var d=document.createDocumentFragment();WH.ae(d,WH.ct("(Content from "));WH.ae(d,WH.ce("a",{href:"/guide="+c.unnamed},WH.ct("Guide #"+c.unnamed)));WH.ae(d,WH.ct(")"));return d}};WH.markup.tags["guild-rankings"]={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/[a-z-]+/},raid:{req:true,valid:/[a-z-]+/},difficulty:{req:false,valid:/(normal|heroic|mythic)/}},toNode:function(l){var p=document.createDocumentFragment();WH.ae(p,WH.ce("h3",{className:"heading-size-2 guild-boss-rankings-heading",dataset:{markupContentTarget:1}},WH.ce("a",{href:"https://raider.io/"},WH.ct("Powered by Raider.IO"))));var c;var o=WH.ce("tr");WH.ae(p,WH.ce("table",{className:"guild-boss-rankings"},o));var h=WH.Strings.slug(l.unnamed);var g=WH.Strings.slug(l.raid);var f=WH.Strings.slug(l.difficulty||"mythic");let key=g+"."+h+"."+f;for(var d=1;d<=3;d++){c=WH.ce("td");WH.ae(o,c);let guildRankings=WH.getPageData(["WH.Markup.guildRankings",key].join("."));if(guildRankings){let guild=guildRankings[d-1];if(guild){var m=guild.realm.toLowerCase().replace(/[^a-z ]/,"").replace(" ","-");c.className="guild-boss-rankings-earned";WH.ae(c,WH.ce("div",{className:"guild-boss-rankings-"+guild.faction},WH.ce("a",{href:"https://raider.io/guilds/"+guild.region.toLowerCase()+"/"+m+"/"+guild.name,target:"_blank"},WH.ct(guild.name))));WH.ae(c,WH.ce("a",{href:"https://raider.io/"+g+"/realm-rankings/"+guild.region.toLowerCase()+"/"+m+"/"+f,target:"_blank"},WH.ct("("+guild.region+") "+guild.realm)));continue}}switch(d){case 1:WH.st(c,"1st Place");break;case 2:WH.st(c,"2nd Place");break;case 3:WH.st(c,"3rd Place");break;default:WH.st(c,d+"th Place")}WH.ae(c,WH.ce("br"));WH.ae(c,WH.ct("Not Earned"))}return p},toText:function(f){var h=WH.Strings.slug(f.unnamed);var l=WH.Strings.slug(f.raid);var d=WH.Strings.slug(f.difficulty||"mythic");let key=l+"."+h+"."+d;var m="";for(var g=1;g<=3;g++){var c="";switch(g){case 1:c="1st";break;case 2:c="2nd";break;case 3:c="3rd";break;default:c=g+"th"}m+=c+" Place: ";let guildRankings=WH.getPageData(["WH.Markup.guildRankings",key].join("."));if(guildRankings){let guild=guildRankings[g-1];if(guild){m+=guild.name+", ("+guild.region+") "+guild.realm+", "+WH.ucfirst(guild.faction)+". ";continue}}m+="Not Earned. "}return f._textContents+": "+m}};WH.markup.tags.lightbox={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^map$/},zone:{req:false,valid:/^-?[0-9]+[a-z]?$/i},floor:{req:false,valid:/^[0-9]+$/},pins:{req:false,valid:/^[0-9]+$/}},validate:function(c){switch(c.unnamed){case"map":if(c.zone){return true}break}return false},toNode:function(c){var d=WH.ce("a");WH.markup.applyCommonAttributes(d,c);var f="";switch(c.unnamed){case"map":f="/maps?data="+c.zone;if(c.floor){f+="."+c.floor}if(c.pins){f+=":"+c.pins}var g=f.substr(6).replace("data=","");d.href=f;WH.aE(d,"click",function(h){if(!WH.isLeftClick(h)){return true}MapViewer.show({link:g});h.preventDefault()})}return d}};WH.markup.tags.listview={empty:true,attr:{id:{req:true,valid:/^\d+/},rows:{req:false,valid:/^\d+/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){let result=WH.ce("div");let gathered=WH.Gatherer.get(WH.Types.LISTVIEW,c.id);if(!gathered){result.className="error-message";WH.ae(result,WH.ct("Listview #"+c.id+" not found."));return result}if(gathered.template!=="db2-file-markup"){result.className="error-message";WH.ae(result,WH.ct("Listview #"+c.id+" uses unknown template: ["+gathered.template+"]."));return result}let lvOpts={id:WH.Strings.guid(),clickable:false,filtrable:true,hash:Listview.HASH_DISABLED,searchable:true,template:{noDebug:true,columns:[]},data:gathered.rows,parent:result,nItemsPerPage:c.rows,createNote:function(f,d){let listviewOptions=[{label:"Product",option:WH.ct(gathered.product)},{label:"Build",option:WH.ct(gathered.build)},{label:"File",option:WH.ct(gathered.file)}];this.addOptions(listviewOptions,{style:{minHeight:"39px"}})}};for(let col,colIndex=0;col=gathered.cols[colIndex];colIndex++){lvOpts.template.columns.push({id:"col"+colIndex,align:"left",compute:(function(d,g,h,f){let cellData=g["col"+d];let value=WH.ct(cellData);if(gathered.cols[d].numeric){value=WH.ce("pre",{style:{display:"inline",margin:"0"}},value)}let iconName=g["col"+d+"icon"];if(iconName){if(value.nodeType!==Node.ELEMENT_NODE){value=WH.ce("span",{},value)}value.classList.add("icontiny");WH.aef(value,WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+iconName+".gif",style:{paddingRight:"5px",verticalAlign:"middle"}}))}let entityType;if(entityType=gathered.cols[d].entityType){value=WH.ce("a",{href:WH.Url.generate(WH.Entity.getPath(entityType,cellData),{subdomain:gathered.subdomain})},value)}WH.ae(h,value);if(g.hotfixAdd){f.classList.add("new-row-2");WH.Tooltip.simple(h,"<i>New row via hotfix.</i>","q0")}else{if(g.hotfixDelete){f.classList.add("deleted");WH.Tooltip.simple(h,"<i>Deleted row via hotfix.</i>","q0")}else{if((g.changes||[])[d]){h.classList.add("changed-cell");WH.Tooltip.simple(h,WH.Strings.escapeHtml(g.changes[d]),"q0")}else{if(g["new"]){f.classList.add("new-row");WH.Tooltip.simple(h,"<i>New row this build.</i>","q0")}}}}}).bind(null,colIndex),name:col.label||"[col"+colIndex+"]",type:col.numeric?Listview.COLUMN_TYPE_NUMBER:Listview.COLUMN_TYPE_TEXT,value:"col"+colIndex,pos:colIndex,sortFunc:(function(g,f,d){let valA=f["col"+g];let valB=d["col"+g];return WH.stringCompare(valA,valB)}).bind(null,colIndex)})}new Listview(lvOpts);result.querySelector("div").className="listview";return result}};WH.markup.tags.map={empty:false,attr:{zone:{req:true,valid:/^-?[0-9a-z\-_]+$/i},floor:{req:false,valid:/^\d+/},source:{req:false,valid:/\S+/},legacy:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{pin:1},mapHits:0,toNode:function(c){let domainInfo=WH.markup.getDatabaseDomainInfo(c);var d=[];while(c._contents.hasChildNodes()){var g=c._contents.removeChild(c._contents.firstChild);d=d.concat(g.whMarkupInfo)}var f=document.createDocumentFragment();var h=WH.ce("div");WH.markup.applyCommonAttributes(h,c);WH.ae(f,h);WH.ae(f,WH.ce("div",{style:{clear:"left"}}));new Mapper({parent:h,unique:WH.markup.tags.map.mapHits++,zone:c.zone,coords:d?d:null,legacy:c.legacy||false,level:c.hasOwnProperty("floor")?c.floor:undefined,dataEnv:domainInfo.dataEnv});return f}};WH.markup.tags.pin={empty:false,attr:{url:{req:false,valid:/\S+/},type:{req:false,valid:/^[0-9]+$/},x:{req:true,valid:/^[0-9]{1,2}(\.[0-9])?$/},y:{req:true,valid:/^[0-9]{1,2}(\.[0-9])?$/},path:{req:false,valid:/^([0-9]{1,2}(\.[0-9])?[,:]?)+$/}},taglessSkip:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{map:1},toNode:function(g){if(g.url&&!WH.markup.isUrlSafe(g.url)){g.url=""}var m=g._contents;if(g.url&&g.url.indexOf("npc=")!=-1){var h=document.createDocumentFragment();WH.ae(h,WH.ce("b",{className:"q"},m));WH.ae(h,WH.ce("br"));WH.ae(h,WH.ce("span",{className:"q2"},WH.ct(WH.TERMS.clicktoviewthisnpc_stc)));m=h}if(g.url&&(g.url.indexOf("/")<0)&&(g.url.indexOf("=")>=0)){g.url="/"+g.url}var p=null;if(g.path){var l=g.path.split(":"),p=[];for(var d=0,f=l.length;d<f;++d){var c=l[d].split(",");if(c.length==2){p.push([parseFloat(c[0]||0),parseFloat(c[1]||0)])}}}var o=WH.ce("div");o.whMarkupInfo=[[parseFloat(g.x||0),parseFloat(g.y||0),{label:WH.ce("div",{},m).innerHTML,url:g.url,type:g.type,lines:p}]];return o}};WH.markup.tags.model={empty:false,attr:{item:{req:false,valid:/^[0-9]+$/},object:{req:false,valid:/^[0-9]+$/},npc:{req:false,valid:/^[0-9]+$/},itemset:{req:false,valid:/^[0-9,]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},border:{req:false,valid:/^[0-9]+$/},fileid:{req:false,valid:/^[0-9]+$/},"float":{req:false,valid:/^(left|right)$/i},humanoid:{req:false,valid:/^1$/},img:{req:false,valid:/\S+/},label:{req:false,valid:/[\S ]+/},link:{req:false,valid:/\S+/},shadow:{req:false,valid:/^(true|false)$/},slot:{req:false,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,skipSlots:{4:1,5:1,6:1,7:1,8:1,9:1,10:1,16:1,19:1,20:1},toNode:function(d){var m=WH.markup.getDatabaseDomainInfo(d);var f=WH.ce("a");var g;WH.markup.applyCommonAttributes(f,d);var h=false;if(d.npc){f.href="#modelviewer:"+WH.Types.NPC+":"+d.npc+":"+(d.humanoid?"1":"0");WH.aE(f,"click",function(){var p={dataEnv:m.dataEnv,type:WH.Types.NPC,displayId:d.npc,slot:d.slot,displayAd:1,fromTag:1};if(d.humanoid){p.humanoid=1}if(d.link){p.link=d.link}if(d.label){p.label=d.label}if(d.fileid){p.fileId=d.fileid}WH.ModelViewer.showLightbox(p)});var c={alt:d._contents.textContent,title:d._contents.textContent,src:d.img||WH.ModelViewer.getContentPath(m.dataEnv)+"thumbs/npc/"+d.npc+".png"};if(!d.img){c.width="150";c.height="150"}WH.ae(f,g=WH.ce("img",c));h=true}else{if(d.object){f.href="#modelviewer:"+WH.Types.OBJECT+":"+d.object;WH.aE(f,"click",function(){var p={dataEnv:m.dataEnv,type:WH.Types.OBJECT,displayId:d.object,displayAd:1,fromTag:1};if(d.link){p.link=d.link}if(d.label){p.label=d.label}if(d.fileid){p.fileId=d.fileid}WH.ModelViewer.showLightbox(p)});var c={alt:d._contents.textContent,title:d._contents.textContent,src:d.img||WH.ModelViewer.getContentPath(m.dataEnv)+"thumbs/obj/"+d.object+".png"};if(!d.img){c.width="150";c.height="150"}WH.ae(f,g=WH.ce("img",c));h=true}else{if(d.item&&d.slot){f.href="#modelviewer:"+WH.Types.ITEM+":"+d.item+":"+d.slot;WH.aE(f,"click",function(){var p={dataEnv:m.dataEnv,type:WH.Types.ITEM,displayId:d.item,slot:d.slot,displayAd:1,fromTag:1};if(d.link){p.link=d.link}if(d.label){p.label=d.label}if(d.fileid){p.fileId=d.fileid}WH.ModelViewer.showLightbox(p)});var c={alt:d._contents.textContent,title:d._contents.textContent,src:d.img||WH.Wow.Item.getThumbUrl(d.item,undefined,m.dataEnv)};if(!d.img){c.width="150";c.height="150"}WH.ae(f,g=WH.ce("img",c));h=true}else{if(d.itemset){f.href="javascript:";WH.aE(f,"click",function(){var p={dataEnv:m.dataEnv,type:WH.Types.ITEM_SET,equipList:d.itemset.split(","),displayAd:1,fromTag:1};if(d.link){p.link=d.link}if(d.label){p.label=d.label}if(d.fileid){p.fileId=d.fileid}WH.ModelViewer.showLightbox(p)})}else{if(d.fileid){f.href="javascript:";WH.aE(f,"click",function(){var p={dataEnv:m.dataEnv,fileId:d.fileid,displayAd:1,fromTag:1};if(d.link){p.link=d.link}if(d.label){p.label=d.label}WH.ModelViewer.showLightbox(p)});if(d.img){var c={alt:d._contents.textContent,title:d._contents.textContent,src:d.img};WH.ae(f,g=WH.ce("img",c));h=true}}else{var l=document.createDocumentFragment();WH.ae(l,WH.ct("[model]"));WH.ae(l,WH.ce("span",{dataset:{markupContentTarget:1}}));WH.ae(l,WH.ct("[/model]"));return l}}}}}if(g){if(d["float"]){g.classList.add("markup-float-"+d["float"])}if(d.border!==undefined){if(d.border==0){g.classList.add("no-border")}else{g.classList.add("border");g.style.borderWidth=""+d.border+"px"}}else{g.classList.add("content-image");if(d.shadow=="true"){g.classList.add("content-image-shadowed")}}}while(h&&d._contents.hasChildNodes()){d._contents.removeChild(d._contents.firstChild)}return f}};WH.markup.tags.modelviewer=WH.markup.tags.model;WH.markup.tags["mythic-damage-calc"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^[^\/][\/a-zA-Z0-9_-]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},callbacks:[],toNode:function(c){let div=WH.ce("div");let createCalc=function(){new WH.Wow.MythicDamageCalc(div,{embedded:true,hash:c.unnamed})};if(!WH.Wow.MythicDamageCalc){this.callbacks.push(createCalc);if(this.callbacks.length===1){WH.loadAssets("mythic-damage-calc",function(){let callback;while(callback=WH.markup.tags["mythic-damage-calc"].callbacks.shift()){callback()}})}}else{createCalc()}return div}};WH.markup.tags["pet-team"]={empty:true,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},calcDivsOnPage:0,callbacks:[],toNode:function(c){var g=WH.markup.getDatabaseDomainInfo(c);this.calcDivsOnPage++;var h=WH.ce("div",{id:"markup-pet-team-"+this.calcDivsOnPage++,className:"bpetteamcalc-markup-parent"});var d=function(){new BattlePetTeamCalc({id:h.id,embedded:true,markup:true,hash:c.unnamed.replace(/^#+/,""),editable:c.editable=="true",dataDomain:g.host})};if(!WH.isSet("BattlePetTeamCalc")){this.callbacks.push(d);if(this.callbacks.length==1){WH.loadAssets("battle-pet-team-calc",function(){for(var m,l=0;m=WH.markup.tags["pet-team"].callbacks[l];l++){m()}})}}else{d()}return h}};WH.markup.tags["raid-bots-form"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^droptimizer|gear|talents|quick|stats$/}},toNode:function(c){return WH.Raidbots.createForm(c.unnamed)}};WH.markup.tags.reddit={empty:true,ltrim:true,attr:{unnamed:{req:true,valid:/\br\/[^\/]+\/comments\/[a-z0-9]+/},width:{req:false,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){let resultDiv=WH.ce("div",{className:"reddit-markup"});let id36=c.unnamed.match(/\br\/[^\/]+\/comments\/([a-z0-9]+)/)[1];WH.xhrJsonRequest("https://api.reddit.com/api/info?id=t3_"+id36,function(d){if(!d||!d.data||!d.data.children||!d.data.children[0]||!d.data.children[0].data||d.data.children[0].kind!=="t3"){WH.st(resultDiv,"Error: could not fetch Reddit post "+c.unnamed);resultDiv.classList.add("error-message");return}let post=d.data.children[0].data;WH.DOM.addScriptOnce("https://embed.redditmedia.com/widgets/platform.js",{async:true});let frameWidth=Math.min(Platform.getViewportWidth()-40,c.width||800);WH.ae(resultDiv,WH.ce("div",{className:"reddit-markup-container",style:{width:frameWidth+"px"}},WH.ce("blockquote",{className:"reddit-card"},WH.ce("a",{href:"https://www.reddit.com"+post.permalink}))))});return resultDiv}};WH.markup.tags["reddit-video"]={empty:true,ltrim:true,attr:{unnamed:{req:true,valid:/\br\/[^\/]+\/comments\/[a-z0-9]+/},width:{req:false,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){let resultDiv=WH.ce("div",{className:"reddit-markup"});let id36=c.unnamed.match(/\br\/[^\/]+\/comments\/([a-z0-9]+)/)[1];WH.xhrJsonRequest("https://api.reddit.com/api/info?id=t3_"+id36,function(d){if(!d||!d.data||!d.data.children||!d.data.children[0]||!d.data.children[0].data||d.data.children[0].kind!=="t3"){WH.st(resultDiv,"Error: could not fetch Reddit post "+c.unnamed);resultDiv.classList.add("error-message");return}let post=d.data.children[0].data;let video=(post.secure_media&&post.secure_media.reddit_video)||(post.preview&&post.preview.reddit_video_preview);if(!video||!video.fallback_url){WH.st(resultDiv,"Error: could not find any video in Reddit post "+c.unnamed);resultDiv.classList.add("error-message");return}WH.DOM.addScriptOnce("https://embed.redditmedia.com/widgets/platform.js",{async:true});let videoWidth=Math.min(Platform.getViewportWidth()-40,c.width||800,video.width);WH.ae(resultDiv,WH.ce("div",{className:"reddit-markup-container",style:{width:videoWidth+"px"}},WH.ce("blockquote",{className:"reddit-card"},WH.ce("a",{href:"https://www.reddit.com"+post.permalink}))))});return resultDiv}};WH.markup.tags.regexreplace={empty:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{"guide-content":1},attr:{unnamed:{req:true,valid:/^[^a-z\\].+[^a-z\\]$/},"with":{req:true,valid:/^.*$/}},toNode:function(c){var f=document.createDocumentFragment();WH.ae(f,WH.ct(" "));var d=WH.ce("span",{className:"q0"});WH.ae(f,d);WH.ae(d,WH.ct('Regex Replacing: "'));WH.ae(d,WH.ce("b",{},WH.ct(c.unnamed)));WH.ae(d,WH.ct('" With: "'));WH.ae(d,WH.ce("b",{},WH.ct(c["with"])));WH.ae(d,WH.ct('"'));return f}};WH.markup.tags.replace={empty:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{"guide-content":1},attr:{unnamed:{req:true,valid:/^.+$/},"with":{req:true,valid:/^.*$/}},toNode:function(c){var f=document.createDocumentFragment();WH.ae(f,WH.ct(" "));var d=WH.ce("span",{className:"q0"});WH.ae(f,d);WH.ae(d,WH.ct('Replacing: "'));WH.ae(d,WH.ce("b",{},WH.ct(c.unnamed)));WH.ae(d,WH.ct('" With: "'));WH.ae(d,WH.ce("b",{},WH.ct(c["with"])));WH.ae(d,WH.ct('"'));return f}};WH.markup.tags.screenshot={empty:false,attr:{id:{req:false,valid:/^[0-9]+$/},url:{req:false,valid:/\S+/},thumb:{req:false,valid:/\S+/},size:{req:false,valid:/^(thumb|small|resized|normal)$/i},width:{req:false,valid:/^[0-9]+$/},height:{req:false,valid:/^[0-9]+$/},"float":{req:false,valid:/^(left|right)$/i},border:{req:false,valid:/^[0-9]+$/},shadow:{req:false,valid:/^(true|false)$/}},taglessSkip:true,allowedClass:WH.markup.CLASS.STAFF,validate:function(c){if(c.url&&!c.thumb){return false}else{if(!c.id&&!c.url){return false}}return true},toNode:function(h){var f=[];var q=[];var d="javascript:";var c="";var m={};if(h.id){m=WH.Gatherer.get(WH.Types.SCREENSHOT,h.id)||{};d=WH.getScreenshotUrl(h.id,"normal",{description:h.title,imageType:m.imageType});var p=h.id;if(h.thumb&&h.thumb.match(/^[0-9]+$/)){p=h.thumb;h.thumb=null}c=WH.getScreenshotUrl(p,h.size||"thumb",{description:h.title,imageType:m.imageType})}else{if(h.url){d=h.url}}if(h.thumb){c=h.thumb}if(!g_screenshots[WH.markup.mediaUid]){g_screenshots[WH.markup.mediaUid]=[]}var o=WH.ce("a",{href:d});WH.markup.applyCommonAttributes(o,h);WH.aE(o,"click",(function(u,t,r){if(!WH.isLeftClick(r)){return}ScreenshotViewer.show({screenshots:u,pos:t});r.preventDefault()}).bind(null,""+WH.markup.mediaUid,g_screenshots[WH.markup.mediaUid].length));var g=WH.ce("img");WH.ae(o,g);if(h.size&&h.width){g.width=h.width}if(h.size&&h.height){g.height=h.height}g.src=WH.Url.addMaxSizeParams(c,{height:g.height,width:g.width});if(h.border!==undefined){if(h.border==0){g.classList.add("no-border")}else{g.classList.add("border");g.style.borderWidth=""+h.border+"px"}}else{g.classList.add("content-image");if(h.shadow=="true"){g.classList.add("content-image-shadowed")}}if(h["float"]){g.classList.add("markup-float-"+h["float"])}g.alt=h.title||"";var l={caption:h.title,width:(h.size?null:h.width),height:(h.size?null:h.height),noMarkup:true};if(h.id){l.id=h.id;l.imageType=m.imageType}else{l.url=h.url}g_screenshots[WH.markup.mediaUid].push(l);return o}};WH.markup.tags["google-sheet"]={empty:true,attr:{unnamed:{req:true,valid:/^[a-zA-Z0-9_-]+$/}},libraryLoaded:false,toNode:function(c){var d=WH.Strings.guid();var f=c.unnamed;var g=document.createDocumentFragment();WH.ae(g,WH.ce("img",{src:WH.staticUrl+"/images/icons/ajax-medium-242424.gif",style:{margin:"0 5px 0 0",position:"relative",top:"-1px",verticalAlign:"middle",width:"16px"}}));WH.ae(g,WH.ct(WH.TERMS.loading_ellipsis));var h=WH.ce("div",{id:d},g);h.dataset.loading=1;if(!WH.markup.tags["google-sheet"].libraryLoaded){$.getScript("https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.3.4/tabletop.min.js");WH.markup.tags["google-sheet"].libraryLoaded=true}setTimeout(WH.markup.tags["google-sheet"].fetchSheet.bind(null,h,f),0);return h},fetchSheet:function(d,c){if(typeof Tabletop==="undefined"){setTimeout(WH.markup.tags["google-sheet"].fetchSheet.bind(null,d,c),50);return}Tabletop.init({key:c,callback:WH.markup.tags["google-sheet"].renderSheet.bind(null,d,c),simpleSheet:true});setTimeout((function(g,f){if(g.dataset.loading){WH.markup.tags["google-sheet"].renderError(g,f)}}).bind(null,d,c),5000)},renderError:function(d,c){var f=document.createDocumentFragment();WH.ae(f,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(f,WH.ct(WH.Strings.nbsp+" "+LANG.Markup.googleSheetError));WH.ae(f,WH.ce("a",{href:"https://docs.google.com/spreadsheets/d/"+c,target:"_blank"},WH.ct(c)));delete d.dataset.loading;$(d).empty().append(f)},renderSheet:function(l,h,g,d){if(!d||!d.model_names||!d.model_names.length||!d.models||!d.models[d.model_names[0]]){WH.markup.tags["google-sheet"].renderError(l,h);return}var m={columns:[],searchable:true,filtrable:true,clickable:false};var o=d.models[d.model_names[0]].column_names;for(var f=0;f<o.length;f++){var c=o[f];if(!c){continue}m.columns.push({id:WH.Strings.slug(c),name:WH.deUrlize(c),type:"text",align:g[0][c].length>10?"left":"center",compute:(function(p,t,u,r){if(t[p].length<=10){var q=WH.ce("span",{className:"no-wrap"});WH.st(q,t[p]);WH.ae(u,q)}else{WH.st(u,t[p])}}).bind(null,c),getVisibleText:(function(p,q){return q[p]}).bind(null,c),sortFunc:(function(r,q,p){return WH.stringCompare(q[r],p[r])}).bind(null,c)})}Listview.templates[l.id]=m;delete l.dataset.loading;l.className="listview";WH.ee(l);new Listview({template:l.id,id:l.id,parent:l.id,data:g})}};WH.markup.tags["soulbind-calc"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^[^\/][\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},callbacks:[],toNode:function(c){let domainInfo=WH.markup.getDatabaseDomainInfo(c);let div=WH.ce("div");let createCalc=function(){new WH.Wow.SoulbindCalc(div,{embedded:true,hash:c.unnamed,editable:c.editable==="true",dataEnv:domainInfo.dataEnv})};if(!WH.Wow.SoulbindCalc){this.callbacks.push(createCalc);if(this.callbacks.length===1){WH.loadAssets("soulbind-calc",function(){let callback;while(callback=WH.markup.tags["soulbind-calc"].callbacks.shift()){callback()}})}}else{createCalc()}return div}};WH.markup.tags["survey-covenants"]={empty:true,attr:{background:{req:false,valid:/^false$/},"class":{req:false,valid:/^.+$/},spec:{req:false,valid:/^.+$/},date:{req:false,valid:/^\d{4}-\d\d-\d\d$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){const g=WH.Gatherer;const f=WH.Strings;const d=WH.WarcraftLogs;let classSlug=f.slug(c["class"]||"",true);let specSlug=f.slug(c.spec||"",true);let fullSlug=[classSlug,specSlug].filter(function(h){return!!h}).join(".");if(c.date){fullSlug+="/"+c.date}let data=g.get(WH.Types.SURVEY_COVENANTS,fullSlug);if(!data){let noDataError=WH.ce("div");WH.ae(noDataError,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(noDataError,WH.ct(f.nbsp+" "+WH.TERMS.notenoughdata));return noDataError}let result=WH.ce("div",{className:"top-covenants"});if(c.background==="false"){result.classList.add("no-background")}let row=WH.ce("div");WH.ae(result,row);let totalCovenantsAdded=0;data.data.sort(function(l,h){return WH.stringCompare(g.getName(WH.Types.COVENANT,l.id),g.getName(WH.Types.COVENANT,h.id))});for(let i=0,covenantData;covenantData=data.data[i];i++){let covenant=g.get(WH.Types.COVENANT,covenantData.id);let slug=f.slug(covenant.name_enus||"");let cell=WH.ce("span",{className:"covenant-"+slug+" icon-"+slug},WH.ct(g.getName(WH.Types.COVENANT,covenantData.id)+" "+WH.Strings.formatNumber(covenantData.pop/100,true,0,1)));WH.ae(row,cell);WH.Tooltip.simple(cell,d.getCovenantTooltip.bind(undefined,covenantData),"q");totalCovenantsAdded++}while(totalCovenantsAdded<4){WH.ae(row,WH.ce("span"));totalCovenantsAdded++}if(data.endTimestamp){let times=WH.ce("div",{className:"top-covenants-time"});WH.ae(result,times);if(data.startTimestamp){let startDate=new Date(data.startTimestamp*1000);let elapsed=(WH.getServerTime()-startDate)/1000;let span=WH.ce("span");WH.formatDate(span,elapsed,startDate,null,1);WH.ae(times,span);WH.ae(times,WH.ct(" - "))}let endDate=new Date(data.endTimestamp*1000);let elapsed=(WH.getServerTime()-endDate)/1000;let span=WH.ce("span");WH.formatDate(span,elapsed,endDate,null,1);WH.ae(times,span)}return result}};WH.markup.tags.talent={empty:true,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},abilities:{req:false,valid:/^true|false$/},editable:{req:false,valid:/^true$/},glyphs:{req:false,valid:/^false$/},specs:{req:false,valid:/^true$/},builds:{req:false,valid:/^true|false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},icons:{req:false}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},callbacks:[],toNode:function(c){if(WH.isClassicTree()||WH.isBurningCrusadeTree()){return WH.markup.tags.talent.toNodeClassic(c)}var h=WH.markup.getDatabaseDomainInfo(c);if(c.unnamed.indexOf("-")<0){c.glyphs="false"}var l=WH.ce("div",{className:"talentcalc-markup-parent"});if(c.glyphs=="false"){l.className+="talentcalc-markup-no-glyphs"}if(c.specs!="true"){l.className+=" talentcalc-markup-no-specs"}var d={parent:l,embedded:true,markup:true,hash:c.unnamed.replace(/^#+/,""),editable:c.editable=="true",dataDomain:h.host,dataEnv:h.dataEnv};if(c.builds){d.builds=JSON.parse(c.builds)}var g=function(){new TalentCalc(d)};if(!WH.isSet("TalentCalc")){this.callbacks.push(g);if(this.callbacks.length==1){WH.loadAssets("talent-calc",function(){for(var o,m=0;o=WH.markup.tags.talent.callbacks[m];m++){o()}})}}else{g()}return l},toNodeClassic:function(c){var h=WH.ce("div",{className:"talentcalc-markup-parent"});var d={embedded:true,hash:c.unnamed.replace(/^#+/,""),editable:c.editable==="true",abilities:c.abilities!=="false"};var g=function(){new WH.Wow.TalentCalcClassic(h,d)};if(!WH.Wow.hasOwnProperty("TalentCalcClassic")){this.callbacks.push(g);if(this.callbacks.length==1){WH.loadAssets("talent-calc-classic",function(){for(var m,l=0;m=WH.markup.tags.talent.callbacks[l];l++){m()}})}}else{g()}return h}};WH.markup.tags["pvp-calc"]={empty:true,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},icons:{req:false}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},callbacks:[],counter:0,toNode:function(c){var g=WH.markup.getDatabaseDomainInfo(c);var h=WH.ce("div",{id:"markup-pvptalent-"+this.counter++,className:"pvptalentcalc-markup-parent"});var d=function(){new PvpTalentCalc({id:h.id,embedded:true,markup:true,hash:c.unnamed.replace(/^#+/,""),editable:c.editable=="true",dataDomain:g.host})};if(!WH.isSet("PvpTalentCalc")){this.callbacks.push(d);if(this.callbacks.length==1){WH.loadAssets("pvp-talent-calc",function(){for(var m,l=0;m=WH.markup.tags["pvp-calc"].callbacks[l];l++){m()}})}}else{d()}return h}};WH.markup.tags["talent-pvp"]=WH.markup.tags["pvp-calc"];WH.markup.tags["honor-calc"]=WH.markup.tags["pvp-calc"];WH.markup.tags.time={empty:true,attr:{until:{req:false,valid:/^\d+$/},since:{req:false,valid:/^\d+$/},server:{req:false,valid:/^true$/}},validate:function(c){if(!c.until&&!c.since){return false}return true},toNode:function(c){var d=WH.ce("span");d.title=(new Date((c.until?c.until:c.since)*1000)).toLocaleString();WH.st(d,WH.markup.tags.time.getTime(c));setInterval(WH.markup.tags.time.updateTime.bind(null,d,c),5000);return d},getTime:function(c){var f;if(c.server){f=WH.getServerTime().getTime()/1000}else{f=(new Date()).getTime()/1000}var d=0;if(c.until){d=c.until-f}else{d=f-c.since}if(d>0){return WH.formatTimeElapsed(d)}else{return"0 "+LANG.timeunitspl[6]}},updateTime:function(d,c){d.firstChild.nodeValue=WH.markup.tags.time.getTime(c)}};WH.markup.tags.tooltip={empty:false,attr:{unnamed:{req:false,valid:/\S+/},name:{req:false,valid:/\S+/},bare:{req:false,valid:/^true$/i},label:{req:false,valid:/[\S ]+/}},taglessSkip:true,allowedClass:WH.markup.CLASS.STAFF,validate:function(c){if(!c.unnamed&&!c.name){return false}return true},toNode:function(c){if(c.unnamed){var f=document.createElement("span");f.className="tip";WH.aE(f,"mouseover",function(o){WH.Tooltip.showAtCursor(o,LANG[c.unnamed],0,0,"q")});WH.aE(f,"mousemove",WH.Tooltip.cursorUpdate);WH.aE(f,"mouseout",WH.Tooltip.hide);return f}var l=document.createElement("div");if(c.label){var g=document.createElement("table");l.appendChild(g);var h=document.createElement("tr");g.appendChild(h);var m=document.createElement("td");h.appendChild(m);m.className="q0";m.style.width="300px";var d=document.createElement("small");m.appendChild(d);d.appendChild(document.createTextNode(c.label))}l.appendChild(c._contents);WH.markup.tooltipTags[c.name]=l.innerHTML;if(c.bare){WH.markup.tooltipTagsWithRawText[c.name]=true}return null}};WH.markup.tags["top-builds"]={empty:true,attr:{background:{req:false,valid:/^false$/},boss:{req:true,valid:/^.+$/},"class":{req:true,valid:/^.+$/},difficulty:{req:true,valid:/^(heroic|mythic)$/},spec:{req:true,valid:/^.+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){const g=WH.Wow.Covenant;const f=WH.Gatherer;const d=WH.WarcraftLogs;let data=WH.getPageData(["WH.Markup.topBuilds",c.boss,c.difficulty,c["class"],c.spec].join("."));if(!data){let noDataError=WH.ce("div");WH.ae(noDataError,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(noDataError,WH.ct(WH.Strings.nbsp+" "+WH.TERMS.notopbuildsdata_tip));return noDataError}let dataEnv=WH.getDataEnv();if(data.items){f.addData(WH.Types.ITEM,dataEnv,data.items)}if(data.spells){f.addData(WH.Types.SPELL,dataEnv,data.spells)}let result=WH.ce("div",{className:"top-builds"});if(c.background==="false"){result.classList.add("no-background")}let dataSections=0;let notEnoughDataErrors=0;let covenantWrapper=WH.ce("div",{className:"top-builds-covenants"});WH.ae(covenantWrapper,WH.getImitationHeading(WH.TERMS.covenants,6));let covenantTable=WH.ce("table");let covenantPopRow=WH.ce("tr",{className:"top-builds-covenants-popularity"});let covenantIconRow=WH.ce("tr",{className:"top-builds-covenants-icon"});WH.ae(covenantTable,covenantPopRow);WH.ae(covenantTable,covenantIconRow);let totalCovenantsAdded=0;if(data.build.covenants){for(let i=0,covenant;covenant=data.build.covenants[i];i++){WH.ae(covenantPopRow,WH.ce("td",undefined,WH.ct(Math.round(covenant.pop)+"%")));let icon=WH.Icon.create(g.getIcon(covenant.id),WH.Icon.SMALL,"javascript:;");WH.Tooltip.simple(WH.Icon.getLink(icon),d.getCovenantTooltip.bind(undefined,covenant),"q",true);WH.ae(covenantIconRow,WH.ce("td",undefined,icon));totalCovenantsAdded++}}dataSections++;if(!totalCovenantsAdded){WH.de(covenantIconRow);let covenantErrorCell=WH.ce("td",undefined,WH.ct(WH.TERMS.notenoughdata));WH.ae(covenantPopRow,covenantErrorCell);notEnoughDataErrors++}WH.ae(covenantWrapper,covenantTable);WH.ae(result,covenantWrapper);dataSections++;notEnoughDataErrors+=d.displayTopSpells(result,WH.TERMS.topConduits,"top-builds-conduits",data.build.conduits,true);dataSections++;notEnoughDataErrors+=d.displayTopSpells(result,WH.TERMS.topLegendaries,"top-builds-legendary-powers",data.build.legendaryPowers,true);let trinketWrapper=WH.ce("div",{className:"top-builds-trinkets"});WH.ae(trinketWrapper,WH.getImitationHeading(WH.TERMS.toptrinkets,6));let trinketTable=WH.ce("table");let trinketPopRow=WH.ce("tr",{className:"top-builds-trinkets-popularity"});let trinketIconRow=WH.ce("tr",{className:"top-builds-trinkets-icon"});WH.ae(trinketTable,trinketPopRow);WH.ae(trinketTable,trinketIconRow);let totalTrinketsAdded=0;if(data.build.trinkets){for(let i=0,trinket;trinket=data.build.trinkets[i];i++){let trinketItem=f.get(WH.Types.ITEM,trinket.id);if(!trinketItem){continue}let trinketIcon=Icon.create(trinketItem.icon,Icon.sizeIds.small,undefined,WH.Wow.Item.getPath(trinket.id),undefined,undefined,undefined,undefined,true);trinketIcon.className+=" iconsmall-q"+trinketItem.quality;let trinketIconLink=Icon.getLink(trinketIcon);trinketIconLink.setAttribute("data-whattach","true");trinketIconLink.target="_blank";let trinketIconCell=WH.ce("td");WH.ae(trinketIconCell,trinketIcon);WH.ae(trinketPopRow,WH.ce("td",{innerHTML:Math.round(trinket.pop)+"%"}));WH.ae(trinketIconRow,trinketIconCell);totalTrinketsAdded++}}dataSections++;if(!totalTrinketsAdded){WH.de(trinketIconRow);let trinketErrorCell=WH.ce("td",{innerHTML:WH.TERMS.notenoughdata});WH.ae(trinketPopRow,trinketErrorCell);notEnoughDataErrors++}WH.ae(trinketWrapper,trinketTable);WH.ae(result,trinketWrapper);let talentWrapper=WH.ce("div",{className:"top-builds-talents"});WH.ae(talentWrapper,WH.getImitationHeading(WH.TERMS.toptalents,6));let talentTable=WH.ce("table",{className:"top-builds-top-talents"});let totalTalentsAdded=0;if(data.build.talents){let talentPopRow=WH.ce("tr",{className:"top-builds-talents-popularity"});let talentIconRow=WH.ce("tr",{className:"top-builds-talents-icon"});let talentLevelRow=WH.ce("tr",{className:"top-builds-talents-level"});WH.ae(talentTable,talentPopRow);WH.ae(talentTable,talentIconRow);WH.ae(talentTable,talentLevelRow);let talentLevels=WH.Wow.Spell.getTalentLevels();for(let talentRowId=0,talentTier;talentTier=data.build.talents[talentRowId];talentRowId++){if(talentRowId!==0){let dividerCell=WH.ce("td",{className:"top-builds-talents-divider",rowSpan:3});WH.ae(talentPopRow,dividerCell)}let talentHeadingCell=WH.ce("th",{className:"q"});let talentLevelDiv=WH.ce("div");WH.st(talentLevelDiv,talentLevels[talentRowId]);WH.ae(talentHeadingCell,talentLevelDiv);WH.ae(talentLevelRow,talentHeadingCell);let added=0;let totalRowPercentage=0;let iconsThisRow=0;for(let i=0,talent;talent=talentTier[i];i++){let spell=f.get(WH.Types.SPELL,talent.id);if(!spell){this.display_addUnknownIcon(talentPopRow,talentIconRow,Math.round(talent.pop));totalRowPercentage+=Math.round(talent.pop);added++;continue}let talentIcon=Icon.create(spell.icon,Icon.sizeIds.small,undefined,WH.Wow.Spell.getPath(talent.id));WH.Icon.getLink(talentIcon).target="_blank";let talentIconCell=WH.ce("td");WH.ae(talentIconCell,talentIcon);WH.ae(talentPopRow,WH.ce("td",{innerHTML:Math.round(talent.pop)+"%"}));WH.ae(talentIconRow,talentIconCell);totalRowPercentage+=Math.round(talent.pop);added++;totalTalentsAdded++;iconsThisRow++}talentHeadingCell.colSpan=Math.max(1,iconsThisRow);let percentageDisplay=added===2?100-totalRowPercentage:WH.TERMS.questionmark_punct;while(added<3&&totalRowPercentage<100){this.display_addUnknownIcon(talentPopRow,talentIconRow,percentageDisplay);added++}}}dataSections++;if(!totalTalentsAdded){WH.ee(talentTable);let talentErrorCell=WH.ce("td",{innerHTML:WH.TERMS.notenoughdata});let talentErrorRow=WH.ce("tr",undefined,talentErrorCell);WH.ae(talentTable,talentErrorRow);notEnoughDataErrors++}WH.ae(talentWrapper,talentTable);WH.ae(result,talentWrapper);if(notEnoughDataErrors===dataSections){WH.ee(result);let error=WH.ce("div",{className:"top-builds-no-data q0",innerHTML:WH.term("noTopDifficultyBossKillsDataForSpec_tip",WH.TERMS[c.difficulty]),style:{marginTop:"10px"}});WH.ae(result,error)}return result},display_addUnknownIcon:function(f,d,c){let questionMarkIcon=Icon.create(Icon.questionMarkIcon,Icon.sizeIds.small,undefined,"javascript:");let iconLink=Icon.getLink(questionMarkIcon);WH.Tooltip.simple(iconLink,'<b class="q10">'+WH.TERMS.notfound_format.replace("%s",WH.Types.getUpperSingular(WH.Types.SPELL))+"</b><br>"+WH.TERMS.entityremovedsincedatasaved_tip,"q0",true);let questionMarkIconCell=WH.ce("td");WH.ae(questionMarkIconCell,questionMarkIcon);let td=WH.ce("td",{innerHTML:c+"%"});td.style.opacity=".5";WH.ae(f,td);WH.ae(d,questionMarkIconCell)}};WH.markup.tags["top-covenants"]={empty:true,attr:{background:{req:false,valid:/^false$/},"class":{req:false,valid:/^.+$/},spec:{req:false,valid:/^.+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){const g=WH.Gatherer;const f=WH.Strings;const d=WH.WarcraftLogs;let classSlug=f.slug(c["class"]||"all",true);let specSlug=f.slug(c.spec||"all",true);let data=WH.getPageData(["WH.Markup.topCovenants",classSlug,specSlug].join("."));if(!data||!data.topCovenants||!data.topCovenants.length){let noDataError=WH.ce("div");WH.ae(noDataError,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(noDataError,WH.ct(f.nbsp+" "+WH.TERMS.notenoughdata));return noDataError}let result=WH.ce("div",{className:"top-covenants"});if(c.background==="false"){result.classList.add("no-background")}let row=WH.ce("div");WH.ae(result,row);let totalCovenantsAdded=0;data.topCovenants.sort(function(l,h){return WH.stringCompare(g.getName(WH.Types.COVENANT,l.id),g.getName(WH.Types.COVENANT,h.id))});for(let i=0,covenantData;covenantData=data.topCovenants[i];i++){let covenant=g.get(WH.Types.COVENANT,covenantData.id);let slug=f.slug(covenant.name_enus||"");let cell=WH.ce("span",{className:"covenant-"+slug+" icon-"+slug},WH.ct([covenant["name_"+Locale.getName()],WH.Strings.formatNumber(covenantData.pop/100,true,0,1)].join(" ")));WH.ae(row,cell);WH.Tooltip.simple(cell,d.getCovenantTooltip.bind(undefined,covenantData),"q");totalCovenantsAdded++}while(totalCovenantsAdded<4){WH.ae(row,WH.ce("span"));totalCovenantsAdded++}return result}};WH.markup.tags["top-mythic-classes"]={empty:true,attr:{unnamed:{req:true,valid:/^[A-Za-z0-9' -]+$/},affixes:{req:true,valid:/^(current|all)$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(o){let data=WH.getPageData(["WH.Markup.topMythicClasses",o.unnamed,o.affixes].join("."));let noDataError=WH.ce("div");WH.ae(noDataError,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(noDataError,WH.ct(WH.Strings.nbsp+" "+WH.TERMS.notopmythicclassesdata_tip));if(!data){return noDataError}var u=WH.ce("div",{className:"top-mythic-classes"});var c=["tank","healer","dps"];for(var l=0,p;p=data.classes[l];l++){var t=WH.staticUrl+"/images/classes/symbols/icon-"+g_file_classes[p.class_id]+".png";var q=Math.round(p.total/data.counts.total*100)+"%";var d=WH.ce("div",{className:"top-mythic-classes-class"});WH.ae(u,d);var m=WH.ce("div",{className:"top-mythic-classes-class-content"});WH.ae(d,m);WH.ae(m,WH.ce("div",{className:"top-mythic-classes-class-crest",style:{backgroundImage:"url("+t+")"}}));var r=WH.ce("div",{className:"top-mythic-classes-class-title"});WH.ae(m,r);WH.ae(r,WH.ce("span",{className:"c"+p.class_id},WH.ct(g_chr_classes[p.class_id])));WH.ae(r,WH.ce("small",{},WH.ct(q)));for(var h=0,f;f=c[h];h++){if(p.hasOwnProperty(f)){var g=WH.ce("span");WH.ae(g,WH.ce("b",{},WH.ct(Math.round(p[f]/data.counts[f]*100))));WH.ae(g,WH.ct("%"));WH.ae(m,WH.ce("span",{className:"iconrole iconsmall "+f},g))}}}if(!u.hasChildNodes()){return noDataError}return u}};WH.markup.tags["top-mythic-runs"]={empty:true,attr:{unnamed:{req:true,valid:/^.*$/},affixes:{req:true,valid:/^.*$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(t){let data=WH.getPageData(["WH.Markup.topMythicRuns",t.unnamed,t.affixes].join("."));let noDataError=WH.ce("div");WH.ae(noDataError,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(noDataError,WH.ct(WH.Strings.nbsp+" "+WH.TERMS.notopmythicrunsdata_tip));if(!data){return noDataError}var g=WH.ce("div",{className:"top-mythic-runs"});var C=5;for(var A=0,p;p=data.runs[A];A++){p=p.run;var h=WH.ce("div",{className:"top-mythic-runs-run"});WH.ae(g,h);WH.ae(h,WH.ce("div",{className:"top-mythic-runs-run-level"},WH.ct(WH.TERMS.mythicplus+WH.TERMS.wordspace_punct+p.mythic_level)));var o=p.clear_time_ms/1000;var w=Math.floor(o/60);o=Math.round(o-(w*60));WH.ae(h,WH.ce("div",{className:"top-mythic-runs-run-time"},WH.ct(w+WH.TERMS.wordspace_punct+LANG[w===1?"timeunitssg":"timeunitspl"][5]+WH.TERMS.wordspace_punct+o+WH.TERMS.wordspace_punct+LANG[o===1?"timeunitssg":"timeunitspl"][6])));if(p.roster.length){var m=document.createDocumentFragment();var E=document.createDocumentFragment();for(var z=0,c;c=p.roster[z];z++){c=c.character;var D=g_spec2SeoShorthand[c["class"].id][WH.getSpecIndexFromSpecId(c.spec.id)];var d=Icon.create(WH.Wow.PlayerClass.Specialization.getIconName(c.spec.id),Icon.sizeIds.small,undefined,"/"+D+"-"+g_class2SeoShorthand[c["class"].id]+"-guide",undefined,undefined,undefined,undefined,true);WH.Tooltip.simple(d,'<span class="no-wrap">'+WH.sprintf(WH.TERMS.guide_format,WH.TERMS.specclass_format.replace("%1$s",WH.Wow.PlayerClass.Specialization.getName(c.spec.id)).replace("%2$s",g_chr_classes[c["class"].id]))+"</span>","c"+c["class"].id,true);WH.ae(m,WH.ce("td",{},d));var q=g_file_genders[c.race.id===WH.Wow.Race.ID_BLOOD_ELF?1:0];var f=WH.Icon.create("race_"+g_file_races[c.race.id]+"_"+q,WH.Icon.SMALL,WH.Entity.getPath(WH.Types.RACE,c.race.id,g_chr_races[c.race.id]),{span:true});WH.Tooltip.simple(f,g_chr_races[c.race.id],"q",true);WH.ae(E,WH.ce("td",{},f))}var l=WH.ce("table");WH.ae(h,l);WH.ae(l,WH.ce("tr",{},m));WH.ae(l,WH.ce("tr",{},E))}if(t.affixes==="all"){var B=WH.ce("div",{className:"top-mythic-runs-run-affixes"});WH.ae(h,B);WH.ae(B,WH.ct(WH.TERMS.affixes+WH.TERMS.colon_punct));for(var v=0,r;r=p.weekly_modifiers[v];v++){var F=WH.Icon.create(r.icon,WH.Icon.SMALL,WH.Entity.getPath(WH.Types.AFFIX,r.id,r.name),{span:true});var u=Icon.getLink(F);u.setAttribute("data-whattach","true");WH.ae(B,F)}}if(A+1===C){break}}if(!g.hasChildNodes()){return noDataError}return g}};WH.markup.tags.twitch={empty:true,attr:{unnamed:{req:true,valid:/^\S+$/},width:{req:false,valid:/^[0-9]+$/},height:{req:false,valid:/^[0-9]+$/},time:{req:false,valid:/^(?:\d+h)?(?:\d{1,2}m)?(?:\d{1,2}s)?$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){let size=(function(){let maxWidth=Platform.getViewportWidth()-40;let width;let height;let aspect=16/9;if(c.width&&c.height){width=parseInt(c.width);height=parseInt(c.height);aspect=width/height;if(width>maxWidth){width=maxWidth;height=width/aspect}}else{if(c.width){width=Math.min(parseInt(c.width),maxWidth);height=width/aspect}else{if(c.height){height=parseInt(c.height);width=height*aspect;if(width>maxWidth){width=maxWidth;height=width/aspect}}else{width=Math.min(maxWidth,620);height=width/aspect}}}return{width:width,height:height}})();let embed=(function(){if(/^[a-zA-Z0-9_-]{4,25}$/.test(c.unnamed)){return{type:"channel",id:c.unnamed,time:undefined}}let match;if(match=c.unnamed.match(/\/videos?\/(\d+)/)){let result={type:"video",id:match[1],time:undefined};if(match=c.unnamed.match(/[&?]t=((?:\d+h)?(?:\d{1,2}m)?(?:\d{1,2}s)?)/)){result.time=match[1]}return result}if(match=c.unnamed.match(/clips\.twitch\.tv\/([a-zA-Z0-9]+)/)){return{type:"clip",id:match[1],time:undefined}}if(match=c.unnamed.match(/\/clips?\/([a-zA-Z0-9]+)/)){return{type:"clip",id:match[1],time:undefined}}if(match=c.unnamed.match(/twitch\.tv\/([a-zA-Z0-9_-]{3,25})/)){return{type:"channel",id:match[1],time:undefined}}return{type:undefined,id:undefined,time:undefined}})();let queryParams="&parent="+encodeURIComponent(location.hostname);queryParams+="&autoplay=false";if(c.time&&embed.type==="video"){queryParams+="&time="+encodeURIComponent(c.time)}else{if(embed.time){queryParams+="&time="+encodeURIComponent(embed.time)}}switch(embed.type){case"channel":return WH.ce("iframe",{src:"https://player.twitch.tv/?channel="+embed.id+queryParams,frameBorder:0,scrolling:"no",height:size.height,width:size.width});case"video":return WH.ce("iframe",{src:"https://player.twitch.tv/?video=v"+embed.id+queryParams,frameBorder:0,scrolling:"no",height:size.height,width:size.width});case"clip":return WH.ce("iframe",{src:"https://clips.twitch.tv/embed?clip="+embed.id+queryParams,frameBorder:0,scrolling:"no",height:size.height,width:size.width})}return WH.ce("div",{className:"error-message",style:{border:"1px dashed",boxSizing:"border-box",height:size.height+"px",width:size.width+"px",padding:"5px"}},WH.ct("Error: Could not detect Twitch embed type for ["+c.unnamed+"]."))}};WH.markup.tags.video={empty:true,attr:{id:{req:true,valid:/^[0-9]+$/},unnamed:{req:false,valid:/^embed$/i},"float":{req:false,valid:/^(left|right)$/i},shadow:{req:false,valid:/^(true|false)$/},border:{req:false,valid:/^[0-9]+$/}},ltrim:true,rtrim:true,allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){if(!g_videos[c.id]){return WH.ce("b",{},WH.ct("Video #"+c.id))}var l=g_videos[c.id];var g=[];var h=[];if(c.unnamed){switch(l.videoType){case 1:return WH.markup.tags.youtube.toNode({unnamed:l.videoId});case 2:return WH.ce("video",{controls:true},WH.ce("source",{src:WH.Url.generate("/video-stream/"+l.id+"-"+l.videoId,{dataEnv:WH.dataEnv.MAIN,locale:LOCALE_ENUS})}));default:return WH.ce("b",{},WH.ct("Video id "+c.id+" cannot be embedded with unsupported type: "+l.videoType))}}if(!g_videos[WH.markup.mediaUid]){g_videos[WH.markup.mediaUid]=[]}let videoUrlId=l.videoId;if(l.videoType===2){videoUrlId=c.id+"-"+videoUrlId}var m=WH.ce("div",{style:{position:"relative",display:"inline-block",zoom:1}});var d=WH.ce("a",{href:WH.sprintf(vi_siteurls[l.videoType],videoUrlId)});WH.ae(m,d);WH.markup.applyCommonAttributes(d,c);WH.aE(d,"click",function(o){if(!WH.isLeftClick(o)){return}VideoViewer.show({videos:WH.markup.mediaUid,pos:g_videos[WH.markup.mediaUid].length});o.preventDefault()});if(vi_thumbnails[l.videoType]){var f=WH.ce("img",{src:WH.sprintf(vi_thumbnails[l.videoType],l.videoId)});WH.ae(d,f);if(c.border!==undefined){if(c.border==0){f.classList.add("no-border")}else{f.classList.add("border");f.style.borderWidth=""+c.border+"px"}}else{f.classList.add("content-image");if(c.shadow!=="false"){f.classList.add("content-image-shadowed")}}if(c["float"]){f.classList.add("markup-float-"+c["float"])}if(l.hasCaption){f.alt=l.caption}WH.ae(d,WH.ce("img",{src:WH.staticUrl+"/images/icons/play-sm.png",style:{opacity:"0.6",position:"absolute",width:"48px",height:"48px",top:"23px",left:"38px"}}))}else{WH.st(d,l.caption)}g_videos[WH.markup.mediaUid].push(WH.dO(l));return m}};WH.markup.tags.youtube={empty:true,attr:{unnamed:{req:true,valid:/\S+/},title:{req:false,valid:/[\S ]+/},thumb:{req:false,valid:/\S+/},width:{req:false,valid:/^[0-9]+$/},height:{req:false,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(l){var d=l.width?l.width:640;var p=l.height?l.height:360;if(window.outerWidth&&window.outerWidth-20<d){d=window.outerWidth-20;p=Math.floor(d*0.5625)}var m={height:p,width:d,videoId:l.unnamed,playerVars:{autoplay:1}};if(!WH.markup.tags.youtube.listeningForApiReady){WH.markup.tags.youtube.listeningForApiReady=true;var g;if(WH.isSet("onYouTubeIframeAPIReady")&&(typeof window.onYouTubeIframeAPIReady=="function")){g=window.onYouTubeIframeAPIReady}else{g=function(){}}window.onYouTubeIframeAPIReady=function(){WH.markup.tags.youtube.apiReady=true;g()};if(!WH.isSet("YT")){window.YT={};WH.ajaxIshRequest("https://www.youtube.com/iframe_api",true)}}var f={yt:m,loaded:false};var c=WH.ce("div",{className:"wh-youtube"});f.container=c;var q=(p/d)*100;var h="https://i.ytimg.com/vi/"+m.videoId+"/sddefault.jpg";if(d<=480||$(document).width()<=500){h="https://i.ytimg.com/vi/"+m.videoId+"/hqdefault.jpg"}if(l.thumb){h=l.thumb;c.classList.add("wh-youtube-custom-thumb")}if(q<=35){c.classList.add("wh-youtube-short")}c.style.background="url("+h+")";c.style.maxWidth=""+d+"px";let inner=WH.ce("a",{className:"wh-youtube-inner",href:"javascript:",style:{paddingTop:""+q+"%"}});WH.ae(c,inner);if(l.title){WH.ae(inner,WH.ce("div",{className:"wh-youtube-title"},WH.ct(l.title)))}WH.ae(inner,WH.ce("i",{className:"fa fa-circle"}));WH.ae(inner,WH.ce("i",{className:"fa fa-play-circle"}));WH.aE(inner,"click",WH.markup.tags.youtube.onClick.bind(f));return c},fromHtml:function(o){var d;if(d=o.match(/<iframe\b[\s\S]*?src="[\s\S]*?youtube\.com\/embed\/[\s\S]*?"[\s\S]*?><\/iframe>/gi)){for(var g=0;g<d.length;++g){var l=d[g].match(/src="[\s\S]*?youtube\.com\/embed\/([\s\S]*?)"/i),h=d[g].match(/width[:="]+\s*([0-9]+)/i),c=d[g].match(/height[:="]+\s*([0-9]+)/i),f=d[g].match(/border[:="]+\s*([0-9]+)/i);o=o.replace(d[g],"[youtube="+l[1]+(h?" width="+h[1]:"")+(c?" height="+c[1]:"")+"]")}}return o},listeningForApiReady:false,apiReady:false,onClick:function(){if(this.loaded){return}if(!WH.markup.tags.youtube.apiReady){setTimeout(WH.markup.tags.youtube.onClick.bind(this),125);return}this.container.classList.add("wh-youtube-loaded");this.loaded=true;this.player=new YT.Player(this.container.firstChild,this.yt)}};WH.markup.entityTagToNode=function(h,t,d,g){var r=t.unnamed;var m=WH.markup.getDatabaseDomainInfo(t);var l=m.host;var c=m.nameKey;if(typeof g==="undefined"){g=[]}var f=WH.TERMS.openparenthesis_punct+WH.Types.getUpperSingular(h)+WH.TERMS.wordspace_punct+"#"+r+WH.TERMS.closedparenthesis_punct;if(t.diff){g.push("diff="+t.diff)}if(t.diffnew){g.push("diffnew="+t.diffnew)}if(t.spec){g.push("spec="+t.spec)}if(t.tempname){f=t.tempname}var z=WH.ce("a");if(g.length){z.rel=g.join("&")}var p=parseInt(r,10);var A=null;var u=g_gathered_types[h];var w=WH.Gatherer.get(h,p,m.dataEnv);if(w&&(w[c]||w.name)){if(w.hasOwnProperty("fromDataEnv")){l=WH.Url.generate("",{subdomain:WH.Url.getSubdomain(w.fromDataEnv,m.locale)}).replace(/\/$/,"")}if(w.hasOwnProperty("quality")){var o=w.quality;if(t.quality){o=t.quality}z.classList.add("q"+o)}var B=w[c]||w.name;var q;if((q=B.indexOf(" / "))!=-1){if(/\.1$/.test(r)){B=B.substr(0,q)}else{if(/\.2$/.test(r)){B=B.substr(q+3)}}}if(h===WH.Types.ITEM&&!w.icon){w.icon=Icon.questionMarkIcon}var v=undefined;if((!t.icon||t.icon!=="false")&&(w.icon||typeof u.getIcon==="function")){v=w.icon;switch(h){case WH.Types.ITEM:v=u.getIcon(p,undefined,undefined,m.dataEnv)||v;break;case WH.Types.CLASS:case WH.Types.CURRENCY:case WH.Types.RACE:v=u.getIcon(p)||v;break}}if(v){z.classList.add("icontiny");WH.ae(z,WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+v.toLowerCase()+".gif",style:{verticalAlign:"middle"}}));WH.ae(z,WH.ct(" "))}WH.ae(z,WH.ce("span",{className:"tinyicontxt"},WH.ct(B)));A=B}else{WH.st(z,f)}z.href=l+WH.Entity.getPath(h,r,A);WH.markup.applyCommonAttributes(z,t);return z};WH.markup.entityTagToText=function(f,c){var l=c.unnamed;var h=WH.markup.getDatabaseDomainInfo(c);var d=h.nameKey;var g=WH.Gatherer.get(f,l,h.dataEnv);if(g&&g[d]){return WH.markup.getEscapedHtml(g[d])}return WH.Types.getUpperSingular(f)+WH.TERMS.wordspace_punct+"#"+l};WH.markup.tags.achievement={entityType:WH.Types.ACHIEVEMENT,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tempname:{req:false}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.ACHIEVEMENT),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ACHIEVEMENT)};WH.markup.tags["adventure-combatant-ability"]={entityType:WH.Types.ADVENTURE_COMBATANT_ABILITY,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},icon:{req:false,valid:/^false$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.ADVENTURE_COMBATANT_ABILITY),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ADVENTURE_COMBATANT_ABILITY)};WH.markup.tags.affix={entityType:WH.Types.AFFIX,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.AFFIX),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.AFFIX)};WH.markup.tags["azerite-essence"]={entityType:WH.Types.AZERITE_ESSENCE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.AZERITE_ESSENCE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.AZERITE_ESSENCE)};WH.markup.tags["azerite-essence-power"]={entityType:WH.Types.AZERITE_ESSENCE_POWER,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},spec:{req:false,valid:/^[0-9]+$/},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.AZERITE_ESSENCE_POWER),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.AZERITE_ESSENCE_POWER)};WH.markup.tags["bfa-champion"]={entityType:WH.Types.BFA_CHAMPION,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},level:{req:false,valid:/^[0-9:]+$/},quality:{req:false,valid:/^[2345]$/},abilities:{req:false,valid:/^[0-9:]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:function(d){var c=[];if(d.quality){c.push("q="+d.quality)}if(d.level){c.push("level="+d.level)}if(d.abilities){c.push("abil="+d.abilities)}return WH.markup.entityTagToNode(WH.Types.BFA_CHAMPION,d,undefined,c)},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.BFA_CHAMPION)};WH.markup.tags.building={entityType:WH.Types.BUILDING,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},nolvl:{req:false,valid:/^true$/},"short":{req:false,valid:/^true$/},side:{req:false,valid:/^1|2$/}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:function(m){var f=m.unnamed;var h=WH.markup.getDatabaseDomainInfo(m);var c=h.host;var q=h.nameKey;var r=WH.ce("a");var o=WH.Gatherer.get(WH.Types.BUILDING,f,h.dataEnv);if(o&&o[q]){if(o.hasOwnProperty("fromDataEnv")){c=WH.Url.generate("",{subdomain:WH.Url.getSubdomain(o.fromDataEnv,h.locale)}).replace(/\/$/,"")}var d=o[q];r.href=c+WH.Entity.getPath(WH.Types.BUILDING,f,d);var l=m["short"]?LANG.traits["level"][2]:WH.TERMS.level;if(m.side){var p=new RegExp(m.side==1?" \\/ .+$":"[^\\/]+ \\/ ");d=d.replace(p,"")}else{if(m["short"]){if(g_garrison_building_short_names.hasOwnProperty(f)){d=g_garrison_building_short_names[f]}}}var g=(!m.nolvl&&o.hasOwnProperty("level"))?l+WH.TERMS.wordspace_punct+o.level+WH.TERMS.wordspace_punct:"";WH.st(r,g+d)}else{r.href=c+WH.Entity.getPath(WH.Types.BUILDING,f);WH.st(r,WH.TERMS.openparenthesis_punct+WH.Types.getUpperSingular(WH.Types.BUILDING)+WH.TERMS.wordspace_punct+"#"+f+WH.TERMS.closedparenthesis_punct)}WH.markup.applyCommonAttributes(r,m);return r},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.BUILDING)};WH.markup.tags["class"]={entityType:WH.Types.CLASS,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/i},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}if(c.unnamed>=1&&c.unnamed<=12){return true}return false},toNode:function(c){var d=WH.markup.entityTagToNode(WH.Types.CLASS,c);d.classList.add("c"+c.unnamed);return d},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.CLASS)};WH.markup.tags.champion={entityType:WH.Types.CHAMPION,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},level:{req:false,valid:/^[0-9:]+$/},quality:{req:false,valid:/^[2345]$/},abilities:{req:false,valid:/^[0-9:]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:function(d){var c=[];if(d.quality){c.push("q="+d.quality)}if(d.level){c.push("level="+d.level)}if(d.abilities){c.push("abil="+d.abilities)}return WH.markup.entityTagToNode(WH.Types.CHAMPION,d,undefined,c)},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.CHAMPION)};WH.markup.tags.currency={entityType:WH.Types.CURRENCY,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},amount:{req:false,valid:/^[0-9\:]+$/},icon:{req:false,valid:/^false$/i},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:function(c){var d=WH.markup.entityTagToNode(WH.Types.CURRENCY,c);var h=d.querySelector(".tinyicontxt");if(h){d.classList.add("q1")}if(c.amount){if(h){var l=d.textContent;d.classList.add("tip");WH.aE(d,"mouseover",function(m){WH.Tooltip.showAtCursor(m,l,0,0,"q1")});WH.aE(d,"mousemove",WH.Tooltip.cursorUpdate);WH.aE(d,"mouseout",WH.Tooltip.hide);WH.st(d.querySelector(".tinyicontxt")||d,c.amount.split(":").join(" - "));var f=d.querySelector("img");if(f){d.style.backgroundImage="url("+f.src+")";d.classList.remove("icontiny");d.classList.add("icontinyr");f.parentNode.removeChild(f)}}else{WH.ae(d,WH.ct(WH.TERMS.wordspace_punct+"x"+c.amount.split(":").join(" - ")))}}else{var g=WH.ce("span");while(d.hasChildNodes()){WH.ae(g,d.firstChild)}WH.ae(d,g)}return d},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.CURRENCY)};WH.markup.tags.event={entityType:WH.Types.EVENT,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.EVENT),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.EVENT)};WH.markup.tags.faction={entityType:WH.Types.FACTION,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.FACTION),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.FACTION)};WH.markup.tags.follower={entityType:WH.Types.FOLLOWER,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},level:{req:false,valid:/^[0-9:]+$/},quality:{req:false,valid:/^[2345]$/},abilities:{req:false,valid:/^[0-9:]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:function(d){var c=[];if(d.quality){c.push("q="+d.quality)}if(d.level){c.push("level="+d.level)}if(d.abilities){c.push("abil="+d.abilities)}return WH.markup.entityTagToNode(WH.Types.FOLLOWER,d,undefined,c)},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.FOLLOWER)};WH.markup.tags["gear-set"]={entityType:WH.Types.GEAR_SET,empty:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},toNode:function(c){var h=c.unnamed;var g=g_gearsets[h];var d=WH.Entity.getPath(WH.Types.GEAR_SET,h,(g||{}).name);var f=WH.ce("a",{href:d,target:"_blank"});f.setAttribute("whattach","true");if(g){if(g["class"]){f.className="icontiny c"+g["class"];WH.ae(f,WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+g_classes.getIcon(g["class"])+".gif",style:{verticalAlign:"middle"}}));WH.ae(f,WH.ct(" "))}WH.ae(f,WH.ct(g.name))}else{WH.ae(f,WH.ct(WH.Types.getUpperSingular(WH.Types.GEAR_SET)+WH.TERMS.wordspace_punct+"#"+h))}return f}};WH.markup.tags.guide={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.GUIDE),toText:function(c){var f=c.unnamed;var d="name";if(g_guides[f]&&g_guides[f][d]){return WH.markup.getEscapedHtml(g_guides[f][d])}return WH.Types.getUpperSingular(WH.Types.GUIDE)+WH.TERMS.wordspace_punct+"#"+f}};WH.markup.tags["mission-ability"]={entityType:WH.Types.MISSION_ABILITY,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.MISSION_ABILITY),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.MISSION_ABILITY)};WH.markup.tags.garrisonability=WH.cO(WH.markup.tags["mission-ability"]);delete WH.markup.tags.garrisonability.entityType;WH.markup.tags.icondb={entityType:WH.Types.ICON,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},block:{req:false,valid:/^(true|false)$/},size:{req:false,valid:/^(tiny|small|medium|large)$/},name:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:function(c){var g=c.size?c.size:"small";var l=c.name==="true";var o=c.unnamed;var m=WH.markup.getDatabaseDomainInfo(c);var f=WH.TERMS.openparenthesis_punct+WH.Types.getUpperSingular(WH.Types.ICON)+WH.TERMS.wordspace_punct+"#"+o+WH.TERMS.closedparenthesis_punct;let rel=[];if(c.diff){rel.push("diff="+c.diff)}if(c.diffnew){rel.push("diffnew="+c.diffnew)}rel=rel.length?rel.join("&"):null;if(c.tempname){f=c.tempname}var d=WH.ce("a");var h=WH.Gatherer.get(WH.Types.ICON,o,m.dataEnv);let url=m.host;if(h&&h.name){if(h.hasOwnProperty("fromDataEnv")){url=WH.Url.generate("",{subdomain:WH.Url.getSubdomain(h.fromDataEnv,m.locale)}).replace(/\/$/,"")}url+=WH.Entity.getPath(WH.Types.ICON,o,h.name)}else{url+=WH.Entity.getPath(WH.Types.ICON,o)}d.href=url;if(h&&h.name){if(l){f=" "+h.name}if(g==="tiny"){d.classList.add("icontiny");let tinyIcon=WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+h.icon.toLowerCase()+".gif",style:{verticalAlign:"middle"}});WH.ae(d,tinyIcon)}else{let iconOptions={span:l||c.block!=="true"};if(!l){if(rel){iconOptions.rel=rel}return WH.Icon.create(h.name,g,url,iconOptions)}WH.ae(d,WH.Icon.create(h.name,g,null,iconOptions))}}if(rel){d.rel=rel}if(l){WH.ae(d,WH.ct(f))}WH.markup.applyCommonAttributes(d,c);return d},toText:function(c){var d=c.unnamed;if(g_icons[d]&&g_icons[d].name){return WH.markup.getEscapedHtml(g_icons[d].name)}return WH.Types.getUpperSingular(WH.Types.ICON)+WH.TERMS.wordspace_punct+"#"+d}};WH.markup.tags.item={entityType:WH.Types.ITEM,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/i},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},"azerite-powers":{req:false,valid:/^[0-9:]+$/},bonus:{req:false,valid:/^[0-9:]+$/},spec:{req:false,valid:/^[0-9]+$/},ak:{req:false,valid:/^[0-9]+$/},tooltip:{req:false,valid:/^true$/i},tempname:{req:false},transmog:{req:false,valid:/^([0-9]+|hidden)$/}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:function(d){var c=[];if(d.ak){c.push("artk="+d.ak)}if(d["azerite-powers"]){c.push("azerite-powers="+d["azerite-powers"])}if(d.bonus){c.push("bonus="+d.bonus)}if(d.spec){c.push("spec="+d.spec)}if(d.transmog){c.push("transmog="+d.transmog)}var f=WH.markup.entityTagToNode(WH.Types.ITEM,d,undefined,c);f.dataset.entity="item";f.dataset.entityHasIcon="true";if(d.tooltip){f=WH.ce("span",{},f);$WowheadPower.replaceWithTooltip(f,WH.Types.ITEM,d.unnamed)}return f},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ITEM)};WH.markup.tags["item-set"]={entityType:WH.Types.ITEM_SET,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^-?[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.ITEM_SET),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ITEM_SET)};WH.markup.tags.itemset=WH.cO({},WH.markup.tags["item-set"]);delete WH.markup.tags.itemset.entityType;WH.markup.tags.mission={entityType:WH.Types.MISSION,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.MISSION),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.MISSION)};WH.markup.tags.npc={entityType:WH.Types.NPC,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.NPC),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.NPC)};WH.markup.tags["order-advancement"]={entityType:WH.Types.ORDER_ADVANCEMENT,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.ORDER_ADVANCEMENT),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ORDER_ADVANCEMENT)};WH.markup.tags.outfit={entityType:WH.Types.OUTFIT,empty:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},toNode:function(c){var h=c.unnamed;var g=g_outfits[h];var d=WH.Entity.getPath(WH.Types.OUTFIT,h,g&&g.name);var f=WH.ce("a",{href:d,target:"_blank"});f.setAttribute("whattach","true");if(g){if(g.classs){f.className="icontiny c"+g.classs;WH.ae(f,WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+g_classes.getIcon(g.classs)+".gif",style:{verticalAlign:"middle"}}));WH.ae(f,WH.ct(" "))}WH.ae(f,WH.ct(g.name))}else{WH.ae(f,WH.ct(WH.Types.getUpperSingular(WH.Types.OUTFIT)+WH.TERMS.wordspace_punct+"#"+h))}return f}};WH.markup.tags["pet-ability"]={entityType:WH.Types.PET_ABILITY,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.PET_ABILITY),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.PET_ABILITY)};WH.markup.tags.petability=WH.cO({},WH.markup.tags["pet-ability"]);delete WH.markup.tags.petability.entityType;WH.markup.tags.object={entityType:WH.Types.OBJECT,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.OBJECT),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.OBJECT)};WH.markup.tags.pet={entityType:WH.Types.PET,empty:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.PET),toText:function(c){var d=c.unnamed;if(g_pet_families&&g_pet_families[d]){return WH.markup.getEscapedHtml(g_pet_families[d])}return WH.Types.getUpperSingular(WH.Types.PET)+WH.TERMS.wordspace_punct+"#"+d}};WH.markup.tags.quest={entityType:WH.Types.QUEST,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:function(c){let id=c.unnamed;let quest=WH.Gatherer.get(WH.Types.QUEST,id);let a=WH.markup.entityTagToNode(WH.Types.QUEST,c);if(quest){let s=a.querySelector("span");if(s&&quest.hasOwnProperty("_side")){switch(quest._side){case 1:s.classList.add("icon-alliance");break;case 2:s.classList.add("icon-horde");break}}}return a},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.QUEST)};WH.markup.tags.race={entityType:WH.Types.RACE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},gender:{req:false,valid:/^(0|1)$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}if(g_file_races[c.unnamed]){return true}return false},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.RACE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.RACE)};WH.markup.tags.resource={entityType:WH.Types.RESOURCE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.RESOURCE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.RESOURCE)};WH.markup.tags.ship={entityType:WH.Types.SHIP,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},quality:{req:false,valid:/^[2345]$/},abilities:{req:false,valid:/^[0-9:]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:function(d){var c=[];if(d.quality){c.push("q="+d.quality)}if(d.level){c.push("level="+d.level)}if(d.abilities){c.push("abil="+d.abilities)}return WH.markup.entityTagToNode(WH.Types.SHIP,d,undefined,c)},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.SHIP)};WH.markup.tags.skill={entityType:WH.Types.SKILL,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.SKILL),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.SKILL)};WH.markup.tags.sound={empty:true,attr:{unnamed:{req:false,valid:/^[0-9]+$/},src:{req:false,valid:/\S+/},title:{req:false,valid:/\S+/},type:{req:false,valid:/\S+/},src2:{req:false,valid:/\S+/},type2:{req:false,valid:/\S+/},domain:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if(c.unnamed){return true}if(!c.src){return false}return true},toNode:function(r){var t;var d;var v;var h;var l;var p;var o=WH.markup.getDatabaseDomainInfo(r);var w=o.host;if(r.unnamed){if(!(r.unnamed in g_sounds)){return null}if(!g_sounds[r.unnamed].hasOwnProperty("files")){return null}var m;var g=g_sounds[r.unnamed].files;g.sort(function(){return Math.sign(Math.random()-0.5)});while(!m&&g.length){m=g.shift();if(!m.hasOwnProperty("type")){m=undefined}}if(!m){return null}t=m.type;d=m.url;v=g_sounds[r.unnamed].name?g_sounds[r.unnamed].name:m.title;h=w+WH.Entity.getPath(WH.Types.SOUND,r.unnamed,v)}else{if(WH.markup.allow<WH.markup.CLASS.STAFF){return null}d=r.src;v=r.title?r.title:"(Unknown)";if(!(/^(https?:)?\/\//).test(d)){if(/^\d+$/.test(d)){let srcId=parseInt(d);d=WH.staticUrl+"/sound-ids/live/enus/"+(srcId&255)+"/"+srcId}else{d=WH.staticUrl+"/wowsounds"+d}}if(r.hasOwnProperty("type")){t=r.type}else{switch(r.src.toLowerCase().substr(-4)){case".mp3":t="audio/mpeg";break;case".ogg":t='audio/ogg; codecs="vorbis"';break}}if(r.src2){l=r.src2;if(!(/^(https?:)?\/\//).test(l)){if(/^\d+$/.test(l)){let srcId=parseInt(l);d=WH.staticUrl+"/sound-ids/live/enus/"+(srcId&255)+"/"+srcId}else{l=WH.staticUrl+"/wowsounds"+l}}if(r.hasOwnProperty("type2")){p=r.type2}else{switch(r.src2.toLowerCase().substr(-4)){case".mp3":p="audio/mpeg";break;case".ogg":p='audio/ogg; codecs="vorbis"';break}}}}var u=document.createDocumentFragment();var q=WH.ce("audio");WH.ae(u,q);q.preload="none";q.controls="true";WH.markup.applyCommonAttributes(q,r);if(r.unnamed){q.setAttribute("rel","sound="+r.unnamed)}var c=WH.ce("source",{src:d});WH.ae(q,c);if(t){c.type=t}if(l){c=WH.ce("source",{src:l});WH.ae(q,c);if(p){c.type=p}}if(h){var f=WH.ce("div",{className:"audiomarkup"});f.appendChild(u.firstChild);WH.ae(f,WH.ce("br"));WH.ae(f,WH.ce("a",{href:h},WH.ct(v)));WH.ae(u,f)}return u},fromHtml:function(d){var c=d.match(/<audio [^>]*\brel="sound=(\d+)/);if(c){return"[sound="+c[1]+"]"}return d.replace(/<audio\b[\s\S]*?><source\b[\s\S]*\bsrc="([^"]*?)"[\s\S]*?<\/audio>/gi,'[sound src="$1"]')}};WH.markup.tags.spell={entityType:WH.Types.SPELL,empty:true,allowInReplies:true,attr:{buff:{req:false,valid:/^true$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},domain:{req:false,valid:WH.markup.regex.domain},icon:{req:false,valid:/^(false|tiny|small|medium|large)$/},rank:{req:false,valid:WH.markup.regex.isInt},site:{req:false,valid:WH.markup.regex.domain},tempname:{req:false},tooltip:{req:false,valid:/^true$/},unnamed:{req:true,valid:/^[0-9]+$/}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:function(o){var d=o.unnamed;var h=WH.markup.getDatabaseDomainInfo(o);var c=h.host;var q=h.nameKey;var r;var t=[];var f=WH.TERMS.openparenthesis_punct+WH.Types.getUpperSingular(WH.Types.SPELL)+WH.TERMS.wordspace_punct+"#"+d+WH.TERMS.closedparenthesis_punct;if(o.buff){t.push("buff")}if(o.diff){t.push("diff="+o.diff)}if(o.diffnew){t.push("diffnew="+o.diffnew)}if(o.rank){t.push("rank="+o.rank)}if(o.tempname){f=o.tempname}var p=document.createDocumentFragment();var l=WH.Gatherer.get(WH.Types.SPELL,d,h.dataEnv);if(l&&l[q]){if(l.hasOwnProperty("fromDataEnv")){c=WH.Url.generate("",{subdomain:WH.Url.getSubdomain(l.fromDataEnv,h.locale)}).replace(/\/$/,"")}var g=false;var m=false;switch(o.icon){case"false":break;case"large":case"medium":case"small":g=WH.Icon.create(l.icon.toLowerCase(),o.icon,c+WH.Entity.getPath(WH.Types.SPELL,d,l[q]),{span:true});g.dataset.entityIcon="spell";WH.ae(p,g);break;case"tiny":default:if(o["class"]){o["class"]+=" icontiny"}else{o["class"]="icontiny"}m=l.icon.toLowerCase()}r=WH.ce("a",{href:c+WH.Entity.getPath(WH.Types.SPELL,d,l[q])});WH.ae(p,r);if(t.length){r.rel=t.join("&")}WH.markup.applyCommonAttributes(r,o);r.dataset.entity="spell";r.dataset.entityHasIcon=(g||m)?"true":"false";if(m){WH.ae(r,WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+m+".gif",style:{verticalAlign:"middle"}}));WH.ae(r,WH.ct(" "));WH.ae(r,WH.ce("span",{className:"tinyicontxt"},WH.ct(l[q])))}else{WH.ae(r,WH.ct(l[q]))}if(l.hasOwnProperty("quality")&&l.quality>=0){r.classList.add("q"+l.quality)}}else{r=WH.ce("a",{href:c+WH.Entity.getPath(WH.Types.SPELL,d)});WH.ae(p,r);if(t.length){r.rel=t.join("&")}r.dataset.entity="spell";WH.st(r,f)}if(o.tooltip){p=WH.ce("span",{},p);$WowheadPower.replaceWithTooltip(p,WH.Types.SPELL,o.unnamed)}return p},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.SPELL)};WH.markup.tags.statistic=WH.cO({},WH.markup.tags.achievement);delete WH.markup.tags.statistic.entityType;WH.markup.tags.storyline={entityType:WH.Types.STORYLINE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.STORYLINE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.STORYLINE)};WH.markup.tags.threat={entityType:WH.Types.THREAT,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.THREAT),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.THREAT)};WH.markup.tags.title={entityType:WH.Types.TITLE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.TITLE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.TITLE)};WH.markup.tags["transmog-set"]={entityType:WH.Types.TRANSMOG_SET,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.TRANSMOG_SET),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.TRANSMOG_SET)};WH.markup.tags.zone={entityType:WH.Types.ZONE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(c){if((c.domain||c.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.ZONE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ZONE)};WH.markup.tags.acronym={empty:false,attr:{unnamed:{req:true}},toNode:function(c){var d=WH.ce("span");d.className="tip";WH.markup.applyCommonAttributes(d,c);WH.aE(d,"mouseover",function(f){WH.Tooltip.showAtCursor(f,c.unnamed,0,0,"q1")});WH.aE(d,"mousemove",WH.Tooltip.cursorUpdate);WH.aE(d,"mouseout",WH.Tooltip.hide);return d}};WH.markup.tags.b={empty:false,allowInReplies:true,toNode:function(c){var d=WH.ce("b");WH.markup.applyCommonAttributes(d,c);return d},fromHtml:function(c){return c.replace(/<(b|big|strong)\b[\s\S]*?>([\s\S]*?)<\/\1>/gi,"[b]$2[/b]")}};WH.markup.tags.br={empty:true,toNode:function(c){return WH.ce("br")},fromHtml:function(c){return c.replace(/<br\b[\s\S]*?>/gi,"\n")}};WH.markup.tags.center={empty:false,allowInReplies:false,allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){var d=WH.ce("div");d.style.textAlign="-moz-center";d.style.textAlign=d.style.textAlign||"-webkit-center";d.style.textAlign=d.style.textAlign||"center";return d},fromHtml:function(c){return c.replace(/<center>([\s\S]+?)<\/center>/gi,"[pad][div align=center]$1[/div][pad]")}};WH.markup.tags.code={block:true,empty:false,attr:{wrap:{req:false,valid:/^(true|false)$/}},rtrim:true,itrim:true,helpText:true,allowedChildren:{"<text>":1},toNode:function(c){var d=WH.ce("pre");d.className="code";if(c.wrap==="true"){d.style.whiteSpace="normal"}else{if(c.wrap==="false"){d.style.whiteSpace="nowrap"}}if(c.first){d.className+=" first"}if(c.last){d.className+=" last"}WH.markup.applyCommonAttributes(d,c);return d}};WH.markup.tags.color={empty:false,attr:{unnamed:{req:true,valid:/^.*/i}},allowedClass:WH.markup.CLASS.STAFF,extraColors:{deathknight:"c6",dk:"c6",druid:"c11",hunter:"c3",mage:"c8",monk:"c10",paladin:"c2",priest:"c5",rogue:"c4",shaman:"c7",warlock:"c9",warrior:"c1",poor:"q0",common:"q1",uncommon:"q2",rare:"q3",epic:"q4",legendary:"q5",artifact:"q6",heirloom:"q7",wowtoken:"q8",kyrian:"covenant-kyrian",venthyr:"covenant-venthyr",necrolord:"covenant-necrolord","night-fae":"covenant-night-fae"},toNode:function(c){var f=/^(aqua|black|blue|fuchsia|gray|green|lightblue|lime|maroon|navy|olive|purple|red|silver|teal|white|yellow|c\d+|r\d+|q\d*?|#[a-f0-9]{6})$/i;var d=WH.ce("span");if(c.unnamed.match(f)){if(c.unnamed.toLowerCase()=="#00c0ff"){d.className="blizzard-blue"}else{if(/^[qcr]\d+$/i.test(c.unnamed)){d.className=c.unnamed}else{d.style.color=c.unnamed}}}else{if(WH.markup.tags.color.extraColors[c.unnamed]){d.className=WH.markup.tags.color.extraColors[c.unnamed]}}WH.markup.applyCommonAttributes(d,c);return d}};WH.markup.tags["cta-button"]={allowedClass:WH.markup.CLASS.STAFF,empty:false,helpText:"[cta-button=https://www.google.com border=strong class=c3]"+WH.TERMS.text+"[/cta-button]",attr:{unnamed:{req:false,valid:/\S+/},border:{req:false,valid:/^(strong|none)$/},icon:{req:false,valid:/\S+/},newwindow:{req:false,valid:/^true$/},onclick:{req:false,valid:/[\S ]+/},rel:{req:false,valid:/\S+/},style:{req:false,valid:/^[^"<>]+$/},tooltip2:{req:false,valid:/\S+/},tooltip:{req:false,valid:/\S+/}},validate:function(c){return WH.markup.tags.url.validate(c)},toNode:function(c){let a=WH.markup.tags.url.toNode(c);if(a.nodeType!==Node.ELEMENT_NODE){return a}a.classList.add("cta-button");if(c.border){a.dataset.border=c.border}if(c.icon){a.dataset.markupContentTarget=1;a.dataset.icon="true";WH.aef(a,WH.ce("span",{className:"cta-button-icon",style:{"background-image":"url("+WH.Icon.getIconUrl(c.icon,WH.Icon.MEDIUM)+")"}}))}return a}};WH.markup.tags.del={empty:false,attr:{copy:{req:false,valid:/^true$/}},toNode:function(c){var d=WH.ce("del");d.className="diffmod";WH.markup.applyCommonAttributes(d,c);if(!c.copy){d.setAttribute("unselectable","on")}return d}};WH.markup.tags.div={empty:false,block:true,ltrim:true,rtrim:true,itrim:true,attr:{clear:{req:false,valid:/^(left|right|both)$/i},unnamed:{req:false,valid:/^hidden$/i},"float":{req:false,valid:/^(left|right)$/i},align:{req:false,valid:/^(left|right|center)$/i},margin:{req:false,valid:/^\d+$/},style:{req:false,valid:/^[^"<>]+$/},width:{req:false,valid:/^[0-9]+(px|em|\%)$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){var d=WH.ce("div");if(c.clear){d.style.clear=c.clear}if(c.unnamed){d.style.display="none"}if(c.width){d.style.width=c.width}if(c["float"]){d.className+=" markup-float-"+c["float"]}if(c.align){d.style.textAlign=c.align}if(c.margin){d.style.margin=c.margin+"px"}if(c.first){d.className+=" first"}if(c.last){d.className+=" last"}d.className=d.className.replace(/^ +/,"");WH.markup.applyCommonAttributes(d,c);return d},fromHtml:function(h,g){g=g||0;var c;if(c=WH.markup.matchOuterTags(h,"<div\\b[\\s\\S]*?>","</div>","g")){for(var d=0;d<c.length;++d){var l=c[d][1].match(/float:\s*(left|right)"/i),f=c[d][1].match(/width[:="]+\s*([0-9]+)/i);h=h.replace(c[d][1]+c[d][0]+c[d][2],"\n"+Array(g+1).join("\t")+"[div"+(l?" float="+l[1]:"")+(f?" width="+f[1]:"")+"]"+WH.markup.tags.div.fromHtml(c[d][0],g+1)+"[/div]")}}return h}};WH.markup.tags["entity-list-toggle"]=new function(){this.block=true;this.empty=false;this.ltrim=true;this.rtrim=true;this.itrim=true;this.attr={"for":{req:true,valid:/.+/}};this.toNode=function(l){let wrapper=WH.ce("div",{className:"entity-list-toggle"});wrapper.setAttribute("data-initialized","false");wrapper.dataset["for"]=l["for"];let inner=WH.ce("div",{className:"entity-list-toggle-controls"});WH.ae(wrapper,inner);WH.markup.applyCommonAttributes(wrapper,l);clearTimeout(g.initTimer);g.initTimer=setTimeout(h,0);return wrapper};const g={initTimer:undefined};function f(m,l){let requirementId=l.id+"-requirement";let requirement=WH.qs("#"+requirementId,m);if(!requirement){m.dataset.hasRequirements="true";let requirementSet=WH.qs(".entity-list-item-requirement-set",m);if(requirementSet){WH.ae(requirementSet,WH.ct(WH.TERMS.comma_punct))}else{requirementSet=WH.ce("span",{className:"entity-list-item-requirement-set"});let requirementsWrapper=WH.ce("div",{className:"entity-list-item-requirement"});WH.aef(m,requirementsWrapper);WH.Strings.sprintf(WH.GlobalStrings.SPELL_FAILED_REQUIRES_SPELL_FOCUS,"|").split("|").forEach(function(p,o){if(p){WH.ae(requirementsWrapper,WH.ct(p))}if(o===0){WH.ae(requirementsWrapper,requirementSet)}})}requirement=WH.ce("span",{id:requirementId,innerHTML:l.innerHTML});WH.ae(requirementSet,requirement)}}function h(){$('.entity-list-toggle[data-initialized="false"] .entity-list-toggle-controls').each(function(){let controls=this;let wrapper=this.parentNode;WH.qsa(".entity-list-toggle-option",controls).forEach(function(l){l.classList.add("fa");l.classList.add("fa-fw");WH.aE(l,"click",d.bind(undefined,wrapper,l,false));d(wrapper,l,true);WH.qsa("a",l).forEach(function(m){WH.aE(m,"click",function(o){o.preventDefault()})})});wrapper.setAttribute("data-initialized","true")})}function d(p,m,l,o){if(o){o.preventDefault()}let targetWrapper=WH.ge(p.dataset["for"]);if(!targetWrapper){WH.error("No target wrapper for entity list toggler.",p);return}let optionDetails={enabled:{on:m.dataset.entityListEnable?m.dataset.entityListEnable.split(","):[],off:m.dataset.entityListDisable?m.dataset.entityListDisable.split(","):[],onRequires:parseInt(m.dataset.entityListEnableRequires),offRequires:parseInt(m.dataset.entityListDisableRequires)},shown:{on:m.dataset.entityListShow?m.dataset.entityListShow.split(","):[],off:m.dataset.entityListHide?m.dataset.entityListHide.split(","):[],onRequires:parseInt(m.dataset.entityListShowRequires),offRequires:parseInt(m.dataset.entityListHideRequires)}};if(l===true||m.classList.contains("fa-check")){m.classList.remove("fa-check");m.classList.add("fa-times");optionDetails.checked=false}else{m.classList.remove("fa-times");m.classList.add("fa-check");optionDetails.checked=true}c(targetWrapper,m,l,optionDetails,"enabled","on");c(targetWrapper,m,l,optionDetails,"enabled","off");c(targetWrapper,m,l,optionDetails,"shown","on");c(targetWrapper,m,l,optionDetails,"shown","off")}function c(r,p,l,m,o,q){let requiredCount=m[o][q+"Requires"];let datasetBase="entityListItem"+WH.ucfirst(o);for(let i=0,itemNumber;itemNumber=m[o][q][i];i++){let listItem=r.childNodes[itemNumber-1];if(!listItem){continue}if(l!==true){listItem.dataset.animate="true"}if(requiredCount){if(listItem.dataset[datasetBase+"Method"]==="direct"){continue}let datasetCount=datasetBase+WH.ucfirst(q)+"Count";let newCount=parseInt(listItem.dataset[datasetCount])||0;if(l!==true){newCount+=m.checked?1:-1}listItem.dataset[datasetCount]=newCount;listItem.dataset[datasetBase]=newCount===requiredCount?JSON.stringify(q==="on"):JSON.stringify(q!=="on")}else{listItem.dataset[datasetBase]=m.checked?JSON.stringify(q==="on"):JSON.stringify(q!=="on");listItem.dataset[datasetBase+"Method"]="direct"}if(o==="enabled"){f(listItem,p)}}}};WH.markup.tags["entity-list-toggle-option"]={empty:false,attr:{disable:{req:false,valid:WH.markup.regex.intCsv},"disable-requires":{req:false,valid:WH.markup.regex.isInt},enable:{req:false,valid:WH.markup.regex.intCsv},"enable-requires":{req:false,valid:WH.markup.regex.isInt},hide:{req:false,valid:WH.markup.regex.intCsv},"hide-requires":{req:false,valid:WH.markup.regex.isInt},show:{req:false,valid:WH.markup.regex.intCsv},"show-requires":{req:false,valid:WH.markup.regex.isInt}},toNode:function(c){if(!c.show&&!c.hide&&!c.enable&&!c.disable){return WH.ce("div",{style:{display:"none"}})}let wrapper=WH.ce("div",{className:"entity-list-toggle-option",id:WH.Strings.guid()});WH.preventSelectStart(wrapper);["show","hide","enable","disable"].forEach(function(d){let typeCaps=WH.ucfirst(d);if(c[d]){wrapper.dataset["entityList"+typeCaps]=c[d];if(c[d+"-requires"]){wrapper.dataset["entityList"+typeCaps+"Requires"]=c[d+"-requires"]}}});WH.markup.applyCommonAttributes(wrapper,c);return wrapper}};WH.markup.tags.grid={empty:false,itrim:true,allowedClass:WH.markup.CLASS.STAFF,attr:{"column-width":{req:false,valid:WH.markup.regex.cssUnitOrInt},style:{req:false,valid:/^[^"<>]+$/},width:{req:false,valid:WH.markup.regex.cssUnitOrInt}},toNode:function(c){let grid=WH.ce("div",{className:"markup-grid"});if(c["column-width"]){if(/\d$/.test(c["column-width"])){c["column-width"]+="px"}grid.style.gridTemplateColumns="repeat(auto-fill, minmax("+c["column-width"]+", 1fr))"}if(c.width){if(/\d$/.test(c.width)){c.width+="px"}grid.style.width="100%";grid.style.maxWidth=c.width}return grid}};WH.markup.tags.hr={empty:true,trim:true,allowedModes:{article:1,quickfacts:1,comment:1},toNode:function(c){return WH.ce("hr")},fromHtml:function(c){return c.replace(/<hr\b[\s\S]*?>/gi,"[hr]")}};WH.markup.tags.h2={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:false,valid:/^first$/i},clear:{req:false,valid:/^(true|both|left|right)$/i},style:{req:false,valid:/^[^"<>]+$/},toc:{req:false,valid:/^.+$/i}},toNode:function(c){if(!c.id){c.id=WH.Strings.slug(c.toc!=="false"&&c.toc||c._textContents,true)}var d=WH.ce("h2");WH.markup.applyCommonAttributes(d,c);d.className=(d.className?" ":"")+"heading-size-2";if(c.first||c.unnamed){d.className+=" first"}if(c.last){d.className+=" last"}if(c.clear){if(c.clear=="true"){c.clear="both"}d.style.clear=c.clear}return d},fromHtml:function(c){return c.replace(/<h2\b[\s\S]*?>([\s\S]*?)<\/h2>/gi,"\n[major-heading]$1[/major-heading]")}};WH.markup.tags.h3={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,attr:{unnamed:{req:false,valid:/^first$/i},style:{req:false,valid:/^[^"<>]+$/},toc:{req:false,valid:/^.+$/i}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){if(!c.id){c.id=WH.Strings.slug(c.toc!=="false"&&c.toc||c._textContents,true)}var d=WH.ce("h3");WH.markup.applyCommonAttributes(d,c);d.className=(d.className?" ":"")+"heading-size-3";if(c.first||c.unnamed){d.className+=" first"}if(c.last){d.className+=" last"}return d},fromHtml:function(c){return c.replace(/<h3\b[\s\S]*?>([\s\S]*?)<\/h3>/gi,"\n[minor-heading]$1[/minor-heading]")}};WH.markup.tags.h4={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,attr:{unnamed:{req:false,valid:/^first$/i},toc:{req:false,valid:/^false$/i}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){if(!c.id){c.id=WH.Strings.slug(c._textContents,true)}var d=WH.ce("h4");WH.markup.applyCommonAttributes(d,c);d.className=(d.className?" ":"")+"heading-size-4";if(c.first||c.unnamed){d.className+=" first"}if(c.last){d.className+=" last"}return d},fromHtml:function(c){return c.replace(/<h4\b[\s\S]*?>([\s\S]*?)<\/h4>/gi,"\n[h4]$1[/h4]")}};WH.markup.tags.h5={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,attr:{unnamed:{req:false,valid:/^first$/i},toc:{req:false,valid:/^false$/i}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){if(!c.id){c.id=WH.Strings.slug(c._textContents,true)}var d=WH.ce("h5");WH.markup.applyCommonAttributes(d,c);d.className=(d.className?" ":"")+"heading-size-5";if(c.first||c.unnamed){d.className+=" first"}if(c.last){d.className+=" last"}return d},fromHtml:function(c){return c.replace(/<h5\b[\s\S]*?>([\s\S]*?)<\/h5>/gi,"\n[h5]$1[/h5]")}};WH.markup.tags.h6={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,attr:{unnamed:{req:false,valid:/^first$/i},toc:{req:false,valid:/^false$/i}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){if(!c.id){c.id=WH.Strings.slug(c._textContents,true)}var d=WH.ce("h6");WH.markup.applyCommonAttributes(d,c);d.className=(d.className?" ":"")+"heading-size-6";if(c.first||c.unnamed){d.className+=" first"}if(c.last){d.className+=" last"}return d},fromHtml:function(c){return c.replace(/<h6\b[\s\S]*?>([\s\S]*?)<\/h6>/gi,"\n[h6]$1[/h6]")}};WH.markup.tags.i={empty:false,allowInReplies:true,toNode:function(c){var d=WH.ce("i");WH.markup.applyCommonAttributes(d,c);return d},fromHtml:function(c){return c.replace(/<(i|em)\b[\s\S]*?>([\s\S]*?)<\/\1>/gi,"[i]$2[/i]")}};WH.markup.tags.icon={empty:false,itrim:true,attr:{align:{req:false,valid:/^right$/i},"float":{req:false,valid:/^(left|right)$/i},name:{req:false,valid:/\S+/},size:{req:false,valid:/^(tiny|small|medium|large)$/},unnamed:{req:false,valid:/^class$/i},url:{req:false,valid:/\S+/},preset:{req:false,valid:/\S+/}},allowedClass:WH.markup.CLASS.STAFF,presets:{boss:WH.staticUrl+"/images/icons/boss.gif",heroic:WH.staticUrl+"/images/icons/heroic.gif",mythic:WH.staticUrl+"/images/icons/mythic.gif"},validate:function(c){if(!c.name&&!c.url&&!c.preset){return false}if(c.preset&&!WH.markup.tags.icon.presets[c.preset]){return false}return true},toNode:function(c){var f=(c.size?c.size:"tiny");if(!c.name){c.name=""}var h;if(f=="tiny"){h=WH.ce("span");WH.markup.applyCommonAttributes(h,c);if(c.unnamed==undefined){h.className=(h.className?" ":"")+"icontiny"+(c.align?"r":"");var l="";if(c.name){l=WH.staticUrl+"/images/wow/icons/tiny/"+c.name.toLowerCase()+".gif"}else{if(c.preset){l=WH.markup.tags.icon.presets[c.preset]}else{if(c.url&&WH.markup.isUrlSafe(c.url)){l=c.url}else{return document.createDocumentFragment()}}}h.style.backgroundImage="url("+l+")"}else{h.className=c.name}}else{h=WH.ce("div");WH.markup.applyCommonAttributes(h,c);h.className=(h.className?" ":"")+"icon"+f;WH.aE(h,"click",Icon.showIconName.bind(null,h));if(c["float"]){h.style["float"]=c["float"]}var g={small:0,medium:1,large:2};var d=null;if(c.url&&WH.markup.isUrlSafe(c.url)){d=c.url}else{if(c._textContents&&WH.markup.isUrlSafe(c._textContents)){d=c._textContents}}while(c._contents.hasChildNodes()){c._contents.removeChild(c._contents.firstChild)}h.appendChild(Icon.create(c.name.toLowerCase(),g[f],null,d))}return h}};WH.markup.tags.iconlist={empty:false,block:true,ltrim:true,rtrim:true,attr:{domain:{req:false,valid:WH.markup.regex.domain}},taglessSkip:true,allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{b:1,achievement:1,currency:1,event:1,faction:1,item:1,itemset:1,npc:1,object:1,pet:1,quest:1,spell:1,title:1,zone:1},toNode:function(p){var l=WH.markup.getDatabaseDomainInfo(p).subdomain;while(p._contents.hasChildNodes()){p._contents.removeChild(p._contents.firstChild)}var u={itemset:"item_set"};let div=WH.ce("div",{className:"icon-list-col"});let tbl=WH.ce("table",{className:"icon-list"});WH.ae(div,tbl);var r;var d;for(var o=0;o<p._nodes.length;++o){var g=p._nodes[o];g.attr.domain=l;g.attr.icon="false";var h=WH.markup.tags[g.name].toNode(g.attr);var t="";var q=WH.Types[(u[g.name]||g.name).toUpperCase()];if(q){var v=g_gathered_types[q];var m=parseInt(g.attr.unnamed,10);t=(v.getIcon&&v.getIcon(m))||(v[m]&&v[m].icon);if(Array.isArray(t)){t=t[0]}}r=WH.ce("tr");WH.ae(tbl,r);d=WH.ce("th");WH.ae(r,d);if(t){var c="";if(h.tagName==="A"){c=h.href}else{var f=h.querySelector("a");if(f){c=f.href}}WH.ae(d,WH.markup.tags.icon.toNode({name:t,size:"small",url:c,_contents:document.createDocumentFragment()}))}else{WH.ae(d,WH.ce("ul",{},WH.ce("li",{},WH.ct(WH.Strings.nbsp))))}WH.ae(r,WH.ce("td",{},h))}return div}};WH.markup.tags.img={empty:true,count:0,attr:{src:{req:false,valid:/\S+/},icon:{req:false,valid:/\S+/},id:{req:false,valid:/^[0-9]+$/},blog:{req:false,valid:/^[0-9]+$/},news:{req:false,valid:/^[0-9]+$/},size:{req:false,valid:/^(thumb|resized|normal|large|medium|small|tiny)$/i},width:{req:false,valid:/^[0-9%]+$/},height:{req:false,valid:/^[0-9]+$/},"float":{req:false,valid:/^(left|right|center)$/i},border:{req:false,valid:/^[0-9]+$/},shadow:{req:false,valid:/^(true|false)$/},margin:{req:false,valid:/^[0-9]+$/},style:{req:false,valid:/^[^<>]+$/}},blogSize:/^(thumb|normal)$/i,idSize:/^(thumb|resized|normal)$/i,iconSize:/^(large|medium|small|tiny)$/i,allowedClass:WH.markup.CLASS.STAFF,validate:function(c){if(c.src){return true}else{if(c.id){return(c.size?WH.markup.tags.img.idSize.test(c.size):true)}else{if(c.icon){return(c.size?WH.markup.tags.img.iconSize.test(c.size):true)}else{if(c.blog||c.news){return(c.size?WH.markup.tags.img.blogSize.test(c.size):true)}}}}return false},toNode:function(h){var p=WH.ce("img");var l=p;var f=[];var q=[];WH.markup.applyCommonAttributes(p,h);p.removeAttribute("style");p.className="";let imgSrc="";if(h.src){imgSrc=h.src}else{if(h.id){var o=WH.Gatherer.get(WH.Types.SCREENSHOT,h.id)||{};imgSrc=WH.getScreenshotUrl(h.id,h.size||"normal",{description:h.title,imageType:o.imageType})}else{if(h.icon){imgSrc=WH.staticUrl+"/images/wow/icons/"+(h.size?h.size:"large")+"/"+h.icon+".jpg"}else{if(h.blog||h.news){if(g_blogimages[h.blog||h.news]){var g=g_blogimages[h.blog||h.news];if(h.size&&h.size=="thumb"){var c=WH.staticUrl+"/uploads/blog/images/"+(h.blog||h.news)+(g.type==3?".png":".jpg");imgSrc=WH.staticUrl+"/uploads/blog/thumbs/"+(h.blog||h.news)+(g.type==3?".png":".jpg");p.alt=g.alt;p.width=g.thumbwidth;p.height=g.thumbheight;if(!g_screenshots[WH.markup.mediaUid]){g_screenshots[WH.markup.mediaUid]=[]}var d=WH.markup.tags.img.count++;l=WH.ce("a",{},l);l.href=c;l.id="img-thumb-"+d;setTimeout((function(t,v,u){var r=WH.ge("img-thumb-"+t);if(r){r.onclick=(function(A,z,w){if(!WH.isLeftClick(w)){return}ScreenshotViewer.show({screenshots:A,pos:z});return false}).bind(null,v,u)}}).bind(null,d,""+WH.markup.mediaUid,g_screenshots[WH.markup.mediaUid].length),0);var m={url:c,caption:g.alt,width:g.width,height:g.height,noMarkup:true};g_screenshots[WH.markup.mediaUid].push(m)}else{imgSrc=WH.staticUrl+"/uploads/blog/images/"+(h.blog||h.news)+(g.type==3?".png":".jpg");p.alt=g.alt;if(!h.width&&!h.height){h.width=g.width;h.height=g.height}else{if(!h.height){if(h.width.toString().indexOf("%")===-1){h.height=Math.round(g.height*h.width/g.width)}}else{if(!h.width){h.width=Math.round(g.width*h.height/g.height)}}}}}else{return WH.ct(WH.TERMS.image+WH.TERMS.wordspace_punct+"#"+(h.blog||h.news))}}}}}if(h.width){p.width=h.width}if(h.height){p.height=h.height}if(h["float"]){if(h["float"]=="center"){l=WH.ce("div",{},l);l.style.textAlign="center";q.push("margin:10px auto")}else{f.push("markup-float-"+h["float"]);if(h.margin){if(h["float"]=="left"){q.push("margin:0 "+h.margin+"px "+h.margin+"px 0")}else{q.push("margin:0 0 "+h.margin+"px "+h.margin+"px")}}}}if(h.border){if(h.border==0){f.push("no-border")}else{f.push("border");q.push("border-width:"+h.border+"px")}}else{f.push("content-image");if(h.shadow=="true"){f.push("content-image-shadowed")}}p.src=WH.Url.addMaxSizeParams(imgSrc,{width:p.width,height:p.height});p.alt=h.title||p.alt||"";if(h.style&&WH.markup.allow>=WH.markup.CLASS.STAFF){q.push(h.style)}if(f.length){p.className=f.join(" ")}if(q.length){p.setAttribute("style",q.join(";"))}return l},fromHtml:function(o){var d;if(d=o.match(/<img\b[\s\S]*?src="[\s\S]+?"[\s\S]*?>/gi)){for(var g=0;g<d.length;++g){var l=d[g].match(/src="([\s\S]+?)"/i),h=d[g].match(/width[:="]+\s*([0-9]+)/i),c=d[g].match(/height[:="]+\s*([0-9]+)/i),f=d[g].match(/border[:="]+\s*([0-9]+)/i);o=o.replace(d[g],"[img src="+l[1]+(h?" width="+h[1]:"")+(c?" height="+c[1]:"")+" border="+(f?f[1]:0)+"]")}}return o}};WH.markup.tags["inline-code"]={block:false,empty:false,attr:{wrap:{req:false,valid:/^(true|false)$/}},allowedChildren:{"<text>":1},toNode:function(c){var d=WH.ce("code");if(c.wrap==="true"){d.style.whiteSpace="normal"}else{if(c.wrap==="false"){d.style.whiteSpace="nowrap"}}if(c.first){d.className+=" first"}if(c.last){d.className+=" last"}WH.markup.applyCommonAttributes(d,c);return d}};WH.markup.tags.ins={empty:false,toNode:function(c){var d=WH.ce("ins");d.className="diffmod";WH.markup.applyCommonAttributes(d,c);return d}};WH.markup.tags.li={empty:false,itrim:true,attr:{"class":{req:false,valid:/^[a-z0-9 _-]+$/i},style:{req:false,valid:/^[^<>]+$/}},helpText:function(){var d="";d+="[ul]";for(var c=0;c<3;++c){d+="\n[li]"+WH.TERMS.listitem_stc+"[/li]"}d+="\n[/ul]\n\n";d+="[ol]";for(var c=0;c<3;++c){d+="\n[li]"+WH.TERMS.listitem_stc+"[/li]"}d+="\n[/ol]\n";return d.toLowerCase()},toNode:function(c){var d=WH.ce("li");WH.markup.applyCommonAttributes(d,c);d.appendChild(WH.ce("div"));return d},fromHtml:function(g,f){f=f||0;var c;if(c=WH.markup.matchOuterTags(g,"<li\\b[\\s\\S]*?>","</li>","g")){for(var d=0;d<c.length;++d){g=g.replace(c[d][1]+c[d][0]+c[d][2],"\n\t"+Array(f+1).join("\t")+"[li]"+WH.markup.tags.li.fromHtml(c[d][0],f+1)+"[/li]")}}return g}};WH.markup.tags["major-heading"]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:false,valid:/^first$/i},clear:{req:false,valid:/^(true|both|left|right)$/i},style:{req:false,valid:/^[^"<>]+$/},toc:{req:false,valid:/^.+$/i}},toNode:function(c){if(!c.id){c.id=WH.Strings.slug(c.toc!=="false"&&c.toc||c._textContents,true)}var d=WH.ce("h2");d.classList.add("heading-size-2");if(c.first||c.unnamed){d.classList.add("first")}if(c.last){d.classList.add("last")}if(c.clear==="true"||c.clear==="both"){d.style.clear="both"}else{if(c.clear){d.style.clear=c.clear}}WH.markup.applyCommonAttributes(d,c);return d},fromHtml:function(c){return c.replace(/<h2\b[\s\S]*?>([\s\S]*?)<\/h2>/gi,"\n[major-heading]$1[/major-heading]")}};WH.markup.tags["minor-heading"]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,attr:{unnamed:{req:false,valid:/^first$/i},style:{req:false,valid:/^[^"<>]+$/},toc:{req:false,valid:/^.+$/i}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){if(!c.id){c.id=WH.Strings.slug(c.toc!=="false"&&c.toc||c._textContents,true)}var d=WH.ce("h3");d.classList.add("heading-size-3");if(c.first||c.unnamed){d.classList.add("first")}if(c.last){d.classList.add("last")}if(c.clear==="true"||c.clear==="both"){d.style.clear="both"}else{if(c.clear){d.style.clear=c.clear}}WH.markup.applyCommonAttributes(d,c);return d},fromHtml:function(c){return c.replace(/<h3\b[\s\S]*?>([\s\S]*?)<\/h3>/gi,"\n[minor-heading]$1[/minor-heading]")}};WH.markup.tags.nav={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{"nav-item":1},toNode:function(o){var f="nav-markup-"+WH.Strings.guid();var p=document.createDocumentFragment();WH.ae(p,WH.ce("div",{className:"clear"}));var d=WH.ce("div",{className:"smooth-nav-wrapper",id:f});WH.ae(p,d);var t=WH.ce("div",{className:"smooth-nav-outer"});WH.ae(d,t);var u=WH.ce("div",{className:"smooth-nav-inner"});WH.ae(t,u);var q;var h;var g=o._contents;while(g.hasChildNodes()){h=g.removeChild(g.firstChild);q=WH.ce("a",{id:f+"-"+l,rel:"np"});if(h.whMarkupInfo.url){q.href=h.whMarkupInfo.url}if(h.whMarkupInfo.tooltip){WH.Tooltip.simple(q,h.whMarkupInfo.tooltip.replace(/&lt;br&gt;/g,"<br>"),"q")}while(h.hasChildNodes()){WH.ae(q,h.firstChild)}var c=false;var r=null;for(var l=0,m=q.childNodes.length;l<m;l++){if(q.childNodes[l].nodeType===Node.TEXT_NODE){q.dataset.text=WH.Strings.slug(q.childNodes[l].textContent,true,LOCALE_ENUS);c=true}else{if(!c){r=q.childNodes[l].textContent||r}}}if(!c&&r){q.dataset.text=WH.Strings.slug(r,true,LOCALE_ENUS)}WH.ae(u,q)}setTimeout(WH.setupSmoothNavClicks.bind(null,"#"+f),0);return p}};WH.markup.tags["nav-item"]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{nav:1},attr:{unnamed:{req:false,valid:/\S+/},tooltip:{req:false,valid:/^.*$/}},toNode:function(c){var d=WH.ce("div");d.whMarkupInfo={tooltip:c.tooltip,url:c.unnamed};return d}};WH.markup.tags.n5={empty:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/}},toNode:function(c){return document.createTextNode(WH.getN5(c.unnamed))}};WH.markup.tags.minibox={empty:false,rtrim:true,itrim:true,attr:{"float":{req:false,valid:/^(left|right)$/i}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){var d=WH.ce("div");d.className="minibox";if(c["float"]=="left"){d.className+=" minibox-left"}WH.markup.applyCommonAttributes(d,c);return d}};WH.markup.tags.money={empty:true,attr:{unnamed:{req:false,valid:/^[0-9]+|[0-9]+-[0-9]+$/},items:{req:false,valid:/^[0-9,]+$/},currency:{req:false,valid:/^[0-9,]+$/},achievement:{req:false,valid:/\S+/},side:{req:false,valid:/^(alliance|horde|both)$/i},arena:{req:false,valid:/^[0-9]+$/},honor:{req:false,valid:/^[0-9]+$/},conquest:{req:false,valid:/^[0-9]+$/},justice:{req:false,valid:/^[0-9]+$/},valor:{req:false,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(u){var q=[];var C=[];if(u.items){var c=u.items.split(",");if(c.length>=2){for(var p=0,B=c.length;p<B-1;p+=2){q.push({id:c[p],count:c[p+1]})}}}if(u.currency){var m=u.currency.split(",");if(m.length>=2){var o=null;for(var D=0,d=m.length;D<d-1;D+=2){var r=m[D];var t=parseInt(m[D+1]);if(o&&o.id===r){if(o.increment===null&&t-o.max<=5){o.increment=t-o.max}if(o.increment&&(o.max+o.increment===t||o.max/t>0.925)){o.values.push(t);o.max=t;o.value=o.min+"-"+o.max;continue}}o={id:r,increment:null,max:t,min:t,value:t,values:[t]};C.push(o)}}}if(u.arena&&!u.conquest){u.conquest=u.arena}if(u.honor){C.push({id:WH.Wow.Currency.ID_HONOR,value:u.honor})}if(u.conquest){C.push({id:WH.Wow.Currency.ID_CONQUEST,value:u.conquest})}if(u.justice){C.push({id:WH.Wow.Currency.ID_JUSTICE,value:u.justice})}if(u.valor){C.push({id:WH.Wow.Currency.ID_VALOR,value:u.valor})}var g=u.achievement;var H=document.createDocumentFragment();if(u.unnamed){var w=null;var A=null;if(u.unnamed.indexOf("-")!==-1){var v=u.unnamed.split("-");w=this.calculateMoney(v[0]);A=this.calculateMoney(v[1])}else{w=this.calculateMoney(u.unnamed)}if(A===null||JSON.stringify(w)===JSON.stringify(A)){this.displayMoney(H,w)}else{if(w.length===1&&A.length===1&&w[0].type===A[0].type){w[0].value+="-"+A[0].value;this.displayMoney(H,w)}else{this.displayMoney(H,w);H.appendChild(WH.ct(" - "));this.displayMoney(H,A)}}}if(q.length>5){if(H.hasChildNodes()){H.appendChild(WH.ct(" "));H.appendChild(WH.ct(WH.Strings.sprintf(WH.TERMS.oneOfEntityCount_format,q.length,WH.Types.getUpperPlural(WH.Types.ITEM))))}}else{for(var p=0,B=q.length;p<B;p++){var G=q[p];if(H.hasChildNodes()){H.appendChild(WH.ct(" "))}var z=g_items[G.id]||{};var E=z.icon||WH.Icon.UNKNOWN;var l=WH.staticUrl+"/images/wow/icons/tiny/"+E.toLowerCase()+".gif";H.appendChild(WH.ce("a",{href:WH.Entity.getPath(WH.Types.ITEM,G.id),className:"moneyitem no-wrap",style:{backgroundImage:'url("'+l+'")'}},WH.ct(G.count)))}}for(var F=0,f=C.length;F<f;F++){var h=C[F];if(H.hasChildNodes()){H.appendChild(WH.ct(" "))}var E=g_gatheredcurrencies.getIcon(h.id);if(E===WH.Icon.UNKNOWN&&window.g_currencies&&g_currencies.hasOwnProperty(h.id)&&g_currencies[h.id][1]){E=g_currencies[h.id][1]}var I=WH.ce("a",{href:WH.Entity.getPath(WH.Types.CURRENCY,h.id),className:"icontinyr tip q1 no-wrap",style:{backgroundImage:'url("'+WH.staticUrl+"/images/wow/icons/tiny/"+E.toLowerCase()+'.gif")'}});WH.ae(I,WH.ct(h.value));if(h.values&&h.values.length>2){WH.Tooltip.addTooltipText(I,WH.TERMS.oneOf_colon+Locale.formatList(h.values,"or",280))}H.appendChild(I)}if(g>0){if(H.hasChildNodes()){H.appendChild(WH.ct(" "))}H.appendChild(WH.markup.tags.achievementpoints.toNode({unnamed:g.toString()}))}return H},calculateMoney:function(c){var d=[];if(c>=10000){d.push({type:"gold",value:WH.numberFormat(Math.floor(c/10000))});c%=10000}if(c>=100){d.push({type:"silver",value:WH.numberFormat(Math.floor(c/100))});c%=100}if(c>=1){d.push({type:"copper",value:WH.numberFormat(Math.floor(c))})}return d},displayMoney:function(d,g){var h=false;for(var f=0,c=g.length;f<c;f++){if(h){d.appendChild(WH.ct(WH.TERMS.wordspace_punct))}d.appendChild(WH.ce("span",{className:"money"+g[f].type},WH.ct(g[f].value)));h=true}}};WH.markup.tags.ol={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedChildren:{li:1,ul:1,ol:1},toNode:function(c){var f=WH.ce("ol");var d=[];if(c.first){d.push("first")}if(c.last){d.push("last")}if(d.length>0){f.className=d.join(" ")}WH.markup.applyCommonAttributes(f,c);return f},fromHtml:function(g,f){f=f||0;var c;if(c=WH.markup.matchOuterTags(g,"<ol\\b[\\s\\S]*?>","</ol>","g")){for(var d=0;d<c.length;++d){g=g.replace(c[d][1]+c[d][0]+c[d][2],"\n"+Array(f+1).join("\t")+"[ol]"+WH.markup.tags.ol.fromHtml(c[d][0],f+1)+"\n"+Array(f+1).join("\t")+"[/ol]")}}return g}};WH.markup.tags.p={empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){var d=WH.ce("p");d.style.lineHeight="1.4em";d.style.margin="1em 0 0 0";WH.markup.applyCommonAttributes(d,c);return d},fromHtml:function(g){var d;if(d=g.match(/<p\b[\s\S]*?>[\s\S]*?<\/p>/gi)){for(var f=0;f<d.length;++f){var h=d[f].match(/^<p\b[\s\S]*?text-align:\s*(center|left|right)/i);var c=d[f].match(/<p\b[\s\S]*?>([\s\S]*?)<\/p>/i);g=g.replace(d[f],"[pad][div"+(h?" align="+h[1]:"")+"]"+(c?c[1]:"")+"[/div][pad]")}}return g}};WH.markup.tags.pad={empty:true,block:true,trim:true,allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){var d=WH.ce("div");d.className="pad";if(c.first){d.className+=" first"}if(c.last){d.className+=" last"}WH.markup.applyCommonAttributes(d,c);return d}};WH.markup.tags.pre={empty:false,block:true,rtrim:true,toNode:function(c){var d=WH.ce("pre");d.className="code";if(c.first){d.className+=" first"}if(c.last){d.className+=" last"}WH.markup.applyCommonAttributes(d,c);return d},fromHtml:function(c){return c.replace(/<pre\b[\s\S]*?>([\s\S]*?)<\/pre>/gi,"[pre]$1[/pre]")}};WH.markup.tags.quote={block:true,empty:false,rtrim:true,ltrim:true,itrim:true,attr:{unnamed:{req:false,valid:/[\S ]+/},align:{req:false,valid:/^(left|right|center)$/i},blizzard:{req:false,valid:/^true$/},clear:{req:false,valid:/^(left|right|both)$/i},collapse:{req:false,valid:/^true$/},display:{req:false,valid:/^block$/},"float":{req:false,valid:/^(left|right|none)$/i},pname:{req:false},type:{req:false,valid:WH.markup.regex.noWhitespace},url:{req:false,valid:WH.markup.regex.noWhitespace},wowhead:{req:false,valid:/^true$/}},allowedModes:{article:1,quickfacts:1,comment:1},validate:function(c){if(c.type||c.blizzard||c.wowhead||c.collapse||c.url){if(WH.markup.allow<WH.markup.CLASS.STAFF){return false}}return true},toNode:function(c){let quoteWrapper=WH.ce("div",{className:"quote"});WH.markup.applyCommonAttributes(quoteWrapper,c);if(c.display){quoteWrapper.style.display=c.display}if(c.align){quoteWrapper.style.textAlign=c.align}if(c.clear){quoteWrapper.style.clear=c.clear}if(c.first){quoteWrapper.classList.add("first")}if(c.last){quoteWrapper.classList.add("last")}if(c["float"]){quoteWrapper.classList.add("markup-float-"+c["float"])}let type=c.type||"user";if(c.blizzard){type="blizzard"}else{if(c.wowhead){type="wowhead"}}quoteWrapper.dataset.type=type;let quoteHeader=WH.ce("div",{className:"quote-header"});WH.ae(quoteWrapper,quoteHeader);let quoteBody=WH.ce("div",{className:"quote-body",dataset:{markupContentTarget:1}});WH.ae(quoteWrapper,quoteBody);let url=WH.markup.getFixedUrl(c.url);if(type==="blizzard"){let matches=url.match(/^https?:\/\/(us|eu)\.battle\.net\/wow\/en\/blog\/([0-9]+)/i)||url.match(/^https?:\/\/(us|eu)\.battle\.net\/wow\/en\/forum\/topic\/([0-9]+)/i)||url.match(/^https?:\/\/(www\.)?worldofwarcraft\.com\/en-us\/news\/([0-9]+)/i)||url.match(/^https?:\/\/(us|eu)\.battle\.net\/forums\/(?:en\/)?wow\/topic\/([0-9]+)/i);if(matches||url&&WH.markup.isUrlSafe(url)){let postLinkName;if(matches){postLinkName=WH.TERMS.officialPost;let parts=["","blue-tracker","topic"];if(["us","eu"].includes(matches[1])){parts.push(matches[1])}parts.push(matches[2]);WH.ae(quoteHeader,WH.ce("a",{href:parts.join("/"),target:"_blank"},WH.ct(WH.TERMS.bluetracker)));WH.ae(quoteHeader,WH.ce("span",{className:"quote-header-separator"},WH.ct(" | ")))}else{postLinkName=c.pname||(url.indexOf("bluetracker")>=0?WH.TERMS.bluetracker:WH.TERMS.viewOriginal)}WH.ae(quoteHeader,WH.ce("a",{href:url,target:"_blank"},WH.ct(postLinkName)))}}else{if(url&&WH.markup.isUrlSafe(url)){WH.ae(quoteHeader,WH.ce("a",{href:url,target:"_blank"},WH.ct(WH.TERMS.link)))}}let username=c.unnamed&&c.unnamed.trim()||null;let hasSource=!!username;quoteWrapper.dataset.hasSource=JSON.stringify(hasSource);if(hasSource){let quoteSource=WH.ce("div",{className:"quote-source"});WH.ae(quoteBody,quoteSource);if(type==="user"){if(c.url&&WH.markup.isUrlSafe(c.url)){let a=WH.ce("a",{href:WH.markup.getFixedUrl(c.url)},WH.ct(username));if(WH.markup.isUrlExternal(c.url)){a.target="_blank"}WH.ae(quoteSource,a)}else{if(WH.User.isUsernameValid(username)){WH.ae(quoteSource,WH.ce("a",{href:"/user="+username},WH.ct(username)))}else{WH.ae(quoteSource,WH.ct(username))}}WH.ae(quoteSource,WH.ct(" "+WH.TERMS.said_colon))}else{WH.ae(quoteSource,WH.ct(username))}}if(c._nodes&&c._nodes.length){let me=c._nodes[0].parent;let parentQuotes=0;let parent=me.parent;while(parent&&parent.name==="quote"){parentQuotes++;parent=parent.parent}if(parentQuotes>=2){c.collapse="true"}}if(type!=="user"||hasSource||c.collapse){let collapseToggle=WH.ce("a",{className:"quote-toggle",href:"javascript:"});WH.aE(collapseToggle,"click",function(){quoteWrapper.classList.toggle("quote-collapsed")});WH.ae(quoteHeader,collapseToggle);if(c.collapse){quoteWrapper.classList.add("quote-collapsed")}}return quoteWrapper}};WH.markup.tags.reveal={empty:false,allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){if(!WH.markup.inNewsType||WH.markup.inNewsType>1){return document.createDocumentFragment()}var g=document.createDocumentFragment();var f=WH.ce("span",{style:{display:"none"}});g.appendChild(f);g.appendChild(WH.ct(" "));var d=WH.ce("a",{className:"revealtoggle",href:"javascript:"});g.appendChild(d);WH.aE(d,"click",WH.markup.tags.reveal.toggleReveal.bind(null,d,f));WH.st(d,WH.TERMS.openparenthesis_punct+WH.TERMS.readmore.toLowerCase()+WH.TERMS.closedparenthesis_punct);return g},toggleReveal:function(c,d){c=$(c);d=$(d);if(d.is(":visible")&&c.is(":visible")){d.hide();c.text(WH.TERMS.openparenthesis_punct+WH.TERMS.readmore.toLowerCase()+WH.TERMS.closedparenthesis_punct)}else{d.show();if(c.hasClass("changelog")){c.hide()}else{c.text(WH.TERMS.openparenthesis_punct+WH.TERMS.hide.toLowerCase()+WH.TERMS.closedparenthesis_punct)}}}};WH.markup.tags.s={empty:false,allowInReplies:true,toNode:function(c){var d=WH.ce("del");WH.markup.applyCommonAttributes(d,c);return d},fromHtml:function(c){c=c.replace(/<del\b[\s\S]*?>([\s\S]*?)<\/del>/gi,"[s]$1[/s]");return c.replace(/<s\b[\s\S]*?>([\s\S]*?)<\/s>/gi,"[s]$1[/s]")}};WH.markup.tags.section={empty:false,ltrim:true,rtrim:true,trim:true,allowedClass:WH.markup.CLASS.STAFF,attr:{},toNode:function(c){var d=WH.ce("div");d.className="secheader";d.dataset.markupContentTarget=1;d.appendChild(WH.ce("var"));return d}};WH.markup.tags.small={empty:false,toNode:function(c){var d=WH.ce("small");WH.markup.applyCommonAttributes(d,c);return d},fromHtml:function(c){return c.replace(/<small\b[\s\S]*?>([\s\S]*?)<\/small>/gi,"[small]$1[/small]")}};WH.markup.tags.span={empty:false,attr:{"class":{req:false,valid:/^[a-z0-9 _-]+$/i},style:{req:false,valid:/^[^<>]+$/},unnamed:{req:false,valid:/^(hidden|invisible)$/},tooltip:{req:false,valid:/\S+/},tooltip2:{req:false,valid:/\S+/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){var d=WH.ce("span");WH.markup.applyCommonAttributes(d,c);if(c.unnamed=="hidden"){d.style.display="none"}else{if(c.unnamed=="invisible"){d.style.visibility="hidden"}}if(c.tooltip&&WH.markup.tooltipTags[c.tooltip]){WH.aE(d,"mouseover",function(f){WH.Tooltip.showAtCursor(f,WH.markup.tooltipTags[c.tooltip],0,0,WH.markup.tooltipTagsWithRawText[c.tooltip]?null:"q",(c.tooltip2&&WH.markup.tooltipTags[c.tooltip2])?WH.markup.tooltipTags[c.tooltip2]:null)});WH.aE(d,"mousemove",WH.Tooltip.cursorUpdate);WH.aE(d,"mouseout",WH.Tooltip.hide)}return d},fromHtml:function(c){return c.replace(/<span\b([\s\S]*?)>([\s\S]*?)<\/span>/gi,function(h,o,m){var g=/style="[\s\S]*?color:\s?#(\w{6});?/i;var l=o.match(g);if(l){var d={ffd100:"q","9d9d9d":"q0",ffffff:"q1","1eff00":"q2","0070dd":"q3",a335ee:"q4",ff8000:"q5",e5cc80:"q6","00ccff":"q8","71d5ff":"q9",ff4040:"q10",ffff98:"q13",ff8040:"r1",ffff00:"r2","40bf40":"r3","808080":"r4",c69b6d:"c1",f48cba:"c2",aad372:"c3",fff468:"c4",c41e3b:"c6","2359ff":"c7","68ccef":"c8","9382c9":"c9","008467":"c10",ff7c0a:"c11"};var f=d[l[1]];if(f){return"[color="+f+"]"+m+"[/color]"}}return h})}};WH.markup.tags.spoiler={block:true,empty:false,attr:{unnamed:{req:false,valid:/^.*$/}},rtrim:true,ltrim:true,itrim:true,timer:null,toNode:function(c){var l=document.createDocumentFragment();l.appendChild(WH.ce("div",{className:"pad"}));var m=WH.ce("div",{className:"spoiler-wrapper"});l.appendChild(m);var h=WH.ce("div",{className:"spoiler-desc"});WH.ae(m,h);WH.ae(h,WH.ce("b",{},WH.ct(WH.TERMS.spoiler_colon)));if(c.unnamed){WH.ae(h,WH.ct(WH.TERMS.wordspace_punct+c.unnamed))}WH.ae(h,WH.ct(" "));var g=WH.ce("button",{type:"button",className:"spoiler-revealer btn btn-small btn-site"});WH.st(g,WH.TERMS.revealspoiler);WH.aE(g,"click",function(){m.classList.add("spoiler-reveal")});WH.ae(h,g);var f=WH.ce("button",{type:"button",className:"spoiler-hider btn btn-small btn-site"});WH.st(f,WH.TERMS.hidespoiler);WH.aE(f,"click",function(){m.classList.remove("spoiler-reveal")});WH.ae(h,f);var d=WH.ce("div",{className:"spoiler",dataset:{markupContentTarget:1}});WH.markup.applyCommonAttributes(d,c);WH.ae(m,d);return l}};WH.markup.tags.sub={empty:false,toNode:function(c){var d=WH.ce("sub");WH.markup.applyCommonAttributes(d,c);return d},fromHtml:function(c){return c.replace(/<sub\b[\s\S]*?>([\s\S]*?)<\/sub>/gi,"[sub]$1[/sub]")}};WH.markup.tags.sup={empty:false,toNode:function(c){var d=WH.ce("sup");WH.markup.applyCommonAttributes(d,c);return d},fromHtml:function(c){return c.replace(/<sup\b[\s\S]*?>([\s\S]*?)<\/sup>/gi,"[sup]$1[/sup]")}};WH.markup.tags.tabs={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{tab:1},attr:{name:{req:true,valid:/\S+/},width:{req:false,valid:/^[0-9]+(px|em|\%)$/}},toNode:function(c){c.id=WH.Strings.slug(c.name,true,Locale.getId());var m=document.createDocumentFragment();WH.ae(m,WH.ce("div",{className:"clear"}));WH.ae(m,WH.ce("div",{id:"dsf67g4d-"+c.id+(WH.markup.isPreview?"-preview":"")}));var h=WH.ce("div");WH.ae(m,h);if(c.width){h.style.width=c.width}var o=WH.ce("div",{className:"tabbed-contents"});WH.ae(h,o);var l;var g;var f=[];while(c._contents.hasChildNodes()){g=c._contents.removeChild(c._contents.firstChild);l=g.whMarkupInfo;f.push(l);var d=WH.ce("div",{id:"tab-"+c.id+"-"+l.id});d.style.display="none";while(g.hasChildNodes()){WH.ae(d,g.firstChild)}WH.ae(d,WH.ce("div",{className:"clear"}));WH.ae(o,d)}setTimeout((function(u,r,v){var p=new Tabs({parent:WH.ge("dsf67g4d-"+u.id+(v?"-preview":"")),forum:1,noScroll:(v?true:false)});for(var q=0;q<r.length;++q){var t=r[q];p.add(t.name,{id:u.id+"-"+t.id,icon:t.icon,"class":t["class"]})}p.flush()}).bind(null,c,f,(WH.markup.isPreview?"preview":"")),0);return m}};WH.markup.tags.tab={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{tabs:1},attr:{name:{req:true,valid:/[\S ]+/},icon:{req:false,valid:/\S+/},id:{req:false,valid:/[\S ]+/}},toNode:function(c){var f=c.id?WH.Strings.slug(c.id,true,Locale.getId()):null;if(!f){f=WH.Strings.slug(c.name,true,Locale.getId())}if(!f){f=WH.Strings.guid()}c.name=WH.stringReplace(c.name,"_"," ");if(typeof c["class"]!="undefined"){c["class"]=WH.stringReplace(c["class"],"_"," ")}var d=WH.ce("div");d.whMarkupInfo={id:f,name:c.name,icon:c.icon,"class":c["class"]};return d}};WH.markup.tags.table={empty:false,ltrim:true,rtrim:true,itrim:true,allowedChildren:{tr:1},attr:{border:{req:false,valid:/^[0-9]+$/},cellspacing:{req:false,valid:/^[0-9]+$/},cellpadding:{req:false,valid:/^[0-9]+$/},style:{req:false,valid:/^[^<>]+$/},width:{req:false,valid:/^[0-9]+(px|em|\%)$/}},toNode:function(c){var d=WH.ce("table");WH.markup.applyCommonAttributes(d,c);if(typeof c.border!=="undefined"){d.border=c.border;if(d.className){d.className+=" clean-markup-table-borders"}else{d.className="clean-markup-table-borders"}}if(typeof c.cellspacing!=="undefined"){d.cellSpacing=c.cellspacing}if(typeof c.cellpadding!=="undefined"){d.cellPadding=c.cellpadding}if(typeof c.width!=="undefined"){d.style.width=c.width}d.appendChild(WH.ce("tbody"));return d},fromHtml:function(o,l){l=l||0;var c;if(c=WH.markup.matchOuterTags(o,"<table\\b[\\s\\S]*?>","</table>","g")){for(var f=0;f<c.length;++f){var d=c[f][1].match(/border[:="]+\s*([0-9]+)/i),g=c[f][1].match(/width[:="]+\s*([0-9]+)/i),p=c[f][1].match(/cellspacing="([\s\S]+?)"/i),h=c[f][1].match(/cellpadding="([\s\S]+?)"/i);o=o.replace(c[f][1]+c[f][0]+c[f][2],"\n"+Array(l+1).join("\t")+"[table"+(d?" border="+d[1]:"")+(g?" width="+g[1]:"")+(p?" cellspacing="+p[1]:"")+(h?" cellpadding="+h[1]:"")+"]"+WH.markup.tags.table.fromHtml(c[f][0],l+1)+"\n"+Array(l+1).join("\t")+"[/table]")}}return o}};WH.markup.tags.tr={empty:false,itrim:true,allowedChildren:{td:1},allowedParents:{table:1},toNode:function(c){var d=WH.ce("tr");WH.markup.applyCommonAttributes(d,c);return d},fromHtml:function(g,f){f=f||0;var c;if(c=WH.markup.matchOuterTags(g,"<tr\\b[\\s\\S]*?>","</tr>","g")){for(var d=0;d<c.length;++d){g=g.replace(c[d][1]+c[d][0]+c[d][2],"\n\t"+Array(f+1).join("\t")+"[tr]"+WH.markup.tags.tr.fromHtml(c[d][0],f+1)+"\n"+Array(f+1).join("\t")+"[/tr]")}}return g}};WH.markup.tags.td={empty:false,itrim:true,allowedParents:{tr:1},attr:{unnamed:{req:false,valid:/^header$/},align:{req:false,valid:/^(right|left|center|justify)$/i},valign:{req:false,valid:/^(top|middle|bottom|baseline)$/i},colspan:{req:false,valid:/^[0-9]+$/},rowspan:{req:false,valid:/^[0-9]+$/},width:{req:false,valid:/^[0-9]+(px|em|\%)$/}},toNode:function(c){var d=WH.ce(c.unnamed?"th":"td");WH.markup.applyCommonAttributes(d,c);if(c.align!=undefined){d.style.textAlign=c.align}if(c.valign!=undefined){d.style.verticalAlign=c.valign}if(c.colspan!=undefined){d.colSpan=c.colspan}if(c.rowspan!=undefined){d.rowSpan=c.rowspan}if(c.width!=undefined){d.style.width=c.width}return d},fromHtml:function(q,l){l=l||0;var u=["td","th"],f;for(var h=0;h<u.length;++h){if(f=WH.markup.matchOuterTags(q,"<"+u[h]+"\\b[\\s\\S]*?>","</"+u[h]+">","g")){for(var o=0;o<f.length;++o){var c=f[o][1].match(/width[:="]+\s*([0-9]+)/i),p=f[o][1].match(/align="([\s\S]+?)"/i),r=f[o][1].match(/valign="([\s\S]+?)"/i),d=f[o][1].match(/colspan="([\s\S]+?)"/i),g=f[o][1].match(/rowspan="([\s\S]+?)"/i);q=q.replace(f[o][1]+f[o][0]+f[o][2],"\n\t\t"+Array(l+1).join("\t")+"[td"+(u[h]=="th"?"=header":"")+(c?" width="+c[1]:"")+(p?" align="+p[1]:"")+(r?" valign="+r[1]:"")+(d?" colspan="+d[1]:"")+(g?" rowspan="+g[1]:"")+"]"+WH.markup.tags.td.fromHtml(f[o][0],l+1)+"[/td]")}}}return q}};WH.markup.tags.toc={block:true,post:true,trim:true,ltrim:true,rtrim:true,collect:{h2:1,h3:1,"major-heading":1,"minor-heading":1,toggler:1},exclude:{tabs:{h2:1,h3:1,"major-heading":1,"minor-heading":1},minibox:{h2:1,h3:1,"major-heading":1,"minor-heading":1}},allowedClass:WH.markup.CLASS.STAFF,attr:{h3:{req:false,valid:/^false$/},"minor-heading":{req:false,valid:/^false$/}},postParseNode:function(v,u){var C=document.createDocumentFragment();var o=WH.ce("h3",{className:"heading-size-3"});WH.ae(C,o);if(v.first){o.classList.add("first")}if(v.last){o.classList.add("last")}WH.markup.applyCommonAttributes(o,v);WH.st(o,WH.TERMS.tableofcontents);var E;var q;var r;var d=[C];r=WH.ce("ul");WH.ae(d[d.length-1],r);d.push(r);var g=WH.ce("b");var t=WH.ge("guide-view-toc");var c=null;if(t){C.removeChild(o);g=false;c=WH.ge("guide-navigation")}var l="";var p=(v.h3!="false"&&v["minor-heading"]!="false");var m=[];for(var w in u.h2){m.push(u.h2[w])}for(var w in u["major-heading"]){m.push(u["major-heading"][w])}for(var w in u.h3){m.push(u.h3[w])}for(var w in u["minor-heading"]){m.push(u["minor-heading"][w])}for(var w in u.toggler){m.push(u.toggler[w])}m.sort(function(G,F){return G.offset-F.offset});var f=false;for(var A in m){if(m[A].name=="h2"||m[A].name=="major-heading"){f=true;break}}for(var z in m){w=m[z];switch(w.name){case"toggler":if((w.attr.toc!="false")&&w.attr.name){var B=w.attr.size||3;if(B==3&&l=="h2"){r=WH.ce("ul");WH.ae(d[d.length-1],r);d.push(r)}else{if(B==2&&l=="h3"){d.pop()}}q=WH.ce("li");WH.ae(d[d.length-1],q);if(g){q.appendChild(g.cloneNode(false))}WH.ae(g?q.firstChild:q,WH.ce("a",{href:"#"+(w.attr.id?WH.Strings.slug(w.attr.id,true):WH.Strings.slug(w.attr.toc||w.attr.name,true))},WH.ct(w.attr.toc||w.attr.name)));l="h"+B}break;case"h2":case"major-heading":if(w.attr.toc!="false"){if(l=="h3"){d.pop()}q=WH.ce("li");WH.ae(d[d.length-1],q);if(g){q.appendChild(g.cloneNode(false))}WH.ae(g?q.firstChild:q,WH.ce("a",{href:"#"+(w.attr.id?WH.Strings.slug(w.attr.id,true):WH.Strings.slug(w.attr.toc||w.attr._textContents,true))},WH.ct(w.attr.toc||w.attr._textContents)));l="h2"}break;case"h3":case"minor-heading":if(p&&w.attr.toc!="false"&&(l!=""||u.h2.length==0||u["major-heading"].length==0)){if(l=="h2"){r=WH.ce("ul");WH.ae(d[d.length-1],r);d.push(r)}else{if(!l&&f){WH.ae(d[d.length-1],WH.ce("li",{},WH.ct(WH.TERMS.overview)));r=WH.ce("ul");WH.ae(d[d.length-1],r);d.push(r)}}q=WH.ce("li");WH.ae(d[d.length-1],q);if(g){q.appendChild(g.cloneNode(false))}WH.ae(g?q.firstChild:q,WH.ce("a",{href:"#"+(w.attr.id?WH.Strings.slug(w.attr.id,true):WH.Strings.slug(w.attr.toc||w.attr._textContents,true))},WH.ct(w.attr.toc||w.attr._textContents)));l="h3"}break}}if(t){if(c){var h=$(c);var D=h.find('a[href$="wowhead.com'+location.pathname+'"]');if(D.length){$(t).closest("table").parent().remove();D.addClass("current");D.after(C);return null}}$(t).empty().append(C);return null}return C}};WH.markup.tags.toggler={empty:false,attr:{id:{req:false,valid:/^[a-z0-9_-]+$/i},closed:{req:false,valid:/^(true|false)$/i},"class":{req:false,valid:/^[a-z0-9 _-]+$/i},icon:{req:false,valid:/^[a-z0-9 _-]+$/i},name:{req:false,valid:/^.+$/i},size:{req:false,valid:/^[2-6]$/i},toc:{req:false,valid:/^.+$/i},unnamed:{req:false,valid:/^hidden$/i}},toNode:function(c){if(c.id){var d=WH.ce("a");d.href="javascript:";d.className="disclosure-"+(c.unnamed?"off":"on");WH.aE(d,"click",WH.disclose.bind(null,"#"+c.id,d));return d}var h=document.createDocumentFragment();var m=((c.toc!=="false"&&c.toc)?WH.Strings.slug(c.toc,true):"")||(c.name?WH.Strings.slug(c.name,true):"")||WH.Strings.guid();var g=WH.getMajorHeading("",c.size||3,undefined,{id:m});h.appendChild(g);var l=WH.ce("div");h.appendChild(l);l.dataset.markupContentTarget=1;if(c.closed=="true"){l.style.display="none"}var d=WH.ce("a");WH.ae(g,d);d.href="javascript:";d.className="toggler-"+(c.closed=="true"?"off":"on");WH.aE(d,"click",WH.toggle.bind(d,l));WH.ae(d,WH.ce("span",{className:"fa fa-chevron-right fa-fw"}));var f=WH.ce("span");WH.ae(d,f);f.className="toggler-title";if(c.icon){f.className+=" toggler-title-with-icon";f.appendChild(Icon.create(c.icon,0,null,false,null,null,null,null,true))}if(c["class"]){f.className+=" "+c["class"]}WH.ae(f,WH.ct(c.name||WH.TERMS.clicktotoggledisplay_stc));return h}};WH.markup.tags.u={empty:false,allowInReplies:true,toNode:function(c){var d=WH.ce("ins");WH.markup.applyCommonAttributes(d,c);return d},fromHtml:function(c){return c.replace(/<(ins|u)\b[\s\S]*?>([\s\S]*?)<\/\1>/gi,"[u]$2[/u]")}};WH.markup.tags.ul={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedChildren:{li:1,ul:1,ol:1},toNode:function(c){var f=WH.ce("ul");var d=[];if(c.first){d.push("first")}if(c.last){d.push("last")}if(d.length>0){f.className=d.join(" ")}WH.markup.applyCommonAttributes(f,c);return f},fromHtml:function(g,f){f=f||0;var c;if(c=WH.markup.matchOuterTags(g,"<ul\\b[\\s\\S]*?>","</ul>","g")){for(var d=0;d<c.length;++d){g=g.replace(c[d][1]+c[d][0]+c[d][2],"\n"+Array(f+1).join("\t")+"[ul]"+WH.markup.tags.ul.fromHtml(c[d][0],f+1)+"\n"+Array(f+1).join("\t")+"[/ul]")}}return g}};WH.markup.tags.url={allowedClass:WH.markup.CLASS.USER,allowInReplies:true,empty:false,helpText:"[url=https://www.google.com]"+WH.TERMS.link+"[/url]",attr:{unnamed:{req:false,valid:/\S+/},newwindow:{req:false,valid:/^true$/},onclick:{req:false,valid:/[\S ]+/},rel:{req:false,valid:/\S+/},style:{req:false,valid:/^[^"<>]+$/},tooltip2:{req:false,valid:/\S+/},tooltip:{req:false,valid:/\S+/}},validate:function(c){if(c.onclick&&WH.markup.allow<WH.markup.CLASS.ADMIN){return false}if(c.tooltip&&WH.markup.allow<WH.markup.CLASS.STAFF){return false}if(c.unnamed&&/^(mailto:|irc:)/i.test(c.unnamed.trim())&&WH.markup.allow<WH.markup.CLASS.STAFF){return false}if(c.unnamed&&/^(javascript:)/i.test(c.unnamed.trim())){return false}return true},toNode:function(attr){let url;if(attr.unnamed){url=attr.unnamed;url=url.replace(/&amp;/,"&");if(url==="#"){url="javascript:"}else{if(!url.match(/^([^:\\.\/]+):/i)&&url.charAt(0)!=="/"&&url.charAt(0)!=="#"){url="/"+url}}}else{url=attr._textContents;url=url.replace(/&amp;/,"&")}if(!WH.markup.isUrlSafe(url,true)){return document.createDocumentFragment()}let a=WH.ce("a");WH.markup.applyCommonAttributes(a,attr);a.href=WH.markup.getFixedUrl(url);if(WH.markup.isUrlExternal(url)||attr.newwindow){a.target="_blank"}if(attr.rel){a.rel=attr.rel}if(attr.onclick){WH.aE(a,"click",(function(code){return function(){eval(code)}})(attr.onclick))}if(attr.tooltip&&WH.markup.tooltipTags[attr.tooltip]){WH.aE(a,"mouseover",function(e){WH.Tooltip.showAtCursor(e,WH.markup.tooltipTags[attr.tooltip],0,0,WH.markup.tooltipTagsWithRawText[attr.tooltip]?null:"q",(attr.tooltip2&&WH.markup.tooltipTags[attr.tooltip2])?WH.markup.tooltipTags[attr.tooltip2]:null)});WH.aE(a,"mousemove",WH.Tooltip.cursorUpdate);WH.aE(a,"mouseout",WH.Tooltip.hide)}return a},fromHtml:function(c){return c.replace(/<a\b[^>]*?href=\"(.+?)\"[\s\S]*?>([\s\S]*?)<\/a>/gi,"[url=$1]$2[/url]")}};WH.markup.tags.wowheadresponse={block:true,empty:false,rtrim:true,ltrim:true,itrim:true,attr:{unnamed:{req:true,valid:/[\S ]+/},roles:{req:true,valid:/[0-9]+/}},allowedModes:{article:1,quickfacts:1,comment:1},allowedClass:WH.markup.CLASS.STAFF,toNode:function(d){var m=d.unnamed.trim();if(m.length<=0){return document.createDocumentFragment()}var l=WH.ce("div",{className:"quote",dataset:{markupContentTarget:1}});WH.markup.applyCommonAttributes(l,d);if(d.first){l.classList.add("firstmargin")}if(d.last){l.classList.add("last")}var g="comment-role-moderator";if(d.roles&U_GROUP_ADMIN){g="comment-role-admin"}l.classList.add(g);var h=WH.ce("small",{className:"icon-wowhead"});WH.ae(l,h);var c=WH.ce("b",{className:g});WH.ae(h,c);var f=WH.ce("a",{href:"/user="+m},WH.ct(m));WH.ae(c,f);WH.ae(h,WH.ct(WH.TERMS.wordspace_punct+WH.TERMS.said_colon));WH.ae(l,WH.ce("div",{className:"pad"}));return l}};WH.markup.tags["<text>"]={empty:true,noHelp:true,allowInReplies:true,toNode:(function(){const h=new RegExp("(.*\\.)?("+["allakhazam.com","battle.net","be-imba.hu","blizzard.com","curse.com","elitistjerks.com","eq2interface.com","eqinterface.com","fanbyte.com","guildfans.com","guildwork.com","hearthhead.com","hearthstonetopdecks.com","joystiq.com","lotrointerface.com","mmo-champion.com","mmoui.com","raidbots.com","raider.io","sc2ranks.com","tankspot.com","thottbot.com","torchlightarmory.com","torhead.com","vginterface.com","vindictusdb.com","warcraftlogs.com","worldoflogs.com","worldofwarcraft.com","wow-europe.com","wow-heroes.com","wowhead.com","wowinsider.com","wowinterface.com","wowpedia.org","wowwiki.com","zam.com"].join("|").replace(/\./g,"\\.")+")","i");const d=/\/t?way(?: +([^/;\n\d]+|#\d+))? +(\d+(?:[.,]\d+)?),? +(\d+(?:[.,]\d+)?)(?: +([^/;\n]*[^ /;\n]\b\)?(?!:\/\/)))?/;const m=/(https?:\/\/|www\.)([\/_a-z0-9%?#@\-+~&=;:'|]|\.[a-z0-9\-])+/gi;function g(p){let allCoords=[];WH.qsa(":scope > span[data-map-pin-json]",p.parentNode).forEach(function(q){try{let data=JSON.parse(q.dataset.mapPinJson);if(data){allCoords.push([data.x,data.y])}}catch(r){}});return allCoords}function o(p){let allCommands=[];WH.qsa(":scope > span[data-map-pin-json]",p.parentNode).forEach(function(q){try{let data=JSON.parse(q.dataset.mapPinJson);if(data&&data.uiMapId){let name=data.name;if(data.uiMapName){if(name){name=WH.term("parens_format",name,data.uiMapName)}else{name=data.uiMapName}}allCommands.push(WH.Wow.UiMap.generateInGamePinLinkCommand(data.uiMapId,data.x,data.y,name))}}catch(r){}});return allCommands}function l(p){let allCommands=[];WH.qsa(":scope > span[data-map-pin-json]",p.parentNode).forEach(function(q){try{let data=JSON.parse(q.dataset.mapPinJson);if(data){allCommands.push(WH.Wow.UiMap.generateTomTomCommand([data.x,data.y],{uiMapId:data.uiMapId,uiMapName:data.uiMapName,name:data.name}))}}catch(r){}});return allCommands}function f(p){let matches=p.match("[a-z]+://([a-z0-9.-]+)");return!matches||matches[1].search(h)===0}function c(){m.lastIndex=0;d.lastIndex=0}return function(q,p){p=p||$.noop;if(q._rawText===" "&&!p.noNbsp){q._rawText=WH.Strings.nbsp}q._rawText=q._rawText.replace(/\\\[/g,"[");q._rawText=q._rawText.replace(/&nbsp;/g,WH.Strings.nbsp).replace(/&ndash;/g,"\u2013").replace(/&mdash;/g,"\u2014");if(p&&p.needsRaw){return WH.ct(q._rawText)}let lines=q._rawText.split("\n");let df=document.createDocumentFragment();let lookForLinks=!(p&&p.noLink);let line;let processUrls=function(r){if(r.index>0){WH.ae(df,WH.ct(line.substr(0,r.index)));line=line.substr(r.index)}let url=r[0];url=url.replace(/^www/,"http://www");if(WH.markup.allow<WH.markup.CLASS.USER&&!f(url)){let link=WH.ce("span",{className:"tip"},WH.ct(WH.TERMS.linkremoved));WH.Tooltip.simple(link,WH.TERMS.linkremoved_tip,"q");WH.ae(df,link)}else{let link=WH.ce("a",{href:url});if(WH.markup.isUrlExternal(url)){link.target="_blank"}WH.st(link,r[0]);WH.ae(df,link)}line=line.substr(r[0].length)};let processTomTomCommands=function(r){if(r.index>0){WH.ae(df,WH.ct(line.substr(0,r.index)));line=line.substr(r.index)}let uiMapId;let uiMapName;let idMatch=r[1]&&r[1].match(/^#(\d+)$/);if(idMatch){uiMapId=idMatch[1]}else{uiMapName=r[1]}let x=r[2].replace(/[.,]/,WH.TERMS.decimal_punct);let y=r[3].replace(/[.,]/,WH.TERMS.decimal_punct);let pinName=r[4];let mapPinData={name:pinName,x:x,y:y};let tomTomCommandSpan=WH.ce("span",{className:"tip"},WH.ct(r[0]));let options={getAllCoords:g.bind(null,tomTomCommandSpan),getAllInGameMapPins:o.bind(null,tomTomCommandSpan),getAllTomTomCommands:l.bind(null,tomTomCommandSpan),includeTomTom:true};if(uiMapId){mapPinData.uiMapId=uiMapId;options.uiMapId=uiMapId}else{if(window.g_pageInfo&&g_pageInfo.uiMapId){mapPinData.uiMapId=g_pageInfo.uiMapId;options.uiMapId=g_pageInfo.uiMapId}}if(uiMapName){mapPinData.uiMapName=uiMapName;options.uiMapName=uiMapName}if(pinName){options.name=pinName}tomTomCommandSpan.dataset.mapPinJson=JSON.stringify(mapPinData);WH.Wow.UiMap.clickToCopyCoordinates(tomTomCommandSpan,[x,y],options);WH.ae(df,tomTomCommandSpan);line=line.substr(r[0].length)};let urlMatch;let tomTomMatch;if(!lookForLinks){for(let lineIndex=0,lineLen=lines.length;lineIndex<lineLen;lineIndex++){line=lines[lineIndex];if(lineIndex>0){WH.ae(df,WH.ce("br"))}while(tomTomMatch=d.exec(line)){processTomTomCommands(tomTomMatch);c()}if(line.length){WH.ae(df,WH.ct(line))}}}else{for(let lineIndex=0,lineLen=lines.length;lineIndex<lineLen;lineIndex++){line=lines[lineIndex];if(lineIndex>0){WH.ae(df,WH.ce("br"))}while(true){urlMatch=m.exec(line);tomTomMatch=d.exec(line);if(urlMatch&&tomTomMatch){if(tomTomMatch.index<urlMatch.index){processTomTomCommands(tomTomMatch)}else{processUrls(urlMatch)}}else{if(urlMatch){processUrls(urlMatch)}else{if(tomTomMatch){processTomTomCommands(tomTomMatch)}else{c();break}}}c()}if(line.length){WH.ae(df,WH.ct(line))}}}return df}})(),toText:function(c){return c._rawText}};WH.markup.tags.achievementpoints={empty:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){var d=WH.ce("span",{className:"moneyachievement tip"},WH.ct(WH.numberFormat(c.unnamed)));WH.markup.applyCommonAttributes(d,c);WH.Tooltip.simple(d,"<b>"+WH.TERMS.achievementpoints_stc+"</b>","q1");return d}};WH.markup.tags.anchor={empty:true,ltrim:true,rtrim:true,attr:{unnamed:{req:false,valid:/\S+/}},validate:function(c){if(!c.unnamed&&!c.id){return false}return true},toNode:function(c){if(!c.unnamed&&c.id){c.unnamed=c.id;c.id=null}var d=WH.ce("a",{id:c.unnamed});WH.markup.applyCommonAttributes(d,c);return d}};WH.markup.tags.db={empty:true,attr:{unnamed:{req:true,valid:/^(live|ptr|beta|classic|mop|wod|legion|bfa|shadowlands|sl)$/}},toNode:function(c){WH.markup.setDataEnv(c.unnamed);return null},toText:function(c){WH.markup.setDataEnv(c.unnamed);return""}};WH.markup.tags.feedback={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{mailto:{req:false,valid:/^true$/i}},toNode:function(c){var d=WH.ce("a",{href:"mailto:feedback@wowhead.com"},WH.ct("feedback@wowhead.com"));if(!c.mailto){d.href="javascript:";WH.aE(d,"click",function(){ContactTool.show()})}var f=WH.ce("span",{className:"icontiny",style:{backgroundImage:"url("+WH.staticUrl+"/images/icons/email.gif)"}},d);return WH.ce("b",{},f)}};WH.markup.tags.forumrules={empty:true,allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){var d=WH.ce("a",{href:"/forums&topic=2"},WH.ct("forum rules"));var f=WH.ce("span",{className:"icontiny",style:{backgroundImage:"url("+WH.staticUrl+"/images/icons/favicon.gif)"}},d);return WH.ce("b",{},f)}};WH.markup.tags.html={empty:false,allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{"<text>":1},rawText:true,taglessSkip:true,toNode:function(d){var g=WH.ce("div");g.innerHTML=d._contents.textContent;while(d._contents.hasChildNodes()){d._contents.removeChild(d._contents.firstChild)}var c=g.getElementsByTagName("script");while(c.length){c[0].parentNode.replaceChild(WH.ct(c[0].outerHTML),c[0])}var f=document.createDocumentFragment();while(g.hasChildNodes()){f.appendChild(g.firstChild)}WH.markup.tags.html.removeEventAttributes(f);return f},removeEventAttributes:function(g){var d=g.childNodes;for(var c=0;c<d.length;c++){WH.markup.tags.html.removeEventAttributes(d[c])}if(g instanceof Element){var f=/^\s*javascript:/i;var h=g.getAttributeNames();for(var c=0;c<h.length;c++){if(h[c].substr(0,2).toLowerCase()==="on"||f.test(g.getAttribute(h[c]))){g.removeAttribute(h[c])}}}}};WH.markup.tags.markupdoc={empty:true,attr:{tag:{req:false,valid:/[a-z0-9]+/i},help:{req:false,valid:/^(admin|staff|premium|user|pending)$/}},allowedClass:WH.markup.CLASS.STAFF,validate:function(c){if(c.tag&&!WH.markup.tags[c.tag]){return false}return true},toNode:function(f){var m="",d=(f.help?WH.markup.CLASS[f.help.toUpperCase()]:false);if(d){m+=WH.TERMS.markuphelp_tip+'<div class="pad3"></div><table class="grid grid-distinct-headings auto-width comment"><tr><th>'+WH.TERMS.youtype_colon+"</th><th>"+WH.TERMS.yousee_colon+"</th></tr>"}if(f.tag){m=WH.markup.tags.markupdoc.generateTagDocs(f.tag,d)}else{for(var c in WH.markup.tags){if(!d&&m!=""){m+='<div class="pad3"></div>'}m+=WH.markup.tags.markupdoc.generateTagDocs(c,d)}}var h=m+(d?"</table>":"");var g=WH.ce("div");g.innerHTML=h;var l=document.createDocumentFragment();while(g.firstChild!=null){l.appendChild(g.removeChild(g.firstChild))}return l},generateTagDocs:function(l,f){var c=WH.markup.tags[l];if(!c){return""}var q="";if(f){if((c.allowedClass&&c.allowedClass>f)||(!c.helpText&&(c.empty||c.allowedParents||c.allowedChildren||!LANG["markup_"+l]))){return""}if(c.helpText&&typeof c.helpText=="function"){q=c.helpText()}else{if(c.helpText&&typeof c.helpText=="string"){q=c.helpText}else{q="["+l+"]"+LANG["markup_"+l].toLowerCase()+"[/"+l+"]"}}var o=document.createElement("div");o.appendChild(WH.markup.getDomFragment(q,{skipReset:true}));return"<tr><td><pre>"+q+"</pre></td><td>"+o.innerHTML+"</td></tr>"}q='<div><h3 class="heading-size-3 first">Tag: ['+WH.markup.getEscapedHtml(l)+"]</h3>";q+='<table class="grid">';if(c.attr){q+='<tr><td align="right" width="200">Attributes:</td><td>';for(var g in c.attr){q+='<div style="margin: 5px; display: inline-block"><table><tr><th style="background-color: #242424; font-weight: bolder" colspan="2">';if(g=="unnamed"){q+="Self (["+l+"=???])"}else{q+=g}q+="</th></tr>";q+='<tr><td align="right">Required:</td><td>'+(c.attr[g].req?"Yes":"No")+"</td></tr>";q+='<tr><td align="right">Valid:</td><td>'+(c.attr[g].valid?WH.markup.getEscapedHtml(c.attr[g].valid.toString()):"--")+"</td></tr></table></div>"}q+="</td></tr>"}q+='<tr><td align="right" width="200">Has closing tag:</td><td>'+(c.empty?"No":"Yes")+"</td></tr>";q+='<tr><td align="right">Required group:</td><td>';if(c.allowedClass==WH.markup.CLASS.ADMIN){q+="Administrator"}else{if(c.allowedClass==WH.markup.CLASS.STAFF){q+="Staff"}else{if(c.allowedClass==WH.markup.CLASS.PREMIUM){q+="Premium"}else{if(c.allowedClass&&c.allowedClass!=WH.markup.CLASS.PENDING){q+="Not pending"}else{q+="None"}}}}q+="</td></tr>";if(c.allowedChildren){q+='<tr><td align="right">Allowed children:</td><td>';for(var h in c.allowedChildren){q+=WH.markup.getEscapedHtml(h)+"<br />"}q+="</td></tr>"}if(c.allowedParents){q+='<tr><td align="right">Allowed parents:</td><td>';for(var h in c.allowedParents){q+=WH.markup.getEscapedHtml(h)+"<br />"}q+="</td></tr>"}if(c.presets){q+='<tr><td align="right">Preset values:</td><td><table>';for(var m in c.presets){q+='<tr><td align="right">'+m+"</td><td>"+WH.markup.getEscapedHtml(c.presets[m])+"</td></tr>"}q+="</table></td></tr>"}if(c.trim){q+='<tr><td colspan="2">Trim whitespace</td></tr>'}if(c.ltrim){q+='<tr><td colspan="2">Trim preceding whitespace</td></tr>'}if(c.rtrim){q+='<tr><td colspan="2">Trim following whitespace</td></tr>'}if(c.itrim){q+='<tr><td colspan="2">Trim whitespace around interior content</td></tr>'}if(c.block){q+='<tr><td colspan="2">Automatically remove top padding if not the first item</td></tr>'}q+="</table></div>";return q}};WH.markup.tags.menu={empty:true,trim:true,ltrim:true,rtrim:true,attr:{tab:{req:true,valid:/^[0-9]+$/},path:{req:true,valid:/\S+/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){var d=c.path.split(",");WH.Layout.set({activeTab:c.tab,breadcrumb:d});return null}};WH.markup.tags.random={empty:false,itrim:true,allowedChildren:{randomoption:1},allowedClass:WH.markup.CLASS.STAFF,toNode:function(d){var f=[];for(var c=0;c<d._nodes.length;c++){if(d._nodes[c].name=="randomoption"){f.push(d._nodes[c].attr._contents)}}if(f.length==0){return d._contents}return f[Math.floor(Math.random()*f.length)]}};WH.markup.tags.randomoption={empty:false,rtrim:true,ltrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{random:1},toNode:function(c){return null}};WH.markup.tags.script={ltrim:true,rtrim:true,empty:false,attr:{src:{req:false,valid:/^\S+$/}},allowedClass:WH.markup.CLASS.ADMIN,allowedChildren:{"<text>":1},rawText:true,taglessSkip:true,toNode:function(c){if(c.src){$.getScript(c.src,function(){try{$.globalEval(c._contents.textContent)}catch(f){WH.error("Markup script error:",f)}})}else{try{$.globalEval(c._contents.textContent)}catch(d){WH.error("Markup script error:",d)}}return null}};WH.markup.tags["set-content-phase"]={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{type:{req:true,valid:/^\d+$/},typeid:{req:true,valid:/^\d+$/},phase:{req:true,valid:/^\d+(\.\d+)?$/}},toNode:function(d){var c=document.createDocumentFragment();var g=WH.ce("span");WH.ae(c,g);var f=WH.ce("a",{href:"javascript:",className:"fa fa-edit",style:{paddingLeft:"0.5em"},dataset:{phase:d.phase}});WH.ae(c,f);WH.aE(f,"click",function(){var h=f.dataset.phase;if(h==0){h=undefined}WH.Wow.showContentPhasePrompt(d.type,[d.typeid],h,function(l){f.dataset.phase=l?l:0;WH.st(g,l?l:"??")})});return c}};WH.markup.tags.style={ltrim:true,rtrim:true,empty:false,allowedClass:WH.markup.CLASS.ADMIN,allowedChildren:{"<text>":1},rawText:true,taglessSkip:true,toNode:function(c){WH.addCss(c._contents.textContent);return null}};WH.markup.tags["video-ad"]={allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:false,value:/^(left|right)$/}},empty:true,trim:true,toNode:function(c){if(!WH.WAS.showAds()){return WH.ce("div")}var d=WH.ce("div",{id:"video-pos-page"});if(c.unnamed){d.className="video-pos-"+c.unnamed}return d}};WH.markup.tags.visitedpage={empty:false,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(c){$.post("/visited-page",{id:c.unnamed},function(){AchievementCheck()});return null}};WH.markup.tags["--"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,trim:true,ltrim:true,rtrim:true,attr:{unnamed:{req:false}},toNode:function(c){return null},toText:function(c){return""}};WH.markup.tree=function(){this.nodes=[];this.currentNode=null};WH.markup.tree.prototype={openTag:function(d,f){if(d!="<text>"&&WH.markup.tags[d]&&!WH.markup.tags[d].allowedClass){WH.markup.tags[d].allowedClass=WH.markup.CLASS.PENDING}if(!WH.markup.tags[d]){return false}else{if(WH.markup.tags[d].allowedModes&&WH.markup.tags[d].allowedModes[WH.markup.modes[WH.markup.mode]]==undefined){return false}else{if(WH.markup.tags[d].allowedClass&&WH.markup.tags[d].allowedClass>WH.markup.allow){return false}}}if(WH.markup.mode==WH.markup.MODE.REPLY&&!WH.markup.tags[d].allowInReplies){return false}var g={name:d,attr:f,parent:null,nodes:[]};if(this.currentNode){g.parent=this.currentNode}if(WH.markup.tags[d].allowedParents){if(g.parent!=null){if(WH.markup.tags[d].allowedParents[g.parent.name]===undefined){return false}}else{if(WH.markup.root==undefined||WH.markup.tags[d].allowedParents[WH.markup.root]==undefined){return false}}}if(g.parent&&WH.markup.tags[g.parent.name].allowedChildren&&WH.markup.tags[g.parent.name].allowedChildren[d]==undefined){return false}if(this.currentNode){if(this.currentNode.nodes.length==0&&g.name=="<text>"&&WH.markup.tags[this.currentNode.name].itrim){g.attr=WH.markup.utility.ltrimText(g.attr)}else{if(this.currentNode.nodes.length>0){var h=this.currentNode.nodes.length-1;var c=WH.markup.utility.checkSiblingTrim(this.currentNode.nodes[h],g);this.currentNode.nodes[h]=c[0];g=c[1]}}if(g.name=="<text>"){if(g.attr._rawText.length>0){this.currentNode.nodes.push(g)}}else{this.currentNode.nodes.push(g)}}else{if(this.nodes.length>0){var h=this.nodes.length-1;var c=WH.markup.utility.checkSiblingTrim(this.nodes[h],g);this.nodes[h]=c[0];g=c[1]}if(g.name=="<text>"){if(g.attr._rawText.length>0){this.nodes.push(g)}}else{this.nodes.push(g)}}if(!WH.markup.tags[d].empty&&!WH.markup.tags[d].post){this.currentNode=g}return true},closeTag:function(d){if(WH.markup.tags[d].empty||WH.markup.tags[d].post){return false}if(!this.currentNode){return false}else{if(this.currentNode.name==d){if(this.currentNode.nodes.length>0){var h=this.currentNode.nodes.length-1;if(WH.markup.tags[this.currentNode.name].itrim&&this.currentNode.nodes[h].name=="<text>"){var g=this.currentNode.nodes[h];g.attr=WH.markup.utility.rtrimText(g.attr);this.currentNode.nodes[h]=g}}this.currentNode=this.currentNode.parent}else{if(WH.markup.tags[this.currentNode.name].allowedChildren&&WH.markup.tags[this.currentNode.name].allowedChildren[d]==undefined){return false}else{var f=function(m,l){for(var o=l.length-1;o>=0;--o){if(l[o].name==m){return o}}return-1};var c;if(this.currentNode.parent){c=f(d,this.currentNode.parent.nodes)}else{c=f(d,this.nodes)}if(c==-1){return false}}}}return true},toNode:function(){var f=[];var p={};for(var v in WH.markup.collectTags){p[v]=[]}this.tagless(true);var t=0;var c=function(z,D,H){var F=document.createDocumentFragment();var C;for(var E=0;E<z.length;++E){var B=z[E];if(D==0&&E==0&&WH.markup.firstTags[B.name]){B.attr.first=true}else{if(D>0&&E==0&&WH.markup.firstTags[B.parent.name]){B.attr.first=true}}if(E==z.length-1&&WH.markup.firstTags[B.name]){B.attr.last=true}if(WH.markup.excludeTags[B.name]){H[B.name]=(H[B.name]?H[B.name]+1:1)}for(var G in H){for(var K in WH.markup.excludeTags[G]){if(WH.markup.excludeTags[G][K][B.name]){B.attr[K]="false"}}}if(WH.markup.collectTags[B.name]){B.offset=t++;p[B.name].push(B)}if(WH.markup.tags[B.name].post){var J=document.createElement("div");J.id="postNode-replace-"+f.length;F.appendChild(J);f.push(B)}else{if(WH.markup.tags[B.name].empty){if(B.parent&&WH.markup.tags[B.parent.name].rawText){try{C=WH.markup.tags[B.name].toNode(B.attr,{needsRaw:true})}catch(I){C=WH.ce("div",{className:"q10"},WH.ct("Whoops, markup engine error! Tag: "+B.name+" "+I));WH.error(I)}}else{try{C=WH.markup.tags[B.name].toNode(B.attr,{noLink:B.parent&&B.parent.name==="url"})}catch(I){C=WH.ce("div",{className:"q10"},WH.ct("Whoops, markup engine error! Tag: "+B.name+" "+I));WH.error(I)}}F.appendChild(WH.markup.assembleDomNode(C))}else{var A=arguments.callee(B.nodes,D+1,H);B.attr._contents=A;B.attr._nodes=B.nodes;try{C=WH.markup.tags[B.name].toNode(B.attr)}catch(I){C=WH.ce("div",{className:"q10"},WH.ct("Whoops, markup engine error! Tag: "+B.name+" "+I));WH.error(I)}F.appendChild(WH.markup.assembleDomNode(C,A))}}if(H[B.name]){H[B.name]--;if(H[B.name]==0){delete H[B.name]}}}return F};var r=c(this.nodes,0,[]);for(var l=0;l<f.length;++l){var u=r.querySelector("#postNode-replace-"+l);var d=f[l];var o=WH.markup.tags[d.name].postParseNode(d.attr,p);o=WH.markup.assembleDomNode(o);u.parentNode.replaceChild(o,u)}var w=r.querySelectorAll("a");for(var l=0;l<w.length;l++){var m=w[l].href.match(/^http(s)?:\/\/([^\/:@]+\.)?wowhead\.com[\/:]/);if(!m){continue}var g=m[2]||"";if(!m[1]&&g.substr(-4)!=="dev."){w[l].href=w[l].href.replace(/^http:/,"https:")}var h=WH.markup.regex.subdomainEnv;for(var q in h){if(!h.hasOwnProperty(q)){continue}if(WH.markup.disabledEnvironments[q]&&h[q].test(g)){w[l].href=w[l].href.replace(g,g.replace(h[q],"$1")||"www.")}}}return r},tagless:function(h){var c=function(l){var r=document.createDocumentFragment();for(var m=0;m<l.length;++m){var q=l[m];var p=arguments.callee(q.nodes);if(h){q.attr._textContents=p.textContent}else{q.attr._contents=p}if(q.name=="<text>"){var o=WH.markup.tags[q.name].toNode(q.attr,{noLink:true,noNbsp:true});r.appendChild(WH.markup.assembleDomNode(o))}else{if(WH.markup.tags[q.name].toText){r.appendChild(document.createTextNode(WH.markup.tags[q.name].toText(q.attr)))}}if(!WH.markup.tags[q.name].taglessSkip){r.appendChild(p)}}return r};if(h){c(this.nodes)}else{var d=c(this.nodes);var g=document.createElement("div");g.appendChild(d);var f=g.innerHTML;f=f.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"');return f}},imageUploadIds:function(){var d=[];var c=function(f){for(var g=0;g<f.length;++g){var h=f[g];if(h.name=="img"&&h.attr.upload){d.push(h.attr.upload)}arguments.callee(h.nodes)}};c(this.nodes);return d}};WH.markup.utility=new function(){this.ltrimText=function(c){c._rawText=c._rawText.ltrim();return c};this.rtrimText=function(c){c._rawText=c._rawText.rtrim();return c};this.checkSiblingTrim=function(d,c){if(c.name=="<text>"&&(WH.markup.tags[d.name].rtrim||WH.markup.tags[d.name].trim)){c.attr=WH.markup.utility.ltrimText(c.attr)}else{if(d.name=="<text>"&&(WH.markup.tags[c.name].ltrim||WH.markup.tags[c.name].trim)){d.attr=WH.markup.utility.rtrimText(d.attr)}}return[d,c]}};WH.markup.init();WH.MD5=new function(){function f(w,A){var z=w[0],v=w[1],C=w[2],B=w[3];z=c(z,v,C,B,A[0],7,-680876936);B=c(B,z,v,C,A[1],12,-389564586);C=c(C,B,z,v,A[2],17,606105819);v=c(v,C,B,z,A[3],22,-1044525330);z=c(z,v,C,B,A[4],7,-176418897);B=c(B,z,v,C,A[5],12,1200080426);C=c(C,B,z,v,A[6],17,-1473231341);v=c(v,C,B,z,A[7],22,-45705983);z=c(z,v,C,B,A[8],7,1770035416);B=c(B,z,v,C,A[9],12,-1958414417);C=c(C,B,z,v,A[10],17,-42063);v=c(v,C,B,z,A[11],22,-1990404162);z=c(z,v,C,B,A[12],7,1804603682);B=c(B,z,v,C,A[13],12,-40341101);C=c(C,B,z,v,A[14],17,-1502002290);v=c(v,C,B,z,A[15],22,1236535329);z=p(z,v,C,B,A[1],5,-165796510);B=p(B,z,v,C,A[6],9,-1069501632);C=p(C,B,z,v,A[11],14,643717713);v=p(v,C,B,z,A[0],20,-373897302);z=p(z,v,C,B,A[5],5,-701558691);B=p(B,z,v,C,A[10],9,38016083);C=p(C,B,z,v,A[15],14,-660478335);v=p(v,C,B,z,A[4],20,-405537848);z=p(z,v,C,B,A[9],5,568446438);B=p(B,z,v,C,A[14],9,-1019803690);C=p(C,B,z,v,A[3],14,-187363961);v=p(v,C,B,z,A[8],20,1163531501);z=p(z,v,C,B,A[13],5,-1444681467);B=p(B,z,v,C,A[2],9,-51403784);C=p(C,B,z,v,A[7],14,1735328473);v=p(v,C,B,z,A[12],20,-1926607734);z=h(z,v,C,B,A[5],4,-378558);B=h(B,z,v,C,A[8],11,-2022574463);C=h(C,B,z,v,A[11],16,1839030562);v=h(v,C,B,z,A[14],23,-35309556);z=h(z,v,C,B,A[1],4,-1530992060);B=h(B,z,v,C,A[4],11,1272893353);C=h(C,B,z,v,A[7],16,-155497632);v=h(v,C,B,z,A[10],23,-1094730640);z=h(z,v,C,B,A[13],4,681279174);B=h(B,z,v,C,A[0],11,-358537222);C=h(C,B,z,v,A[3],16,-722521979);v=h(v,C,B,z,A[6],23,76029189);z=h(z,v,C,B,A[9],4,-640364487);B=h(B,z,v,C,A[12],11,-421815835);C=h(C,B,z,v,A[15],16,530742520);v=h(v,C,B,z,A[2],23,-995338651);z=t(z,v,C,B,A[0],6,-198630844);B=t(B,z,v,C,A[7],10,1126891415);C=t(C,B,z,v,A[14],15,-1416354905);v=t(v,C,B,z,A[5],21,-57434055);z=t(z,v,C,B,A[12],6,1700485571);B=t(B,z,v,C,A[3],10,-1894986606);C=t(C,B,z,v,A[10],15,-1051523);v=t(v,C,B,z,A[1],21,-2054922799);z=t(z,v,C,B,A[8],6,1873313359);B=t(B,z,v,C,A[15],10,-30611744);C=t(C,B,z,v,A[6],15,-1560198380);v=t(v,C,B,z,A[13],21,1309151649);z=t(z,v,C,B,A[4],6,-145523070);B=t(B,z,v,C,A[11],10,-1120210379);C=t(C,B,z,v,A[2],15,718787259);v=t(v,C,B,z,A[9],21,-343485551);w[0]=g(z,w[0]);w[1]=g(v,w[1]);w[2]=g(C,w[2]);w[3]=g(B,w[3])}function r(C,z,w,v,B,A){z=g(g(z,C),g(v,A));return g((z<<B)|(z>>>(32-B)),w)}function c(z,w,D,C,v,B,A){return r((w&D)|((~w)&C),z,w,v,B,A)}function p(z,w,D,C,v,B,A){return r((w&C)|(D&(~C)),z,w,v,B,A)}function h(z,w,D,C,v,B,A){return r(w^D^C,z,w,v,B,A)}function t(z,w,D,C,v,B,A){return r(D^(w|(~C)),z,w,v,B,A)}function q(z){var B=z.length,A=[1732584193,-271733879,-1732584194,271733878],w;for(w=64;w<=z.length;w+=64){f(A,u(z.substring(w-64,w)))}z=z.substring(w-64);var v=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;w<z.length;w++){v[w>>2]|=z.charCodeAt(w)<<((w%4)<<3)}v[w>>2]|=128<<((w%4)<<3);if(w>55){f(A,v);for(w=0;w<16;w++){v[w]=0}}v[14]=B*8;f(A,v);return A}function u(w){var z=[],v;for(v=0;v<64;v+=4){z[v>>2]=w.charCodeAt(v)+(w.charCodeAt(v+1)<<8)+(w.charCodeAt(v+2)<<16)+(w.charCodeAt(v+3)<<24)}return z}var o="0123456789abcdef".split("");function l(z){var w="",v=0;for(;v<4;v++){w+=o[(z>>(v*8+4))&15]+o[(z>>(v*8))&15]}return w}function d(v){for(var w=0;w<v.length;w++){v[w]=l(v[w])}return v.join("")}function m(v){return d(q(v))}function g(w,v){return(w+v)&4294967295}if(m("hello")!="5d41402abc4b2a76b9719d911017c592"){function g(v,A){var z=(v&65535)+(A&65535),w=(v>>16)+(A>>16)+(z>>16);return(w<<16)|(z&65535)}}this.hash=function(v){return m(v)}};var Menu=new function(){const v=this;const ad="menu-item-heading";const J="menu-item-spacer";const F="unlinked";var K=100;var Y=333;var z=0;var U=1;var g=2;var ay=3;var aa=4;v.ITEM_NAME=z;v.ITEM_LABEL=U;v.ITEM_URL=g;v.ITEM_SUBMENU=ay;v.ITEM_OPTIONS=aa;var S=520;var av=4;var E=2;var W=26;var aj=6;var al=6;var q=[mn_artifactWeaponCalc,mn_classes,mn_currencies,mn_database,mn_events_holidays,mn_events_recurring,mn_guides_specs,mn_pvpTalentCalc,mn_icons,mn_itemSets,mn_npcs,mn_objects,mn_outfits,mn_pets,mn_races,mn_resources,mn_skills,mn_sounds,mn_talentCalc,mn_transmog_classes,mn_transmogsets];var ag=[mn_quests];var B=[{menu:mn_battlepets,paths:[["*"]]},{menu:mn_classHalls,paths:[[23],[30],[7]]},{menu:mn_forums,paths:[[-2]]},{menu:mn_garrisons,paths:[[4,"*"]]},{menu:mn_guides,paths:[[1]]},{menu:mn_items,paths:[[4,1],[4,2],[4,3],[4,4],[1],[0],[16],[7],[6],[9],[-2,0,"*"],[-2,1,"*"],[-2,2],[-2,16],[-2,4],[-2,5],[-2,6],[-2,7],[-3]]},{menu:mn_npcs,paths:[["*"]]},{menu:mn_spells,paths:[[7],[-17],[-18],[-13],[-16],[-12],[-2],[50],[52],[54],[-3],[-3,"*"],[-7],[11],[9]]},{menu:mn_zones,paths:[[9],["classHalls"]]}];const r={currentMenu:null,divCache:{},menuItemsCache:{},menuOpener:null,nextUniqueId:0,openLinks:{},showingHeaderMenu:false,timer:{hideMenu:null,showMenu:null},visibleMenus:{}};v.add=function(aH,aI,aF,aG){aF=aF||{};var aE;if(typeof aH==="string"){aH=WH.qs(aH);aE=$(aH)}else{if(aH instanceof jQuery){if(!aH.length){WH.error("Tried to add a menu to an empty jQuery object.");return}aE=aH;aH=aH.get(0)}else{aE=$(aH)}}if(!aH){WH.error("Tried to add a menu to an invalid target.");return}if(aF.onShow){aI.onShow=aF.onShow}if(aF.onHide){aI.onHide=aF.onHide}if(aF.padded){aI.padded=aF.padded}aE.data("menu",aI);Q(aH,aF);if(aF.showImmediately){if(aF.showAtCursor){ai.call(this,aG)}else{o.call(this,aG)}}};v.addButtons=function(aG,aH,aF){var aI=$(aG);if(!aI.length){return}var aE=$('<span class="menu-buttons"></span>');$.each(aH,function(aJ,aM){if(P(aM)){return}if(!T(aM)){return}var aN=$("<a></a>");var aK=$("<span></span>",{text:aM[U]}).appendTo(aN);v.linkifyItem(aM,aN);aN.data("parentMenu",aH).data("menuItem",aM);if(aM[aa]&&aM[aa].rel){aN.attr("rel",aM[aa].rel)}var aL=v.getSubmenu(aM);if(aL){aK.addClass("hassubmenu");if(Platform.isTouch()){az.add(aN.get(0),aL)}else{v.add(aN,aL,{padded:aF&&aF.padded,showAtElement:aF&&aF.menusOnClick})}}aE.append(aN)});aI.append(aE)};v.addToSubmenu=function(aF,aG){var aE=v.getSubmenu(aF);if(aE){aE.push(aG)}else{aF[ay]=[aG]}};v.createItem=function(aE){let item=[];["name","label","url","submenu","options"].forEach(function(aF){if(aE.hasOwnProperty(aF)){item[v["ITEM_"+aF.toUpperCase()]]=aE[aF]}});return item};v.findItem=function(aF,aE){return v.getFullPath(aF,aE).pop()};v.getFeaturedNavigationMenu=function(){if(WH.isClassicTree()){return window.mn_classic_featuredContent||[]}if(WH.isBurningCrusadeTree()){return window.mn_burningCrusade_featuredContent||[]}var aF=window.mn_featuredContent||[];if(!Menu.findItem(aF,["classes"])){var aO=[];for(var aJ=0,aG=mn_specialization.length;aJ<aG;aJ++){var aM=mn_specialization[aJ];var aH=Menu.getSubmenu(aM);if(!aH){continue}aO.push([aM[z],aM[U],null,null,{heading:true}]);for(var aI=0,aN=aH.length;aI<aN;aI++){var aE="/"+g_spec2SeoShorthand[aM[z]][aI+1]+"-"+g_class2SeoShorthand[aM[z]]+"-guide";var aP=JSON.parse(JSON.stringify(aH[aI][aa]));aP.className="c"+aM[z];aO.push([aH[aI][z],aH[aI][U],aE,null,aP])}}var aL=[];while(aL.length<2){var aK=Math.floor(Math.random()*12)+1;if(aL.indexOf(aK)===-1){aL.push(aK)}}aF.unshift(["classes",WH.TERMS.classes,"/classes",aO,{className:"header-nav-classes first-"+aL[0]+" second-"+aL[1],zulNoHref:true}])}return aF};v.getFullPath=function(aL,aK){var aF=[];var aJ=function(aQ,aP){var aR=an(aL,aQ);if(aR!==-1){var aN=[];var aO=aL[aR];if(aO[aa]&&aO[aa].breadcrumbParent){var aM=aJ(aO[aa].breadcrumbParent,true);if(aM){aN.push(aM.pop())}}aO.parentMenu=aL;if(!aP){aL=v.getSubmenu(aO)}aN.push(aO);return aN}return null};for(var aH=0;aH<aK.length;++aH){var aG=aJ(aK[aH]);if(aG){for(var aE=0,aI;aI=aG[aE];aE++){aF.push(aI)}}}return aF};v.getItemOptions=function(aE){if(!aE[aa]){aE[aa]={}}return aE[aa]};v.getItemUrl=function(aF){var aE=aF[g];if(!aE){return null}if(aF.modifyUrl){aE=WH.modifyUrl(aE,aF.modifyUrl.params,aF.modifyUrl.opt,aF)}return aE};v.getLabel=function(aE,aF){let label=aE[U];if(aE[aa]){let options=aE[aa];if(options.generateText){label=options.generateText(aE)}if(aF===true){if(options.breadcrumb){label=options.breadcrumb}}else{if(typeof options.prefix==="string"){label=options.prefix+label}else{if(typeof options.prefix==="object"){let prefix=options.prefix[0];for(let findString in options.prefix.replacements){if(options.prefix.replacements.hasOwnProperty(findString)){prefix=prefix.replace(findString,options.prefix.replacements[findString])}}label=prefix+label}}}if(options.replacements){for(let findString in options.replacements){if(options.replacements.hasOwnProperty(findString)){label=label.replace(findString,options.replacements[findString])}}}}return label};v.getMenu=function(aE){if(aE===undefined){aE="path"}return window["mn_"+aE]};v.getOpener=function(){return ac()?r.menuOpener:null};v.getSubmenu=function(aF){var aE=aF[ay];if(typeof aE==="string"){aE=Menu.getMenu(aE)}return aE&&aE.length?aE:null};v.hasSubmenuContent=function(aE){return c(v.getSubmenu(aE))};v.hide=function(aE){am(false);if(Platform.isTouch()){az.closeAllMenus();return}G(null,aE);aw()};v.isHeading=function(aE){return P(aE)};v.linkifyItem=function(aG,aH){var aF=v.getItemOptions(aG);if(typeof aG[aa]=="object"&&aG[aa].className){aH.addClass(aG[aa].className)}if(typeof aG[aa]=="object"&&aG[aa].onMouseOver){aH.mouseover(aG[aa].onMouseOver)}if(typeof aG[aa]=="object"&&aG[aa].onMouseOut){aH.mouseout(aG[aa].onMouseOut)}if(!aG[g]){aH.attr("href","javascript:");aH.addClass(F);if(aF.tooltip){aH.attr("href",aF.tooltip);aH.click(WH.rf)}return false}if(typeof aG[g]=="function"){aH.attr("href","javascript:");aH.click(at);if(aF.tooltip){aH.attr("href",aF.tooltip);aH.click((function(aI){aI();return false}).bind(null,aG[g]))}else{aH.click(aG[g])}if(aF.rel){aH.attr("rel",aF.rel)}}else{var aE=v.getItemUrl(aG);aH.attr("href",aE);if(aF.newWindow||WH.isExternalUrl(aE)){aH.attr("target","_blank")}if(aF.rel){aH.attr("rel",aF.rel)}else{if(typeof aE==="string"&&(aE.indexOf("/guides/")===0||aE.indexOf("/guide=")===0)){aH.attr("rel","np")}}}return true};v.map=function(aG,aO,aS){aO.className+=" menu-map";for(var aK=0,aR;aR=aG[aK];aK++){if(aR[aa]&&aR[aa].menuMapHide){continue}WH.ae(aO,WH.getMajorHeading(typeof aR[g]=="string"?'<a href="'+v.getItemUrl(aR)+'">'+aR[U]+"</a>":aR[U],2));var aI=v.getSubmenu(aR);if(aI instanceof Array){var aQ=WH.ce("div",{className:"menu-map-section"});var aF=null;var aP=WH.ce("div",{className:"menu-map-submenu-group"});for(var aJ=0,aN=aI.length;aJ<aN;aJ++){var aM=aI[aJ];if(aM[aa]&&aM[aa].menuMapHide){continue}if(P(aM)){WH.ae(aQ,aP);aP=WH.ce("div",{className:"menu-map-submenu-group"});aF=aM[U];WH.ae(aQ,WH.getMajorHeading(typeof aM[g]=="string"?'<a href="'+v.getItemUrl(aM)+'">'+aM[U]+"</a>":aM[U],3));continue}var aH=v.getSubmenu(aM);if(aS&&aS.noEmptySubmenus&&!aH){continue}var aL=WH.getMajorHeading(typeof aM[g]=="string"?'<a href="'+v.getItemUrl(aM)+'">'+aM[U]+"</a>":aM[U],4);var aE=WH.ce("div",{className:"menu-map-submenu"},aL);if(aM[U]==aF){aE.setAttribute("data-duplicate-heading","true")}if(aH){v.addButtons(aE,aH,{menusOnClick:true})}WH.ae(aP,aE)}WH.ae(aQ,aP);WH.ae(aO,aQ)}}};v.modifyUrl=function(aG,aH,aF){var aE={params:aH,opt:aF};w(aG,function(aI){aI.modifyUrl=aE});WH.Layout.updateBreadcrumb()};v.prepareForZul=function(aE,aF){aA();return Z(aE,aF)};v.render=function(aF,aE){return C(aF,0,true,aE)};this.setItemOption=function(aE,aG,aF){if(!aE[aa]){aE[aa]={}}aE[aa][aG]=aF};v.setSubmenu=function(aF,aE){aF[ay]=aE};v.show=function(aF,aE){if(Platform.isTouch()){az.onRootNodeClick.call(aE,null,aF)}else{am(WH.closest(aE,".header")!==undefined);ak(aF,aE)}};v.showAtCursor=function(aF,aE){if(Platform.isTouch()){az.onNodelessClick(aF,aE);return}r.currentMenu=aF;ab(aF,aE.pageX,aE.pageY)};v.sort=function(aF,aE){if(WH.inArray(aF,true,P)!==-1){I(aF,aE)}else{m(aF,aE)}};v.sortGlobalMenus=function(){if(Locale.getId()===LOCALE_ENUS){return}for(var aG=0,aI=q.length;aG<aI;aG++){Menu.sort(q[aG])}for(var aF=0,aH=ag.length;aF<aH;aF++){Menu.sort(ag[aF],true)}for(var aE=0,aJ=B.length;aE<aJ;aE++){O(B[aE].menu,B[aE].paths)}mn_transmogsets.sort(function(aL,aK){if(aL[z]===1020){return-1}else{if(aK[z]===1020){return 1}}return 0})};v.updateItem=function(aE){var aH=aE.$a;if(!aH){return}var aF=v.getItemOptions(aE);aH.removeClass("checked tinyicon icon");aH.css("background-image","");if(aE.checked){aH.addClass("checked fonticon");aH.prepend('<i class="fa fa-check fa-size-s fa-color-white fonticon-icon"/>')}else{var aI=false;var aG=function(aR){switch(typeof aR){case"string":return aR;break;case"function":var aQ=aR(aE);if(typeof aQ=="string"){return aQ}break}return false};if(!aI&&aF.armory){var aJ=aG(aF.armory);if(aJ){aI=true;aH.addClass("armoryicon");aH.css("background-image","url("+aJ+")")}}if(!aI&&aF.fontIcon){var aO=aG(aF.fontIcon);if(aO){aI=true;aH.addClass("fonticon");aH.prepend('<i class="fa fa-'+aO+' fonticon-icon"/>')}}if(!aI&&aF.tinyIcon){var aK=aG(aF.tinyIcon);if(aK){aI=true;aH.addClass("tinyicon");aH.css("background-image","url("+WH.getTinyIconUrl(aK)+")")}}if(!aI&&aF.icon){var aN=aG(aF.icon);if(aN){aI=true;aH.addClass("icon");aH.css("background-image","url("+aN+")")}}if(!aI&&aF.socketColor){var aP=aG(aF.socketColor);if(aP&&g_file_gems[aP]){aI=true;aH.addClass("socket-"+g_file_gems[aP])}}}if(aF.np){aH.attr("rel","np")}var aM=(aF["class"]||aF.className);if(aM){aH.addClass(aM)}if(aF.attributes){for(var aL in aF.attributes){if(aF.attributes.hasOwnProperty(aL)){aH.attr(aL,aF.attributes[aL])}}}};function Q(aF,aE){if(aE.noEvents){return}if(Platform.isTouch()){WH.aE(aF,"click",az.onRootNodeClick);return}if(aE.showAtCursor){if(aE.leftAndRightClick){aF.oncontextmenu=WH.rf;WH.aE(aF,"click",function(aG){if(aG.which===2){return}ai.call(this,aG);aG.preventDefault()});WH.aE(aF,"mouseup",R.bind(this,ai))}else{if(aE.rightClick){aF.oncontextmenu=WH.rf;WH.aE(aF,"mouseup",R.bind(this,ai))}else{WH.aE(aF,"click",ai)}}}else{if(aE.showAtElement){if(aE.leftAndRightClick){aF.oncontextmenu=WH.rf;WH.aE(aF,"click",function(aG){if(aG.which===2){return}o.call(this,aG);aG.preventDefault()});WH.aE(aF,"mouseup",R.bind(this,o));WH.aE(aF,"mouseleave",G)}else{if(aE.rightClick){aF.oncontextmenu=WH.rf;WH.aE(aF,"mouseup",R.bind(this,o));WH.aE(aF,"mouseleave",G)}else{WH.aE(aF,"click",function(aG){if(aG.which===2||this.classList.contains("open")){return}o.call(this,aG);aG.preventDefault()});WH.aE(aF,"mouseleave",G)}}}else{WH.aE(aF,"mouseenter",o);WH.aE(aF,"mouseleave",G)}}}function aA(){L(mn_events_holidays,mn_events_urls);L(mn_events_recurring,mn_events_urls);au(mn_forums,"/forums?board=",{useSimpleIds:true});au(mn_garrisons,null,{useLastUrl:true});Menu.findItem(mn_lists,[101])[g]=WH.Profiler.create;$(window).keyup((function(aG,aH){if(aH.keyCode==27){aG()}}).bind(null,at));var aF=$('<div class="menu"><a href="#"><span>ohai</span></a></div>').css({left:"-1000px",top:"-1000px"}).appendTo(document.body);var aE=aF.children("a").outerHeight();aF.remove();if(aE&&!isNaN(aE)&&aE!=W){W=aE}aA=function(){}}function aD(aF){var aE=v.getItemOptions(aF);if(typeof aE.regenerateMenuItem==="function"){WH.cO(aF,aE.regenerateMenuItem(aF))}if(aE.checkedUrl&&location.href.match(aE.checkedUrl)){aF.checked=true}if(typeof aE.checkedFunc=="function"){aF.checked=aE.checkedFunc(aF)}}function af(aH){if(aH.onBeforeShow){aH.onBeforeShow(aH)}for(var aG=0,aE=aH.length;aG<aE;aG++){if(!(aH[aG]instanceof Array)){return}var aF=v.getItemOptions(aH[aG]);if(aF.onBeforeShow){aF.onBeforeShow(aH[aG])}}}function X(aE){while(r.openLinks[aE]){r.openLinks[aE].classList.remove("open");r.openLinks[aE]=null;aE++}}function ap(aI,aH,aF,aG){var aE;if(!isNaN(aH)&&r.divCache[aH]){aE=r.divCache[aH];aE.children().detach();aE.css({left:0,top:0});ax(aE[0],aI);if(aF.padded&&WH.isRetailTree()){aE.addClass("menu-padded")}return aE}aE=$("<div></div>").data("depth",aH).mouseenter(H.bind(null,aH)).mouseleave(d).delegate("a","mouseenter",{depth:aH},aq).delegate("a","click",N);ax(aE[0],aI);if(aF.padded&&WH.isRetailTree()){aE.addClass("menu-padded")}if(aG!==true&&!isNaN(aH)){r.divCache[aH]=aE}return aE}function D(aX,aF){var aQ=aX.length;var aK=$(window).height()-(E*2)-aj;var aR=Math.floor(Math.max(0,aK)/W);var a4=Math.floor(S/W);var aM;var aT=false;if(aQ>0){aM=aX[0].find("a").first();if(a4<aR&&!aM.data("noSoftColumns")){aT=true;aR=a4}}var aG=[];var aV=-1;if(aQ>0){if(aM.data("column")){aX.each(function(){var a5=$(this).find("a").first().data("column");if(a5){aV=a5-1}if(!aG[aV]){aG[aV]=$("<td/>",{"class":"menu-column"})}aG[aV].append(this)})}else{if(aR<aQ){var aH=Math.min(av,Math.ceil(aQ/aR));var aJ=Math.ceil(aQ/aH);var a1=0;var aU=aQ;var aW=0;while(aU>0){aV++;var aS=Math.min(aU,aJ);var aO=a1;var aN=aO+aS;if(aT){if(aW!=0){aN+=aW;aS+=aW;aW=0}if(aX[aN-1]&&aX[aN-1].hasClass(ad)){aN--;aS--;aW=1}if(aX[aN]&&!aX[aN].hasClass(ad)){if(aX[aN-2]&&aX[aN-1]&&aX[aN]&&aX[aN-2].hasClass(ad)&&!aX[aN-1].hasClass(ad)){if(aX[aN+1]&&aX[aN+2]&&!aX[aN+1].hasClass(ad)&&aX[aN+2].hasClass(ad)){aN+=2;aS+=2}else{aN-=2;aS-=2;aW=2}}if(aX[aN]&&aX[aN+1].hasClass(ad)){aN+=1;aS+=1}if(aX[aN+1]&&aX[aN+2]&&!aX[aN+1].hasClass(ad)&&aX[aN+2].hasClass(ad)){aN+=2;aS+=2}}}aX.slice(aO,aN).each(function(){if(!aG[aV]){aG[aV]=$("<td/>",{"class":"menu-column"})}aG[aV].append(this)});a1+=aS;aU-=aS}}}}if(aG.length){var aP=WH.ce("div",{className:"menu-outer"});var a2=WH.ce("div",{className:"menu-inner"});var a0=WH.ce("table",{className:"menu-columns"});var aE=WH.ce("tbody");var a3=$("<tr/>");WH.ae(aP,a2);WH.ae(a2,a0);WH.ae(a0,aE);for(var aY=0,aL;aL=aG[aY];aY++){a3.append(aL)}a3.appendTo(aE);return{columns:aG.length,menu:aP,padded:aF}}var aI=$('<div class="menu-outer"></div>');var aZ=$('<div class="menu-inner"></div>');aX.each(function(){aZ.append(this)});aI.append(aZ);return{menu:aI,padded:aF}}function V(aE){aD(aE);var aL=$("<div/>",{"class":"menu-item"});var aF=$("<a/>").appendTo(aL);aE.$a=aF;aF.data("menuItem",aE);let label=v.getLabel(aE);let addItemLabel=true;if(aE[aa]&&aE[aa].spacer){aF.addClass(J);aF.addClass(F);addItemLabel=false}else{if(P(aE)){aF.addClass(ad);aF.text(label);addItemLabel=false}v.linkifyItem(aE,aF)}v.updateItem(aE);if(aE[aa]){if(aE[aa].column){aF.data("column",aE[aa].column)}if(aE[aa].noSoftColumns){aF.data("noSoftColumns",aE[aa].noSoftColumns)}if(aE[aa].modifyTooltip){aF.get(0)._fixTooltip=aE[aa].modifyTooltip}if(aE[aa].extraActions){for(var aJ=0,aK=aE[aa].extraActions.length;aJ<aK;aJ++){var aI=aE[aa].extraActions[aJ];var aG=WH.ce("a");if(aI.fontIcon){aG.classList.add("fa");if(aI.fontIcon.indexOf(" ")!==-1){var aO=aI.fontIcon.split(" ");for(var aN=0,aH=aO.length;aN<aH;aN++){aG.classList.add("fa-"+aO[aN])}}else{aG.classList.add("fa-"+aI.fontIcon)}}else{aG.classList.add("fa");aG.classList.add("fa-circle");aG.classList.add("fa-size-s")}if(typeof aI.url==="string"){aG.href=aI.url}else{if(typeof aI.callback==="function"){WH.aE(aG,"click",aI.callback)}}if(typeof aI.tooltipText!=="undefined"){WH.Tooltip.simple(aG,aI.tooltipText,typeof aI.tooltipClass!=="undefined"?aI.tooltipClass:"q2",true)}for(var aM in aI){if(!aI.hasOwnProperty(aM)){continue}switch(aM){case"callback":case"fontIcon":case"tooltipClass":case"tooltipText":case"url":break;default:aG.setAttribute(aM,aI[aM])}}aL.append(aG)}}}if(addItemLabel){let $span;if(typeof label=="object"&&label!=null&&("tagName"in label)&&label.tagName.toLowerCase()==="span"){let subSpan;while(subSpan=label.getElementsByTagName("span")[0]){let div=document.createElement("div");div.className=subSpan.className;$.extend(div.style,subSpan.style);div.style.display="inline";let node;while(node=subSpan.firstChild){node.parentNode.removeChild(node);div.appendChild(node)}subSpan.parentNode.insertBefore(div,subSpan);subSpan.parentNode.removeChild(subSpan)}$span=$(label).clone()}else{$span=$("<span></span>");$span.text(label)}$span.appendTo(aF);if(v.getSubmenu(aE)){$span.addClass("hassubmenu")}}return aL}function aB(aG,aE){var aF=f(aG);if(r.menuItemsCache[aF]){return r.menuItemsCache[aF]}let nextHeading;let menuItems=[];$.each(aG,function(aI,aJ){if(!(aJ instanceof Array)){aJ=["","Error: Invalid menu item",null,null,{className:"q10"}];WH.error("Trying to render an invalid menu item.",typeof aJ)}if(!T(aJ)){return}var aK=V(aJ);if(!aE&&P(aJ)){nextHeading=aK;return}if(nextHeading){menuItems.push(nextHeading);nextHeading=null}menuItems.push(aK)});var aH=$(menuItems);r.menuItemsCache[aG]=aH;return aH}function L(aI,aE){for(var aF=0,aG;aG=aI[aF];aF++){if(typeof aG[g]!=="string"){continue}var aH=aG[g].replace(/^\//,"");if(aE[aH]){aG[g]="/"+aE[aH]}}}function h(aF,aE,aG){X(0);A(aF,0,aE,aG);t(1)}function A(aK,aJ,aE,aL,aG){aA();if(typeof aK=="function"){aK=aK()}af(aK);var aF=C(aK,aJ);aF.appendTo(document.body);var aI=!ac(aJ);r.visibleMenus[aJ]=aF;for(let i=0,$visibleMenu;$visibleMenu=r.visibleMenus[i];i++){$visibleMenu.attr("data-reverse-tier",aJ-i+1)}let pos=aJ===0?p(aF,aJ,r.showingHeaderMenu,aE,aL):ao(aF,aJ,r.showingHeaderMenu,aG);aF.css({position:r.showingHeaderMenu?"fixed":"absolute",left:pos.x+"px",top:pos.y+"px"});var aH=WH.createRect(pos.x,pos.y,aF.width(),aF.height());WH.WAS.intersect(aH,true);if(aI){aF.addClass("animated-reveal")}aF.show()}function ah(aF,aE){aF.splice(0,aF.length);$.each(aE,function(aG,aI){if(aI[U]){aF.push([aI[z],aI[U],aI[g],undefined,aI[aa]])}var aH=v.getSubmenu(aI);if(aH){$.each(aH,function(aJ,aK){aF.push(aK)})}})}function an(aE,aF){return WH.inArray(aE,aF,function(aG){return aG[z]})}function au(aH,aF,aE,aG){if(typeof aG!=="number"){aG=0}aE=aE||{};if(typeof aE.hash==="string"&&aE.hash.indexOf("#")!==0){aE.hash="#"+aE.hash}$.each(aH,function(aJ,aL){if(aL===undefined||P(aL)){return}if(aE.uniqueUrls&&aE.uniqueUrls[aL[z]]){aL[g]=aE.uniqueUrls[aL[z]]}else{if(aL[g]==null){if(aE.idReplacements&&aE.idReplacements[aL[z]]){aL[g]=aF+aE.idReplacements[aL[z]]+(aE.hash||"")}else{aL[g]=aF+aL[z]+(aE.hash||"")}}}var aK=v.getSubmenu(aL);if(aK){var aI=true;var aM=aF;if(aE.useSimpleIds){aI=false}else{if(aE.useSimpleIdsAfter!=null&&aG>=aE.useSimpleIdsAfter){aI=false}else{if(aE.useLastUrl){aI=false;aM=aL[g]+((aL[g].indexOf("=")>=0)?".":"=")}}}if(aI){aM+=aL[z]+"."}au(aK,aM,aE,aG+1)}})}function p(aM,aJ,aI,aO,aN){var aL=WH.getViewport();var aK=aM.width();var aG=aM.height();var aH=aK+al;var aE=aG+aj;var aF=(aO!=null&&aN!=null);if(aF){if(aN+aE>aL.b){aN=Math.max(aL.t,aL.b-aE)}}else{let offset=WH.getOffset(r.menuOpener,aI);aO=offset.left;aN=offset.top+r.menuOpener.offsetHeight;if(r.menuOpener.classList.contains("imitation-select")){aO-=2}if(aN+aE>aL.b&&offset.top>=aE){aN=offset.top-aE}}if(aO+aH>aL.r){aO=Math.max(aL.l,aL.r-aH)}return{x:aO,y:aN}}function ao(aM,aJ,aI,aG){var aL=WH.getViewport();var aK=aM.width();var aF=aM.height();var aH=aK+al;var aE=aF+aj;let menuItemLink=r.openLinks[aJ-1];let offset=WH.getOffset(menuItemLink,aI);var aO=offset.left+menuItemLink.offsetWidth-5;var aN=offset.top-2;if(WH.isClassicTree()||WH.isBurningCrusadeTree()){if(WH.Theme.isClassic()&&aG){aN--}else{if(WH.Theme.isThottbot()){aN+=2}}}if(aO+aH>aL.r){aO=Math.max(aL.l,offset.left-aK)}if(aN+aE>aL.b){aN=Math.max(aL.t,aL.b-aE)}return{x:aO,y:aN}}function f(aE){if(aE.uniqueId==null){aE.uniqueId=r.nextUniqueId++}return aE.uniqueId}function l(aF){var aE=v.getItemOptions(aF);if(aE&&aE.requiredAccess&&!WH.User.hasRole(aE.requiredAccess)){return false}return true}function c(aE){if(!aE||!aE.length){return false}for(let i=0,len=aE.length;i<len;i++){if(!P(aE[i])&&T(aE[i])){return true}}return false}function at(){am(false);if(Platform.isTouch()){az.closeAllMenus();return}if(r.menuOpener){r.menuOpener.classList.remove("open")}t(0)}function t(aE){while(r.visibleMenus[aE]){r.visibleMenus[aE].stop().hide();r.visibleMenus[aE]=null;++aE}if(!r.visibleMenus[0]){aw();WH.WAS.restoreHidden()}}function ae(aG){var aE=[];var aF;if(!P(aG[0])){aF=[];aE.push([0,"",null,aF])}$.each(aG,function(aH,aI){if(P(aI)){aF=[];aE.push([aI[z],aI[U],aI[g],aF,aI[aa]])}else{if(aF){aF.push(aI)}else{aE.push(aI)}}});return aE}function P(aE){return aE[z]==null||(aE[aa]&&aE[aa].heading)}function T(aG){if(!(aG instanceof Array)){return false}if(!l(aG)){return false}if(aG[aa]){if(aG[aa].hide){return false}if(aG[aa].requiredTrees&&!aG[aa].requiredTrees.includes(WH.getDataTree())){return false}if(typeof aG[aa].condition==="function"){if(!aG[aa].condition()){return false}}}if(!aG.checkingVisibility){var aF=v.getSubmenu(aG);if(aF){aG.checkingVisibility=true;var aE=c(aF);delete aG.checkingVisibility;if(!aE&&false){return false}}}return true}function ac(aE){return r.visibleMenus[aE||0]!=null}function aw(){if(r.currentMenu&&r.currentMenu.onHide){r.currentMenu.onHide.call(r.menuOpener,r.currentMenu)}r.currentMenu=null;r.menuOpener=null}function N(aG){var aH=$(this);var aF=aH.data("menuItem");if(!aF){return}var aE=v.getItemOptions(aF);if(aE.onClick){aE.onClick(aG)}}function aq(aH){clearTimeout(r.timer.hideMenu);clearTimeout(r.timer.showMenu);var aI=aH.data.depth;X(aI);var aG=$(this).data("menuItem");if(aG){var aF=v.getSubmenu(aG);if(aF){this.classList.add("open");r.openLinks[aI]=this;var aE=function(aM,aN,aJ){var aL=WH.closest(aJ,".menu-item");var aK=aL?aL.matches(":first-child"):false;A(aM,aN+1,undefined,undefined,aK);t(aN+2)};if(!ac(aI+1)){r.timer.showMenu=setTimeout(aE.bind(this,aF,aI,this),K)}else{aE(aF,aI,this)}return}}t(aI+1)}function d(){clearTimeout(r.timer.hideMenu);clearTimeout(r.timer.showMenu);r.timer.hideMenu=setTimeout(at,Y)}function H(aH,aG){clearTimeout(r.timer.hideMenu);var aF=!aG.target.className;if(!aF){var aE=aG.target.className.split(" ");aF=aE.indexOf("open")==-1&&aE.indexOf("hassubmenu")==-1&&aE.indexOf("fonticon-icon")==-1}if(aF){clearTimeout(r.timer.hideMenu);clearTimeout(r.timer.showMenu);X(aH);t(aH+1)}}function ai(aF){clearTimeout(r.timer.hideMenu);clearTimeout(r.timer.showMenu);var aE=$(this);var aG=aE.data("menu");am(WH.closest(this,".header")!==undefined);r.menuOpener=this;r.currentMenu=aG;v.showAtCursor(aE.data("menu"),aF);u(this,aG,aF)}function R(aE,aF){aF=WH.normalizeEvent(aF);if(aF._button==3||aF.shiftKey||aF.ctrlKey){aE.call(this,aF)}}function G(aF,aE){clearTimeout(r.timer.hideMenu);clearTimeout(r.timer.showMenu);if(ac()){if(aE===true){at()}else{r.timer.hideMenu=setTimeout(at,Y)}}}function o(aE){clearTimeout(r.timer.hideMenu);clearTimeout(r.timer.showMenu);let showMenu=(function(aF){let $node=$(this);let menu=$node.data("menu");am(WH.closest(this,".header")!==undefined);ak(menu,this);u(this,menu,aF)}).bind(aE.currentTarget||aE.target,aE);if(ac()){showMenu()}else{r.timer.showMenu=setTimeout(showMenu,K)}}function u(aF,aG,aE){if(aG.onShow){aG.onShow.call(aF,aG,aE)}}function Z(aF,aG){if(!(aF instanceof Array)){return null}var aE=[];let nextHeading;for(let i=0,menuItem;menuItem=aF[i];i++){let zulMenuItem=aC(menuItem,aG);if(!zulMenuItem){continue}if(P(menuItem)){nextHeading=zulMenuItem;continue}if(nextHeading){aE.push(nextHeading);nextHeading=null}aE.push(zulMenuItem)}return aE}function aC(aH,aJ){var aF=aH[aa]||{};if(aF.zulHide){return null}if(aH[aa]&&aH[aa].requiredAccess&&!WH.User.hasRole(aH[aa].requiredAccess)){return null}var aI={type:"link"};var aE="";if(P(aH)){aI.heading=true}aI.text=aH[U];if(typeof aI.text!="string"){aI.text=""}aI.name="null";if(aH[aa]&&aH[aa].hasOwnProperty("zulName")){aI.name=aH[aa].zulName}if(aF.zulNoHref){}else{if(typeof aF.zulHref=="function"){aI.href=aF.zulHref}else{switch(typeof aH[g]){case"string":aI.href=Menu.getItemUrl(aH);break;case"function":aI.click=aH[g];break}}}if(aH[aa]){if(aF.zulGetMobileMenu){if(!aI.menu){aI.menu={}}aI.menu.mobile=aF.zulGetMobileMenu}if(aF.fontIcon){aI.fontIcon=aF.fontIcon}if(aF.icon){aI.imageIcon={url:aF.icon,enlargeIcon:true}}if(aF.tinyIcon){aI.imageIcon={url:WH.getTinyIconUrl(aF.tinyIcon),enlargeIcon:true}}if(aF.armory){aI.imageIcon={url:aF.armory,enlargeIcon:true};aE=(aE?" ":"")+"zul-bar-icon-armory"}if(typeof aI.imageIcon=="object"&&typeof aI.fontIcon!="undefined"){delete aI.fontIcon}if(aH.checked){aI.checked=true}else{if(aF.checkedUrl&&location.href.match(aF.checkedUrl)){aI.checked=true}else{if(typeof aF.checkedFunc=="function"){aI.checked=aF.checkedFunc(aH)}else{if(aF.checked){aI.checked=true}}}}}var aG=v.getSubmenu(aH);if(aG){if(!aI.menu){aI.menu={}}aI.menu.mobile=Z(aG)}if(aE){aI.className=aE}if(aJ){aI.condition=aJ}else{if(aF.zulCondition){aI.condition=aF.zulCondition}}return aI}function C(aI,aH,aG,aE){var aF=aH===0?aI.padded:false;if(!aI||aI.length===0){aI=[["","Error: Menu is empty",null,null,{className:"q10"}]];WH.error("Trying to render an empty menu.")}var aK=aB(aI,aE);var aJ=D(aK,aF);let $div=ap(aI,aH,aJ,aG);$div.append(aJ.menu);return $div}function ax(aE,aF){aE.className="menu";if(aF.classes){for(let i=0,len=aF.classes.length;i<len;i++){aE.classList.add(aF.classes[i])}}}function am(aE){if(r.showingHeaderMenu===aE){return}r.showingHeaderMenu=aE;document.body.dataset.showingHeaderMenu=JSON.stringify(aE)}function ak(aF,aE){if(r.menuOpener){r.menuOpener.classList.remove("open")}r.currentMenu=aF;r.menuOpener=aE;aE.classList.add("open");h(aF)}function ab(aF,aE,aG){clearTimeout(r.timer.hideMenu);clearTimeout(r.timer.showMenu);h(aF,aE,aG)}function m(aI,aF){if(!(aI instanceof Array)){WH.error("Trying to do a menu sort on a non-array.",typeof aI,aI);return}aI.sort(function(aK,aJ){return WH.stringCompare(aK[U],aJ[U])});if(aF){for(var aE=0,aH;aH=aI[aE];aE++){var aG=v.getSubmenu(aH);if(aG){Menu.sort(aG,aF)}}}}function I(aF,aE){let implodedMenu=ae(aF);$.each(implodedMenu,function(aG,aH){var aH=v.getSubmenu(aH);if(aH){m(aH,aE)}});ah(aF,implodedMenu)}function O(aF,aE){$.each(aE,function(aG,aM){var aL;if(aM[aM.length-1]==="*"){if(aM.length>1){var aI=v.findItem(aF,aM.slice(0,aM.length-1));aL=v.getSubmenu(aI)}else{aL=aF}if(aL instanceof Array){for(var aJ=0,aK;aK=aL[aJ];aJ++){var aH=v.getSubmenu(aK);if(aH){v.sort(aH)}}}else{WH.error("Could not find submenus to sort.",aF,aE)}}else{aL=v.findItem(aF,aM);if(aL){var aH=v.getSubmenu(aL);if(aH){v.sort(aH)}}}})}function M(aF,aE){$.each(aF,function(aG,aH){w(aH,aE)})}function w(aF,aG){aG(aF);var aE=v.getSubmenu(aF);if(aE){M(aE,aG)}}var az=new function(){var aN={container:null,containerArrow:null,currentMenu:null,menuOpener:null,path:[]};this.add=function(aP,aQ){var aO=$(aP);aO.data("menu",aQ);aO.click(az.onRootNodeClick)};this.closeAllMenus=function(){$(".header-nav dt > a.active").removeClass("active");$("#header-nav-subnav").removeClass("touch-menu").empty();if(aN.container){aN.container.empty().css({display:"none"})}aN.currentMenu=null;aN.path=[];aN.containerArrow=null;if(aN.menuOpener){aN.menuOpener.removeClass("touch-menu-active")}aN.menuOpener=null;aw()};this.onNodelessClick=function(aP,aO){r.currentMenu=aP;r.menuOpener=null;if(aN.menuOpener){aN.menuOpener.removeClass("touch-menu-active");aN.menuOpener=null}aN.currentMenu=aP;am(false);aG(aP,{atPosition:[aO.pageX,aO.pageY+5]});u(null,aP,aO);if(aO){aO.preventDefault();aO.stopPropagation()}};this.onRootNodeClick=function(aQ,aS){var aO=$(this);if(aO.hasClass("active")||aO.hasClass("touch-menu-active")){az.closeAllMenus();if(aQ){aQ.preventDefault();aQ.stopPropagation()}return}var aR=aO.parent();var aP=aO.data("menuItem");am(WH.closest(this,".header")!==undefined);if(!aS){aS=aO.data("menu")}if(typeof aS==="function"){aS=aS()}r.currentMenu=aS;r.menuOpener=this;if(aN.menuOpener){aN.menuOpener.removeClass("touch-menu-active");aN.menuOpener=null}if(aR[0].tagName==="DT"){az.closeAllMenus();aO.addClass("active");aN.currentMenu=null;aN.path=[aP[z]];aG(aS)}else{aN.menuOpener=aO;aN.menuOpener.addClass("touch-menu-active");aN.currentMenu=aS;aN.path=aP?[aP[z]]:[null];aG(aS,{atElement:aO})}u(this,aS,aQ);if(aQ){aQ.preventDefault();aQ.stopPropagation()}};function aJ(aT,aX,aY){var aP=aT.menu||Menu.getMenu();var aV,aQ,aS,aR;if(aY){for(aS in aN.path){aV=aN.path[aS];for(aR in aP){aQ=aP[aR];if(aQ[z]==aV){aP=v.getSubmenu(aQ);break}}}aN.path=aN.path.concat(aX)}var aO,aW,aU;for(aS in aX){aV=aX[aS];aO=null;for(aR in aP){aQ=aP[aR];if(aQ[z]==aV){aO=aQ;break}}if(!aO){break}aW=WH.ce("li");aU=WH.ce("a");aU.href="javascript:";v.linkifyItem(aO,$(aU));aU.innerHTML=aO[U];aU.onclick=aI;WH.ae(aW,aU);WH.ae(aT,aW)}}function aM(aR,aS){var aP=null,aQ;for(var aO in aS){aQ=aS[aO];if(!T(aQ)){continue}if(P(aQ)){aE(aR,aQ);aP=aH(aR);continue}if(!aP){aP=aH(aR)}WH.ae(aP,aL(aQ))}}function aE(aP,aO){let link=WH.ce("a");let $link=$(link);aO.$a=$link;$link.data("menuItem",aO);v.linkifyItem(aO,$link);v.updateItem(aO);$link.text(aO[U]);WH.ae(aP,WH.getMajorHeading($link.get(0),2))}function aH(aP){var aO=WH.ce("ul");WH.ae(aP,aO);return aO}function aL(aO){V(aO);aD(aO);var aQ=$("<a></a>");aO.$a=aQ;aQ.data("menuItem",aO);var aR=v.linkifyItem(aO,aQ);v.updateItem(aO);var aT;var aW=v.getLabel(aO),aX,aS,aP;if((typeof aW=="object")&&("tagName"in aW)&&(aW.tagName.toLowerCase()=="span")){while(aX=aW.getElementsByTagName("span")[0]){aS=document.createElement("div");aS.className=aX.className;$.extend(aS.style,aX.style);aS.style.display="inline";while(aP=aX.firstChild){aP.parentNode.removeChild(aP);aS.appendChild(aP)}aX.parentNode.insertBefore(aS,aX);aX.parentNode.removeChild(aX)}aT=$(aW)}else{aT=$("<span></span>");aT.text(v.getLabel(aO))}aT.appendTo(aQ);var aV=WH.ce("li");aQ.appendTo(aV);if(v.getSubmenu(aO)){if(aR){aQ.addClass("has-sub");aT.addClass("has-sub");var aU=WH.ce("a");aU.className="view-sub";aU.href="javascript:";aU.onclick=aK;$(aU).data("menuItem",aO);WH.ae(aV,aU)}else{aQ.addClass("only-sub").data("menuItem",aO).click(aK);aT.addClass("only-sub")}}return aV}function aK(){var aO=$(this).data("menuItem");var aP=$(".touch-menu-breadcrumb");if(aP.length){aJ(aP.get(0),[aO[z]],true)}else{aN.path.push(null)}aF(v.getSubmenu(aO),{animate:this})}function aG(aQ,a3){if(!a3){a3={}}var aR;if(a3.atElement||a3.atPosition){var aV=false;if(!aN.container){aN.container=$("<div/>",{"class":"floating-touch-menu-container",css:{display:"none"}});aN.container.appendTo("body")}else{var a0=aN.container.offset();aV=a0.top}aN.container.empty();aR=$("<div/>",{"class":"floating-touch-menu"});aN.containerArrow=$("<div/>",{"class":"floating-touch-menu-arrow"});aR.append(aN.containerArrow).appendTo(aN.container);var a2=$("<a/>",{"class":"floating-touch-menu-closer"});a2.click(az.closeAllMenus);aN.container.append(a2);var aX=a3.atElement?a3.atElement.offset():{left:a3.atPosition[0],top:a3.atPosition[1]};var aZ=aX.top;if(a3.atElement){aZ+=a3.atElement.outerHeight()}var aW=parseInt(aZ+7);var aP=aW!=aV;aN.container.css({display:"block",top:(aP?aW-10:aW)+"px"});var aT=aX.left;if(a3.atElement){aT+=(a3.atElement.outerWidth()/2)}aN.containerArrow.css({display:"block",left:parseInt(aT-10)+"px"});if(aP){aN.container.css({opacity:"0"});setTimeout(function(){aN.container.animate({opacity:"1",top:"+=10px"})},0)}}else{aN.container=null;aN.containerArrow=null;aR=$("#header-nav-subnav");if(!aR.length){aR=$("<div/>",{"class":"header-nav-subnav",id:"header-nav-subnav"});aR.insertAfter(".header-nav")}aR.empty()}var aS=false;if((!a3.atElement&&!a3.atPosition)||(a3.atElement&&a3.atElement.data("menuItem"))){aS=true}if(aS){if(aN.container){aN.container.addClass("has-breadcrumb")}var aU=WH.ce("ul");aU.className="touch-menu-breadcrumb";if(a3.atElement){var a1=$(a3.atElement);if(a1.data("parentMenu")){aU.menu=$(a3.atElement).data("parentMenu")}else{if(a1.html()){aU.menu=[[0,a1.html(),null,aQ]]}}}aJ(aU,aN.path)}else{if(aN.container){aN.container.removeClass("has-breadcrumb")}}if(aN.container){if(a3.atElement&&a3.atElement.parents("div.breadcrumb")){aN.container.addClass("from-breadcrumb")}else{aN.container.removeClass("from-breadcrumb")}}var aO=WH.ce("div");aO.className="touch-menu-items";aO.style.left="0%";aF(aQ,{target:aO});var aY=WH.ce("div");aY.className="touch-menu-items-wrapper";WH.ae(aY,aO);if(aS){aR.append(aU)}aR.append(aY).attr("class","touch-menu")}function aI(){var aS=$(this).parent();if(aS.is(":last-child")){return true}var aQ=aS.index();var aR=Menu.getMenu();for(var aP=0;aP<=aQ;aP++){for(var aO in aR){if(aR[aO][z]==aN.path[aP]){aR=v.getSubmenu(aR[aO]);break}}}aS.nextAll().remove();aF(aR,{reverse:aN.path.length-aQ-1,targetPathIndex:aQ});aN.path=aN.path.slice(0,aQ+1);return false}function aF(aT,aR){if(aR.animate){var aS=$(".touch-menu-items");$(aR.animate).parent().addClass("chosen");aS.addClass("chosen");setTimeout(function(){var aW=WH.ce("div");aW.className="touch-menu-items";var aY=(aN.path.length-2)*-10+2;aW.style.left=aY+"%";aM(aW,aT);var aZ=$(aW);var aX=aS.last();aX.after(aZ);var a0=aX.height();aS.each(function(){var a1=$(this);if(a1.data("height")){a1.css({height:"1px"}).animate({left:"-=12%"})}else{a1.data("height",a1.height()).css("height",a1.height()+"px").animate({left:"-=12%",height:"1px"})}});var aV=aZ.height();aZ.css("height",a0+"px").animate({left:"-=12%",height:aV+"px"})},100)}else{if(aR.reverse){var aU=$(".touch-menu-items");var aO=$(aU.get(aR.targetPathIndex));var aQ=aR.reverse*12;var aP=aU.last();aO.css({height:aP.height()+"px"}).animate({left:"+="+aQ+"%",height:aO.data("height")+"px"},{complete:function(){$(this).css("height","")}});aP.css({height:"1px"});aU.not(aO).animate({left:"+="+aQ+"%"},{complete:function(){aO.removeClass("chosen");$(".chosen",aO).removeClass("chosen");aO.nextAll().stop().remove()}})}else{if(aR.target){$(aR.target).empty();aM(aR.target,aT)}}}}};v.addTouch=az.add};var MENU_IDX_NAME=Menu.ITEM_NAME;var MENU_IDX_LABEL=Menu.ITEM_LABEL;var MENU_IDX_URL=Menu.ITEM_URL;var MENU_IDX_OPT=Menu.ITEM_OPTIONS;WH.Notifications=new function(){const z=this;this.GA_ACTION_GENERAL="General";this.GA_ACTION_DELIVERY_WEB_PUSH="Web Push Delivery Method";this.GA_ACTION_EVENT_NEWS_PUBLISHED="News Published Events";this.GA_CATEGORY="Notifications";const q="notifications-dialog";const v="notifications-error-seen";const d=1;const B=2;const K=3;const f=4;const D=5;const J={1:"allNewsPosts",2:"classicWowNewsOnly",3:"nonClassicNewsOnly",4:"devNewsOnly",5:"otherGamesOnly"};const w=[d,B,K,f,D];const G="/js-local/WH/ServiceWorkers/Notifications/WebPush.js";let my={newSubInfo:null,postSubscriptionCallback:null};this.browserSupportsNotifications=function(){return!!(window.Promise&&navigator.serviceWorker&&window.PushManager)};this.getNewsGroupsOptions=function(N,M){let fragment=document.createDocumentFragment();for(let i=0;i<w.length;i++){let group=w[i];let checked=M.indexOf(group)!==-1;let checkbox=WH.ce("input",{name:"newsGroups["+N+"]["+group+"]",type:"checkbox",checked:checked});checkbox.dataset.subId=N.toString();checkbox.dataset.group=group.toString();WH.aE(checkbox,"click",H.bind(null,N));if(i!==0){WH.ae(fragment,WH.ce("br"))}let label=WH.ce("label",undefined,checkbox);WH.ae(label,WH.ct(WH.TERMS[J[group]]));WH.ae(fragment,label)}return fragment};this.isBrowserDenied=function(){return Notification.permission==="denied"};this.getNewSubInfo=function(){return my.newSubInfo};this.getSubscription=function(){return navigator.serviceWorker.getRegistrations().then(function(M){for(let i=0;i<M.length;i++){let reg=M[i];WH.debug(reg,new RegExp(G));if(reg.active.scriptURL.match(new RegExp(G))){return reg.pushManager.getSubscription()}}return null})};this.enableNewsNotifications=function(){L()};this.setPostSubscriptionCallback=function(M){my.postSubscriptionCallback=M};this.showSubscriptionListError=function(){p("subscription-list-error",WH.TERMS.notificationsSubscriptionListFailed_tip)};function g(M){let buttonsSelector="."+q+"-buttons";let buttons=WH.qsa(buttonsSelector+" .btn");for(let i=0;i<buttons.length;i++){buttons[i].disabled=true}let button=WH.qs(buttonsSelector+"-"+M);if(button){button.classList.add("working")}}function m(){WH.LocalStorage.remove(v)}function I(){WH.de("."+q)}function H(M,N){if(N.target.checked===false){return}let inputs=WH.qsa('input[data-sub-id="'+M+'"]');let isAll=parseInt(N.target.dataset.group)===d;for(let i=0;i<inputs.length;i++){let group=parseInt(inputs[i].dataset.group);if(isAll&&group!==d){inputs[i].checked=false}else{if(!isAll&&group===d){inputs[i].checked=false}}}}function F(){if(WH.PageMeta.page==="account"){WH.debug("Notifications onboarding disabled on this page (legacy mechanism).");return}if(WH.getPageData("notifications.disable-onboarding")){WH.debug("Notifications onboarding disabled on this page.");return}if(!WH.LocalStorage.isSupported()){WH.Track.nonInteractiveEvent(z.GA_CATEGORY,z.GA_ACTION_DELIVERY_WEB_PUSH,"Browser does not support local storage");WH.error("This browser does not support local storage.");return}if(!z.browserSupportsNotifications()){WH.Track.nonInteractiveEvent(z.GA_CATEGORY,z.GA_ACTION_DELIVERY_WEB_PUSH,"Browser does not support notifications");WH.error("This browser does not support notifications.");return}if(WH.Notifications.Onboarding.isComplete()){WH.debug("Notifications onboarding already complete.");return}if(!window.Notification||Notification.permission==="denied"){WH.debug("Stage 2 is denied.");WH.Notifications.Onboarding.setComplete();return}if(WH.Notifications.Onboarding.isStage1Denied()){WH.debug("Stage 1 is denied.");return}if(WH.Notifications.Onboarding.isStage1Granted()){WH.debug("Stage 1 is granted.");u();return}h()}function o(){WH.debug("Sleeping stage 1.");WH.Track.interactiveEvent(z.GA_CATEGORY,z.GA_ACTION_EVENT_NEWS_PUBLISHED,"Temporarily closed notifications request");I();WH.Notifications.Onboarding.stage1Sleep()}function A(){WH.debug("Denying stage 1.");WH.Track.interactiveEvent(z.GA_CATEGORY,z.GA_ACTION_EVENT_NEWS_PUBLISHED,"Declined notifications request");I();WH.Notifications.Onboarding.stage1Deny();WH.Notifications.Onboarding.setComplete()}function L(M){WH.debug("Granting stage 1.");m();WH.Notifications.Onboarding.stage1Grant();if(M===true){WH.Track.interactiveEvent(z.GA_CATEGORY,z.GA_ACTION_EVENT_NEWS_PUBLISHED,"Accepted notifications request");g("accept");if(WH.getDataEnv()!==WH.dataEnv.MAIN||Locale.getId()!==LOCALE_ENUS){WH.Notifications.Onboarding.setComplete();let url=WH.Url.generate("/notifications/settings",{subdomain:WH.Url.getSubdomain(WH.dataEnv.MAIN,LOCALE_ENUS)});if(Locale.getId()!==LOCALE_ENUS){url+="?locale="+Locale.getId()}let form=WH.ce("form",{action:url,method:"POST"});let acceptInput=WH.ce("input",{type:"hidden",name:"accept",value:"1"});WH.ae(form,acceptInput);WH.ae(document.body,form);form.submit();return}}u()}function u(){var M=false;z.getSubscription().then(function(N){M=N===null;return navigator.serviceWorker.register(G)}).then(function(N){let serviceWorker=N.installing||N.waiting||N.active;if(serviceWorker){if(serviceWorker.state==="activated"){r(N,M)}else{serviceWorker.addEventListener("statechange",function(O){if(O.target.state==="activated"){r(N,M)}})}}})["catch"](function(N){I();WH.Track.nonInteractiveEvent(z.GA_CATEGORY,z.GA_ACTION_DELIVERY_WEB_PUSH,"Failed to register service worker");WH.error("Could not register push notifications service worker.",N);C()})}function p(M,N){WH.debug("show message",M,N);I();let wrapper=WH.ce("div",{className:q});wrapper.dataset.dialog=M;let messageDiv=WH.ce("div",{className:q+"-message"},WH.ct(N));WH.ae(wrapper,messageDiv);let buttons=WH.ce("div",{className:q+"-buttons"});WH.ae(wrapper,buttons);WH.ae(buttons,WH.ce("button",{className:"btn btn-site "+q+"-buttons-close",onclick:function(){WH.Track.interactiveEvent(z.GA_CATEGORY,z.GA_ACTION_DELIVERY_WEB_PUSH,"Closed "+M+"message");I()},type:"button"},WH.ct(WH.TERMS.close)));WH.ae(document.body,wrapper)}function c(M){WH.debug("Saving subscription...");return $.ajax({url:"/notifications/subscribe",method:"POST",type:"json",data:{subscription:JSON.parse(JSON.stringify(M)),platform:window.navigator.platform,userAgent:window.navigator.userAgent},success:function(N){WH.Track.nonInteractiveEvent(z.GA_CATEGORY,z.GA_ACTION_DELIVERY_WEB_PUSH,"Saved push subscription on backend");WH.debug("Save successful.");my.newSubInfo=N;WH.Notifications.Onboarding.setComplete()}})}function E(N,M){$.ajax({url:"/notifications/save-subscription-settings",method:"post",data:{id:my.newSubInfo.id,endpointUrl:my.newSubInfo.endpoint,name:N,newsGroups:M},complete:function(){WH.debug("Saved the sub name as",N);I();my.newSubInfo.name=N;my.newSubInfo.groups=M;t()}})}function l(){WH.debug("Showing ask-for-name popup");WH.Track.nonInteractiveEvent(z.GA_CATEGORY,z.GA_ACTION_DELIVERY_WEB_PUSH,"Requesting device name after subscribing");I();let wrapper=WH.ce("div",{className:q});wrapper.dataset.dialog="ask-for-name";let nameMessageText=WH.TERMS.notificationsDeviceName_tip;let nameMessage=WH.ce("div",{className:q+"-message"},WH.ct(nameMessageText));WH.ae(wrapper,nameMessage);let formWrapper=WH.ce("div",{className:q+"-form"});WH.ae(wrapper,formWrapper);let name=WH.ce("input",{name:"name",placeholder:WH.TERMS.name,type:"text"});WH.ae(formWrapper,name);let newsGroupsWrapper=WH.ce("div",{style:{verticalAlign:"top"}});WH.ae(newsGroupsWrapper,WH.ct(WH.TERMS.newsGroup+WH.TERMS.colon_punct));WH.ae(newsGroupsWrapper,WH.ce("br"));WH.ae(newsGroupsWrapper,z.getNewsGroupsOptions(0,[d]));WH.ae(formWrapper,newsGroupsWrapper);let buttons=WH.ce("div",{className:q+"-buttons"});WH.ae(wrapper,buttons);let save=function(){WH.Track.interactiveEvent(z.GA_CATEGORY,z.GA_ACTION_DELIVERY_WEB_PUSH,"Saved device name after subscribing");let newsGroups=[];let inputs=WH.qsa('input[name*="newsGroups"]',newsGroupsWrapper);for(let i=0;i<inputs.length;i++){let input=inputs[i];if(input.checked){newsGroups.push(input.dataset.group)}}E(name.value,newsGroups);g("save")};WH.aE(name,"keydown",function(M){if(M.key==="Enter"){save()}});let saveButton=WH.ce("button",{className:"btn btn-site "+q+"-buttons-save",onclick:save,type:"button"},WH.ct(WH.TERMS.save));WH.ae(buttons,saveButton);WH.ae(buttons,WH.ce("button",{className:"btn "+q+"-buttons-close",onclick:function(){WH.Track.interactiveEvent(z.GA_CATEGORY,z.GA_ACTION_DELIVERY_WEB_PUSH,"Closed device settings dialog after news sub");I();t()},type:"button"},WH.ct(WH.TERMS.close)));WH.ae(document.body,wrapper);name.focus()}function h(){if(WH.Notifications.Onboarding.isStage1Sleeping()){WH.debug("Stage 1: sleeping");return}WH.debug("Showing stage1 popup");WH.Track.nonInteractiveEvent(z.GA_CATEGORY,z.GA_ACTION_EVENT_NEWS_PUBLISHED,"Showing notifications request to user");let wrapper=WH.ce("div",{className:q});wrapper.dataset.dialog="stage-1";let message=WH.ce("div",{className:q+"-message"},WH.ct(WH.TERMS.enableNewsNotifications_tip));WH.ae(wrapper,message);let buttons=WH.ce("div",{className:q+"-buttons"});WH.ae(wrapper,buttons);let onAccept=L.bind(null,true);WH.ae(buttons,WH.ce("button",{className:q+"-buttons-accept btn btn-site",onclick:onAccept,type:"button"},WH.ct(WH.TERMS.accept)));WH.ae(buttons,WH.ce("button",{className:q+"-buttons-decline btn",onclick:A,type:"button"},WH.ct(WH.TERMS.decline)));WH.ae(buttons,WH.ce("button",{className:q+"-buttons-maybe-later btn",onclick:o,type:"button"},WH.ct(WH.TERMS.maybeLater)));WH.ae(document.body,wrapper)}function C(){if(WH.LocalStorage.get(v)==="1"){return}p("subscription-error",WH.TERMS.notificationsSubscriptionFailed_tip);WH.LocalStorage.set(v,"1")}function r(N,M){WH.debug("Subscribing with reg:",N);N.pushManager.subscribe({userVisibleOnly:true,applicationServerKey:WH.getPageData("notifications.public-key")}).then(function(O){if(!O){throw"Did not find subscription"}WH.debug("Got subscription:",O,JSON.stringify(O));return c(O)}).then(function(O){I();if(O&&WH.User.isLoggedIn()&&M){l()}else{t()}})["catch"](function(O){I();WH.Track.nonInteractiveEvent(z.GA_CATEGORY,z.GA_ACTION_DELIVERY_WEB_PUSH,"Failed to subscribe");WH.error("Could not subscribe user to push notifications.",O);C()})}function t(){if(my.postSubscriptionCallback){my.postSubscriptionCallback()}}WH.onLoad(F)};WH.Notifications.Onboarding=new function(){const g={complete:false,stage1SleepTime:0};const c="notifications.onboarding";const h="denied";const f="granted";this.isComplete=function(){if(WH.getCookies("notifications")==="1"||d().complete){WH.debug("Onboarding already complete, so setting both cookie and LS.");this.setComplete()}return d().complete};this.isStage1Denied=function(){return d().stage1Status===h};this.isStage1Granted=function(){return d().stage1Status===f};this.isStage1Sleeping=function(){return d().stage1SleepTime>WH.Time.unix()};this.reset=function(){WH.LocalStorage.remove(c)};this.setComplete=function(){WH.debug("Marking onboarding complete.");let data=d();data.complete=true;l(data);if(!WH.getCookies("notifications")){WH.setCookie("notifications",3650,"1","/",".wowhead.com")}};this.stage1Deny=function(){let data=d();data.stage1Status=h;l(data)};this.stage1Grant=function(){let data=d();data.stage1Status=f;l(data)};this.stage1Sleep=function(){let data=d();data.stage1SleepTime=WH.Time.unix()+(WH.Time.SEC_DAY*3);l(data)};this.stage1Wake=function(){let data=d();data.stage1SleepTime=0;l(data)};function d(){return JSON.parse(WH.LocalStorage.get(c))||g}function l(m){WH.LocalStorage.set(c,JSON.stringify(m))}};WH.Page=new function(){this.init=function(){for(let page in WH.Page){if(WH.Page.hasOwnProperty(page)&&WH.Page[page]._init){WH.Page[page]._init()}}}};WH.Paperdoll=new function(){this.BONUS_INDEX_START=11;this.EQUIPSET_MAX_BONUSES=16;this.TIMEWALKER_LEVEL_INDEX=28};WH.convertRawItemDataForPaperdoll=function(d){var f={};f.slotId=d[0];f.itemId=d[1];f.transmogId=d[9];f.hidden=d[10];f.rawBonuses=d.slice(WH.Paperdoll.BONUS_INDEX_START,WH.Paperdoll.BONUS_INDEX_START+WH.Paperdoll.EQUIPSET_MAX_BONUSES);f.bonuses=[];for(var c in f.rawBonuses){if(f.rawBonuses.hasOwnProperty(c)&&f.rawBonuses[c]){f.bonuses.push(f.rawBonuses[c])}}return f};WH.convertPaperdollItemDataToRaw=function(f){var c=[];for(var d=0;d<(WH.Paperdoll.BONUS_INDEX_START+WH.Paperdoll.EQUIPSET_MAX_BONUSES);d++){c[d]=0}c[0]=f.slotId;c[1]=f.itemId;c[9]=f.transmogId?f.transmogId:0;c[10]=f.hidden?f.hidden:0;c[WH.Paperdoll.BONUS_INDEX_START]=f.itemBonus?f.itemBonus:0;return c};const Platform=new function(){const h=this;this.known=false;this.initialized=false;this.initSteps={};let isMobile=false;let isTablet=false;let isForced=false;let agent=navigator.userAgent||navigator.vendor||window.opera;this.get=function(){if(this.isMobile()){return"mobile"}if(this.isTablet()){return"tablet"}return"pointer"};this.getBrowserInfo=function(m,l){m=m||navigator.userAgent;l=l||navigator.platform;let data={browser:{name:m,version:undefined},os:{name:l,version:undefined}};let version;if(/Edge/.test(m)){data.browser.name="Edge";if(version=m.match(/Edge\/(\d+[.]\d+)/)){data.browser.version=version[1]}}else{if(/MSIE/.test(m)){data.browser.name="Internet Explorer";if(version=m.match(/MSIE (\d+[.]\d+)/)){data.browser.version=version[1]}}else{if(/Chrome/.test(m)){data.browser.name="Chrome";if(version=m.match(/Chrome\/([\d.]+)/)){data.browser.version=version[1]}if(/CrOS/.test(m)){l="CrOS"}}else{if(/Opera/.test(m)){data.browser.name="Opera"}else{if(/Android/.test(m)){data.browser.name="Android Webkit Browser";data.os.name=(/Android\s[.\d]+/.exec(m)||[])[0]||data.os.name}else{if(/Firefox/.test(m)){data.browser.name="Firefox";if(version=m.match(/Firefox\/([.\d]+)/)){data.browser.version=version[1]}}else{if(/Safari/.test(m)){data.browser.name="Safari";if(/iPhone/.test(m)||/iPad/.test(m)||/iPod/.test(m)){data.os.name="iOS"}}}}}}}}if(!data.browser.version){if(version=m.match(/Version\/([.\d]+)/)){data.browser.version=version[1]}else{if(version=m.match(/Opera\/([.\d]+)/)){data.browser.version=version[1]}}}if(l==="MacIntel"||l==="MacPPC"){data.os.name="Mac OS X";if(version=m.match(/10([._\d]+)/)){data.browser.version=version[1];if(/[_]/.test(data.os.version)){data.os.version=data.os.version.split("_").join(".")}}}else{if(l==="CrOS"){data.os.name="ChromeOS"}else{if(l==="Win32"||l==="Win64"){data.os.name="Windows"}else{if(!data.os.name){if(/Android/.test(m)){data.os.name="Android"}else{if(/Linux/.test(l)){data.os.name="Linux"}else{if(/Windows/.test(m)){data.os.name="Windows"}}}}}}}return data};this.getViewportHeight=function(){return this.getViewportSize().height};this.getViewportSize=function(){let element=window;let prefix="inner";if(!("innerWidth"in window)){prefix="client";element=document.documentElement||document.body}return{width:element[prefix+"Width"],height:element[prefix+"Height"]}};this.getViewportWidth=function(){return this.getViewportSize().width};this.init=function(){if(Platform.initSteps["3"]||Platform.initialized){return}if(Platform.isTouch()){Platform.preInit1();Platform.preInit2()}WH.prepInfobox();WH.Responsive.test(true);c();WH.Layout.showClassicLinkOrRedirect();Platform.initSteps["3"]=true;Platform.initialized=true};this.isMobile=function(){return isMobile};this.isTablet=function(){return isTablet};this.isTouch=function(){return this.isMobile()||this.isTablet()};this.preInit1=function(){if(Platform.initSteps["1"]){return}$("html").addClass(Platform.get()+"-device"+(isForced?" forced-device":""));if(Platform.isTouch()){g()}WH.Layout.setBodyAttributes();Platform.initSteps["1"]=true};this.preInit2=function(){if(Platform.initSteps["2"]){return}if(Platform.isTouch()){d()}Platform.initSteps["2"]=true};this.setTouchScrollable=function(l){if(!Platform.isTouch()){return}document.querySelector("html").style.overflow=l?"auto":"hidden";document.querySelector("body").style.overflow=l?"auto":"hidden"};function f(){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(agent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(agent.substr(0,4))){isMobile=true}if(!isMobile){if(/(android|ipad|playbook|silk)/i.test(agent)){isTablet=true}}let gets=WH.getGets();if(typeof gets.testmobile!="undefined"&&!isMobile){isForced=true;isMobile=true}if(typeof gets.testtablet!="undefined"&&!isTablet){isForced=true;isTablet=true}h.known=true}function g(){$("html").addClass("touch-device")}function d(){Platform.preInit1();document.body.dataset.sidebar="false";$(".sidebar .vertical-block-bg, .sidebar .sidebar-block-bg, .sidebar .block-block-bg").remove();$(".header-expand-site").remove()}function c(){setTimeout(function(){WH.updateContentHeight();if(!WH.qs(".sidebar")||!WH.qs(".main-contents")){return}if(MutationObserver){let lastReaction=undefined;let throttledMutationReaction=function(m,l){if(lastReaction!==undefined){return}lastReaction=setTimeout(function(){m();lastReaction=undefined},l)};let observer=new MutationObserver(throttledMutationReaction.bind(null,WH.updateContentHeight,200));let toObserve={childList:true,attributes:true,characterData:true,subtree:true};observer.observe(WH.qs(".sidebar"),toObserve);observer.observe(WH.qs(".main-contents"),toObserve)}else{setInterval(WH.updateContentHeight,200)}},9)}f();WH.onLoad(h.init)};var PoundChecker=new function(){var c=null;var g=null;var d=1000;var f=function(){if(!g){PoundChecker.stop();return}if(location.hash){g()}};this.start=function(h,l){if(g){if(WH.isDev()){alert("Multiple pound checkers are bad, mmkay?")}return}g=h;if(l){d=l}c=setInterval(f,d)};this.stop=function(){clearInterval(c);c=g=null;d=1000};this.pause=function(){clearInterval(c)};this.resume=function(){if(g){c=setInterval(g,d)}}};WH.Profiler=new function(){const c=this;this.create=function(l,f,h,g,d){if(!l||typeof l!=="string"||!f||typeof f!=="string"||!h||typeof h!=="string"){if(g===true){alert(WH.TERMS.filloutdetails_tip)}if(d){return}(new Dialog()).show("fetchlist",{data:{region:l,realm:f,character:h},onSubmit:function(m){c.create(m.region,m.realm,m.character,true,false);return false}});return}location.href="/list/"+WH.Strings.slug(l+"-"+f+"-"+h,true)};this.getAvatarUrl=function(d){if(d.region){if(d.thumbnail){return WH.BlizzardApi.getCharacterThumbnailUrl(d.region,d.thumbnail)}else{if(d.race&&(d.gender===0||d.gender===1)){return"https://"+d.region.toLowerCase()+".battle.net/wow/static/images/2d/avatar/"+d.race+"-"+d.gender+".jpg"}}}return null};this.getFavorite=function(){var f=null;if(g_user.lists instanceof Array){for(var g=0,d=g_user.lists.length;g<d;g++){if(g_user.lists[g].pinned&&(f===null||new Date(g_user.lists[g].updated)>new Date(f.updated))){f=g_user.lists[g]}}}return f};this.getMenuItem=function(h,d){var g={className:(h.mode!=1||(h.armory&&!h.errcode)?"listmanager-mode"+h.mode:"q10")};if(d&&h.region){var f=WH.Profiler.getAvatarUrl(h);if(f){g.armory=f}}if(!g.armory&&h.mode==1&&h.pinned){g.fontIcon="thumb-tack"}return[h.id,h.name,WH.Profiler.getPath(h),null,g]};this.getPath=function(d){return"/list="+d.id+(d.url?"/"+d.url:"")}};function li_onSaveTab(xhr,opt){var text=xhr.responseText;if(text.charAt(0)!="{"||text.charAt(text.length-1)!="}"){return}var list=null;try{list=(JSON&&JSON.parse(text))||eval(text)}catch(e){return}if(!list||!list.id){return}return list}function li_getCurrentUserList(d){if(g_user.lists&&g_user.lists.length){for(var c in g_user.lists){if(g_user.lists[c].id==d){return g_user.lists[c]}}}return null}function li_getListStatus(id,onSuccess){new Ajax("/list&status="+id+"&t="+Math.random(),{method:"POST",onSuccess:function(xhr,opt){var response=eval(xhr.response)[0];if(!response.id){return}li_setButtonStatus(WH.ge("list-status"),response);if(response.refresh){setTimeout(li_getListStatus,response.refresh,id,onSuccess);return}if(response.status==3&&onSuccess){onSuccess()}}})}function li_setButtonStatus(g,f){var c=LANG["li_status"+f.status];var h=$("#list-delete");h.hide();if(f.errcode>0){c=LANG["li_code"+f.errcode]+" #"+f.errcode;h.show()}var l="";if(f.status==1||f.status==2){g.blur();l=" fa-spin";if(f.position===0){c+=WH.TERMS.colon_punct+WH.TERMS.nextInLine}else{c+=WH.TERMS.colon_punct+WH.sprintf(WH.TERMS.inline_format,WH.numberFormat(f.position))}}if(g){var d=" btn-";switch(f.status){case 1:case 2:d+="warning";break;case 3:d+="success";break;case 4:d+="danger";break;case 0:default:d+="primary"}g.className=g.className.replace(/ +btn-[^ ]+\b/,d).replace(/( fa-spin)?( +status-[^ ]+\b)?/,l+" status-"+f.status);g.innerHTML=c;if(f.errcode==104){WH.ae(g,WH.ce("div",{style:{padding:"1em",textAlign:"left"}},WH.BlizzardApi.getNotFoundMessage()))}}}function li_updateRealmSelect(m,d){WH.ee(d);var g=WH.Wow.Realm.getAll();if(!g){WH.ae(d,WH.ce("option",{},WH.ct(WH.TERMS.loading_ellipsis)));g={};WH.Wow.Realm.fetchData(li_updateRealmSelect.bind(null,m,d))}WH.ae(d,WH.ce("option"));if(!g[m]){return}var h=[];for(var f in g[m]){if(!g[m].hasOwnProperty(f)){continue}h.push(g[m][f])}h.sort(function(q,o){return q.name.localeCompare(o.name)});for(var l,c=0;l=h[c];c++){if(l.name.indexOf(l.name_enus)>=0){continue}var p=WH.ce("option");p.value=l.name_enus;WH.st(p,l.name);WH.ae(d,p)}h.sort(function(q,o){return q.name_enus.localeCompare(o.name_enus)});for(var l,c=0;l=h[c];c++){var p=WH.ce("option");p.value=l.name_enus;WH.st(p,l.name_enus);WH.ae(d,p)}}Dialog.templates.createlist={title:WH.TERMS.createnewlist,width:400,buttons:[["check",WH.TERMS.ok],["x",WH.TERMS.cancel]],fields:[{id:"name",label:WH.TERMS.name,required:1,type:"text"}]};Dialog.templates.fetchlist={title:WH.TERMS.lookupblizzardbattlenetprofile,width:400,buttons:[["check",WH.TERMS.ok],["x",WH.TERMS.cancel]],fields:[{id:"region",label:WH.TERMS.region,required:1,type:"select",options:{US:"US",EU:"EU",KR:"KR",TW:"TW"},compute:function(h,g,d,l,f,c){h.id="dialog-region";$(h).change(function(){li_updateRealmSelect($(this).val(),$("#dialog-realm").get(0))})}},{id:"realm",label:WH.TERMS.realm,required:1,type:"select",options:[],compute:function(h,g,d,l,f,c){h.id="dialog-realm";li_updateRealmSelect($("#dialog-region").val(),h)}},{id:"character",label:WH.TERMS.character,required:1,type:"text"}]};var ProgressBar=function(c){this.opts={text:"",hoverText:"",color:"rep6",width:0,progress:0};this.elements={text:null,hoverText:null,textContainer:null,progress:null,container:null};WH.cO(this.opts,c);this.build()};ProgressBar.prototype.build=function(){var d=$("<a/>",{"class":"progressbar",href:"javascript:"});if(this.opts.width>0){d.css("width",this.opts.width+"px")}else{d.css("width","auto")}var c=$("<div/>",{"class":"progressbar-text"});if(this.opts.text){this.elements.text=$("<del/>",{text:this.opts.text});c.append(this.elements.text)}if(this.opts.hoverText){this.elements.hoverText=$("<ins/>",{text:this.opts.hoverText});c.append(this.elements.hoverText)}d.append(c);var f=$("<div/>",{"class":"progressbar-"+this.opts.color,css:{width:this.opts.progress+"%"},text:WH.Strings.nbsp});d.append(f);if(this.opts.text){c.append($("<div/>",{"class":"progressbar-text progressbar-hidden",text:this.opts.text}))}this.elements.container=d;this.elements.progress=f;this.elements.textContainer=c;return d};ProgressBar.prototype.setText=function(c){this.opts.text=c;if(this.elements.text){this.elements.text.text(this.opts.text)}else{this.elements.text=$("<del/>",{text:this.opts.text});if(this.opts.hoverText){this.opts.hoverText.before(this.elements.text)}else{this.elements.textContainer.append(this.elements.text)}}};ProgressBar.prototype.setHoverText=function(c){this.opts.hoverText=c;if(this.elements.hoverText){this.elements.hoverText.text(this.opts.hoverText)}else{this.elements.hoverText=$("<ins/>",{text:this.opts.hoverText});this.elements.textContainer.append(this.elements.hoverText)}};ProgressBar.prototype.setProgress=function(c){this.opts.progress=c;this.elements.progress.css("width",this.opts.progress+"%")};ProgressBar.prototype.setWidth=function(c){this.opts.width=c;if(this.opts.width>0){this.elements.container.css("width",this.opts.width+"px")}else{this.elements.container.css("width","auto")}};ProgressBar.prototype.getText=function(){return this.opts.text};ProgressBar.prototype.getHoverText=function(){return this.opts.hoverText};ProgressBar.prototype.getWidth=function(){return this.opts.width};ProgressBar.prototype.getContainer=function(){return this.elements.container};WH.Raidbots=new function(){this.createForm=function(h){var l=WH.ce("form",{action:"https://www.raidbots.com/simbot/"+h,method:"get",className:"raidbots-form"});var o=WH.ce("select",{name:"region"});WH.ae(o,c(WH.TERMS.region));var g=WH.ce("select",{name:"realm"});WH.ae(g,c(WH.TERMS.realm));WH.ae(g,c(WH.TERMS.selectRegion_tip,false));WH.aE(o,"change",f.bind(this,g,o));var p=WH.ce("input",{type:"text",name:"name",placeholder:WH.TERMS.characterName,required:true});WH.aE(g,"change",function(){p.focus()});var m=WH.ce("button",{className:"fa fa-external-link",type:"submit"});WH.st(m,WH.TERMS.submit);WH.ae(l,o);WH.ae(l,g);WH.ae(l,p);WH.ae(l,m);WH.Wow.Realm.fetchData(d.bind(this,o,g));return l};function c(l,g){var h=WH.ce("option",{disabled:true,selected:typeof g==="boolean"?g:true,required:true});WH.st(h,l);return h}function f(u,v,t){var l=WH.Wow.Realm.getAll();if(!l){WH.Wow.Realm.fetchData(f.bind(this,u,v));return}WH.ee(u);var g=v.options&&v.options[v.selectedIndex]?v.options[v.selectedIndex].value:null;if(g===null){WH.ae(u,c("Invalid region",false));return}if(!l[g]){WH.ae(u,c("No realms found for that region ("+g+")",false));return}WH.ae(u,c(WH.Strings.sprintf(WH.TERMS.realms_format,g)));var q=[];for(var h in l[g]){if(l[g].hasOwnProperty(h)&&l[g][h]){q.push(l[g][h])}}q.sort(function(z,w){return z.name.localeCompare(w.name)});for(var m=0,r=q.length;m<r;m++){var p=q[m];var o=WH.ce("option",{value:p.slug});WH.st(o,p.name);WH.ae(u,o)}if(typeof t==="undefined"||t){u.focus()}}function d(h,l){var p=WH.Wow.Realm.getAll();if(!p){WH.Wow.Realm.fetchData(d.bind(this,h,l));return}WH.ee(h);WH.ae(h,c(WH.TERMS.region));var r=[];for(var q in p){r.push(q)}r.sort();for(var m=0,g=r.length;m<g;m++){var o=WH.ce("option",{value:r[m],selected:r[m].toUpperCase()==="US"});WH.st(o,r[m]);WH.ae(h,o)}f(l,h,false)}};WH.Responsive=new function(){this.CONSTANTS={INTERIOR_SIDEBAR_REMOVAL_BREAKPOINT:768,SIDEBAR_REMOVAL_BREAKPOINT:1200};var f={platformInitComplete:false,testCount:0};this.removeFixedPosition=function(){d.removeFixedPosition()};this.test=function(g){f.testCount++;c.test();d.test();if(g){f.platformInitComplete=true}};var d=new function(){var o=["db-action-buttons"];var g=["announcement","infobox-original-position","lntlwentlsdn35"];var m={elements:{bodyPosition:undefined,container:undefined,fixedPosition:undefined,pagePosition:undefined,staticPosition:undefined}};this.removeFixedPosition=function(){if(!m.elements.fixedPosition){return}var p=m.elements.fixedPosition;m.elements.fixedPosition=undefined;this.test();WH.de(p)};this.test=function(){if(!WH.WAS.showAds()){return}if(!m.elements.container){if(m.elements.container===false){return}m.elements.container=WH.ge("ac-container");if(!m.elements.container){return}}if(!m.elements.staticPosition&&!m.elements.fixedPosition){m.elements.staticPosition=WH.ge("video-pos-static");m.elements.fixedPosition=WH.ge("video-pos-fixed")}if(m.elements.pagePosition==null){m.elements.pagePosition=WH.ge("video-pos-page");if(m.elements.pagePosition){if(m.elements.staticPosition){WH.de(m.elements.staticPosition)}if(m.elements.bodyPosition){WH.de(m.elements.bodyPosition)}m.elements.staticPosition=m.elements.pagePosition;m.elements.bodyPosition=m.elements.pagePosition}else{if(document.readyState==="complete"){m.elements.pagePosition=false}}}h();if(!m.elements.bodyPosition&&!m.elements.staticPosition){return}var q=m.elements.container.parentNode.id;var p=window.aclrePlayerMoved||function(){};if(Platform.getViewportSize().width<=WH.Responsive.CONSTANTS.SIDEBAR_REMOVAL_BREAKPOINT){if(m.elements.bodyPosition&&q!==m.elements.bodyPosition.id){WH.ae(m.elements.bodyPosition,m.elements.container);p()}}else{if(m.elements.staticPosition){if(WH.isElementInView(m.elements.staticPosition,true)||!m.elements.fixedPosition){if(q!==m.elements.staticPosition.id){WH.ae(m.elements.staticPosition,m.elements.container);p()}}else{if(m.elements.fixedPosition&&q!==m.elements.fixedPosition.id){WH.ae(m.elements.fixedPosition,m.elements.container);p()}}}}};function h(){if(m.elements.bodyPosition){return}var p=WH.ge("main-contents");if(!p){return}var q=l(p);if(!q){return}m.elements.bodyPosition=WH.ce("div",{id:"video-pos-body"});q.parentNode.insertBefore(m.elements.bodyPosition,q.nextSibling)}function l(t){mainLoop:for(var q=0;q<t.childNodes.length;q++){var u=t.childNodes[q];if(!u||u.nodeType!==Node.ELEMENT_NODE||u.tagName==="SCRIPT"||u.tagName==="NOSCRIPT"){continue}if(u.id){for(var r=g.length,v=0;v<r;v++){if(u.id.indexOf(g[v])===0){continue mainLoop}}}if(u.className){for(var p=o.length,w=0;w<p;w++){if(u.className.match(new RegExp("\\b"+o[w]+"\\b"))){continue mainLoop}}}if(!$(u).is(":visible")){continue}if(q+1===t.childNodes.length){break}if(u.classList.contains("text")){return l(u)}return u}return null}};var c=new function(){var g;this.test=function(){if(!g&&(!f.platformInitComplete||f.testCount<5)){g=WH.ge("infobox-alternate-position")}var m=$(".infobox");h(m);l(m)};function h(p){if(!g||!p.length){return}var m=Platform.getViewportSize();var o=p.closest(".interior-sidebar");if(o.length){if(m.width<=WH.Responsive.CONSTANTS.INTERIOR_SIDEBAR_REMOVAL_BREAKPOINT){o.appendTo(g)}else{if(!o.parent().hasClass("interior-sidebar-wrapper")){$(".interior-sidebar-wrapper").prepend(o)}}}else{if(m.width<=WH.Responsive.CONSTANTS.SIDEBAR_REMOVAL_BREAKPOINT){p.appendTo(g)}else{if(p.parent().attr("id")!=="infobox-original-position"){$("#infobox-original-position").append(p)}}}}function l(o){var m=(Platform.getViewportSize()).width-54;if(!Platform.isTouch()){m-=20}$(".icon-db-link div",o).each(function(){this.style.width="auto";window.requestAnimationFrame((function(){this.style.width=Math.min(m,this.parentNode.offsetWidth)+"px"}).bind(this))})}};$(window).scroll(d.test)};$(window).resize(WH.Responsive.test);function ss_submitAScreenshot(){tabsContribute.focus(1)}function ss_validateForm(c){if(!c.elements.screenshotfile.value.length){alert(WH.TERMS.selectscreenshot_tip);return false}return true}function ss_appendSticky(){let stickyDiv=WH.ge("infobox-sticky-ss");if(!stickyDiv){return}let pos=WH.inArray(lv_screenshots,1,function(c){return c.sticky});if(pos<0&&lv_screenshots.length){pos=0;for(let x=1;x<lv_screenshots.length;x++){if(Date.parse(lv_screenshots[x].date)>Date.parse(lv_screenshots[pos].date)){pos=x}}}if(pos!=-1){stickyDiv.className="has-thumb";let screenshot=lv_screenshots[pos];let a=WH.ce("a");a.href="#screenshots:id="+screenshot.id;a.onclick=function(c){ScreenshotViewer.show({screenshots:lv_screenshots,pos:pos});return WH.rfWithoutControlKey(c)};let size=[300,300];let img=WH.ce("img");let scale=Math.min(size[0]/screenshot.width,size[1]/screenshot.height);img.src=WH.getScreenshotUrl(screenshot.id,"small",{imageType:screenshot.imageType});img.width=Math.round(scale*screenshot.width);img.height=Math.round(scale*screenshot.height);img.className="border";WH.ae(a,img);WH.ae(stickyDiv,a);$("#infobox-screenshots").append(" ("+lv_screenshots.length+")").wrapInner($('<a href="#screenshots"></a>').click(function(){tabsRelated.focus(tabsRelated.getTabById("screenshots"));return false}))}else{let noneYetDiv=WH.ce("div");let anchor=WH.ce("a",{href:"javascript:"},WH.ct(WH.TERMS.submitone_stc));if(!g_user.id){anchor.href="/account=signin"}noneYetDiv.innerHTML=WH.sprintf(WH.TERMS.noneyet_format,anchor.outerHTML);if(g_user.id>0){anchor=noneYetDiv.querySelector("a");WH.aE(anchor,"click",function(){ss_submitAScreenshot()})}WH.ae(stickyDiv,noneYetDiv);let viewIn3dButton=WH.ge("wh-mv-view-in-3d-button");if(viewIn3dButton&&viewIn3dButton.dataset.mvDisplayId){let imageUrl="";if(viewIn3dButton.dataset.mvType==WH.Types.NPC){imageUrl=WH.Wow.Npc.getThumbUrl(parseInt(viewIn3dButton.dataset.mvDisplayId))}else{if(viewIn3dButton.dataset.mvType==WH.Types.ITEM){let gathered=WH.Gatherer.get(parseInt(viewIn3dButton.dataset.mvType),parseInt(viewIn3dButton.dataset.mvTypeId));let raceMask=gathered&&gathered.jsonequip&&gathered.jsonequip.races;let raceId=WH.Wow.Models.getRaceIdFromMask(raceMask);if(gathered.classs!==WH.Wow.Item.CLASS_ARMOR){raceId=undefined}imageUrl=WH.Wow.Item.getThumbUrl(parseInt(viewIn3dButton.dataset.mvDisplayId),raceId)}}if(imageUrl){let img=WH.ce("img",{src:imageUrl,width:300,height:300,className:"border",style:{display:"none"},id:"sticky-screenshot-model-substitute"});WH.aE(img,"load",function(){img.style.display="";stickyDiv.classList.add("has-thumb-substitute")});WH.aE(img,"error",function(){img.style.display="none";stickyDiv.classList.remove("has-thumb-substitute")});WH.ae(stickyDiv,img)}}}ss_appendSticky=function(){}}var g_screenshots={};var ScreenshotViewer=new function(){var F,H,g,C,d,w=150,N=150,K,u,m=0,D,L,o,p,r,S,A,z,q,B,T,c,E,G="screenshots";function P(){var Y=F[H];C=Y.width;d=Y.height;var aa=C;var W=WH.getWindowSize();var X=W.w-w;var V=Math.min(C,X);var Z=V*(d/C);if(Z+N>W.h){aa=(W.h-N)*(C/d);K=true}else{K=false}Lightbox.setSize(aa+Lightbox.UI_WIDTH);$(".screenshotviewer-image-inner",p).css({"padding-top":(d/C)*100+"%"})}function t(X){var W=F[X],V="#"+G;if(m==0){V+=(W?":id="+W.id:"")}else{V+=":"+D+":"+(W?X+1:X+0.5)}return V}function M(W){var V="";if(typeof g_gathered_types=="object"&&g_gathered_types[W.type]&&g_gathered_types[W.type][W.typeId]&&g_gathered_types[W.type][W.typeId]["name_"+Locale.getName()]){V=g_gathered_types[W.type][W.typeId]["name_"+Locale.getName()]}else{if(typeof g_pageInfo=="object"&&g_pageInfo.type&&g_pageInfo.typeId&&g_pageInfo.name){V=g_pageInfo.name}}if(W.caption){if(V){V+=WH.TERMS.hyphen_punct+W.caption}else{V=W.caption}}return V}function I(ad){clearTimeout(E);if(ad&&!K&&WH.getWindowSize().h>L.offsetHeight+N){return}L.style.visibility="hidden";var ae=F[H];P();var ah=M(ae);var V=ae.url||WH.getScreenshotUrl(ae.id,"normal",{description:ah,imageType:ae.imageType});var Y='<img src="'+V+'" width="'+C+'" height="'+d+'">';p.innerHTML=Y+'<div class="screenshotviewer-image-inner" style="padding-top:'+(d/C)*100+'%"></div>';if(!ad){WH.Track.interactiveEvent("Screenshots","Show",ae.id+((ae.caption&&ae.caption.length)?" ("+ae.caption+")":""));if(ae.url){z.href=V;z.style.display="block"}else{z.href=WH.getScreenshotUrl(ae.id,"normal",{description:ah,imageType:ae.imageType});z.style.display="block"}if(!ae.user&&typeof g_pageInfo=="object"){ae.user=g_pageInfo.username}var ab=(ae.date&&ae.user),aa=(F.length>1);if(ab){var Z=new Date(ae.date),ag=(WH.getServerTime()-Z)/1000;var af=q.firstChild.childNodes[1];af.href="/user="+ae.user;af.innerHTML=ae.user;var ak=q.firstChild.childNodes[3];WH.ee(ak);ak.removeAttribute("class");ak.removeAttribute("title");WH.formatDate(ak,ag,Z);q.firstChild.title=WH.TERMS.from+ae.user+" "+WH.formatDate(null,ag,Z);q.firstChild.style.display=""}else{q.firstChild.style.display="none"}var ak=q.childNodes[1];WH.ee(ak);if(ae.user){if(ab){WH.ae(ak,WH.ct(" "+LANG.dash+" "))}var af=WH.ce("a");af.href="javascript:";af.onclick=ContactTool.show.bind(ContactTool,{mode:3,screenshot:ae});af.className="fa fa-exclamation-triangle fa-size-s";WH.Tooltip.simple(af,WH.TERMS.reportingoptions_tip,"q2");WH.ae(af,WH.ct(WH.TERMS.report));WH.ae(ak,af)}ak=q.childNodes[2];if(aa){var aj="";if(ae.user){aj=LANG.dash}if(H%1!=0){aj+=WH.sprintf(WH.TERMS.advertisementbetweenimages_tip,H+0.5,H+1.5,F.length)}else{aj+=(H+1)+WH.TERMS.of_lc+F.length}ak.innerHTML=aj;ak.style.display=""}else{ak.style.display="none"}q.style.display=(ab||aa?"":"none");if(Locale.getId()!=LOCALE_ENUS&&ae.caption){ae.caption=""}var ac=(ae.caption!=null&&ae.caption.length);var W=(ae.subject!=null&&ae.subject.length&&ae.type&&ae.typeId);if(ac||W){Y="";if(W){var ai=WH.ce("div");WH.ae(ai,WH.ct(WH.Types.getUpperSingular(ae.type)+WH.TERMS.colon_punct));WH.ae(ai,WH.ce("a",{href:WH.Entity.getPath(ae.type,ae.typeId)},WH.ct(ae.subject)));Y+=ai.innerHTML}var X=document.createDocumentFragment();if(ac){if(W){Y+=LANG.dash}X=ae.noMarkup?document.createTextNode(ae.caption):WH.markup.getDomFragment(ae.caption,{mode:WH.markup.MODE.SIGNATURE})}$(B).html(Y).append(X);B.style.display=""}else{B.style.display="none"}if(F.length>1){S.href=t(U(-1));A.href=t(U(1));S.style.display=A.style.display=""}else{S.style.display=A.style.display="none"}if(H!=g||Platform.isTouch()){r.style.display="none"}location.replace(t(H))}Lightbox.reveal();L.style.visibility="visible"}function U(W){var V=H;V+=W;if(V<0){V=F.length-1}else{if(V>=F.length){V=0}}return V}function J(V){H=U(V);f();return false}function h(V){V=WH.normalizeEvent(V);switch(V.keyCode){case 37:J(-1);break;case 39:J(1);break}}function Q(){I(1)}function R(){l();if(F.length>1){WH.dE(document,"keyup",h)}if(u&&m==0){if(u.indexOf(":id=")!=-1){u="#"+G}WH.setHash(u)}else{WH.clearHash()}}function O(ab,X,W){if(typeof W.screenshots=="string"){F=g_screenshots[W.screenshots];m=1;D=W.screenshots}else{F=W.screenshots;m=0;D=null}L=ab;H=0;if(W.pos&&W.pos>=0&&W.pos<F.length){H=W.pos}g=H;if(X){ab.className+=" has-lightbox-caption screenshotviewer";o=WH.ce("div");o.className="lightbox-content screenshotviewer-screen";r=WH.ce("div");r.className="screenshotviewer-keystip";r.innerHTML=WH.TERMS.sceenshotviewerkeys_tip;WH.ae(ab,r);var ad=WH.ce("div");var aa=WH.ce("div");ad.className="screenshotviewer-page-wrapper screenshotviewer-prev-wrapper";aa.className="screenshotviewer-page-wrapper screenshotviewer-next-wrapper";S=WH.ce("a");A=WH.ce("a");S.className="screenshotviewer-prev";A.className="screenshotviewer-next";S.href="javascript:";A.href="javascript:";var Y=WH.ce("span");Y.className="fa fa-chevron-left";WH.ae(S,Y);Y=WH.ce("span");Y.className="fa fa-chevron-right";WH.ae(A,Y);WH.aE(S,"click",J.bind(S,-1));WH.aE(S,"tap",J.bind(S,-1));WH.aE(A,"click",J.bind(A,1));WH.aE(A,"tap",J.bind(A,1));WH.ae(ad,S);WH.ae(aa,A);WH.ae(o,ad);WH.ae(o,aa);p=WH.ce("div",{className:"screenshotviewer-image",innerHTML:'<div class="screenshotviewer-image-inner"></div>'});WH.ae(o,p);WH.ae(ab,o);var Z=WH.ce("a");Z.className="dialog-option fa fa-times";Z.href="javascript:";Z.onclick=Lightbox.hide;WH.ae(Z,WH.ct(WH.TERMS.close));WH.ae(ab,Z);z=WH.ce("a");z.className="dialog-option fa fa-external-link";z.href="javascript:";z.target="_blank";WH.ae(z,WH.ct(WH.TERMS.original));WH.ae(ab,z);var ac=WH.ce("div",{className:"lightbox-caption"});q=WH.ce("div");q.className="screenshotviewer-from";var V=WH.ce("span");WH.ae(V,WH.ct(WH.TERMS.from));WH.ae(V,WH.ce("a"));WH.ae(V,WH.ct(" "));WH.ae(V,WH.ce("span"));WH.ae(q,V);WH.ae(q,WH.ce("span"));WH.ae(q,WH.ce("span"));WH.ae(ac,q);B=WH.ce("div");B.className="screenshotviewer-caption";WH.ae(ac,B);WH.ae(ab,ac)}u=location.hash;if(F.length>1){WH.aE(document,"keyup",h)}f()}function f(){var V=F[H];if(V&&(!V.width||!V.height)){if(T){T.onload=null;T.onerror=null}else{L.className="";c=[];while(L.firstChild){c.push(L.firstChild);WH.de(L.firstChild)}}clearTimeout(E);E=setTimeout(function(){V.width=126;V.height=22;P();V.width=null;V.height=null;var X=WH.ce("div");X.className="screenshotviewer-loading";var W=WH.ce("img");W.src=WH.staticUrl+"/images/ui/misc/progress-anim.gif";W.width=126;W.height=22;WH.ae(X,W);WH.ae(L,X);Lightbox.reveal();L.style.visiblity="visible"},150);T=new Image();T.onload=(function(W,X){clearTimeout(X);W.width=this.width;W.height=this.height;T=null;v();I()}).bind(T,V,E);T.onerror=(function(W){clearTimeout(W);T=null;Lightbox.hide();v()}).bind(T,E);T.src=V.url||WH.getScreenshotUrl(V.id,"normal",{description:M(V),imageType:V.imageType})}else{I()}}function l(){if(!T){return}T.onload=null;T.onerror=null;T=null;v()}function v(){if(!c){return}WH.ee(L);L.className="lightbox-frame has-lightbox-caption screenshotviewer";for(var V=0;V<c.length;++V){WH.ae(L,c[V])}c=null}this.getScreenshotDescription=function(V){return M(V)};this.checkPound=function(){if(location.hash&&location.hash.indexOf("#"+G)==0){if(!g_listviews[G]){var W=location.hash.split(":");if(W.length==3){var X=g_screenshots[W[1]],V=parseInt(W[2]);if(X&&V>=1&&V<=X.length){ScreenshotViewer.show({screenshots:W[1],pos:V-1,hashname:G})}}}}};this.show=function(V){if("hashname"in V){G=V.hashname;delete V.hashname}Lightbox.show("screenshotviewer",{onShow:O,onHide:R,onResize:Q},V)};$(document).ready(this.checkPound)};WH.Seo=new function(){this.addJsonLdBreadcrumb=function(q){var o=WH.Url.getCanonicalPath().replace(/[?&].*$/,"");var u=false;var p={"@context":"http://schema.org","@type":"BreadcrumbList",itemListElement:[]};var l=function(w,z){var v={"@type":"ListItem",position:w+1,item:{name:z.name}};if(z.url){v.item["@id"]=z.url;if(WH.Url.getPathFromUrl(z.url).indexOf(o)>=0){u=true}}if(z.image){v.item.image=WH.ensureUrlProtocol(z.image)}p.itemListElement.push(v)};for(var h=0,m=q.length;h<m;h++){l(h,q[h])}var r=WH.ge("json-ld-breadcrumbs");if(r){WH.de(r)}if(p.itemListElement.length){if(!u){var t=window.g_pageInfo?g_pageInfo.name:undefined;if(!t){var g=WH.qsa(".heading-size-1");if(g.length===1){t=g[0].textContent}}if(t){l(h,{name:t,url:WH.Url.getCanonical(),image:undefined})}}WH.ae(document.head,WH.ce("script",{id:"json-ld-breadcrumbs",text:JSON.stringify(p),type:"application/ld+json"}))}};function c(){var l=WH.qsa('script[type="application/ld+json"]')||[];for(var h=0,g=l.length;h<g;h++){try{var m=JSON.parse(l[h].textContent)}catch(o){continue}if(m.mainEntityOfPage&&m.image&&m.image.url){return m.image.url}}return undefined}function f(){if(!WH.User.hasRole(U_GROUP_ADMIN|U_GROUP_BLOGGER|U_GROUP_EDITOR)&&WH.User.getId()!==1788274&&!WH.isDev()){return}if(WH.PageMeta.skipSeoValidation){return}WH.onLoad(d)}function d(){if(!document.title){WH.Admin.Debug.error(WH.Admin.Debug.TYPE_SEO,"No page title!")}$(function(){setTimeout(function(){if(!WH.PageMeta.skipSeoHeadingValidation&&!WH.qs("h1")){WH.Admin.Debug.error(WH.Admin.Debug.TYPE_SEO,"No H1!")}},1000)});var l=$('meta[name="description"]').attr("content");if(l){var h='[span class="q0"]SEO Description:[/span] '+l.replace("[","\\[");var m=false;if(l.length<130){h+=' [span class="q0"](short)[/span]';m=true}else{if(l.length>160){h+=' [span class="q0"](long)[/span]';m=true}}if(WH.Strings.hasReplacementValues(l)){WH.Admin.Debug.error(WH.Admin.Debug.TYPE_SEO,h,true)}else{if(m){WH.Admin.Debug.warn(WH.Admin.Debug.TYPE_SEO,h,true)}}}else{WH.Admin.Debug.error(WH.Admin.Debug.TYPE_SEO,"No SEO description!")}var g=$('meta[name="keywords"]').attr("content");if(g){if(WH.Strings.hasReplacementValues(g)){var h='[span class="q0"]SEO Keywords:[/span] '+g.replace("[","\\[").split(",").join(", ");WH.Admin.Debug.error(WH.Admin.Debug.TYPE_SEO,h,true)}}else{WH.Admin.Debug.error(WH.Admin.Debug.TYPE_SEO,"No SEO keywords!")}}requestAnimationFrame(f)};var ShowOnMap=function(f,g,d){const c=this;c.data=f;c.currentPath=[];if(g==null){g=myMapper}c.mapper=g;c._legend=null;c._legendLabel=null;c._legendContents=null;c._legendHorde=null;c._legendAlliance=null;c._menu=[];c._trackingIcons=[];c._controlsdiv=d?$(typeof d=="string"?("#"+d):d):$("#lenrlkn4");c.construct()};ShowOnMap.prototype.onExpand=function(){this.expanded=true;location.replace(this.pound+".map")};ShowOnMap.prototype.onCollapse=function(){this.expanded=false;var c=WH.getHash();if(c.indexOf("#show")==0&&c.indexOf(".map")>0){this.pound=c.substr(0,c.indexOf(".map"));location.replace(this.pound)}};ShowOnMap.prototype.construct=function(){if(!this.data){return}var aj=this._controlsdiv;var h=function(l,d){return WH.stringCompare(l[1],d[1])};var O=[];var f=[];for(var ag in this.data){if(this.data[ag].length===undefined){var W=[];var V=[];var w={};var E=this.data[ag];for(var Z in E){var g=false;for(var ad=0,C=E[Z].length;ad<C;++ad){if(E[Z][ad].paths){g=true;break}}var t=WH.Strings.slug(Z);if(E[Z][0].name_enus!==undefined){t=WH.Strings.slug(E[Z][0].name_enus)}var v={};var T={};var K=[t];var Y=ShowOnMap.combinePins(E[Z],false,g);var R=Y[0];var F=Y[1];var al=0;for(var ad=0;ad<R.length;++ad){var J=R[ad];var N=ShowOnMap.buildTooltip(J.list);var o=N[2];var ae=null;if(o=="javascript:"){ae=N[3]}if(J.list.length==1){o=g_types[J.list[0].type]&&J.list[0].id?WH.Entity.getPath(J.list[0].type,J.list[0].id):""}if(ag=="rare"||ag=="herb"||ag=="vein"){N[1]=W.length+1}if(v[J.level]==undefined){v[J.level]=[]}v[J.level].push([J.coord[0],J.coord[1],{url:o,label:N[0],menu:ae,type:N[1],lines:J.list[0].paths}]);al++}if(al>0){var o=g_types[E[Z][0].type]&&E[Z][0].id?WH.Entity.getPath(E[Z][0].type,E[Z][0].id):"";T[W.length+1]=[Z,o];K.push(Z+WH.sprintf(WH.TERMS._paren,F));K.push(this.showStuff.bind(this,v,[ag,t],T));W.push(K);for(var af in v){if(V[af]){V[af]=V[af].concat(v[af])}else{V[af]=v[af]}}w[W.length]=[Z,o]}}if(W.length>0){W.sort(h);var K=[ag,LANG.som[ag],this.showStuff.bind(this,V,[ag],w),W];this._menu.push(K);var L=[[null,LANG.som[ag]],["all",WH.TERMS.all,K[2]]];for(x=0;x<W.length;x++){L.push(W[x])}this._trackingIcons.push([ag,undefined,w,L])}}else{if(this.data[ag].length==0){continue}var g=false;for(var ad=0,C=this.data[ag].length;ad<C;++ad){if(this.data[ag][ad].paths){g=true;break}}var K=[ag];var v={};var aa={},I={};var u={},Q={};var T={};var z={};var S={};var Y=ShowOnMap.combinePins(this.data[ag],false,g);var F=Y[1];var al=0,q=0,H=0,r=0,c=0;var A=function(p,ao){for(var am=0;am<ao.length;++am){var d=ao[am];var aq=p;d.list.key=ag;var at=ShowOnMap.buildTooltip(d.list,(p=="hordedailyquests"||p=="alliancedailyquests")?true:false);var l=at[2];var an=null;if(l=="javascript:"){an=at[3]}if(d.list.length==1){l=g_types[d.list[0].type]&&d.list[0].id?WH.Entity.getPath(d.list[0].type,d.list[0].id):""}var ap=[d.coord[0],d.coord[1],{url:l,label:at[0],menu:an,type:at[1],lines:d.list[0].paths}];if(v[d.level]==undefined){v[d.level]=[];aa[d.level]=[];I[d.level]=[];u[d.level]=[];Q[d.level]=[]}if(d.list[0].mapicon){ap[2].mapicon=d.list[0].mapicon}if(aq!="mailbox"&&aq!="vignettes"&&aq!="rare"&&aq!="spirithealer"&&aq!="book"&&aq!="forge"&&aq!="treasure"&&aq!="anvil"&&aq!="hordequests"&&aq!="alliancequests"&&aq!="hordedailyquests"&&aq!="alliancedailyquests"&&aq!="boss"){if(at[1]==2||at[1]==0){if(at[1]==2){z[2]=[WH.TERMS.horde,null]}else{z[0]=[WH.TERMS.neutral,null]}aa[d.level].push(ap);q++}if(at[1]==3||at[1]==0){if(at[1]==3){S[3]=[WH.TERMS.alliance,null]}else{S[0]=[WH.TERMS.neutral,null]}u[d.level].push(ap);r++}}else{if(aq=="hordequests"){aq="quest";if(at[1]==2){z[2]=[WH.TERMS.horde,null]}else{z[0]=[WH.TERMS.neutral,null]}aa[d.level].push(ap);q++}else{if(aq=="hordedailyquests"){aq="daily";if(at[1]==2){z[2]=[WH.TERMS.horde,null]}else{z[0]=[WH.TERMS.neutral,null]}I[d.level].push(ap);H++}else{if(aq=="alliancequests"){aq="quest";if(at[1]==3){S[3]=[WH.TERMS.alliance,null]}else{S[0]=[WH.TERMS.neutral,null]}u[d.level].push(ap);r++}else{if(aq=="alliancedailyquests"){aq="daily";if(at[1]==3){S[3]=[WH.TERMS.alliance,null]}else{S[0]=[WH.TERMS.neutral,null]}Q[d.level].push(ap);c++}else{v[d.level].push(ap);al++}}}}}}return aq};var ai=A(ag,Y[0]);if(ag=="alliancequests"){var D=ShowOnMap.combinePins(this.data[ag],true);if(D[1]>0){A("alliancedailyquests",D[0])}}else{if(ag=="hordequests"){var U=ShowOnMap.combinePins(this.data[ag],true);if(U[1]>0){A("hordedailyquests",U[0])}}}if(ai=="rare"){F=this.data[ai].length}else{if(ai=="forge"||ai=="anvil"||ai=="treasure"||ai=="mailbox"){F=Y[0].length}}if(al>0){var K=[ai,LANG.som[ai]+WH.sprintf(WH.TERMS._paren,F),this.showStuff.bind(this,v,[ai],T)];this._menu.push(K);this._trackingIcons.push([ai,v,T])}if(q>0){var K=[ai,LANG.som[ai]+WH.sprintf(WH.TERMS._paren,q),this.showStuff.bind(this,aa,["horde",ai],z),null];if(ai=="quest"){K.push({tinyIcon:"quest_start"});if(H>0){f.push(K);K=["daily",WH.TERMS.questgiversdaily+WH.sprintf(WH.TERMS._paren,H),this.showStuff.bind(this,I,["horde","daily"],z),null,{tinyIcon:"quest_start_daily"}];this._trackingIcons.push(["daily",I,z])}}f.push(K);this._trackingIcons.push([ai,aa,z])}if(r>0){var K=[ai,LANG.som[ai]+WH.sprintf(WH.TERMS._paren,r),this.showStuff.bind(this,u,["alliance",ai],S),null];if(ai=="quest"){K.push({tinyIcon:"quest_start"});if(c>0){O.push(K);K=["daily",WH.TERMS.questgiversdaily+WH.sprintf(WH.TERMS._paren,c),this.showStuff.bind(this,Q,["alliance","daily"],S),null,{tinyIcon:"quest_start_daily"}];this._trackingIcons.push(["daily",Q,S])}}O.push(K);this._trackingIcons.push([ai,u,S])}}}O.sort(h);f.sort(h);this._menu.sort(h);if(f.length>0){this._menu.unshift(["horde",WH.TERMS.horde,"",f,{tinyIcon:"side_horde"}])}if(O.length>0){this._menu.unshift(["alliance",WH.TERMS.alliance,"",O,{tinyIcon:"side_alliance"}])}var B=[-1,WH.TERMS.nothing,this.showStuff.bind(this,[],[-1],{})];B.checked=true;this._menu.push(B);var M=WH.createButton(WH.TERMS.showonmap_ellipsis,null,{"class":"mapper-som-button fa fa-search"});Menu.add(M,this._menu,{showAtElement:true});aj.append(M);var P;if(!this._legend){this._legend=$("<div/>",{"class":"mapper-legend",css:{display:"none"}});var ac=$("<div/>",{"class":"mapper-legend-container"});this._legendLabel=$("<b/>",{text:WH.TERMS.legend_colon});ac.append(this._legendLabel);this._legendContents=$("<div/>",{css:{"float":"right"}});ac.append(this._legendContents);var P=$("<div/>",{css:{clear:"right"}});ac.append(P);this._legend.append(ac)}aj.append(this._legend);P=$("<div/>",{css:{clear:"left"}});aj.append(P);this.setTrackingIcons();var G=[];var ab=WH.getHash();if(ab.indexOf("#show:")!=-1){G=ab.split(".")}else{if(this.data.instance){G.push("#show:boss")}}if(G.length>0){if(G.length==2&&G[1]=="map"){this.expanded=true;this.mapper.toggleZoom()}var X=G[0].split(":");if(X.length<2){return}var ah=this._menu;for(var ad=1;ad<X.length;++ad){var ak=X.length-1;for(var Z=0;Z<ah.length;++Z){if(ah[Z][0]==X[ad]){if(ah[Z][3]&&ad<ak){ah=ah[Z][3]}else{ah=ah[Z]}break}}}if(ah&&ah[2]&&jQuery.isFunction(ah[2])){ah[2]()}}};ShowOnMap.prototype.setTrackingIcons=function(){var u=this.mapper.parent;var J={repair:"repair",auctioneer:"auctioneer",banker:"banker",battlemaster:"battlemaster",innkeeper:"inn",guildmaster:"guild",stablemaster:"stablemaster",flightmaster:"flightmaster",trainer:"trainer-profession",vendor:"vendor-food",quest:"quest",daily:"daily",anvil:"blacksmithing",herb:"herbalism",vein:"mining",book:"trainer-class",forge:"smelting",spirithealer:"spirithealer",boss:"boss",rare:"hostile-npc",vignettes:"resource",treasure:"treasure",mailbox:"mailbox"};var r=[{name:WH.Types.getUpperPlural(WH.Types.NPC),icons:["repair","auctioneer","banker","battlemaster","innkeeper","guildmaster","stablemaster","flightmaster","trainer","vendor","spirithealer","boss","rare"],elements:[]},{name:WH.Types.getUpperPlural(WH.Types.QUEST),icons:["quest","daily"],elements:[]},{name:WH.GlobalStrings.TRADE_SKILLS,icons:["anvil","herb","vein","book","forge"],elements:[]},{name:WH.TERMS.loot,icons:["vignettes","treasure"],elements:[]},{name:WH.TERMS.goal,icons:["mailbox"],elements:[]}];var c=this._trackingIcons;c.sort(function(m,l){return WH.stringCompare(m[0],l[0])});for(var A=1;A<c.length;A++){if(c[A][0]==c[A-1][0]){var v={};for(var B in c[A][1]){if(!c[A][1].hasOwnProperty(B)){continue}v[B]=c[A][1][B]}for(B in c[A-1][1]){if(!c[A-1][1].hasOwnProperty(B)){continue}if(!v.hasOwnProperty(B)){v[B]=c[A-1][1][B]}else{v[B]=v[B].concat(c[A-1][1][B])}}c[A-1][1]=v;var G={};for(var h in c[A][2]){if(!c[A][2].hasOwnProperty(h)){continue}G[h]=c[A][2][h]}for(h in c[A-1][2]){if(!c[A-1][2].hasOwnProperty(h)){continue}G[h]=c[A-1][2][h]}c[A-1][2]=G;c.splice(A--,1)}}c.sort(function(m,l){return WH.stringCompare(LANG.som[m[0]],LANG.som[l[0]])});var g=WH.ce("div",{className:"mapper-legend-icons"});for(var I=0,w;w=c[I];I++){if(!J.hasOwnProperty(w[0])){continue}var F=WH.ce("div");F.className="mapper-legend-icon "+J[w[0]];F.setAttribute("data-legend-icon",w[0]);F.onmousedown=WH.rf;if(w[1]){var d=[w[0]];if(w[0]!="vignettes"&&w[0]!="treasure"){d.splice(0,0,-2)}WH.aE(F,"click",this.showStuff.bind(this,w[1],d,w[2],F))}if(w[3]){Menu.add(F,w[3],{showAtElement:true})}WH.Tooltip.simpleNonTouch(F,LANG.som[w[0]]);var q=false;for(var H=0,t;t=r[H];H++){if(t.icons.indexOf(w[0])>-1){q=true;r[H].elements.push(F);break}}if(!q){WH.error("Could not find group for map icon.",w[0])}}for(var E=0,L;L=r[E];E++){if(L.elements.length){var p=WH.ce("div",{className:"mapper-legend-icons-group"});var o=WH.ce("div",{className:"mapper-legend-icons-heading",innerHTML:L.name});var z=WH.ce("div",{className:"mapper-legend-icons-icons"});if(L.style){for(var D in L.style){if(L.style.hasOwnProperty(D)){p.style[D]=L.style[D]}}}for(var C=0,K;K=L.elements[C];C++){WH.ae(z,K)}WH.ae(p,o);WH.ae(p,z);WH.ae(g,p)}}var f=WH.ce("div",{className:"mapper-legend-icons-tip",innerHTML:WH.TERMS.clickicontoshowonmap_tip});$("> span:first-child",this.mapper.parent).append(f);WH.ae(u,g);u.className+=" mapper-autoheight"};ShowOnMap.prototype.setLegend=function(h){this._legendContents.empty();var l=$("<div/>");var f=0;for(var d in h){var g=$("<span/>",{"class":("mapper-pin mapper-pin-"+d+" mapper-legend-pin")});if(h[d][1]){var c=$("<a/>",{href:h[d][1],text:h[d][0]});g.append(c)}else{g.text(h[d][0])}l.append(g);if((++f)%4==0){l.append($("<br/>"))}}this._legendContents.append(l)};ShowOnMap.prototype.showStuff=function(h,l,d){if(WH.isEqualSimpleObject(l,this.currentPath)){this.showStuff.call(this,[],[-1],{});return}Menu.hide();var c=false;for(var f=0,g;g=l[f];f++){if(typeof g!="string"){continue}var p=$('[data-legend-icon="'+g+'"]');if(p.length){p.parents(".mapper-legend-icons").find(".mapper-legend-icon").removeClass("active");p.addClass("active");c=true;break}}if(!c){$(".mapper-legend-icon",this.mapper.parent).removeClass("active")}var m={coords:h,preservelevel:true};if((typeof g_pageInfo!="undefined")&&g_pageInfo.hasOwnProperty("id")){m.zone=g_pageInfo.id}this.mapper.update(m);this.setLegend(d);this.checkMenu(l);this.currentPath=l;if((l.length==1&&l[0]==-1)||(l[0]==-2)){this.pound="";WH.clearHash();return}this.pound="#show:"+l.join(":");if(this.pound!="#show:boss"){location.replace(this.pound+(this.expanded?".map":""))}};ShowOnMap.prototype.clearChecks=function(d){for(var c=0;c<d.length;++c){d[c].checked=false;if(d[c][3]&&d[c][3].length>0){this.clearChecks(d[c][3])}}this._legend.hide()};ShowOnMap.prototype.checkMenu=function(p){this.clearChecks(this._menu);if(p[0]!=-1){this._legend.show()}else{this._legend.hide()}var c=this._menu;var m=[];for(var f=0;f<p.length;++f){for(var d=0;d<c.length;++d){if(c[d][0]==p[f]){c[d].checked=true;m.push([c[d][0],c[d][1]]);c=c[d][3];break}}}if(p[0]==-2){m.push([p[1],LANG.som[p[1]]])}var g=m.length-1;var h="";var l={rare:true,herb:true,vein:true};for(var f=0;f<m.length;++f){if(f>0&&l[m[0][0]]){var o=$("span",this._legendContents);o.removeClass("mapper-legend-pin");o.append($("<b/>",{text:" "+m[f][1].substr(m[f][1].lastIndexOf("("))}))}else{if(f==g){h+="<span>"}else{h+='<span class="breadcrumb-arrow">'}h+=m[f][1]+"</span>"}}this._legendLabel.html(h)};ShowOnMap.combinePins=function(A,E,h){var l={};var v=null,d=null;var q,o;var C=0;var f=function(G,p){var c=Math.floor(G[0]);var F=Math.floor(G[1]);if(!p){if(c%2==1){c+=1}if(F%2==1){F+=1}}if(l[c]===undefined){l[c]={}}if(l[c][F]===undefined){l[c][F]=[]}return[c,F]};for(var t=0;t<A.length;++t){var m=A[t];if(E){if(!m.quests){continue}var w=true;for(var u=0;u<m.quests.length;++u){if(m.quests[u].daily){w=false;break}}if(w){continue}}else{if(h&&m.id!=0){v=f([m.id,0],true);q=v[0];o=v[1];var g=WH.dO(m);g.coord=m.coords[0];l[q][o].push(g);C++;continue}}if(m.point=="start"||m.point=="end"){v=f(m.coord);q=v[0];o=v[1];if(l[q][o].length>3){var B=l[q][o];l[q][o]=[];for(var z=0;z<B.length;++z){d=f(B[z].coord,true);l[d[0]][d[1]].push(B[z])}}l[q][o].push(m);C++}else{for(var D=0;D<m.coords.length;++D){v=f(m.coords[D]);q=v[0];o=v[1];var g=WH.dO(m);g.coord=m.coords[D];if(l[q][o].length>3){var B=l[q][o];l[q][o]=[];for(var z=0;z<B.length;++z){d=f(B[z].coord,true);l[d[0]][d[1]].push(B[z])}}l[q][o].push(g);C++}}}var r=[];for(q in l){for(o in l[q]){r.push({coord:[l[q][o][0].coord[0],l[q][o][0].coord[1]],level:l[q][o][0].level,list:l[q][o]})}}return[r,C]};ShowOnMap.buildTooltip=function(B,D){var w="";var l="";var d=[];var C=-1;var g={};var h=0;var c={};var t=1;for(var v=0;v<B.length;++v){var m=B[v];l=(g_types[m.type]&&m.id?WH.Entity.getPath(m.type,m.id):"");var F=l+m.item;var p=l+m.point;if(!g[F]){g[F]={url:l,obj:m,coords:[m.coord],all:[m]};h++}else{if(!c[p]){g[F].all.push(m)}g[F].coords.push(m.coord)}c[p]=1}var v=0;for(var F in g){var l=g[F].url;var f=g[F].all;var m=g[F].obj;var A=g[F].coords;if(v>0){w+="<br />"}d.push([v++,m.name,l]);t=m.type;if(!m.point){if((m.reacthorde==1&&m.reactalliance<1)||m.side==2){if(C==2||C==-1){C=2}else{C=0}}else{if((m.reactalliance==1&&m.reacthorde<1)||m.side==1){if(C==3||C==-1){C=3}else{C=0}}else{C=0}}}w+='<b class="q'+(C==2?" icon-horde":"")+(C==3?" icon-alliance":"")+'">'+m.name+"</b>";if(A.length>0){w+=" ("+A[0][0]+", "+A[0][1]+")<br />"}if(m.quests){if(m.quests.length>1){w+=WH.TERMS.starsthefollowingquests_colon}else{w+=WH.TERMS.startsthefollowingquest_colon}w+='<div class="indent">';for(var r=0;r<m.quests.length;++r){var z=m.quests[r];if(D&&!z.daily){continue}w+='<span class="q0">['+z.level+"]</span> "+z.name+((z.series&&!z.first)?'<sup style="font-size: 8px">(*)</sup>':"")+((z.category<0&&g_quest_sorts[z.category])?' <i class="q0">'+g_quest_sorts[z.category]+"</i>":"")+"<br />"}w+="</div>"}else{if(m.description){w+=m.description+"<br />"}else{if(m.point){for(var v=0;v<f.length;++v){var u=f[v];switch(u.point){case"start":w+=WH.TERMS.startsthequest_stc+"<br />";if(C=="end"){C="startend"}else{if(C!="startend"){C="start"}}break;case"end":w+=WH.TERMS.endsthequest_stc+"<br />";if(C=="start"){C="startend"}else{if(C!="startend"){C="end"}}break;case"sourcestart":w+=WH.TERMS.sourceofqueststart_colon+"<br />";w+='<div class="indent">'+u.item+"</div>";if(C=="end"){C="startend"}else{if(C!="startend"){C="start"}}break;case"sourceend":w+=WH.TERMS.sourceofquestend_colon+"<br />";w+='<div class="indent">'+u.item+"</div>";if(C=="start"){C="startend"}else{if(C!="startend"){C="end"}}break;case"requirement":w+=WH.TERMS.objectiveofthequest_stc+"<br />";if(C==-1){C=u.objective}break;case"sourcerequirement":w+=WH.TERMS.sourceofaquestobjective_colon+"<br />";w+='<div class="indent">'+u.item+"</div>";if(C==-1){C=u.objective}break}}}}}}w+='<div class="q2">';if(B.length==1){w+=((B[0].type==1&&B[0].id!=0)?WH.TERMS.clicktoviewthisnpc_stc:((B[0].type==2&&B[0].id!=0)?WH.TERMS.clicktoviewthisobject_stc:""))}else{if(h==1){w+=((t==1&&m.id!=0)?WH.TERMS.clicktoviewthisnpc_stc:((t==2&&m.id!=0)?WH.TERMS.clicktoviewthisobject_stc:""))}else{w+="<br />"+WH.TERMS.clicktoview_ellipsis}}w+="</div>";var E=[];E.push(w);E.push(C);if(B.length==1||h==1){E.push(l);E.push(null)}else{E.push("javascript:");E.push(d)}return E};WH.SiteAchievement=new function(){const d=1;const g=2;const f=3;const c={};c[d]=WH.TERMS.copper;c[g]=WH.TERMS.silver;c[f]=WH.TERMS.gold;this.getQualityName=function(h){return c[h]}};(function(h){var r=3;var p=new Array();var d=2650;var f=h("<audio />").get(0),c=WH.staticUrl+"/sfx/wsa.wav",l=1,v=0,q=3,t;function g(w,z){if(z<=0){if(w==true||w=="true"){h("#wsa-overflow").fadeOut(1000,function(){h("#wsa-overflow").remove();l=1})}else{h("#wsa-overflow").remove();l=1}clearInterval(t)}return(z-1)}function u(w,B,z){var C=new Date();C.setDate(C.getDate()+z);var A=escape(B)+((z==null)?"":"; expires="+C.toUTCString());document.cookie=w+"="+A}function o(z){var A,w,C,B=document.cookie.split(";");for(A=0;A<B.length;A++){w=B[A].substr(0,B[A].indexOf("="));C=B[A].substr(B[A].indexOf("=")+1);w=w.replace(/^\s+|\s+$/g,"");if(w==z){return unescape(C)}}}function m(){for(key in p){clearTimeout(p[key])}}h(function(){h("body").delegate(".wsa-vol","click",function(){h(this).toggleClass("alt");if(h(this).hasClass("alt")==true){h.post("/account=setsound",{muted:1})}else{h.post("/account=setsound",{muted:0})}}).delegate(".wsa-notification","mouseover mouseout",function(w){if(w.type=="mouseover"){m();h(".wsa-notification").stop();h(this).css("z-index",1500000);if(h(this).attr("data-animated")=="true"){h(".wsa-notification").fadeTo(100,1)}}else{h(this).css("z-index",999999);if(h(this).attr("data-persistent")!="true"){h(".wsa-notification").each(function(A,z){var B=h(this).attr("id");if(h(this).attr("data-animated")=="true"){p[B]=setTimeout("$('#"+B+"').fadeOut(3000,function(){ $('#"+B+"').remove(); })",1000)}else{p[B]=setTimeout("$('#"+B+"').remove()",3000)}})}}}).delegate(".wsa-notification","click",function(w){if(!(h(w.target).is("a")||h(w.target).hasClass("wsa-vol"))){h(this).remove()}})});h.fn.wsaNotification=function(A){var C={caption:"??? No name",rank:1,href:"/user#achievements",animate:true,playsfx:true,desc:"",persist:false};var A=h.extend(C,A);var F=h("body").children("#wsa-overflow").length;var z=h("body").children(".wsa-notification").length;if(z<r&&F==0){var E=new Date(),E="wsan"+E.getTime();if(z!=(v%r)){v=0}var B=!A.playsfx;var D=A.rank==0?WH.TERMS.newprivilege:WH.sprintf(WH.TERMS.achievementunlocked_format,WH.SiteAchievement.getQualityName(A.rank));var w='<div class="wsa-notification" data-animated="'+A.animate+'" data-persistent="'+A.persist+'" style="bottom: '+(((v%r)*125)+15).toString()+'px" id="'+E+'"><em></em><ins></ins><span class="wsar'+A.rank+'"></span><div><var><i>'+D+'</i><a title="'+A.desc+'" href="'+A.href+'">'+WH.TERMS.viewdetails+" &rarr;</a></var>"+WH.getImitationHeading(A.caption,2).outerHTML+'</div><div class="wsa-vol'+(B?" alt":"")+'"></div></div>';h("body").prepend(w);if(A.playsfx==true||A.playsfx=="true"){if(!h(f).attr("src")){h(f).attr("src",c)}if(f.play){f.play()}else{h(".wsa-sound").remove();h("body").append('<embed class="wsa-sound" src="'+c+'" autostart="true" hidden="true" loop="false" />')}}if(A.animate==true||A.animate=="true"){h("#"+E+" em").css("filter","");h("#"+E+" em").fadeOut(750,function(){h("#"+E+" em").remove()});h("#"+E+" ins").delay(250).animate({marginLeft:"355px",opacity:0},750,function(){h(this).remove();if(!A.persist){p[E]=setTimeout("$('#"+E+"').fadeOut(3000,function(){ $('#"+E+"').remove(); })",d)}})}else{h("#"+E+" em").remove();h("#"+E+" ins").remove();if(!A.persist){p[E]=setTimeout("$('#"+E+"').remove()",d+1000)}}v++}else{var w='<div class="wsa-overflow" id="wsa-overflow" style="bottom: '+0+'px"><a href="/user">'+WH.sprintf(WH.TERMS.wsamore_format,1)+"</a></div>";if(F==0){h("body").prepend(w);q=3;if(A.animate==true||A.animate=="true"){h("#wsa-overflow").slideDown()}else{h("#wsa-overflow").show()}t=setInterval(function(){q=g(A.animate,q)},1000)}else{q=3;l++;h("#wsa-overflow b").text(l)}}}})(jQuery);function AchievementCheck(){$.ajax({cache:false,url:"/ajax-achievement-check",type:"POST",success:function(d){if(d&&d.length){for(var c=0;c<d.length;c++){$().wsaNotification(d[c])}}}})}var Slider=new function(){const w=this;var d;var u;var p;function t(z){z=WH.normalizeEvent(z);u=this;d=WH.getCursorPos(z);WH.aE(document,"mousemove",f);WH.aE(document,"mouseup",o);return false}function f(A){A=WH.normalizeEvent(A);if(!d||!u){return}var C=WH.getCursorPos(A);var D=C.x-d.x;var B=v(u,u._pos+D);var z=c(u);if(z&&u.elements.input){u.elements.input.value=z.value}if(!B){d=C}if(u.onMove){u.onMove(A,u,z)}}function o(z){z=WH.normalizeEvent(z);if(u.onMove){u.onMove(z,u,c(u))}u=null;d=null;WH.dE(document,"mousemove",f);WH.dE(document,"mouseup",o);return false}function r(C,B){B=WH.normalizeEvent(B);u=C;d=WH.getCursorPos(B);var D=WH.ac(u.parentNode);var A=Math.floor(g(u)/2);v(u,d.x-D.x-A);var z=c(u);if(z&&u.elements.input){u.elements.input.value=z.value}if(u.onMove){u.onMove(B,u,z)}WH.aE(document,"mousemove",f);WH.aE(document,"mouseup",o);return false}function m(A,z){if(p){clearTimeout(p)}if(z.type==="change"||z.type==="keypress"&&z.which===13){q(A,z)}else{p=setTimeout(q.bind(0,A,z),1000)}}function q(A,z){let value=A.elements.input.value;let position=c(A);if(isNaN(value)){value=position.value}if(value>A._max){value=A._max}if(value<A._min){value=A._min}Slider.setValue(A,value);if(A.onMove){A.onMove(z,A,c(A))}}function v(A,B,z){let outside=false;let maxPos=l(A);if(B<0){B=0;outside=true}else{if(B>maxPos){B=maxPos;outside=true}}let handleSize=g(A);if(!handleSize&&typeof z==="number"){z=Math.min(Math.max(z,0),100)}else{z=parseFloat(B)/maxPos;z-=(handleSize/h(A))*z;z*=100}A.elements.trackBarProgress.style.width=z+"%";A.style.left=z+"%";A._pos=B;return outside}function l(z){return h(z)-g(z)}function c(C){var A=C._pos/l(C);var B=Math.round((A*(C._max-C._min))+C._min);var z=[A,B];z.percent=A;z.value=B;return z}function h(z){if(z._tsz>0){return z._tsz}return z.elements.track.offsetWidth}function g(z){return typeof z._hsz==="number"?z._hsz:z.offsetWidth}this.getInput=function(z){return z.elements.input};this.getPercent=function(z){return c(z).percent};this.getValue=function(z){return c(z).value};this.setMax=function(A,z){A._max=z;if(A.elements.maxLabel){WH.st(A.elements.maxLabel,z)}Slider.setValue(A,c(A).value)};this.setValue=function(B,A,z){if(A<B._min){A=B._min}else{if(A>B._max&&z!==true){A=B._max}}if(A>B._max){B.elements.container.classList.add("exceeded-max")}else{B.elements.container.classList.remove("exceeded-max")}if(B.elements.input){B.elements.input.value=A}let percentScale=(A-B._min)/(B._max-B._min);v(B,l(B)*percentScale,100*percentScale)};this.setValueDisplay=function(A,z){if(!A.elements.values){WH.error("Can't set the slider value display, this slider doesn't support labels.",z,A);return}WH.ee(A.elements.values);WH.st(A.elements.values,z)};this.setSize=function(B,A){var C=c(B);var z=l(B);B.elements.container.style.width=A+"px";if(z!==l(B)){this.setValue(B,C.value)}};this.setTitle=function(z,A){if(!z.elements.labels){WH.error("Can't set the slider title, this slider doesn't support labels.",A,z);return}if(!z.elements.title){z.elements.title=WH.ce("span",{className:"slider-labels-title"});WH.aef(z.elements.labels,z.elements.title)}WH.ee(z.elements.title);WH.st(z.elements.title,A)};this.init=function(z,A){z.classList.add("slider");z.dataset.track=A.remaining?"remaining":"progress";let handle=WH.ce("div",{className:"slider-track-handle",onmousedown:t});let track=WH.ce("div",{className:"slider-track",onmousedown:r.bind(0,handle)});let trackBar=WH.ce("div",{className:"slider-track-bar"});let trackBarProgress=WH.ce("div",{className:"slider-track-bar-progress"});WH.ae(z,track);WH.ae(track,handle);WH.ae(track,trackBar);WH.ae(trackBar,trackBarProgress);handle.elements={container:z,input:undefined,labels:undefined,maxLabel:undefined,title:undefined,track:track,trackBarProgress:trackBarProgress,values:undefined};handle._min=1;handle._max=100;handle._pos=0;handle._tsz=0;handle._hsz=null;if(A!=null){if(A.minValue||A.minValue===0){handle._min=A.minValue}if(A.maxValue){handle._max=A.maxValue}if(A.onMove){handle.onMove=A.onMove}if(A.trackSize){handle._tsz=A.trackSize}if(typeof A.handleSize==="number"){handle._hsz=A.handleSize}if(A.editable===false){z.classList.add("not-editable");handle._hsz=0}if(A.hasOwnProperty("value")){w.setValue(handle,A.value,true)}if(A.showLabels!==false){z.classList.add("has-labels");handle.elements.labels=WH.ce("div",{className:"slider-labels"});WH.ae(z,handle.elements.labels);handle.elements.values=WH.ce("span",{className:"slider-labels-values"});WH.ae(handle.elements.labels,handle.elements.values);let updateLabelSize;if(A.valueDisplay!==undefined){w.setValueDisplay(handle,A.valueDisplay);updateLabelSize=function(){}}else{let sizer=WH.ce("span",{className:"slider-labels-values-sizer"});WH.ae(handle.elements.values,sizer);if(handle._min!==1){let minLabel=WH.ce("span",{className:"slider-labels-values-min"},WH.ct(WH.TERMS.minimum_abbrev+WH.TERMS.colon_punct+handle._min));WH.ae(handle.elements.values,minLabel)}handle.elements.input=WH.ce("input",{className:"slider-labels-values-input",value:A.hasOwnProperty("value")?A.value:handle._max,type:"text"});WH.ae(handle.elements.values,handle.elements.input);handle.elements.maxLabel=WH.ce("span",{className:"slider-labels-values-max"},WH.ct(handle._max));WH.ae(handle.elements.values,handle.elements.maxLabel);updateLabelSize=function(){WH.st(sizer,handle.elements.input.value);window.requestAnimationFrame(function(){handle.elements.input.style.width=(sizer.offsetWidth||20)+"px"})}}if(typeof A.title==="string"){w.setTitle(handle,A.title)}updateLabelSize();$(handle.elements.input).bind("focus",function(){this.parentNode.classList.add("input-focused")}).bind("blur",function(){this.parentNode.classList.remove("input-focused")}).bind("change",updateLabelSize).bind("click",function(){this.select()}).bind("keypress",function(B){let a=[];let k=B.which;for(let i=48;i<58;i++){a.push(i)}if(!(WH.inArray(a,k)>=0)&&k!==13){B.preventDefault()}updateLabelSize()}).bind("keyup keydown change",function(B){m(handle,B);if(B.which===13||B.which===27){this.blur()}updateLabelSize()})}}return handle}};WH.StatusWidget=function(g,f){const d=this;const c=["remaining","title","value","valueDisplay"];let my={elements:{container:undefined,info:undefined},slider:undefined,updateFunction:undefined};this.getElement=function(l){if(!my.elements.hasOwnProperty(l)){WH.error("Status widget element not found.",l)}return my.elements[l]};this.update=function(){if(my.updateFunction){my.updateFunction(my.slider,this)}};function h(m,l){my.elements.container=m;my.updateFunction=l.updateFunction;my.elements.container.classList.add("status-widget");let sliderOptions={editable:false,maxValue:l.hasOwnProperty("maxValue")?l.maxValue:100,minValue:l.hasOwnProperty("minValue")?l.minValue:1};for(let i=0,option;option=c[i];i++){if(l.hasOwnProperty(option)){sliderOptions[option]=l[option]}}let sliderDiv=WH.ce("div",{className:"status-widget-slider"});WH.ae(my.elements.container,sliderDiv);my.slider=Slider.init(sliderDiv,sliderOptions);my.elements.info=WH.ce("div",{className:"status-widget-info"});WH.ae(my.elements.container,my.elements.info);if(typeof l.updateFunction==="function"){if(typeof l.updateInterval==="number"){setInterval(d.update,l.updateInterval)}requestAnimationFrame(d.update)}}h.apply(this,arguments)};WH.Strings=new function(){const c=this;this.laquo="\u00AB";this.lsaquo="\u2039";this.nbsp="\u00A0";this.raquo="\u00BB";this.rsaquo="\u203A";const d={guidIndex:0,guidPrefix:undefined};this.escapeHtml=function(f){return WH.ce("div",{},WH.ct(f)).innerHTML};this.escapeRegExp=function(f){return f.replace(/[\s\S]/g,function(g){let escape=g.charCodeAt(0).toString(16);let longhand=escape.length>2;return"\\"+(longhand?"u":"x")+("0000"+escape).slice(longhand?-4:-2)})};this.formatNumber=function(g,o,f,h){f=f||0;h=h||f;var l=WH.Strings.formatNumber.supportsOptions;if(l===undefined){l=WH.Strings.formatNumber.supportsOptions=!!(typeof Intl=="object"&&Intl&&typeof Intl.NumberFormat=="function")}var m=g;if(!g instanceof Number){g=new Number(g)}if(isNaN(g)){WH.error("Tried to convert an invalid number",m);g=0}if(!l){if(o){g*=100}return g.toFixed(h)+(o?"%":"")}return g.toLocaleString(undefined,{style:o?"percent":"decimal",useGrouping:true,minimumFractionDigits:f,maximumFractionDigits:h})};this.guid=function(){if(!d.guidPrefix){d.guidPrefix=["wowhead-guid",Date.now(),WH.getServerTime().valueOf(),c.hashCode(location.href),""].join("-")}return d.guidPrefix+(d.guidIndex++)};this.hashCode=function(f){let hash=0;for(let i=0;i<f.length;i++){hash=((hash<<5)-hash)+f.charCodeAt(i);hash|=0}return hash};this.hasReplacementValues=function(f){return!!f.match(/(%[sd]|%\d+\$s|\$\d)/)};this.slug=function(h,g,l){if(typeof h!=="string"){WH.error("Tried to convert a variable of type "+typeof h+" to kebab case.",h);return""}var f=WH.ce("textarea");f.innerHTML=h.replace(/</g,"&lt;").replace(/>/g,"&gt;");h=f.value;if(Locale.exists(l)||Locale.isLocaleName(l)){if(l===LOCALE_ENUS||l===Locale.getName(LOCALE_ENUS)){h=h.replace(" & "," and ")}else{h=h.replace(WH.TERMS.wordspace_punct+WH.TERMS.ampersand_punct+WH.TERMS.wordspace_punct,WH.TERMS.wordspace_punct+WH.TERMS.and_lc+WH.TERMS.wordspace_punct)}}h=h.replace(/%\w|['#]|^\s*|\s*$/g,"");if(g){h=h.replace(/ \/ |_|[^\u00C0-\u1FFF\u2C00-\uD7FF\w]+/g,"-")}else{h=WH.removeAccents(h).replace(/ \/ |_|[^a-z0-9]/ig,"-")}h=h.replace(/-{2,}/g,"-");h=h.replace(/^-+|-+$/g,"");h=h.toLocaleLowerCase();h=h.substr(0,80);return h};this.sprintf=(function(){var g={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function m(o){return h(f(o),arguments)}function h(z,w){var D=1,B=z.length,E,p="",u,r,v,q,A,C,t,o;for(u=0;u<B;u++){if(typeof z[u]==="string"){p+=z[u]}else{if(typeof z[u]==="object"){v=z[u];if(v.keys){E=w[D];for(r=0;r<v.keys.length;r++){if(E==undefined){throw new Error(m('[sprintf] Cannot access property "%s" of undefined value "%s"',v.keys[r],v.keys[r-1]))}E=E[v.keys[r]]}}else{if(v.param_no){E=w[v.param_no]}else{E=w[D++]}}if(g.not_type.test(v.type)&&g.not_primitive.test(v.type)&&E instanceof Function){E=E()}if(g.numeric_arg.test(v.type)&&(typeof E!=="number"&&isNaN(E))){throw new TypeError(m("[sprintf] expecting number but found %T",E))}if(g.number.test(v.type)){t=E>=0}switch(v.type){case"b":E=parseInt(E,10).toString(2);break;case"c":E=String.fromCharCode(parseInt(E,10));break;case"d":case"i":E=parseInt(E,10);break;case"j":E=JSON.stringify(E,null,v.width?parseInt(v.width):0);break;case"e":E=v.precision?parseFloat(E).toExponential(v.precision):parseFloat(E).toExponential();break;case"f":E=v.precision?parseFloat(E).toFixed(v.precision):parseFloat(E);break;case"g":E=v.precision?String(Number(E.toPrecision(v.precision))):parseFloat(E);break;case"o":E=(parseInt(E,10)>>>0).toString(8);break;case"s":E=String(E);E=(v.precision?E.substring(0,v.precision):E);break;case"t":E=String(!!E);E=(v.precision?E.substring(0,v.precision):E);break;case"T":E=Object.prototype.toString.call(E).slice(8,-1).toLowerCase();E=(v.precision?E.substring(0,v.precision):E);break;case"u":E=parseInt(E,10)>>>0;break;case"v":E=E.valueOf();E=(v.precision?E.substring(0,v.precision):E);break;case"x":E=(parseInt(E,10)>>>0).toString(16);break;case"X":E=(parseInt(E,10)>>>0).toString(16).toUpperCase();break}if(g.json.test(v.type)){p+=E}else{if(g.number.test(v.type)&&(!t||v.sign)){o=t?"+":"-";E=E.toString().replace(g.sign,"")}else{o=""}A=v.pad_char?v.pad_char==="0"?"0":v.pad_char.charAt(1):" ";C=v.width-(o+E).length;q=v.width?(C>0?A.repeat(C):""):"";p+=v.align?o+E+q:(A==="0"?o+q+E:q+o+E)}}}}return p}var l=Object.create(null);function f(o){if(l[o]){return l[o]}var r=o,t,v=[],u=0;while(r){if((t=g.text.exec(r))!==null){v.push(t[0])}else{if((t=g.modulo.exec(r))!==null){v.push("%")}else{if((t=g.placeholder.exec(r))!==null){if(t[2]){u|=1;var w=[],q=t[2],p=[];if((p=g.key.exec(q))!==null){w.push(p[1]);while((q=q.substring(p[0].length))!==""){if((p=g.key_access.exec(q))!==null){w.push(p[1])}else{if((p=g.index_access.exec(q))!==null){w.push(p[1])}else{throw new SyntaxError("[sprintf] failed to parse named argument key")}}}}else{throw new SyntaxError("[sprintf] failed to parse named argument key")}t[2]=w}else{u|=2}if(u===3){throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported")}v.push({placeholder:t[0],param_no:t[1],keys:t[2],sign:t[3],pad_char:t[4],align:t[5],width:t[6],precision:t[7],type:t[8]})}else{throw new SyntaxError("[sprintf] unexpected placeholder")}}}r=r.substring(t[0].length)}return l[o]=v}return m}());this.unescapeHtml=function(f){let entityCache={"&gt;":">","&lt;":"<","&amp;":"&","&apos;":"'","&quot;":'"'};let parser;return f.replace(/&(?:(?:#\d+)|(?:#x[0-9a-f]+)|[a-z]+);/ig,function(g){if(entityCache.hasOwnProperty(g)){return entityCache[g]}parser=parser||new DOMParser();return entityCache[g]=parser.parseFromString(g,"text/html").documentElement.textContent})};this.vsprintf=function(g,f){return this.sprintf.apply(null,[g].concat(f||[]))}};WH.Switcher=function(c,g,q){const m="active";const d="inactive";const l={elements:{container:undefined,indicator:undefined},toggleable:false};this.activateChoice=function(r){let choice=WH.qs('.switcher-choice[data-switcher-id="'+r+'"]',l.elements.container);if(choice){choice.click()}else{WH.error("Could not find switcher choice with ID "+r)}};this.setChoiceLabel=function(r,t){let choice=WH.qs('.switcher-choice[data-switcher-id="'+r+'"]',l.elements.container);if(choice){if(typeof t==="string"){WH.st(choice,t)}else{WH.ee(choice);WH.ae(choice,t)}}else{WH.error("Could not find switcher choice with ID "+r)}};function o(r){let link=WH.ce("a",{className:"switcher-choice",dataset:{state:r.active?m:d}},WH.ct(r.name));WH.ae(l.elements.container,link);if(r.id){link.dataset.switcherId=r.id}if(r.active){h(link)}WH.aE(link,"click",f.bind(link,r));WH.preventSelectStart(link);WH.onMutate(link,function(){if(this.dataset.state===m){h(this)}});if(r.nonTouchTooltip){WH.Tooltip.simpleNonTouch(link,r.nonTouchTooltip,undefined,true)}else{if(r.tooltip){WH.Tooltip.simple(link,r.tooltip,undefined,true)}}}function p(t,r,u){u=u||{};if(u.toggleable){l.toggleable=true}l.elements.container=t;l.elements.container.classList.add("switcher");l.elements.indicator=WH.ce("div",{className:"switcher-indicator"});WH.ae(l.elements.container,l.elements.indicator);for(let i=0,switcherChoice;switcherChoice=r[i];i++){o(switcherChoice)}WH.aE(window,"resize",function(){let activeChoice=WH.qs('.switcher-choice[data-state="active"]',l.elements.container);if(activeChoice){h(activeChoice)}})}function f(r,t){let newState=l.toggleable&&this.dataset.state===m?d:m;WH.setData('.switcher-choice[data-state="active"]',"state",d,this.parentNode);this.dataset.state=newState;h(this,true);if(r.onChange){r.onChange.apply(this,arguments)}}function h(t,r){let wrapper=t.parentNode;if(!wrapper){WH.error("Cannot update switcher indicator position, no switcher choice parent found.",t);return}if(r!==true){l.elements.indicator.style.transition="none"}if(t.dataset.state===m){let indicatorBottom=wrapper.offsetHeight-(t.offsetTop+t.offsetHeight);l.elements.indicator.style.bottom=indicatorBottom+"px";l.elements.indicator.style.left=t.offsetLeft+"px";l.elements.indicator.style.width=t.getBoundingClientRect().width+"px"}else{l.elements.indicator.style.bottom="";l.elements.indicator.style.left="";l.elements.indicator.style.width=""}if(r!==true){requestAnimationFrame(function(){requestAnimationFrame(function(){l.elements.indicator.style.transition=""})})}}p.apply(this,arguments)};function Tabs(f){WH.cO(this,f);if(this.parent){this.parent=WH.ge(this.parent)}if(!this.parent){WH.error("Tabs cannot be created without a parent.");return}this.selectedTab=-1;this.ul=null;this.tabs=[];this.nShows=0;if(this.maxRows==null&&Platform.getViewportWidth()<768){this.maxRows=4}if(this.poundable==null){this.poundable=1}this.poundedTab=null;if(this.onLoad==null){this.onLoad=Tabs.onLoad.bind(this)}if(this.onShow==null){this.onShow=Tabs.onShow.bind(this)}if(this.onHide){this.onHide=this.onHide.bind(this)}this.trackClick=Tabs.trackClick.bind(this);if(f.tabs instanceof Array){for(var d=0,c=f.tabs.length;d<c;d++){this.add(f.tabs[d].name,f.tabs[d].options)}this.flush()}}Tabs.prototype={add:function(c,d){let tabSettings;let index=this.tabs.length;tabSettings={caption:c,index:index,owner:this};WH.cO(tabSettings,d);this.tabs.push(tabSettings);if(this.ul){let tab=this.createTab(tabSettings);WH.ae(this.ul,tab)}return index},hide:function(f,h){if(this.tabs[f]){var d=this.selectedTab;if(f==0&&d==-1){this.poundedTab=this.selectedTab=d=0}if(f!=this.poundedTab){this.selectedTab=-1}this.tabs[f].hidden=!h;this.flush();if(!h&&f==d){this.selectedTab=d;for(var g=0,c=this.tabs.length;g<c;++g){if(g!=f&&!this.tabs[g].hidden){return this.show(g,1)}}}}},unlock:function(d,c){if(this.tabs[d]){this.tabs[d].locked=c;let links=WH.gE(this.ul,"a");$(".fa-lock",links[d]).remove();if(c){$("div, b",links[d]).prepend('<span class="fa fa-lock" />')}let tabId=location.hash.substr(1).split(";")[0];if(this.tabs[d].id==tabId){this.show(d,1)}}},focus:function(c){if(c<0){c=this.tabs.length+c}this.forceScroll=1;WH.gE(this.ul,"a")[c].onclick({},true);this.forceScroll=null},show:function(d,f,l){var c;if(isNaN(d)||d<0){d=0}else{if(d>=this.tabs.length){d=this.tabs.length-1}}if((f==null&&d==this.selectedTab)||this.tabs[d].hidden){return}if(this.tabs[d].locked){return this.onShow(this.tabs[d],this.tabs[this.selectedTab])}if(this.selectedTab!=-1){c=this.tabs[this.selectedTab];if(this.onHide&&!this.onHide(c)){return}if(c.onHide&&!c.onHide()){return}}++this.nShows;c=WH.gE(this.ul,"a");if(this.selectedTab!=-1){c[this.selectedTab].className=""}c[d].className="selected";if(this.maxRows){var g=function(m){var o=$(m).parent().siblings(".tab-responsive-list");if(o.length){if(m.parentNode.getAttribute("data-responsive-hidden")=="true"){$("a",o).addClass("selected");$("div, b",o).html(this.getMoreTabName(true,$("b",m).html()))}else{$("a",o).removeClass("selected");$("div, b",o).html(this.getMoreTabName(true))}}};if(l){setTimeout(g.bind(this,c[d]),250)}else{g.call(this,c[d])}}c=this.tabs[d];if(c.onLoad){c.onLoad();c.onLoad=null}this.onShow(this.tabs[d],this.tabs[this.selectedTab]);if(c.onShow){c.onShow(this.tabs[this.selectedTab])}this.selectedTab=d;try{window.dispatchEvent(new CustomEvent("scroll"))}catch(h){}},flush:function(h){var d;var c=WH.ce("div");c.className="tabs-container";var m="ul";this.ul=WH.ce(m);this.ul.className="tabs";WH.ae(c,this.ul);for(var f=0;f<this.tabs.length;++f){var l=this.tabs[f];var g=this.createTab(l);WH.ae(this.ul,g)}WH.ee(this.parent);WH.ae(this.parent,c);if(this.onLoad){let initialTabIndex=this.onLoad();if(initialTabIndex!=null){this.poundedTab=h=initialTabIndex}}this.show(h,null,true);if(this.maxRows){setTimeout((function(){this.collapseExtraTabs()}).bind(this),1)}},createTab:function(m){var h,c,g;h=WH.ce("li");c=WH.ce("b");var f=WH.ce("a");f.rel="np";if(m.className){h.className=m.className}if(m.hidden){h.style.display="none"}if(this.poundable&&!m.noPound){f.href="#"+m.id}else{f.href="javascript:"}if(m.menu){Menu.add(f,m.menu,{showAtElement:true,onShow:m.onShowMenu,onHide:m.onHideMenu})}else{f.onclick=Tabs.onClick.bind(m,f)}var l=WH.ce("div");if(m.locked){g=WH.ce("span",{className:"fa fa-lock"});WH.ae(l,g)}else{if(m.icon){g=WH.ce("span",{className:"icontiny"});g.style.backgroundImage="url("+WH.staticUrl+"/images/wow/icons/tiny/"+m.icon.toLowerCase()+".gif)";WH.ae(l,g)}else{if(m.image){g=WH.ce("img");$.extend(g,m.image);WH.ae(l,g)}else{if(m.fontIcon){g=WH.ce("i",{className:"fa fa-"+m.fontIcon});WH.ae(l,g)}}}}if(m.tooltip){f.onmouseover=(function(d,o){WH.Tooltip.showAtCursor(o,d,0,0,"q")}).bind(f,m.tooltip);f.onmousemove=WH.Tooltip.cursorUpdate;f.onmouseout=WH.Tooltip.hide}if(m["class"]){l.className=m["class"]}WH.ae(l,WH.ct(m.caption));WH.ae(f,l);if(m.locked){g=WH.ce("span",{className:"fa fa-lock"});WH.ae(c,g)}else{if(m.icon){g=WH.ce("span",{className:"icontiny"});g.style.backgroundImage="url("+WH.staticUrl+"/images/wow/icons/tiny/"+m.icon.toLowerCase()+".gif)";WH.ae(c,g)}else{if(m.image){g=WH.ce("img");$.extend(g,m.image);WH.ae(c,g)}else{if(m.fontIcon){g=WH.ce("i",{className:"fa fa-"+m.fontIcon});WH.ae(c,g)}}}}WH.ae(c,WH.ct(m.caption));WH.ae(f,c);WH.ae(h,f);f.tabSettings=m;return h},collapseExtraTabs:function(){var h=$(this.ul);var t=h.find("> li:first-child").outerHeight(true);if(h.height()>t*this.maxRows){var l=$("> li",h);var p=[];var f=[];var q=this.maxRows;l.each(function(w){var z=$(this);var v=z.position();if(v.top>(t*q)-t){f.push(z)}else{p.push(z);while(p.length>2){p.shift()}}});while(f.length>0&&p.length>0){f.unshift(p.pop())}var m=l.length-f.length;var d=[];var r=/<img[^>]+src="([^">]*)"[^>]*>\s*/;for(var g=0,o;o=f[g];g++){o.attr("data-responsive-hidden","true");var c=[g,$("b",o).html(),(function(v){$("a",v).trigger("click");if(Platform.getViewportWidth()<768){$("html, body").animate({scrollTop:$(this.ul).offset().top-42},150)}}).bind(this,o),null,{checkedFunc:(function(v){return this.selectedTab==v}).bind(this,g+m)}];var u=c[MENU_IDX_LABEL].match(r);if(u){c[MENU_IDX_OPT].icon=u[1]}c[MENU_IDX_LABEL]=c[MENU_IDX_LABEL].replace(/<[^>]*>/,"");d.push(c)}this.add(this.getMoreTabName(false),{className:"tab-responsive-list",fontIcon:"bars",menu:d,onShowMenu:(function(){$(this.currentTabContents).addClass("tab-fade")}).bind(this),onHideMenu:(function(){$(".tab-fade").removeClass("tab-fade")}).bind(this),noPound:false})}},getMoreTabName:function(d,f){var c=d?'<i class="fa fa-bars"></i>':"";if(f){c+=" &ndash; "+f}return c},setTabName:function(f,d){this.tabs[f].caption=d;var c=WH.gE(this.ul,"a");WH.setTextNodes(c[f],d)},setTabPound:function(d,c){if(!this.poundable){return}let links=WH.gE(this.ul,"a");links[d].href="#"+this.tabs[d].id+(c?";"+c:"")},setTabTooltip:function(d,f){this.tabs[d].tooltip=f;var c=WH.gE(this.ul,"a");if(f==null){c[d].onmouseover=c[d].onmousemove=c[d].onmouseout=null}else{c[d].onmouseover=function(g){WH.Tooltip.showAtCursor(g,f,0,0,"q2")};c[d].onmousemove=WH.Tooltip.cursorUpdate;c[d].onmouseout=WH.Tooltip.hide}},getSelectedTab:function(){return this.selectedTab},getTabById:function(f){for(var d=0,c=this.tabs.length;d<c;++d){if(this.tabs[d].id==f){return d}}}};Tabs.onClick=function(c,g,f){if(f==null&&this.index==this.owner.selectedTab){return}var d=WH.rfWithoutControlKey(g);if(d==null){return}Menu.hide();this.owner.show(this.index,f);if(this.owner.poundable&&!this.locked){let hashPos=c.href.indexOf("#");if(hashPos!==-1){let tabHash=c.href.substr(hashPos);if(location.hash.indexOf(tabHash)!==0){location.replace(tabHash)}}}return d};Tabs.onLoad=function(){if(!this.poundable||!location.hash.length){return}let tabId=location.hash.substr(1).split(/[;:]/)[0];if(tabId){for(let i=0,tab;tab=this.tabs[i];i++){if(tab.id===tabId&&!tab.locked){return i}}}};Tabs.onShow=function(f,d){if(f.hidden||f.locked){return}if(d){WH.ge("tab-"+d.id).style.display="none"}if(this.poundedTab!=null||d){this.trackClick(f)}var c=WH.ge("tab-"+f.id);c.style.display="";this.currentTabContents=c;WH.Tools.Bloodmallet.updateChartsSizes(c);if(((this.nShows===1&&typeof this.poundedTab==="number"&&this.poundedTab>=0)||this.forceScroll)&&!this.noScroll){setTimeout(WH.scrollTo.bind(WH,this.parent,undefined,!WH.pageWasReloaded()),100)}};Tabs.trackClick=function(c){if(!this.trackable||c.tracked){return}WH.Track.interactiveEvent("Tabs","Show",this.trackable+": "+c.id);c.tracked=1};WH.Theme=new function(){const c=this;this.THEME_CLASSIC="classic";this.THEME_STANDARD="standard";this.THEME_THOTTBOT="thottbot";this.TYPE_CLASSIC="classic";this.TYPE_STANDARD="standard";var d={};d[this.THEME_STANDARD]=this.TYPE_STANDARD;d[this.THEME_CLASSIC]=this.TYPE_CLASSIC;d[this.THEME_THOTTBOT]=this.TYPE_CLASSIC;this.getTheme=function(){return WH.PageMeta.theme||c.THEME_STANDARD};this.getThemePath=function(){var f=c.getTheme();if(f===c.THEME_STANDARD){return""}return f+"/"};this.getThemes=function(){if(WH.isClassicTree()||WH.isBurningCrusadeTree()){return[c.THEME_CLASSIC,c.THEME_THOTTBOT]}return[c.THEME_STANDARD]};this.getThemeType=function(){return d[c.getTheme()]};this.isClassic=function(){return c.getTheme()===c.THEME_CLASSIC};this.isClassicType=function(){return c.getThemeType()===c.TYPE_CLASSIC};this.isStandard=function(){return c.getTheme()===c.THEME_STANDARD};this.isStandardType=function(){return c.getThemeType()===c.TYPE_STANDARD};this.isThottbot=function(){return c.getTheme()===c.THEME_THOTTBOT};this.set=function(f){if(c.getThemes().indexOf(f)<0){alert(WH.TERMS.invalidOption);WH.error("Tried to set an invalid theme:",f);return}WH.User.saveOption("theme",f,function(){window.location=window.location.href})}};WH.Tools=new function(){var d={cta:{}};this.createMountCollectionTrackerCta=function(){return d.cta.mountTracker=d.cta.mountTracker||c("mount",WH.TERMS.mountCollectionTracker,"/mount-collection-tracker")};this.createBattlePetCollectionTrackerCta=function(){return d.cta.battlePetTracker=d.cta.battlePetTracker||c("pet",WH.TERMS.battlePetCollectionTracker,"/battle-pet-collection-tracker")};this.createToyCollectionTrackerCta=function(){return d.cta.toyTracker=d.cta.toyTracker||c("toy",WH.TERMS.toyCollectionTracker,"/toy-collection-tracker")};function c(m,g,f){var l=WH.ce("div",{className:"collection-tracker-cta"});l.setAttribute("data-type",m);var o=WH.ce("div",{className:"collection-tracker-cta-name"});WH.st(o,g);WH.ae(l,o);var p=WH.ce("div",{className:"collection-tracker-cta-name-all-new"});WH.st(p,WH.TERMS.allNew_tip);WH.aef(o,p);var h=WH.createButton(WH.TERMS.collectionCta_button);WH.ae(l,h);WH.ae(l,WH.ce("span",{className:"collection-tracker-cta-primary"}));WH.ae(l,WH.ce("span",{className:"collection-tracker-cta-left"}));WH.ae(l,WH.ce("span",{className:"collection-tracker-cta-center"}));WH.ae(l,WH.ce("span",{className:"collection-tracker-cta-right"}));WH.ae(l,WH.ce("span",{className:"collection-tracker-cta-gradient"}));WH.ae(l,WH.ce("a",{className:"collection-tracker-cta-cover",href:f}));return l}};WH.Tooltip.titleToTooltip=function(c){$(c).each(function(){WH.Tooltip.simple(this,'<span class="no-wrap">'+this.title+"</span>","q");this.removeAttribute("title");this.classList.add("tip")})};WH.Track=new function(){var d={adsBlocked:3,adsUnblocked:4,loggedInUserIsPremium:2,userIsLoggedIn:1,userShouldSeeAds:5};var m=false;var h=10000;var g=10;this.addClickEvents=function(u,p,B){if(!p||!p.actions||!p.category){if(WH.isDev()){WH.log("Tried to add analytics event without appropriate parameters.");WH.log(u);WH.log(p)}return}var q=p.category;var A=WH.gE(u,"a");for(var v=0,z;z=A[v];v++){var r="Follow link";for(var t in p.actions){if(p.actions.hasOwnProperty(t)&&p.actions[t]&&p.actions[t](z)){r=t;break}}var w=(B?B+"-":"")+c(z);$(z).click(WH.Track.interactiveEvent.bind(null,q,r,w))}};this.gaInit=function(q){if(!window.ga||!ga.create){if(!q){q=1}if(q>100){return}setTimeout(WH.Track.gaInit.bind(WH.Track,q+1),q*9);return}ga("create","UA-574613-1","wowhead.com");l(d.userShouldSeeAds,WH.WAS.showAds());l(d.userIsLoggedIn,WH.User.isLoggedIn());if(WH.User.isLoggedIn()){l(d.loggedInUserIsPremium,WH.User.isPremium())}if(WH.WAS.showAds()){var p=WH.ce("ins",{className:"AdSense",style:{display:"block",height:"1px",position:"absolute",top:"-1px"}});document.body.appendChild(p);l(d.adsBlocked,!p.clientHeight);document.body.removeChild(p)}ga("set","anonymizeIp",true);ga("send","pageview");m=true};this.interactiveEvent=function(q,t,p,r){f(q,t,p,r)};this.linkClick=function(q,r,p){if(!m){return}if(typeof r=="function"){r=r(q)}if(typeof p=="function"){p=p(q)}WH.debug("Track Click:",r,p,q.href);ga("send","event",r,"click",p,q.href,{transport:"beacon"});if(p&&p.indexOf("News - View Article")==0){ga("send","event","News","View full version",WH.News.getSubjectFromChild(q),{nonInteraction:1,transport:"beacon"})}};this.nonInteractiveEvent=function(q,t,p,r){f(q,t,p,r,true)};this.setLinkClickEvent=function(q,r,p){if(!q.href||q.href.indexOf("javascript:")===0){return}WH.aE(q,"click",WH.Track.linkClick.bind(null,q,r,p))};function c(p){var r="unknown";var q=WH.getFirstTextContent(p);if(q){r=WH.Strings.slug(q)}else{if(p.title){r=WH.Strings.slug(p.title)}else{if(p.id){r=WH.Strings.slug(p.id)}}}return r}function l(p,q){ga("set","dimension"+p,q)}function o(){var q={"database-logo":{category:"Homepage Logo",actions:{"Click image":function(t){return true}}},"sidebar-container":{category:"Page sidebar",actions:{"Click image":function(t){return true}}}};for(var r in q){var p=WH.ge(r);if(p){WH.Track.addClickEvents(p,q[r])}}}function f(r,u,q,t,w,v){var p=WH.debug.bind(null,"Track Event:",r,u,q,t,w,v);if(!v){p()}if(!m){if(WH.isDev()){return}if(!v){v=0}v++;if(v*g>h){return}setTimeout(f.bind(null,r,u,q,t,w,v),g);return}if(v){p()}if(typeof w==="boolean"){ga("send","event",r,u,q,t,{nonInteraction:w?1:0})}else{ga("send","event",r,u,q,t)}}$(o)};WH.Url=new function(){const d=this;var c="wowhead.com";this.addGet=function(o,h,m){if(o instanceof Location){o=""+o}if(typeof o!=="string"){WH.error("Tried to add a get arg to a non-string!",o,h,m);return o}if(o.substr(-12)==="wowhead.com/"){o+="home"}var l=h+"\\b(=*[^&]+)?";if(o.indexOf("?"+h)>-1){o=o.replace(new RegExp("\\?"+l),"")}if(o.indexOf("&"+h)>-1){o=o.replace(new RegExp("&"+l),"")}return o+(o.indexOf("?")===-1&&o.indexOf("&")===-1?"?":"&")+h+(m?"="+m:"")};this.addMaxSizeParams=function(h,l){let usingStatic=/^https?:\/\/wow\.zamimg\.com/.test(h);usingStatic|=h.substr(0,WH.staticUrl.length)===WH.staticUrl;if(!usingStatic){return h}if(/^https?:\/\/[^\/]+\/modelviewer\//.test(h)){return h}let config=WH.PageMeta.staticResizing||{limit:600,throttle:{start:600,percent:0}};let nativeRes=f(h);let queryParams=d.parseQueryString(h);let findQueryParamName=function(m){m=m.toLowerCase();for(let k in queryParams){if(!queryParams.hasOwnProperty(k)){continue}if(k.toLowerCase()===m){return k}}};let pixelRatio=Math.max(1,Math.ceil((window.devicePixelRatio||1)*2)/2);let madeChange=false;let madeThrottledChange=false;["width","height"].forEach(function(m){if(!l[m]){return}let match=/^(\d+)(?:px)?$/.exec(l[m]);if(match===null){return}let amount=Math.ceil(parseInt(match[1])*pixelRatio);if(amount>config.limit){return}if(nativeRes[m]&&amount>=nativeRes[m]){return}madeThrottledChange=madeThrottledChange||(amount>config.throttle.start);let queryParamName="max"+m.substr(0,1).toUpperCase()+m.substr(1);queryParamName=findQueryParamName(queryParamName)||queryParamName;let startingAmount=queryParams[queryParamName];if(startingAmount){if(/\D/.test(startingAmount)){return}startingAmount=parseInt(startingAmount)}if(startingAmount>amount){return}madeChange=true;queryParams[queryParamName]=amount});if(!madeChange){return h}if(madeThrottledChange){if(parseInt(WH.MD5.hash(h).substr(-2),16)/255>(config.throttle.percent/100)){return h}}let hash="";let hashPos=h.indexOf("#");if(hashPos>=0){hash=h.substr(hashPos);h=h.substr(0,hashPos)}let queryPos=h.indexOf("?");if(queryPos>=0){h=h.substr(0,queryPos)}let queryString=d.buildQuery(queryParams);return h+"?"+queryString+hash};this.buildQuery=function(h){let queryStringComponents=[];for(let property in h){if(!h.hasOwnProperty(property)){continue}if(h[property]===""){queryStringComponents.push(property)}else{queryStringComponents.push(property+"="+encodeURIComponent(h[property]).replace(/%3a/ig,":"))}}return queryStringComponents.join("&")};this.ensurePathSlash=function(h){if(h.substr(0,1)!=="/"){h="/"+h}return h};this.generate=function(l,h){h=h||{};let host=c;let scheme="https:";let subdomain=typeof h.subdomain==="string"?h.subdomain:((h.hasOwnProperty("dataEnv")||h.hasOwnProperty("locale"))?d.getSubdomain(h.dataEnv,h.locale):undefined);if(h.production){if(subdomain){host=subdomain+"."+host}}else{host=d.getHost(subdomain);scheme=location.protocol}if(host===c){host="www."+host}return scheme+"//"+host+d.ensurePathSlash(l)};this.getBetaSubdomain=function(){return WH.BETA_DOMAIN||WH.dataEnvTerm[WH.dataEnv.BETA]};this.getCanonical=function(){var h=WH.qs('link[rel="canonical"]');if(!h){return location.protocol+"//"+location.host+location.pathname+(location.search||"")}return h.href};this.getCanonicalPath=function(){var h=WH.qs('link[rel="canonical"]');if(!h){return location.pathname+(location.search||"")}return d.getPathFromUrl(h.href,true)};this.getDataPageUrl=function(h,l){let pageVersions=WH.getPageData("WH.Url.dataPageVersions")||{};let params={locale:Locale.getId(),dataEnv:l||WH.getDataEnv(),dv:pageVersions[h]||0,b:WH.getDataBuild()};return WH.Url.generate("/data/"+h+"?"+WH.Url.buildQuery(params),{dataEnv:params.dataEnv})};this.getHost=function(m){var l=c;var o="";if(WH.isDev()){o=location.hostname.replace("."+l,"");var h=o.lastIndexOf(".");if(h>=0){o=o.substr(h+1)}}if(o){l=o+"."+l}if(m===undefined){m=d.getSubdomain()}if(!m&&!o){m="www"}if(m){l=m+"."+l}return l};this.getLoginPath=function(h){let path="/account=signin";h=(h===undefined?location.pathname:h).replace(/^\//,"");if(h){path+="?next="+encodeURIComponent(h)}return path};this.getPathFromUrl=function(h,l){if(l===true){return h.replace(/^(?:(?:https?:)?\/\/[^/]+)?\/?([^#]+).*$/,"/$1")}return h.replace(/^(?:(?:https?:)?\/\/[^/]+)?\/?([^?&#]+).*$/,"/$1")};this.getRegistrationPath=function(){return"/account=signup"};this.getSubdomain=function(o,h){o=o||WH.getDataEnv();var l=Locale.getDataEnvForcedLocale(o);if(l!==undefined){h=l}else{if(h===undefined){h=Locale.getId()}}var m=[];if(h!==LOCALE_ENUS){m.push(WH.getDomainFromLocale(h))}switch(o){case WH.dataEnv.MAIN:break;case WH.dataEnv.BETA:m.push(d.getBetaSubdomain());break;case WH.dataEnv.TBC:m.push("tbc");break;default:m.push(WH.dataEnvTerm[o])}return m.join(".")};this.modifyPageQuery=function(h){let modifiedUrl=d.modifyUrlQuery(location.href,h);if(modifiedUrl){history.replaceState({},"",modifiedUrl)}};this.modifyUrlQuery=function(h,l){let parsedUrl=g(location.href);if(!parsedUrl){return null}let query=WH.parseQueryString(parsedUrl.query||"");l(query);let url=parsedUrl.path;if(Object.keys(query).length){url+="?"+WH.Url.buildQuery(query)}if(parsedUrl.hash){url+="#"+parsedUrl.hash}return url};this.parseQueryString=function(h){let pos;if((pos=h.indexOf("#"))>=0){h=h.substr(0,pos)}pos=h.indexOf("?");if(pos<0){return{}}return WH.parseQueryString(h.substr(pos+1))};function f(h){let match;if(match=h.match(/\/uploads\/blog\/(images|thumbs)\/(\d+)/)){let meta=g_blogimages[match[2]];switch(match[1]){case"thumbs":return meta?{width:meta.thumbwidth,height:meta.thumbheight}:{width:200,height:200};case"images":return meta?{width:meta.width,height:meta.height}:{}}return{}}if(match=h.match(/\/uploads\/screenshots\/(normal|resized|small|thumb)\/(\d+)/)){let meta=WH.Gatherer.get(WH.Types.SCREENSHOT,match[2]);let maxWidth;let maxHeight;switch(match[1]){case"normal":return meta?{width:meta.width,height:meta.height}:{};case"resized":maxWidth=772;maxHeight=618;break;case"small":maxWidth=300;maxHeight=300;break;case"thumb":maxWidth=150;maxHeight=150;break}if(!maxWidth||!maxHeight){return{}}if(!meta){return{width:maxWidth,height:maxHeight}}let aspect=meta.width/meta.height;let width=Math.min(maxWidth,meta.width);let height=Math.round(width/aspect);if(height>maxHeight){height=maxHeight;width=Math.round(height*aspect)}return{width:width,height:height}}if(match=h.match(/\/uploads\/guide\/images\/(\d+)/)){let meta=WH.Gatherer.get(WH.Types.GUIDE_IMAGE,match[1]);return meta?{width:meta.width,height:meta.height}:{}}return{}}function g(h){let match=h.match(/^(((https?):)?(\/\/)?([^\/]+\.[^\/]+)?)?(\/([^/?&#][^?&#]*))?([?&]+([^#]*)?)?(#(.*)?)?$/);if(!match){return null}return{host:match[1],scheme:match[3],domain:match[5],path:match[6],query:match[9],hash:match[11]}}};WH.UserAgent=new function(){var c=["ahrefsbot","baiduspider","bingbot","blexbot","comscore.com/web-crawler","dotbot","duckduckbot","exabot","garlikcrawler","getintent","googlebot","ia_archiver","mail.ru_bot","mauibot","mediapartners-google","megaindex.com/crawler","mj12bot","naver.me/spd","piplbot","protopage","rogerbot","semrushbot","sogou.com/docs/","viglink","weborama","yahoo! slurp","yandexbot","yandexmobilebot"];this.isWebCrawler=function(){var g=navigator.userAgent;if(!g){return false}g=g.toLowerCase();for(var f=0,d=c.length;f<d;f++){if(g.indexOf(c[f])!==-1){return true}}return false}};var vi_thumbnails={1:"//i3.ytimg.com/vi/$1/default.jpg"};var vi_siteurls={1:"https://www.youtube.com/watch?v=$1",2:"https://www.wowhead.com/video-stream/$1"};var vi_sitevalidation=[/https?:\/\/(?:www\.)?youtube\.com\/watch\?v=([^& ]{11})/i,/https?:\/\/(?:www\.)?youtu\.be\/([^& ]{11})/i];function vi_submitAVideo(){tabsContribute.focus(2)}function vi_validateForm(d){if(!d.elements.videourl.value.length){alert(WH.TERMS.errorvideo_tip);return false}var g=false;for(var c in vi_sitevalidation){if(!vi_sitevalidation.hasOwnProperty(c)){continue}if(d.elements.videourl.value.match(vi_sitevalidation[c])){g=true;break}}if(!g){alert(WH.TERMS.errorvideo_tip);return false}return true}function vi_appendSticky(){var f=WH.ge("infobox-sticky-vi");if(!f){return}var h=g_pageInfo.type;var g=g_pageInfo.typeId;var o=WH.inArray(lv_videos,1,function(p){return p.sticky});if(o!=-1){f.className="has-thumb";var m=lv_videos[o];var c=WH.ce("a");c.href="#videos:id="+m.id;c.onclick=function(p){VideoViewer.show({videos:lv_videos,pos:o});return WH.rfWithoutControlKey(p)};var d=WH.ce("img");d.src=WH.sprintf(vi_thumbnails[m.videoType].replace(/\/default\.jpg/,"/mqdefault.jpg"),m.videoId);d.className="border";WH.ae(c,d);WH.ae(f,c);var l=$("#infobox-videos");if(!l){l=$("th",$(f).parents().prev("tr"))}l.append(" ("+lv_videos.length+")").wrapInner($('<a href="#videos"></a>').click(function(){tabsRelated.focus(tabsRelated.getTabById("videos"));return false}))}else{if(g_user){var c;if(g_user.id>0){c='<a href="javascript:" onclick="vi_submitAVideo(); return false">'}else{c='<a href="/account=signin">'}f.innerHTML=WH.sprintf(WH.TERMS.noneyet_format,c+WH.TERMS.suggestone_stc+"</a>")}else{$("#infobox-videos,#infobox-sticky-vi").closest("td, th").css("display","none")}}vi_appendSticky=function(){}}var g_videos=[];var VideoViewer=new function(){var v,r,w,H,M,c,A=0,C,p,z,d,q,E,F,J,t,D,o;function u(){var P=v[r];var O=Math.max(o.offsetHeight-18,0),N=Math.max(50,Math.min(520,WH.getWindowSize().h-72-O)),Q=Math.min(1,N/520);w=Math.round(Q*880);H=Math.round(Q*520);E.style.height=F.style.height=J.style.height=(H-95)+"px";Lightbox.setSize(Math.max(480,w)+Lightbox.UI_WIDTH)}function g(P){var N=v[P],O="#videos:";if(A==0){O+="id="+N.id}else{O+=C+":"+(P+1)}return O}function L(V){if(V&&(M==1)&&WH.getWindowSize().h>z.offsetHeight){return}z.style.visibility="hidden";var N=v[r];u();if(!V){var U=(N.caption!=null&&N.caption.length);WH.Track.interactiveEvent("Videos","Show",N.id+(U?" ("+N.caption+")":""));t.href=WH.sprintf(vi_siteurls[N.videoType],N.videoId);switch(N.videoType){case 1:$(q).empty().append(WH.markup.getDomFragment("[youtube="+N.videoId+" width="+w+" height="+H+"]"));break;case 2:WH.ee(q);WH.ae(q,WH.ce("video",{controls:true,width:w,height:H},WH.ce("source",{src:WH.Url.generate("/video-stream/"+N.id+"-"+N.videoId,{dataEnv:WH.dataEnv.MAIN,locale:LOCALE_ENUS})})));t.href=WH.sprintf(vi_siteurls[N.videoType],N.id+"-"+N.videoId);break}if(!N.user&&typeof g_pageInfo=="object"){N.user=g_pageInfo.username}var T=(N.date&&N.user),S=(v.length>1);if(T){var R=new Date(N.date),X=(WH.getServerTime()-R)/1000;var W=D.firstChild.childNodes[1];W.href="/user="+N.user;W.innerHTML=N.user;var aa=D.firstChild.childNodes[3];WH.ee(aa);WH.formatDate(aa,X,R);D.firstChild.style.display=""}else{D.firstChild.style.display="none"}var aa=D.childNodes[1];WH.ee(aa);aa=D.childNodes[2];if(S){var Z="";if(N.user){Z=LANG.dash}Z+=(r+1)+WH.TERMS.of_lc+v.length;aa.innerHTML=Z;aa.style.display=""}else{aa.style.display="none"}D.style.display=(T||S?"":"none");var O=(N.subject!=null&&N.subject.length&&N.type&&N.typeId);if(U||O){var Q="";if(O){var Y=WH.ce("div");WH.ae(Y,WH.ct(WH.Types.getUpperSingular(N.type)+WH.TERMS.colon_punct));WH.ae(Y,WH.ce("a",{href:WH.Entity.getPath(N.type,N.typeId)},WH.ct(N.subject)));Q+=Y.innerHTML}var P=document.createDocumentFragment();if(U){if(O){Q+=LANG.dash}P=N.noMarkup?document.createTextNode(N.caption):WH.markup.getDomFragment(N.caption,{mode:WH.markup.MODE.SIGNATURE})}$(o).html(Q).append(P);o.style.display=""}else{o.style.display="none"}if(v.length>1){E.href=g(K(-1));F.href=g(K(1));E.style.display=F.style.display="";J.style.display="none"}else{E.style.display=F.style.display="none";J.style.display=""}location.replace(g(r))}else{$("object, embed",q).each(function(){this.width=w;this.height=H})}Lightbox.reveal();z.style.visibility="visible";setTimeout(m,1)}function K(O){var N=r;N+=O;if(N<0){N=v.length-1}else{if(N>=v.length){N=0}}return N}function G(){r=K(-1);L();return false}function I(){r=K(1);L();return false}function m(){if(p){document.title=p}}function f(N){N=WH.normalizeEvent(N);switch(N.keyCode){case 37:G();break;case 39:I();break}}function l(){L(1)}function h(){WH.ee(q);if(v.length>1){WH.dE(document,"keyup",f)}if(c&&A==0){if(c.indexOf(":id=")!=-1){c="#videos"}WH.setHash(c)}else{WH.clearHash()}m()}function B(V,P,O){if(typeof O.videos=="string"){v=g_videos[O.videos];A=1;C=O.videos}else{v=O.videos;A=0;C=null}z=V;r=0;if(O.pos&&O.pos>=0&&O.pos<v.length){r=O.pos}if(P){V.className+=" has-lightbox-caption screenshotviewer";d=WH.ce("div");d.className="lightbox-content screenshotviewer-screen";var X=WH.ce("div");var S=WH.ce("div");X.className="screenshotviewer-page-wrapper screenshotviewer-prev-wrapper";S.className="screenshotviewer-page-wrapper screenshotviewer-next-wrapper";E=WH.ce("a");F=WH.ce("a");E.className="screenshotviewer-prev";F.className="screenshotviewer-next";E.href="javascript:";F.href="javascript:";var Q=WH.ce("span");Q.className="fa fa-chevron-left";WH.ae(E,Q);Q=WH.ce("span");Q.className="fa fa-chevron-right";WH.ae(F,Q);E.onclick=G;F.onclick=I;J=WH.ce("a");J.className="screenshotviewer-cover";J.href="javascript:";J.onclick=Lightbox.hide;var T=WH.ce("span");var U=WH.ce("b");WH.ae(U,WH.ct(WH.TERMS.close));WH.ae(T,U);WH.ae(J,T);WH.ae(X,E);WH.ae(S,F);WH.ae(d,X);WH.ae(d,S);WH.ae(d,J);q=WH.ce("div",{className:"screenshotviewer-image"});WH.ae(d,q);WH.ae(V,d);var R=WH.ce("a");R.className="dialog-option fa fa-times";R.href="javascript:";R.onclick=Lightbox.hide;WH.ae(R,WH.ct(WH.TERMS.close));WH.ae(V,R);t=WH.ce("a");t.className="dialog-option fa fa-external-link";t.href="javascript:";t.target="_blank";WH.ae(t,WH.ct(WH.TERMS.original));WH.ae(V,t);var W=WH.ce("div",{className:"lightbox-caption"});D=WH.ce("div");D.className="screenshotviewer-from";var N=WH.ce("span");WH.ae(N,WH.ct(WH.TERMS.from));WH.ae(N,WH.ce("a"));WH.ae(N,WH.ct(" "));WH.ae(N,WH.ce("span"));WH.ae(D,N);WH.ae(D,WH.ce("span"));WH.ae(D,WH.ce("span"));WH.ae(W,D);o=WH.ce("div");o.className="screenshotviewer-caption";WH.ae(W,o);WH.ae(V,W)}c=location.hash;if(v.length>1){WH.aE(document,"keyup",f)}L()}this.checkPound=function(){p=$("title").html();if(location.hash&&location.hash.indexOf("#videos")==0){if(!g_listviews.videos){var O=location.hash.split(":");if(O.length==3){var P=g_videos[O[1]],N=parseInt(O[2]);if(P&&N>=1&&N<=P.length){VideoViewer.show({videos:O[1],pos:N-1})}}}}};this.show=function(N){Lightbox.show("videoviewer",{onShow:B,onHide:h,onResize:l},N);return false};$(document).ready(this.checkPound)};WH.WarcraftLogs=new function(){const c=WH.Gatherer;const d=WH.Types;this.displayTopSpells=function(f,E,g,D,h){var m=WH.ce("div",{className:g});WH.ae(m,WH.getImitationHeading(E,6));var A=WH.ce("table");var t=WH.ce("tr",{className:g+"-popularity"});var p=WH.ce("tr",{className:g+"-icon"});WH.ae(A,t);WH.ae(A,p);var z=0;if(D){for(var w=0,o;o=D[w];w++){var C=WH.Gatherer.get(WH.Types.SPELL,o.id);if(!C){continue}var l=WH.Wow.Spell.getPath(o.id,C.name);var B=WH.Icon.create(C.icon,WH.Icon.SMALL,l,{span:true});var v=Icon.getLink(B);v.setAttribute("data-whattach","true");if(h){v.target="_blank"}var q=WH.ce("td");WH.ae(q,B);WH.ae(t,WH.ce("td",{innerHTML:Math.round(o.pop)+"%"}));WH.ae(p,q);z++}}var u=0;if(!z){WH.de(p);var r=WH.ce("td",{innerHTML:WH.TERMS.notenoughdata});WH.ae(t,r);u++}WH.ae(m,A);if(f instanceof jQuery){f.append(m)}else{WH.ae(f,m)}return u};this.getCovenantTooltip=function(f){let tooltip=WH.ce("div");WH.ae(tooltip,WH.ce("b",{className:"q1"},WH.ct(c.getName(d.COVENANT,f.id))));let soulbindsTable=WH.ce("table",{style:{marginTop:"10px"}});WH.ae(tooltip,soulbindsTable);f.soulbinds.forEach(function(g){let percentCell=WH.ce("td",{className:"q",style:{paddingRight:"3px",textAlign:"right"}},WH.ct(WH.Strings.formatNumber(g.pop/100,true,0,1)));let name=g.id?c.getName(d.SOULBIND,g.id):null;if(!name){if(g.pop<0.5){return}name=WH.TERMS.unknown+" / "+WH.TERMS.none}let nameCell=WH.ce("td",{className:"q",style:{whiteSpace:"nowrap"}},WH.ct(name));let row=WH.ce("tr");WH.ae(row,percentCell);WH.ae(row,nameCell);WH.ae(soulbindsTable,row)});return tooltip.innerHTML}};WH.WAS=new function(){const h=this;var A=333;var w=1000*60*10;var d="Other";var D="Other";var N=100;var v="skinned";const t=Math.floor(Date.now()/1000)%10===0;const r="horizontal";const z="horizontalBTF";const K="mobileFooter";const Q="mobileMedrec";const p="skin";const c="vertical";const T={};T[r]="horizontal-block-bg is-atf";T[z]="horizontal-block-bg is-btf";T[c]="vertical-block-bg is-atf";T[p]="skin-block-bg";T[K]="mobile-fixed-footer-block-bg";T[Q]="block-block-bg is-btf";var f={channelGroup:"",channelName:"",elements:{headerWrapper:undefined},headerWrapperHeight:undefined,postSkinSetupCallbacks:[],rejected:{},removed:false,skin:null};this.init=function(W,Y,X){F(Y);U(W);if(X instanceof Array){M(W,Y,X);if(X.indexOf(r)!==-1){B("Unit requested",r)}if(X.indexOf(p)!==-1){B("Unit requested",p)}}};this.addMobileMedrec=function(W){if(Platform.getViewportWidth()>=768){return}if(WH.ge("ad-"+Q)){return}let target=WH.qs(W);if(!(target instanceof Node)){WH.error("Failed to find mobile medrec target.",W);return}WH.ae(target,WH.ce("div",{className:"block-block-bg"},WH.ce("div",{id:"ad-"+Q})));this.display(Q)};this.addPostSkinSetupCallback=function(W){if(typeof W=="function"){f.postSkinSetupCallbacks.push(W)}};this.addVideoCloser=function(){let acContainer=WH.ge("ac-container");if(!acContainer){let fixedWrapper=WH.qs("#video-pos-fixed");if(!fixedWrapper){if(document.readyState!=="complete"){WH.onLoad(WH.WAS.addVideoCloser)}else{WH.error("Could not find the video container.")}return}WH.onMutate(fixedWrapper,WH.WAS.addVideoCloser,{triggerOnce:true});return}var W=WH.qs(".ac-player-playlist");if(!WH.qs(".ac-player-ph")||(W&&W.style.display!=="none")){WH.onMutate(acContainer,WH.WAS.addVideoCloser,{triggerOnce:true});return}var X=WH.ce("a",{className:"ac-closer"},WH.ce("span"));WH.aE(X,"click",WH.Responsive.removeFixedPosition);WH.ae(acContainer,X)};this.display=function(W){window.zamaf.cmd.push(function(){window.zamaf.displaySync("ad-"+W)})};this.displaySkin=function(W){if(Platform.getViewportWidth()<1250||J()){B("Unit rejected by Wowhead",p);WH.WAS.removeSkin();return false}if(f.skin!==null){WH.WAS.removeSkin(true)}f.skin=W;document.body.classList.add(v);if(W.sidesOnly){document.body.classList.add(v+"-sides-only")}else{document.body.classList.add(v+"-H");if(W.usePageLeaderboard){document.body.classList.add(v+"-use-page-leaderboard")}document.body.classList.add(v+"-height-"+u(W))}WH.WAS.updateSkinPosition(true);WH.aE(window,"scroll",WH.WAS.updateSkinPosition);q(W);WH.Track.nonInteractiveEvent("Skin","Skin Displayed",W.creative,W.lineItem);B("Impression",p);return true};this.getChannelGroup=function(){return f.channelGroup||d};this.getChannelName=function(){return f.channelName||D};this.getDfpLog=function(){var W=WH.LocalStorage.get("dfpLog");if(W){try{W=JSON.parse(W)}catch(X){}}if(!(W instanceof Array)){return[]}return W};this.hideAll=function(){var W=R();W.attr("data-hidden-by-was","true")};this.initVideo=function(){h.addVideoCloser();WH.Responsive.test()};this.intersect=function(ab,ac){var ad;var aa;var X=R();for(var Y=0,W=X.length;Y<W;++Y){var Z=X[Y];if(Z){if(!o(Z)){ad=WH.ac(Z);aa=WH.createRect(ad.x,ad.y,Z.offsetWidth,Z.offsetHeight);if(WH.intersectRect(ab,aa)){if(ac){O(Z)}return Z}}}}return false};this.isSkinned=function(){return f.skin!==null||document.body.classList.contains("skinned")};this.removeAll=function(){f.removed=true;var X=$(".layout > .blocks, #main > .blocks, #page-content > .blocks");X.slideUp({complete:function(){X.remove();$(".horizontal-block-bg, .header-block-bg, .footer-block-bg").remove()},duration:A});var Z=$(".sidebar");Z.animate({top:"0px"},A,false);var W=$(".block-block-bg");W.slideUp({complete:function(){W.remove();W.parent(":empty").remove()},duration:A});Z.empty();var Y=$(".dynamic-ad");Y.slideUp({complete:function(){Y.remove()},duration:A});WH.WAS.removeAnyClip();setTimeout(function(){$("[data-contains-block]").removeAttr("data-contains-block");$("[data-left-contains-block]").removeAttr("data-left-contains-block")},A+1);WH.WAS.removeSkin()};this.removeAnyClip=function(){WH.qsa("#video-pos-body, #video-pos-fixed, #video-pos-page, #video-pos-static").forEach(function(W){WH.de(W)});WH.qsa('[data-has-video-unit="true"]').forEach(function(W){W.dataset.hasVideoUnit="false"})};this.removeSkin=function(X){if(X!==true){$("#ad-skin, .skin--link").remove();document.body.classList.remove("body--skin");document.body.style.background=""}Array.prototype.slice.call(document.body.classList).forEach(function(Y){if(Y.indexOf(v)===0){document.body.classList.remove(Y)}});if(f.skin&&!f.skin.sidesOnly&&!f.skin.usePageLeaderboard){var W=WH.qs(".sidebar-wrapper");if(W){W.style.top="10px"}}$("#video-pos-static").appendTo(".main > .blocks");f.skin=null;WH.Layout.Responsive.updateHeaderOffset()};this.restoreHidden=function(){$('[data-hidden-by-was="true"]').attr("data-hidden-by-was","false")};this.setupDynamicUnits=function(){if(!WH.WAS.showAds()){return}window.zamaf.cmd.push(function(){window.zamaf.displayAllDynamic()})};this.showAds=function(){return g_user.ads&&!f.removed};this.updateSkinPosition=function(W){if(!f.elements.headerWrapper){f.elements.headerWrapper=WH.qs(".header-wrapper");if(!f.elements.headerWrapper){if(document.readyState==="complete"){h.updateSkinPosition=function(){}}return}}var X=f.elements.headerWrapper.getBoundingClientRect().height;var aa=h.isSkinned()?X:undefined;if(f.headerWrapperHeight!==aa||W===true){document.body.style.backgroundPosition=aa?"center "+aa+"px":null;f.headerWrapperHeight=aa}if(WH.Theme.isClassicType()){var Z=WH.Layout.getElement("page-content");if(Z){var Y=f.skin!==null?u(f.skin):(h.isSkinned()?250:null);Z.style.marginTop=Y?X+Y+10+"px":null}}};this.validateUnit=function(W){if(f.rejected[W]){delete f.rejected[W];V(W)}};function L(X,Z,aa){var W=aa?"block-premium-info":"block-remove";if([p,K].indexOf(X)>-1||$("."+W,Z).length){return}var Y=WH.ce("a",{innerHTML:aa?"<b>"+WH.TERMS.wowheadpremium+"</b><br>"+WH.TERMS.premiumupgradeshort_tip:WH.TERMS.removeallads,href:"/premium",className:W});WH.ae(Z,Y)}function I(aa,Z,ac){var X=(WH.WAS.getChannelName()).match(/\bTest\b/)||WH.isDev()||WH.User.hasRole(U_GROUP_ADMIN);var W=[0,0];var ab=WH.ge(Z);if(ab.dataset.unitWidth&&ab.dataset.unitHeight){W=[parseInt(ab.dataset.unitWidth),parseInt(ab.dataset.unitHeight)]}if(!g(W,ac)){var Y=WH.qs("iframe",Z);if(Y){W=[parseInt(Y.getAttribute("width")),parseInt(Y.getAttribute("height"))];if(X){WH.warn("IFRAME UNIT SIZES:",W[0],W[1],"FROM THIS IFRAME:",Y)}}}return W}function u(W){return W.sidesOnly?null:(f.skin.splitHeight||90)}function G(aa){if(aa.id&&aa.id.indexOf("skin")!==-1){return aa}if(aa.getAttribute("data-was-unit")==="true"){return aa.parentNode}if(aa.getAttribute("data-was-parent")==="true"){return aa}if(aa.parentNode.getAttribute("data-was-unit")==="true"){return aa.parentNode.parentNode}if(aa.parentNode.getAttribute("data-was-parent")==="true"){return aa.parentNode}if(aa.className){var Y=m();var W=false;if(Y.indexOf(aa.className)>-1){W=true}if(!W){for(var X=0,Z;Z=Y[X];X++){if(aa.className.indexOf(Z)>-1){W=true;break}}}if(!W){return aa.parentNode}}else{return aa.parentNode}return aa}function m(){var W=[];for(var X in T){if(W.indexOf(T[X])===-1){W.push(T[X])}}m=(function(Y){return Y}).bind(null,W);return W}function R(){return $("."+(m()).join(", ."))}function O(X){var W=G(X);W.setAttribute("data-hidden-by-was","true")}function P(){window.zamaf=window.zamaf||{};window.zamaf.cmd=window.zamaf.cmd||[];var Y=WH.isBlizzardReferral();if(Y){var X=Date.now?Date.now():new Date().getTime();WH.LocalStorage.set("blizz-skin-suppression",X+w);if(Y==="brl"){var W=(""+location.href).replace(/[\?&]brl=[^\?&#]*/,"").replace(/[\?&]brl\b/,"").replace(/^(https?:\/\/[^\/]+\/)home$/,"$1");if(window.history&&window.history.replaceState){window.history.replaceState({},"",W)}else{location.replace(W)}}}}function M(W,Y,X){window.zamaf=window.zamaf||{};window.zamaf.cmd=window.zamaf.cmd||[];window.zamaf.setTargeting=function(){googletag.pubads().setTargeting("Channel",W);googletag.pubads().setTargeting("ChannelGroup",Y)};window.zamaf.slotRenderCallback=l.bind(this);window.zamaf.skinRenderCallback=WH.WAS.displaySkin.bind(this);window.zamaf.cmd.push({event:"zaf:slot:rejected",handler:H})}function o(Y,X){var W=G(Y);if(W){if(X){return W.style.visibility=="hidden"}else{return W.getAttribute("data-hidden-by-was")=="true"}}return false}function g(W,X){if([p,K].indexOf(X)>=0){return true}return W&&W[0]&&W[1]&&W[0]!==1&&W[1]!==1}function E(Z,ab,Y){var W={_time:(new Date).toUTCString(),_slot:ab,_channelName:WH.WAS.getChannelName(),_channelGroup:WH.WAS.getChannelGroup()};if(Y){W._error=Y}for(var aa in Z){if(Z.hasOwnProperty(aa)&&((typeof Z[aa]!=="object"||!Z[aa])||aa==="size")){W[aa]=Z[aa]}}var X=(WH.WAS.getDfpLog()).slice(0,N-1);X.unshift(W);WH.LocalStorage.set("dfpLog",JSON.stringify(X))}function q(Y){if(!Y.sidesOnly){$("#video-pos-static").prependTo(".page-content")}if(!Y.usePageLeaderboard&&!Y.sidesOnly){$("#main > .blocks").remove()}WH.updateContentHeight();for(var W=0,X;X=f.postSkinSetupCallbacks[W];W++){X(Y)}WH.Layout.collapseInteriorSidebar();$(".element-highlight:not(#highlight-highlight-classic)").remove()}function H(X,W){if(X&&typeof X.elementId==="string"){if(X.elementId.indexOf(r)!==-1){B("Unit rejected by ZAF",r)}if(X.elementId.indexOf(p)!==-1){B("Unit rejected by ZAF",p)}WH.debug(X.elementId+" unit rejected by ZAF.",X);V(X.elementId)}else{WH.debug("Unknown unit rejected by ZAF.",X)}}function C(ac,ab){if(!ac){return}var aa=ac.parentNode;if(!aa){return}if(!ab){var Y=G(ac);var W=$(Y);for(var X in T){if(T.hasOwnProperty(X)&&T[X]){var Z=W.closest("."+T[X].split(" ").join("."));if(Z.length){ab=X;break}}}}aa.removeChild(ac);switch(ab){case r:case z:$(aa).closest(".blocks").remove();break}}function V(W){WH.debug("Removing "+W+" unit.");if(typeof W!=="string"){return}var X=WH.ge(W);if(!X){f.rejected[W]=true;return}C(G(X)||X,W.replace(/^ad-/,""))}function F(W){f.channelGroup=W}function U(W){f.channelName=W}function S(ae,ab,aa,W){var Z=G(ab);if(!Z){if(ae===r||ae===p){B("Impression shown but slot callback failed",ae)}return}if(ae===r||ae===p){B("Impression shown and slot callback succeeded",ae)}aa=parseInt(aa);W=parseInt(W);Z.className=Z.className.replace(/ *\bis-[0-9]+x[0-9]+\b/g,"");Z.className+=" is-"+aa+"x"+W;L(ae,Z);L(ae,Z,true);if(ae===K){if(!Z.querySelector(".mobile-footer-closer")){var Y=WH.ce("a",{className:"mobile-footer-closer"});Y.onclick=function(){WH.de(this.parentNode)};Z.appendChild(Y)}}var X=aa+"x"+W;if(aa===728||aa===970){var ac=Z.parentNode.parentNode;ac.setAttribute("data-contains-block",X);if(ac.parentNode&&ac.parentNode.parentNode&&ac.parentNode.parentNode.parentNode&&ac.parentNode.parentNode.parentNode.setAttribute){ac.parentNode.parentNode.parentNode.setAttribute("data-contains-block",X)}}else{if(typeof ae==="string"&&ae.match(/^vertical/)){$(ab).closest(".sidebar").attr("data-contains-sidebar-block",X);$(".layout-wrapper").attr("data-contains-sidebar-block",X);WH.updateContentHeight()}}}function l(ab){var Y=ab.slot.getSlotElementId();var ac=Y.replace("ad-","");if(ac===p){return}var aa=WH.ge(Y);if(aa&&aa.className.indexOf("zamaf-au")>-1){return}if(!aa){var X='Div for DFP unit "'+ac+'" not found!';WH.debug(X);E(ab,ac,X);return}if(ab.isEmpty){WH.info("No slot rendered in DFP event!",ab);E(ab,null,"No slot rendered in DFP event.");return}E(ab,ac);var Z=I(ab,aa,ac);S(ac,aa,Z[0],Z[1]);if(WH.qs(".block-report",aa.parentNode)){return}var W=WH.ce("a",{text:WH.TERMS.reportad,className:"block-report",onclick:(function(ae,ad){WH.Layout.expandSite();ContactTool.show();$('select[name="reason"]').val(9);setTimeout(function(){$('input[name="email"]').focus()},1)}).bind(null,aa,ac)});WH.ae(aa.parentNode,W)}function J(){var W=WH.isBlizzardReferral();var Y=WH.LocalStorage.get("blizz-skin-suppression");if(Y){Y=parseInt(Y);var X=Date.now?Date.now():new Date().getTime();if(!isNaN(Y)&&Y>X&&Y<X+w+(1000*20)){W=true}else{WH.LocalStorage.remove("blizz-skin-suppression")}}J=(function(Z){return Z}).bind(null,W);return W}function B(Y,W,X){if(t){WH.Track.nonInteractiveEvent("Ads",Y,W,X)}}P()};var WAS={displaySkin:WH.WAS.displaySkin};WH.WebP=new function(){const c=this;var f=10;var g={lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"};this.feature=Object.freeze({lossy:"lossy",lossless:"lossless",alpha:"alpha",animation:"animation"});var h={bodyFrameWaitCount:0,supports:{lossy:undefined,lossless:undefined,alpha:undefined,animation:undefined}};this.getImageExtension=function(){return h.supports.alpha?".webp":".png"};this.supportsFeature=function(o,p){if(typeof h.supports[o]==="boolean"){requestAnimationFrame(function(){p(o,h.supports[o])})}var m=new Image();m.onload=function(){var q=(m.width>0)&&(m.height>0);h.supports[o]=q;p(o,q)};m.onerror=function(){h.supports[o]=false;p(o,false)};m.src="data:image/webp;base64,"+g[o]};function l(){c.supportsFeature(c.feature.alpha,function(o,m){d(m)})}function d(m){if(!document.body){if(h.bodyFrameWaitCount>f){window.addEventListener("DOMContentLoaded",d.bind(this,m));return}h.bodyFrameWaitCount++;requestAnimationFrame(d.bind(this,m));return}document.body.classList.add(m?"webp":"no-webp")}l()};WH.Weights=new function(){this.allowWeights=function(){return!WH.isRetailTree()}};function wt_getScaleFacetOptions(g,p){var f=[];if(g){if(g.weights){for(var l in g.weights){if(g.weights.hasOwnProperty(l)){f.push([l,g.weights[l]])}}}else{for(var l=0,d;d=items_filterConfig.filters[l];l++){if(LANG.traits[d.term]&&g[d.term]){f.push([d.id,g[d.term]])}}}}f.sort(function(t,r){return-WH.stringCompare(t[1],r[1])});var m=[],o=[];for(var h=0,q;q=f[h];h++){m.push(q[0]);o.push(q[1])}if(m.length&&o.length){var c={weights:m.join(":"),"weight-values":o.join(":")};if(p){c["gem-quality"]=3}return c}return{}}function wt_getScaleFilter(g,c){if(!WH.Weights.allowWeights()){return""}var f=wt_getScaleFacetOptions(g,c);if(f.weights&&f["weight-values"]){var d=";";if(c){d="&"}else{if(typeof f["gem-quality"]!="undefined"){d+="gm="+f["gem-quality"]+";"}}d+="weights="+f.weights+(c?"&":";")+"weight-values="+f["weight-values"];return d}return""}function wt_getScaleUrlSegment(g,c){var f=wt_getScaleFacetOptions(g,c);if(f.weights&&f["weight-values"]){var d="";if(!c&&typeof f["gem-quality"]!="undefined"){d+="/gem-quality:"+f["gem-quality"]}d+="/weights:"+f.weights+"/weight-values:"+f["weight-values"];return d}return""}function wt_showClassPresetMenu(J,u,w,g,K,H){if(!(u&&g&&K)){return}var f=[[,WH.TERMS.chooseclassspec]];var r="/items";for(var C=0,D;D=items_filterConfig.categories[C];C++){if(D.id==g){r+="/"+D.url;break}}if(g==4&&K){r+="/slot:"+K}var o="";var A="/live-only:on/group-by:"+(g==2?"slot":"source")+"?filter=161;1;0";if(g==2){if(Locale.getName()=="enus"){if(g_item_slots[K]){A+="#"+WH.Strings.slug(g_item_slots[K])}}else{A+="#slot-"+K}}if(g_user.weightscales&&g_user.weightscales.length){var F=[0,WH.TERMS.custom,undefined,[]];f.push(F);for(var I=0,L;L=g_user.weightscales[I];I++){o=wt_getScaleUrlSegment(L)+"/upgrade-for:"+u;if(w&&w.length){o+="/upgrade-bonuses:"+w.join(":")}F[3].push([L.id,L.name,r+o+A])}}var q=WH.isSet("g_items")&&g_items[u]?g_items[u].specs:null;for(var B in wt_presets){if(!wt_presets.hasOwnProperty(B)){continue}var t=[B,g_chr_classes[B],undefined,[],{className:"c"+B,tinyIcon:"class_"+g_file_classes[B]}];if(q!=null&&q.length>0&&g_chr_specs_by_class[B]){var h=g_chr_specs_by_class[B];var c=false;for(var G in h){if(h.hasOwnProperty(G)&&WH.inArray(q,h[G])!=-1){c=true;break}}if(!c){continue}}f.push(t);var E=0;var z=0;for(var d in wt_presets[B]){if(!wt_presets[B].hasOwnProperty(d)){continue}t[Menu.ITEM_SUBMENU].push([undefined,LANG.presets[d]||WH.term("itemlevel_format",d)]);z++;for(var v in wt_presets[B][d]){if(!wt_presets[B][d].hasOwnProperty(v)){continue}c=(q==null||q.length==0);if(!c){for(var m in q){if(q.hasOwnProperty(m)){let specName=WH.Wow.PlayerClass.Specialization.getName(q[m]);if(LANG.presets[v].indexOf(specName)!=-1){c=true;break}}}}if(c){o="/class:"+B+wt_getScaleUrlSegment(wt_presets[B][d][v])+"/upgrade-for:"+u;if(w&&w.length){o+="/upgrade-bonuses:"+w.join(":")}t[Menu.ITEM_SUBMENU].push([E,LANG.presets[v],r+o+A,,{tinyIcon:wt_presets[B][d][v].meta.__icon}]);E++}}}if(z===1){t[Menu.ITEM_SUBMENU].shift()}}Menu.sort(f);Menu.show(f,J)}WH.Wow=new function(){const f=this;this.GENDER_FEMALE=1;this.GENDER_MALE=0;this.INVENTORY_SLOT_AMMO=0;this.INVENTORY_SLOT_HEAD=1;this.INVENTORY_SLOT_NECK=2;this.INVENTORY_SLOT_SHOULDERS=3;this.INVENTORY_SLOT_SHIRT=4;this.INVENTORY_SLOT_CHEST=5;this.INVENTORY_SLOT_WAIST=6;this.INVENTORY_SLOT_LEGS=7;this.INVENTORY_SLOT_FEET=8;this.INVENTORY_SLOT_WRISTS=9;this.INVENTORY_SLOT_HANDS=10;this.INVENTORY_SLOT_FINGER_1=11;this.INVENTORY_SLOT_FINGER_2=12;this.INVENTORY_SLOT_TRINKET_1=13;this.INVENTORY_SLOT_TRINKET_2=14;this.INVENTORY_SLOT_BACK=15;this.INVENTORY_SLOT_MAIN_HAND=16;this.INVENTORY_SLOT_OFF_HAND=17;this.INVENTORY_SLOT_RANGED=18;this.INVENTORY_SLOT_TABARD=19;this.INVENTORY_SLOTS_WITH_MODELS=[this.INVENTORY_SLOT_HEAD,this.INVENTORY_SLOT_SHOULDERS,this.INVENTORY_SLOT_SHIRT,this.INVENTORY_SLOT_CHEST,this.INVENTORY_SLOT_WAIST,this.INVENTORY_SLOT_LEGS,this.INVENTORY_SLOT_FEET,this.INVENTORY_SLOT_WRISTS,this.INVENTORY_SLOT_HANDS,this.INVENTORY_SLOT_BACK,this.INVENTORY_SLOT_MAIN_HAND,this.INVENTORY_SLOT_OFF_HAND,this.INVENTORY_SLOT_TABARD];if(WH.isClassicTree()||WH.isBurningCrusadeTree()){this.INVENTORY_SLOTS_WITH_MODELS.push(this.INVENTORY_SLOT_RANGED)}this.PAPERDOLL_SLOT_ORDER=[this.INVENTORY_SLOT_HEAD,this.INVENTORY_SLOT_NECK,this.INVENTORY_SLOT_SHOULDERS,this.INVENTORY_SLOT_BACK,this.INVENTORY_SLOT_CHEST,this.INVENTORY_SLOT_SHIRT,this.INVENTORY_SLOT_TABARD,this.INVENTORY_SLOT_WRISTS,this.INVENTORY_SLOT_HANDS,this.INVENTORY_SLOT_WAIST,this.INVENTORY_SLOT_LEGS,this.INVENTORY_SLOT_FEET,this.INVENTORY_SLOT_FINGER_1,this.INVENTORY_SLOT_FINGER_2,this.INVENTORY_SLOT_TRINKET_1,this.INVENTORY_SLOT_TRINKET_2,this.INVENTORY_SLOT_MAIN_HAND,this.INVENTORY_SLOT_OFF_HAND,this.INVENTORY_SLOT_RANGED,this.INVENTORY_SLOT_AMMO];this.SIDE_ANY=0;this.SIDE_ALLIANCE=1;this.SIDE_HORDE=2;this.SIDE_BOTH=3;var d={0:"male",1:"female"};const l=[this.INVENTORY_SLOT_HEAD,this.INVENTORY_SLOT_SHOULDERS,this.INVENTORY_SLOT_CHEST,this.INVENTORY_SLOT_WAIST,this.INVENTORY_SLOT_LEGS,this.INVENTORY_SLOT_FEET,this.INVENTORY_SLOT_WRISTS,this.INVENTORY_SLOT_HANDS];const c=10000;const g=100;const h=1;this.buildMoney=function(r){var m={};if(r.copper){m.unnamed=r.copper.toString()}if(r.items&&r.items.length){m.items="";for(var q,p=0;q=r.items[p];p++){m.items+=(m.items?",":"")+q[0]+","+q[1]}}if(r.currencies&&r.currencies.length){m.currency="";for(var o,p=0;o=r.currencies[p];p++){m.currency+=(m.currency?",":"")+o[0]+","+o[1]}}if(r.achievementPoints){m.achievement=r.achievementPoints.toString()}return WH.markup.tags.money.toNode(m)};this.getGenderName=function(m){return WH.TERMS[d[m]]};this.getGenderString=function(m){return d[m]};this.getPatchVersionObject=function(u,t){var q=t||g_wow_versions;var o=false;if(!u){u=Date.now();o=true}var r="?????";var p={build:999999,timestamp:9999999999999,version:r,versionNum:999999};for(var m=0,v;v=q[m];m++){if((v.timestamp<=u)&&(p.version=="?????"||p.build<v.build)){p=v}}if(WH.isDev()&&p.version===r){if(o){WH.error("Could not find a build for the current time!",u,"Versions:",q)}else{WH.error("Could not find a build for timestamp "+u+"!","Versions:",q)}}return p};this.getVersionNumFromStr=function(m){let version=m.split(".");while(version.length<3){version.push(0)}let versionNumber=(parseInt(version[0])*c)||0;if(version[1]){versionNumber+=(parseInt(version[1])*g)||0}if(version[2]){versionNumber+=(parseInt(version[2])*h)||0}return versionNumber};this.getVersionStrFromNum=function(m){m=parseInt(m);if(isNaN(m)){return""}return Math.floor(m/10000)+"."+Math.floor((m%10000)/100)+"."+(m%100)};this.getVersionString=function(m){return WH.PageMeta.dataEnv.versions[m||WH.getDataEnv()]};this.getVersionStringFromTimestamp=function(o,m){return(WH.Wow.getPatchVersionObject(o,m)).version};this.hasVersion=function(m){return f.getVersionNumFromStr(f.getVersionString())>=m};this.isBodyArmorSlot=function(m){return l.includes(m)};this.showContentPhasePrompt=function(q,t,r,u){if((g_user.roles&U_GROUP_STAFF)==0||WH.isRetailTree()){WH.error("Asked to show content phase prompt when we are not allowed.");return}if(!t.length){WH.error("Should call the content phase prompt with at least one type ID");return}if(isNaN(r)){r=""}var m=t.length===1?"this entity":("these "+t.length+" entities");var p=prompt("What should the content phase be for "+m+"?",r);if(p===null){return}var o=undefined;if(p===""){o=0}else{o=parseFloat(p);if(isNaN(o)||o<0){alert("Invalid response ("+p+"): must be a positive number");return}}$.ajax({url:"/admin/content-phase/set",data:{type:q,typeIdCsv:t.join(","),phase:o.toFixed(2)},method:"POST",error:function(v,z,w){alert("Could not update content phase: "+z+"\n"+w)},success:function(v){if(u){u(v.phase)}else{alert("Updated "+v.typeIds.length+" "+(v.typeIds.length==1?"entity":"entities")+" to content phase "+(v.phase||"(None)")+".")}}})}};var ZUL=new function(){var I="has-mobile-zul-bar";var X={scriptLocation:(function(){var ag=document.getElementsByTagName("script");var ah=ag[ag.length-1].src.split("?")[0];return ah.split("/").slice(0,-1).join("/")+"/"})(),menuShowDelay:333,menuHideDelay:333};var ac=false;var m={};var R={mobile:false,mobileScrollSetUp:false,mouseOver:false,iScroll:null,submenuCount:0,submenuTier:0,submenuTiers:[],timers:{menuExpand:null,menuExpandComplete:null,menuOut:null,menuOutPost:null,menuOverPost:null,mobileMenuToggle:null}};this.setOptions=function(ag){if(typeof ag!="object"){return}if(typeof ac!="object"){ac={}}for(var ah in ag){if(!ag.hasOwnProperty(ah)){continue}ac[ah]=ag[ah]}};this.closeMobileMenu=function(){p()};this.addToMenu=function(ag){if(!ac.states){ac.states={}}if(!ac.states.universal){ac.states.universal={}}if(!ac.states.universal.content){ac.states.universal.content=[]}if(ag instanceof Array){ac.states.universal.content=ac.states.universal.content.concat(ag)}else{if(typeof ag=="object"){ac.states.universal.content.push(ag)}}ZUL.regenerateMenu()};this.regenerateMenu=function(){p();if(m.mobileMenu){g(m.barMobile)}};this.setMobileMode=function(ag){if(R.mobile!==Boolean(ag)){ae(ag);return true}return false};this.init=function(ag){if(typeof ag=="object"){ZUL.setOptions(ag)}ad()};function ad(){if(!document.body){setTimeout(ad,5);return}if(m.bar){m.barMobile=null;m.bar.parentElement.removeChild(m.bar)}m.bar=document.createElement("div");m.bar.id=m.bar.className="zul-bar";var ag=false;if(typeof ac.mobileLoadCheck=="function"){if(ac.mobileLoadCheck()){ag=true}}else{if(ac.mobileLoadCheck){ag=true}}ae(ag);document.body.insertBefore(m.bar,document.body.firstChild);W();G();if(typeof ac.onCreateBar=="function"){ac.onCreateBar()}}function W(){if(typeof ac.mobileWidthCheck==="function"){ae(ac.mobileWidthCheck())}else{if(typeof ac.mobileWidthCheck==="number"){ae(l()<ac.mobileWidthCheck)}}}function T(){if(m.barMobile||!m.bar){return}m.barMobile=document.createElement("div");m.barMobile.id=m.barMobile.className="zul-bar-mobile";m.barMobile.className+=" zul-bar-mobile-top-menu";m.barMobile.setAttribute("data-tier","0");H(m.barMobile);Z(m.barMobile);g(m.barMobile);m.bar.appendChild(m.barMobile);if(typeof ac.onCreateMobileBar=="function"){ac.onCreateMobileBar()}}function Z(aj){if(m.mobileBarContent){m.mobileBarContent.parentNode.removeChild(m.mobileBarContent);m.mobileBarContent=null}var ah=function(){if(m.mobileBarContent){return}m.mobileBarContent=document.createElement("div");m.mobileBarContent.id=m.mobileBarContent.className="zul-bar-mobile-content"};var ai=Q();var ag=v();if(ag.mobileBarPre){ah();aa(m.mobileBarContent,ag.mobileBarPre,false)}if(ai.mobileBarPre){ah();aa(m.mobileBarContent,ai.mobileBarPre,false)}if(ag.mobileBarContent){ah();aa(m.mobileBarContent,ag.mobileBarContent,false)}if(ai.mobileBarPost){ah();aa(m.mobileBarContent,ai.mobileBarPost,false)}if(ag.mobileBarPost){ah();aa(m.mobileBarContent,ag.mobileBarPost,false)}if(m.mobileBarContent){aj.appendChild(m.mobileBarContent)}}function H(ag){if(m.mobileMenuButton){m.mobileMenuButton.parentNode.removeChild(m.mobileMenuButton)}m.mobileMenuButton=document.createElement("div");m.mobileMenuButton.id=m.mobileMenuButton.className="zul-bar-mobile-menu-button";m.mobileMenuButtonLink=document.createElement("a");L(m.mobileMenuButtonLink,"click",O);m.mobileMenuButton.appendChild(m.mobileMenuButtonLink);ag.appendChild(m.mobileMenuButton)}function g(ag){if(m.mobileMenu){m.mobileMenu.parentNode.removeChild(m.mobileMenu)}m.mobileMenu=document.createElement("div");m.mobileMenu.id=m.mobileMenu.className="zul-bar-mobile-menu";m.mobileMenuList=r();C(m.mobileMenuList.firstChild);m.mobileMenu.appendChild(m.mobileMenuList);ag.appendChild(m.mobileMenu);Y()}function r(ag,ah){var aj=document.createElement("div");aj.className="zul-bar-mobile-menu-list-wrapper";aj.id=aj.className+(ag?"-"+ag:"");aj.setAttribute("data-tier",ah||0);aj.style.left=o(ah?1:0);var ai=document.createElement("ul");ai.className="zul-bar-mobile-menu-list";ai.id=ai.className+(ag?"-"+ag:"");aj.appendChild(ai);return aj}function q(){var ag=document.createElement("li");ag.className="zul-bar-mobile-row";return ag}function B(ag){R.submenuCount++;var ah=r(R.submenuCount,1);aa(ah.firstChild,ag,true);m.mobileMenu.appendChild(ah);K(true)}function C(ai){var ah=Q();var ag=v();aa(ai,ag.pre,true);aa(ai,ah.pre,true);aa(ai,ag.content,true);aa(ai,ah.post,true);aa(ai,ag.post,true)}function d(ak,aj){var ah=document.createElement("form");ah.id="zul-bar-form-"+aj.name;ah.className="zul-bar-form "+ah.className;if(typeof aj.action=="function"){ah.action=aj.action(ak,ac,aj)}else{ah.action=aj.action||"/"}if(typeof ah.method=="function"){ah.method=aj.method(ak,ac,aj)}else{ah.method=aj.method||"post"}for(var ag=0,ai;ai=aj.fields[ag];ag++){ab(ah,ai,aj)}ak.appendChild(ah)}function ab(at,aw,ak){var al=false;var av=false;var aj="input";var am={};switch(aw.type){case"text":am.type="text";if(typeof aw.label=="function"){am.placeholder=aw.label(at,ac,aw)}else{if(aw.label){am.placeholder=aw.label}else{if(typeof aw.placeholder=="function"){am.placeholder=aw.placeholder(at,ac,aw)}else{if(aw.placeholder){am.placeholder=aw.placeholder}}}}if(typeof aw.value=="function"){am.value=aw.value(at,ac,aw)}else{if(aw.value){am.value=aw.value}}break;case"password":am.type="password";if(typeof aw.label=="function"){am.placeholder=aw.label(at,ac,aw)}else{if(aw.label){am.placeholder=aw.label}else{if(typeof aw.placeholder=="function"){am.placeholder=aw.placeholder(at,ac,aw)}else{if(aw.placeholder){am.placeholder=aw.placeholder}}}}if(typeof aw.value=="function"){am.value=aw.value(at,ac,aw)}else{if(aw.value){am.value=aw.value}}break;case"checkbox":am.type="checkbox";if(typeof aw.label=="function"){av=aw.label(at,ac,aw)}else{av=aw.label}if(typeof aw.checked=="function"){am.checked=aw.value(at,ac,aw)}else{if(aw.checked){am.checked="checked"}}break;case"hidden":aj="hidden";if(typeof aw.value=="function"){am.value=aw.value(at,ac,aw)}else{am.value=aw.value}break;case"button":aj="button";if(typeof aw.typeHTML=="function"){am.type=aw.typeHTML(at,ac,aw)}else{if(aw.typeHTML){am.type=aw.typeHTML}else{am.type="button"}}if(typeof aw.label=="function"){am.innerHTML=aw.label(at,ac,aw)}else{am.innerHTML=aw.label}break;case"link":return P(at,aw,true,false);break;default:alert("Invalid element type passed to ZUL bar: "+aw.type);return false}var au=["click","mouseover","mouseout","change","keyup","keydown","focus","blur"];var ai=["name","innerHTML"].concat(au);for(var ap=0,ao;ao=ai[ap];ap++){if(aw.hasOwnProperty(ao)){if(["name","innerHTML"].indexOf(ao)>-1&&typeof aw[ao]=="function"){am[ao]=aw[ao](at,ac,aw)}else{am[ao]=aw[ao]}}}am.id="zul-bar-form-"+ak.name+"-"+aw.name;am.className="zul-bar-form-"+aw.type;if(typeof aw.className=="function"){am.className+=" "+aw.className(at,ac,aw)}else{if(aw.className){am.className+=" "+aw.className}}var an=document.createElement(aj);for(var ah in am){if(!am.hasOwnProperty(ah)){continue}if(au.indexOf(ah)>-1&&typeof am[ah]=="function"){L(an,ah,am[ah])}else{an[ah]=am[ah]}}if(al){var aq=document.createElement("label");aq.id=aq.className=am.id+"-prelabel";aq.className="zul-bar-form-prelabel zul-bar-form-"+aw.type+"-prelabel "+aq.className;aq.htmlFor=an.id;aq.innerHTML=al;L(aq,"mousedown",function(){return false});at.appendChild(aq)}at.appendChild(an);if(av){var ag=document.createElement("label");ag.id=ag.className=am.id+"-postlabel";ag.className="zul-bar-form-postlabel zul-bar-form-"+aw.type+"-postlabel "+ag.className;ag.htmlFor=an.id;ag.innerHTML=av;L(ag,"mousedown",function(){return false});at.appendChild(ag)}return true}function M(al,ak){var ag=[];for(var ai=0,ah;ah=ak[ai];ai++){if(ah.type=="concatenation"){var aj=ah.content(al,ac);if(aj){ag=ag.concat(aj)}}else{ag.push(ah)}}return ag}function aa(al,ak,am){if(!(ak instanceof Array)||!ak.length){return}ak=M(al,ak);for(var ai=0,ah;ah=ak[ai];ai++){if(typeof ah.condition=="function"){if(!ah.condition(al,ac)){continue}}var aj=al;if(am){var ag=q();al.appendChild(ag);aj=ag}switch(ah.type){case"link":P(aj,ah,false,am);break;case"form":d(aj,ah);break;case"custom":if(typeof ah.custom=="function"){ah.custom(aj,ac)}break;default:}}}function P(az,aj,an,am){var ay=document.createElement("a");ay.className="zul-bar-mobile-item-"+(an?"form-":"")+aj.name;if(typeof aj.id=="function"){var ap=aj.id(az,ac,aj);if(ap){ay.id=ap}}else{if(aj.id){ay.id=f(aj.id)}}if(typeof aj.innerHTML=="function"){ay.innerHTML=aj.innerHTML(az,ac,aj)}else{if(aj.innerHTML){ay.innerHTML=f(aj.innerHTML)}else{if(typeof aj.text=="function"){ay.appendChild(document.createTextNode(aj.text(az,ac,aj)))}else{if(aj.text){ay.appendChild(document.createTextNode(f(aj.text)))}}}}if(typeof aj.href=="function"){var aw=aj.href(az,ac,aj);if(aw){ay.href=aw}}else{if(aj.href){ay.href=f(aj.href)}}if(typeof aj.heading=="function"){if(aj.heading(az,ac,aj)){ay.className+=" zul-bar-mobile-heading"}}else{if(aj.heading){ay.className+=" zul-bar-mobile-heading"}}if(typeof ac.mobileIconSpacing=="function"){if(ac.mobileIconSpacing(az,ac,aj)){ay.className+=" zul-bar-icon-spacing"}}else{if(ac.mobileIconSpacing){ay.className+=" zul-bar-icon-spacing"}}var ah=false;if(aj.checked){switch(typeof aj.checked){case"function":if(aj.checked(az,ac,aj)){ay.className+=" zul-bar-checked";ah=true}break;case"string":if(location.href.match(aj.checked)){ay.className+=" zul-bar-checked";ah=true}break;default:ay.className+=" zul-bar-checked";ah=true}}if(!ah){if(aj.imageIcon){if(typeof aj.imageIcon=="function"){aj.imageIcon=aj.imageIcon(az,ac,aj)}var aq;if(typeof aj.imageIcon!="object"){aq=aj.imageIcon}else{if(aj.imageIcon.url){aq=aj.imageIcon.url}}if(aq){ay.style.backgroundImage="url("+aq+")";ay.className+=" zul-bar-has-image-icon"}if(aj.imageIcon.enlargeIcon){ay.className+=" zul-bar-enlarge-image-icon"}}var at=false;if(typeof aj.fontIcon=="function"){var al=aj.fontIcon(az,ac,aj);if(al){at=al}}else{if(aj.fontIcon){at=aj.fontIcon}}if(at){ay.className+=" zul-bar-has-fa";var ak=document.createElement("i");ak.className="fa fa-fw fa-"+at;ay.insertBefore(ak,ay.firstChild)}}if(typeof aj.className=="function"){var ag=aj.className(az,ac,aj);if(ag){ay.className+=" "+ag}}else{if(aj.className){ay.className+=" "+aj.className}}var ax=false;var aA=!aj.hasOwnProperty("tap")||(typeof aj.tap==="boolean"&&aj.tap);for(var av=0,ao;ao=["click","mouseover","mouseout"][av];av++){if(aj[ao]){if(ao==="tap"||(am&&ao==="click"&&aA)){L(ay,"tap",(function(aB,aC){E(this);setTimeout(function(){aB.call(this,aC)},1)}).bind(ay,aj[ao]));ax=true}else{if(am&&ao==="click"){L(ay,ao,(function(aB,aC){E(this);setTimeout(function(){aB.call(this,aC)},1)}).bind(ay,aj[ao]))}else{L(ay,ao,aj[ao])}}}}if(am&&!ax&&aA){if(typeof ay.href=="string"&&ay.href&&ay.href.charAt(0)!=="#"&&ay.href.substring(0,11)!=="javascript:"){L(ay,"tap",function(aC){var aB=aC.target;E(aB);setTimeout(function(){window.location=aB.href},1)});ax=true}}if(ax){ay.className+=" has-tap-event"}az.appendChild(ay);if(aj.menu&&aj.menu.mobile){if(typeof aj.menu.mobile=="function"){aj.menu.mobile=aj.menu.mobile()}var ai;if(typeof aj.mobileMenuText=="function"){ai=aj.mobileMenuText(m.mobileMenuBackTitleText,ac,aj)}else{if(aj.mobileMenuText){ai=f(aj.mobileMenuText)}else{if(typeof aj.innerHTML=="function"){ai=aj.innerHTML(m.mobileMenuBackTitleText,ac,aj)}else{if(aj.innerHTML){ai=aj.innerHTML}else{if(typeof aj.text=="function"){ai=w(aj.text(m.mobileMenuBackTitleText,ac,aj))}else{if(aj.text){ai=w(aj.text)}}}}}}if(ax){az.className+=" zul-mobile-menu-action-with-submenu";var au=document.createElement("a");au.className="zul-mobile-menu-submenu-arrow has-tap-event";L(au,"tap",(J).bind(au,ai,aj.menu.mobile));az.appendChild(au)}else{az.className+=" zul-mobile-menu-has-submenu";ay.className+=" has-tap-event";L(ay,"tap",(J).bind(ay,ai,aj.menu.mobile))}}}function Y(){if(m.mobileMenuBackRow){m.mobileMenuBackRow.parentNode.removeChild(m.mobileMenuBackRow)}m.mobileMenuBackRow=document.createElement("div");m.mobileMenuBackRow.id=m.mobileMenuBackRow.className="zul-bar-mobile-menu-back-row";m.mobileMenuBackButton=document.createElement("a");m.mobileMenuBackButton.innerHTML=ac.mobileBackText||"Back";m.mobileMenuBackButton.id=m.mobileMenuBackButton.className="zul-bar-mobile-menu-back-button";m.mobileMenuBackButton.onclick=D;m.mobileMenuBackRow.appendChild(m.mobileMenuBackButton);m.mobileMenuBackTitle=document.createElement("div");m.mobileMenuBackTitle.id=m.mobileMenuBackTitle.className="zul-bar-mobile-menu-back-title";m.mobileMenuBackTitleText=document.createElement("span");m.mobileMenuBackTitleText.id=m.mobileMenuBackTitleText.className="zul-bar-mobile-menu-back-title-text";m.mobileMenuBackTitle.appendChild(m.mobileMenuBackTitleText);m.mobileMenuBackRow.appendChild(m.mobileMenuBackTitle);if(ac.mobileHeader){m.mobileMenuBackHeader=document.createElement("ul");m.mobileMenuBackHeader.id="zul-bar-mobile-menu-back-header";m.mobileMenuBackHeader.className=m.mobileMenuBackHeader.id+" zul-bar-mobile-menu-list";aa(m.mobileMenuBackHeader,ac.mobileHeader,true);m.mobileMenuBackRow.appendChild(m.mobileMenuBackHeader);m.barMobile.className+=" zul-bar-mobile-menu-has-mobile-header"}m.barMobile.appendChild(m.mobileMenuBackRow)}function ae(ag){if(ag){T();R.mobile=true;document.documentElement.dataset.header="mobile";document.body.classList.add(I)}else{R.mobile=false;document.documentElement.dataset.header="standard";document.body.classList.remove(I)}}function t(ai,ak){var ah;if(document.querySelectorAll){ah=document.querySelectorAll((ak||"#zul-bar-mobile-menu-list")+" .zul-bar-mobile-menu-active");if(ah){for(var aj=0,ag;ag=ah[aj];aj++){ag.className=ag.className.replace(/ *zul-bar-mobile-menu-active\b/g,"")}}}else{ah=(ai||m.mobileMenuList).getElementsByTagName("a");if(ah){for(var aj=0,ag;ag=ah[aj];aj++){if(ag.className&&ag.className.indexOf("zul-bar-mobile-menu-active")){ag.className=ag.className.replace(/ *zul-bar-mobile-menu-active\b/g,"")}}}}}function K(ai){var ak=ai?-1:1;if(R.submenuTier+ak>0){return false}N();R.submenuTier=R.submenuTier+ak;if(!ai){R.submenuTiers.pop()}af();m.barMobile.setAttribute("data-tier",R.submenuTier);if(R.submenuTier==0){m.barMobile.className+=" zul-bar-mobile-top-menu"}else{m.barMobile.className=m.barMobile.className.replace(/ *zul-bar-mobile-top-menu\b/g,"")}var aj=m.mobileMenu.childNodes;var ag=[];for(var ah=0,al;al=aj[ah];ah++){var am=parseInt(al.getAttribute("data-tier"))+ak;if(am>0){al.setAttribute("data-tier","1");al.style.left=o(R.submenuTier);setTimeout((function(an){an.parentNode.removeChild(an)}).bind(null,al),251)}else{if(am==0){al.style.height="100%"}ag.push(al);setTimeout((function(an,ao){an.setAttribute("data-tier",ao);an.style.left=o(R.submenuTier)}).bind(null,al,am),51)}}if(!ai){t(aj[aj.length-2],"#"+aj[aj.length-2].id)}F(m.mobileMenu,250);setTimeout((function(ao){for(var an=0,ap;ap=ao[an];an++){if(an!=ao.length-1){ap.style.height="10px"}}U(ao[ao.length-1])}).bind(null,ag),251);return true}function u(){if(!m.mobileMenu){return}var ah=m.mobileMenu.childNodes;for(var ag=0,ai;ai=ah[ag];ag++){if(ag>0){ai.parentNode.removeChild(ai)}else{ai.setAttribute("data-tier","0");ai.style.left=o(0)}}R.submenuTiers=[];R.submenuTier=0;m.barMobile.setAttribute("data-tier","0");m.barMobile.className+=" zul-bar-mobile-top-menu"}function af(){var ag=R.submenuTiers[R.submenuTier*-1-1];if(ag){m.mobileMenuBackTitleText.innerHTML=ag}}function G(){L(window,"resize",W);G=function(){}}function S(){if(!R.mobileScrollSetUp){var ag=function(ah){if(R.mobileMenuShown){if(!document.getElementById("zul-bar-mobile").contains(ah.target)){ah.preventDefault()}}};L(document.body,"touchmove",ag);L(document.body,"mousewheel",ag);R.mobileScrollSetUp=true}}function N(){if(R.iScroll){R.iScroll.destroy();R.iScroll=null}}function U(ag){N();R.iScroll=new IScroll(ag,{mouseWheel:true,tap:true})}function O(){Menu.hide(true);WH.Tooltip.hide();if(R.mobileMenuShown){p()}else{A()}}function A(){h("mobileMenuToggle");h("mobileMenuToggleCallback");var ag=document.getElementById("zul-bar-mobile-menu-list-wrapper");ag.style.height="100%";if(!m.fade){m.fade=document.createElement("div");m.fade.id=m.fade.className="zul-bar-fade";L(m.fade,"click",O);m.bar.appendChild(m.fade)}document.body.className+=" zul-mobile-show-menu";R.timers.mobileMenuToggle=setTimeout(function(){document.body.className+=" zul-mobile-animate-menu"},1);if(typeof ac.onShowMobileBarEnd=="function"){R.timers.mobileMenuToggleCallback=setTimeout(function(){ac.onShowMobileBarEnd()},152)}S();U(ag);R.mobileMenuShown=true}function p(){h("mobileMenuToggle");h("mobileMenuToggleCallback");if(typeof ac.onHideMobileBarStart=="function"){ac.onHideMobileBarStart()}N();if(m.fade){m.fade.parentNode.removeChild(m.fade);m.fade=null}var ag=document.body;ag.className=ag.className.replace(/ *zul-mobile-animate-menu\b/g,"");R.timers.mobileMenuToggle=setTimeout(function(){ag.className=ag.className.replace(/ *zul-mobile-animate-menu\b/g,"").replace(/ *zul-mobile-show-menu\b/g,"");t();u();if(typeof ac.onHideMobileBarEnd=="function"){ac.onHideMobileBarEnd()}},251);R.mobileMenuShown=false;u()}function E(ag){var ah=z(ag,"ul");t(ah,"#"+ah.id);ag.className+=" zul-bar-mobile-menu-active"}function J(ah,ag){R.submenuTiers.push(ah);E(this);setTimeout(function(){B(ag)},1)}function D(){K(false)}function Q(){if(!ac.state){return{}}var ag={name:ac.state};return V(ac.states,ag)}function v(){if(ac.states&&ac.states&&ac.states.universal){return ac.states.universal}return{}}function V(ag,ai){if(ag&&typeof ag[ai.name]=="object"){for(var ah in ag[ai.name]){if(ag[ai.name].hasOwnProperty(ah)){ai[ah]=ag[ai.name][ah]}}}return ai}function o(ag){return parseInt(ag)*100+"%"}function f(ag){return ag.indexOf("%")>-1?c(ag,ac.user):ag}function c(ag,ai){if(!ai){return ag}for(var ah in ai){if(!ai.hasOwnProperty(ah)){continue}ag=ag.replace("%"+ah.toUpperCase()+"%",ai[ah])}return ag}function l(){var ag=window.getComputedStyle(document.body,null).getPropertyValue("padding-left")||0;var ah=window.getComputedStyle(document.body,null).getPropertyValue("padding-right")||0;return document.body.clientWidth+parseInt(ag)+parseInt(ah)}function L(ah,ai,aj,ag){if(ah.addEventListener){ah.addEventListener(ai,aj,ag)}else{if(ah.attachEvent){ah.attachEvent("on"+ai,aj)}}}function F(ai,ak){var ah=ai.scrollTop/(ak/15);var aj=ai.scrollLeft/(ak/15);var ag=setInterval(function(){if(ai.scrollTop!=0||ai.scrollLeft!=0){ai.scrollTop=Math.max(0,ai.scrollTop-ah);ai.scrollLeft=Math.max(0,ai.scrollLeft-aj)}else{clearInterval(ag)}},15)}function z(ah,ag){while(ah.parentNode){if(ah.parentNode.tagName==ag.toUpperCase()){return ah.parentNode}ah=ah.parentNode}return null}function w(ag){if(!m.htmlEscaper){m.htmlEscaper=document.createElement("div")}m.htmlEscaper.innerHTML="";m.htmlEscaper.appendChild(document.createTextNode(ag));return m.htmlEscaper.innerHTML}function h(ag){clearTimeout(R.timers[ag]);R.timers[ag]=null}};ZUL.setOptions({site:"wowhead",mobileLoadCheck:function(){return WH.Layout.Responsive.check()},mobileWidthCheck:function(){return WH.Layout.Responsive.check()},mobileBackText:WH.TERMS.back_verb,mobileIconSpacing:true,states:{loggedOut:{pre:[{type:"custom",custom:function(h,d){h.style.paddingLeft="32px";var c=WH.ce("span");c.id=c.className="zul-bar-mobile-loginwithcolon";c.innerHTML=WH.TERMS.loginwith_colon;WH.ae(h,c);c=WH.ce("span");c.id=c.className="zul-bar-mobile-logincolon";c.innerHTML=WH.TERMS.login+WH.TERMS.colon_punct;WH.ae(h,c);var g=WH.ce("a",{id:"zul-bar-mobile-battlenet",className:"zul-bar-mobile-item-battlenet btn btn-site",innerHTML:"Battle.net",href:WH.getRelativeHostPrefix()+"/account=battlenet"});WH.aE(g,"tap",function(){WH.visitUrlWithPostData(WH.getRelativeHostPrefix()+"/account=battlenet",{r:1});return false});WH.ae(h,g);var f=WH.ce("a",{id:"zul-bar-mobile-fanbyte",className:"zul-bar-mobile-item-fanbyte btn btn-site",innerHTML:"<span>"+WH.TERMS.fanbyte+"</span>",href:WH.Url.getLoginPath()});WH.aE(f,"tap",function(){WH.goToLoginPage();return false});WH.ae(h,f)}},{type:"link",name:"register",innerHTML:WH.TERMS.register,href:WH.Url.getRegistrationPath()},{type:"link",name:"get-premium",innerHTML:WH.TERMS.getpremium,href:"/premium",fontIcon:"star"}]},loggedIn:{pre:[{type:"link",name:"staff",innerHTML:WH.TERMS.staffemployees,href:"javascript:",className:"hassubmenu",menu:{mobile:function(){return Menu.prepareForZul(WH.Staff.getMenu())}},condition:function(d,c){return!!WH.Staff}},{type:"link",name:"favorites",innerHTML:WH.TERMS.favorites,href:"javascript:",className:"hassubmenu",menu:{mobile:function(){return Menu.prepareForZul(Favorites.getMenu())}},condition:Favorites.hasFavorites},{type:"link",name:"user",innerHTML:function(d,c){return c.user.name+" <small>("+WH.numberFormat(c.user.reputation)+" "+WH.TERMS.reputation+")</small>"},mobileMenuText:"%NAME%",menu:{mobile:function(){return Menu.prepareForZul(WH.Layout.User.getUserMenu())}}},{type:"link",name:"characters",innerHTML:WH.TERMS.myprofiles,menu:{mobile:function(){return Menu.prepareForZul(WH.Layout.User.getProfilerMenu())}}},{type:"link",name:"upgrade",innerHTML:WH.TERMS.upgradeavailable,href:"/premium",fontIcon:"arrow-up",condition:function(d,c){return!c.user.premium}}]},universal:{pre:[{type:"link",name:"mobileheader",href:"/",heading:true},{type:"concatenation",content:function(d,c){return Menu.prepareForZul(Menu.getFeaturedNavigationMenu())}},{type:"link",text:WH.TERMS.navigation,heading:true},{type:"concatenation",content:function(d,c){return Menu.prepareForZul(Menu.getMenu())}},{type:"link",text:"",heading:true}],content:[{type:"link",name:"feedback",innerHTML:WH.TERMS.feedback,href:"javascript:",fontIcon:"envelope",click:function(){ZUL.closeMobileMenu();ContactTool.show()}},{type:"link",name:"locale",innerHTML:function(d,c){return Locale.getDescription()||WH.TERMS.language},href:"javascript:",mobileMenuText:WH.TERMS.language,menu:{mobile:function(){return Menu.prepareForZul(WH.Layout.User.getLocaleMenu())}}},{type:"link",name:"theme",innerHTML:function(f,c){var d=WH.TERMS.unknown;switch(WH.Theme.getTheme()){case"classic":d=WH.TERMS.classic;break;case"standard":d=WH.TERMS.standard;break;case"thottbot":d=WH.TERMS.thottbot;break;default:WH.error("Unknown theme in ZUL configuration!",WH.Theme.getTheme())}return WH.TERMS.theme_format.replace("%s","<b>"+d+"</b>")},condition:function(d,c){return WH.Theme.getThemes().length>1},mobileMenuText:WH.TERMS.changeTheme,menu:{mobile:(function(){var d=WH.Theme.getThemes();var f=[];for(var g=0,c=d.length;g<c;g++){var h=d[g];(function(l){f.push({name:"theme-"+l,type:"link",innerHTML:WH.TERMS.theme_format.replace("%s",WH.TERMS[l]),href:"javascript:",click:function(){var m=WH.qs(".zul-bar-mobile-item-theme-"+l);if(m){if(m.classList.contains("zul-bar-checked")){ZUL.closeMobileMenu();return}m.classList.add("zul-bar-has-fa");WH.aef(m,WH.ce("i",{className:"fa fa-refresh fa-spin"}))}if(!WH.User.isLoggedIn()){window.location="/account=signin?next="+encodeURIComponent(window.location.href);return}WH.Theme.set(l)},checked:function(o,m){return WH.Theme.getTheme()===l}})})(h)}return f})()}},{type:"link",name:"data-env",innerHTML:function(d,c){let currentData=WH.TERMS.live;switch(WH.getDataEnv()){case WH.dataEnv.PTR:currentData=WH.TERMS.ptr;break;case WH.dataEnv.BETA:currentData=WH.TERMS.beta;break;case WH.dataEnv.CLASSIC:currentData=WH.TERMS.classic;break;case WH.dataEnv.TBC:currentData=WH.TERMS.burningCrusade;break}return WH.sprintf(WH.TERMS.viewingdata_format,"<b>"+currentData+"</b>")},mobileMenuText:WH.TERMS.changedataview,menu:{mobile:function(){let getDataEnvLink=function(d){if(WH.getDataEnv()===d){return"javascript:"}var c=WH.qs('.data-env-links a[data-env="'+WH.dataEnvTerm[d]+'"]');if(c&&c.href){return c.href}return WH.Url.generate(location.pathname+location.search+location.hash,{dataEnv:d})};return[{type:"link",innerHTML:WH.sprintf(WH.TERMS.data_format,WH.TERMS.live),href:getDataEnvLink(WH.dataEnv.MAIN),checked:function(d,c){return WH.getDataEnv()===WH.dataEnv.MAIN}},{type:"link",innerHTML:WH.sprintf(WH.TERMS.data_format,WH.TERMS.ptr),href:getDataEnvLink(WH.dataEnv.PTR),checked:function(d,c){return WH.getDataEnv()===WH.dataEnv.PTR},condition:function(d,c){return WH.isPtrActive()}},{type:"link",innerHTML:WH.sprintf(WH.TERMS.data_format,WH.TERMS.beta),href:getDataEnvLink(WH.dataEnv.BETA),checked:function(d,c){return WH.getDataEnv()===WH.dataEnv.BETA},condition:function(d,c){return WH.isBetaActive()}},{type:"link",innerHTML:WH.sprintf(WH.TERMS.data_format,WH.TERMS.classic),href:getDataEnvLink(WH.dataEnv.CLASSIC),checked:function(d,c){return WH.getDataEnv()===WH.dataEnv.CLASSIC}},{type:"link",innerHTML:WH.sprintf(WH.TERMS.data_format,WH.TERMS.burningCrusade),href:getDataEnvLink(WH.dataEnv.TBC),checked:function(d,c){return WH.getDataEnv()===WH.dataEnv.TBC},condition:function(d,c){return WH.isBurningCrusadeActive()}}]}}}],mobileBarContent:[{type:"form",name:"search",action:"/search",method:"get",fields:[{type:"text",name:"q",label:WH.TERMS.searchGuidesNewsDatabase_stc_ellipsis,value:function(){var c=function(){var d=$(".header-search form input");if(!d.length){setTimeout(c,5);return}$("#zul-bar-form-q").val(d.val()||"")};c();setTimeout(function(){LiveSearch.attach($("#zul-bar-form-search-q"))},0);return""},focus:function(){document.body.scrollTop=0;document.body.scrollLeft=0;var c=WH.ge("zul-bar");c.style.position="absolute";setTimeout(function(){document.body.scrollTop=0;document.body.scrollLeft=0;var d=document.createElement("div");d.className="zul-bar-fade zul-bar-fade-body-only";d.onclick=function(){this.parentNode.removeChild(this)};$("#zul-bar").append(d)},5)},blur:function(){$(".zul-bar-fade.zul-bar-fade-body-only").remove();var c=WH.ge("zul-bar");c.style.position="fixed"}}]},{type:"link",name:"share",className:"fa fa-share-square-o",click:function(){var c=location.href;var d=[[,WH.TERMS.shareon_colon],[0,WH.TERMS.twitter,WH.Layout.getShareUrl("twitter",c),undefined,{fontIcon:"twitter",newWindow:true}],[1,WH.TERMS.facebook,WH.Layout.getShareUrl("facebook",c),undefined,{fontIcon:"facebook-official",newWindow:true}],[2,WH.TERMS.reddit,WH.Layout.getShareUrl("reddit",c),undefined,{fontIcon:"reddit-alien",newWindow:true}]];Menu.show(d,this)}}]}}});WH.Admin.Debug=new function(){const A=this;this.TYPE_CODE="code";this.TYPE_MESSAGE="message";this.TYPE_QUERY="query";this.TYPE_SEO="seo";var v=0;var o=1;var c=2;var u="log";var p="warn";var d="error";var t={announcementId:100000,footerInitialized:false,queue:[],queueElement:undefined};this.error=function(C,D,B){l({level:d,markup:B||false,message:D,type:C})};this.initFooter=function(){let toggle=WH.ce("a",{className:"debug-footer-toggle fa"});WH.preventSelectStart(toggle);WH.ae(WH.qs(".copyright"),toggle);WH.aE(toggle,"click",function(){let debugFooter=WH.qs(".debug-footer");if(debugFooter.dataset.state==="hidden"){WH.st(this,"Hide debug");this.classList.add("fa-minus-circle");this.classList.remove("fa-plus-circle");debugFooter.dataset.state="visible";if(t.footerInitialized){WH.scrollTo(toggle)}}else{WH.st(this,"Show debug");this.classList.add("fa-plus-circle");this.classList.remove("fa-minus-circle");debugFooter.dataset.state="hidden"}debugFooter.classList.toggle("ie11-dataset-fix")});if(WH.User.hasRole(U_GROUP_DEV)){WH.qs(".debug-footer").dataset.state="hidden"}WH.DOM.dispatchEvent(toggle,"click");t.footerInitialized=true};this.initFooterTabs=function(){let debugFooterInner=WH.qs(".debug-footer-inner");if(!debugFooterInner){return}WH.qsa(".debug-footer .tabs a").forEach(function(B){WH.aE(B,"click",function(){let tabContents;if(!this.tabSettings||!(tabContents=WH.ge("tab-"+this.tabSettings.id))){return}let newHeight=tabContents.offsetHeight-2;if(debugFooterInner.style.minHeight){if(parseInt(debugFooterInner.style.minHeight)>=newHeight){return}}else{let infoTab;if(this.tabSettings.id!=="info"&&(infoTab=WH.ge("tab-info"))){infoTab.style.display="";let infoHeight=infoTab.offsetHeight-2;infoTab.style.display="none";if(infoHeight>newHeight){newHeight=infoHeight}}}newHeight=Math.min(newHeight,Platform.getViewportHeight());debugFooterInner.style.minHeight=newHeight+"px"})})};this.log=function(C,D,B){l({level:u,markup:B||false,message:D,type:C})};this.warn=function(C,D,B){l({level:p,markup:B||false,message:D,type:C})};function f(){return WH.PageMeta.debug||false}function z(B){switch(B.type){case A.TYPE_CODE:case A.TYPE_QUERY:if(B.level!==d&&!WH.User.hasRole(U_GROUP_DEV)){return o}return c;case A.TYPE_SEO:if(B.level!==d&&!WH.User.hasRole(U_GROUP_BLOGGER|U_GROUP_EDITOR)){return o}return c;case A.TYPE_MESSAGE:return c;default:WH.error("Unknown debug message type.",B.type);return c}}function l(B){if(!f()){t.queue.push(B);return}switch(z(B)){case c:m(B);break;case v:break;case o:t.queue.push(B);g();break;default:WH.error("Debug message action could not be determined.",B.type,B);m(B)}}function m(E){if(!E.message){var C="Tried to display an empty debug message.";WH.error(C,E);alert(C);return}var D={allowMarkup:E.markup,"class":"debug debug-type-"+(E.type||"unknown")+" debug-level-"+E.level,id:t.announcementId,nocookie:1,parent:"debug-message-wrapper-"+t.announcementId,text:E.message};var G=WH.ce("div",{id:D.parent});var B=WH.ge("announcement-0");if(B){B.parentNode.insertBefore(G,B)}else{if(document.readyState!=="complete"){WH.aE(document,"readystatechange",m.bind(this,E));return}else{var F=WH.qs(".main-contents");if(F){WH.aef(F,G)}else{WH.aef(document.body,G)}}}t.announcementId++;new Announcement(D);$("#"+D.parent+"-markup .error-reveal-button").click(function(){$("#"+D.parent+"-markup > div").show();WH.de(this)})}function h(){while(t.queue.length){m(t.queue.shift())}}function r(){var C={};for(var D=0,B=t.queue.length;D<B;D++){var E=t.queue[D];if(!C[E.level]){C[E.level]=0}C[E.level]++}return C}function w(){if(!t.queueElement){t.queueElement=WH.Layout.User.createDebugQueueElement();if(!t.queueElement){return undefined}WH.aef(t.queueElement,WH.ce("span",{className:"header-user-debug-messages-count"}));WH.aE(t.queueElement,"click",function(){h();g()});WH.Tooltip.simple(t.queueElement,q)}return t.queueElement}function q(){var C=r();var D="debug";var B=t.queue.length!==1?"s":"";var G=[];for(var F in C){if(!C.hasOwnProperty(F)){continue}if(C[F]===t.queue.length){D=F}else{G.push(C[F]+" "+F+(C[F]!==1?"s":""))}}var E=t.queue.length+" "+D+" message"+B+" queued.";if(G.length){E+="<br>Click to show "+Locale.formatList(G)+"."}else{E+="<br>Click to show."}return'<div class="no-wrap q2">'+E+"</div>"}function g(){if(!f()){return}if(!t.queue.length&&!t.queueElement){return}var C=w();if(!C){if(document.readyState!=="complete"){WH.aE(document,"readystatechange",g.bind(this))}else{h()}return}if(!t.queue.length){if(C.style.display!=="none"){C.style.display="none";WH.Layout.updateSearchWidth()}return}var B=r();if(B.hasOwnProperty(d)){C.dataset.level=d}else{if(B.hasOwnProperty(p)){C.dataset.level=p}else{C.dataset.level=u}}C.dataset.count=t.queue.length;var D=WH.qs(".header-user-debug-messages-count",C);if(D){D.innerHTML=C.dataset.level===u?"":t.queue.length}if(C.style.display==="none"){delete C.style.display;WH.Layout.updateSearchWidth();if(WH.Theme.isClassic()){WH.Layout.Responsive.updateNavOverflow()}}}};WH.Admin.Guide=function(){};WH.Admin.Localization=new function(){var w=0;var f=1;var u={0:{"class":"q10",name:"Error"},1:{"class":"r1",name:"Warning"}};var h={"default":":",2:" :",4:"："};var p={"default":": ",2:" : ",4:"："};var t={"default":"…"};var o={"default":"!",4:"！"};var l={"default":".",4:"。"};var A={"default":"?",4:"？"};this.initValidation=function(D,F,E,C,G){let timeout;let $target=$(F);if(D===LOCALE_ENUS){$target.bind("keydown keyup change",(function(I,H){clearTimeout(timeout);timeout=setTimeout(v.bind(null,I,H),300)}).bind(null,$target,C))}else{$target.bind("keydown keyup change",(function(J,I,K,H,L){clearTimeout(timeout);timeout=setTimeout(q.bind(null,J,I,K,H,L),300)}).bind(null,D,$target,$(E),C,G))}if(g_user.roles&U_GROUP_DEV){$target.change()}};function g(D){var C=D.match(/%(?:\d+\$)?[sd]/g);return C?C.length:0}function c(D,I){var E=D.siblings(".localization-message");if(!E.length){E=$("<div/>",{"class":"localization-message"}).appendTo(D.parent())}E.empty();if(I.length){for(var G=0,C=I.length;G<C;G++){var H=I[G];var F="localization-message-"+u[H.type].name.toLowerCase();$("<div/>",{"class":F+" "+u[H.type]["class"],text:u[H.type].name+": "+H.message}).appendTo(E)}}}function r(E,C){var D=[];if(!C.match(/[<>]/)&&E.match(/[<>]/)){D.push({type:w,message:"This translation appears to have HTML in it, but the original does not."})}return D}function d(G,C){var D=[];var F=C.match(/\n/g);var E=G.match(/\n/g);F=F?F.length:0;E=E?E.length:0;if(F>=3){return D}if(E>0&&F===0){D.push({type:f,message:"This translation has line breaks, but the original does not."})}else{if(F!==E){D.push({type:f,message:"The number of line breaks in this translation ("+E+") does not match the original ("+F+")."})}}return D}function v(D,J){let text=J||(D.is("input, textarea")?D.val():D.text());var H=[];if(text!==""){if(text.match(/[<>]/)){H.push({type:f,message:"Avoid using HTML in term text."})}if(text.indexOf("\u0009")>-1){H.push({type:f,message:"Avoid tabs in term text."})}if(text.indexOf(" ")===0){H.push({type:f,message:"Avoid starting with a space in term text."})}var I=false;var F=[l,o,A,t,p,h];for(var E=0,C=F.length;E<C;E++){var G=F[E]["default"];if(text.substr(-1*G.length)===G){I=true;break}}if(!I&&text.substr(-1)===" "){H.push({type:f,message:"Avoid ending with a space in term text, if it's not related to punctuation (such as after a colon)."})}if(text.indexOf("  ")>-1){H.push({type:f,message:"Avoid using multiple sequential spaces in term text."})}if(text.match(/(\r\n|\r|\n)/)){H.push({type:f,message:"Avoid using line breaks in term text, if possible."})}}c(D,H)}function z(H,E,C){var F=[];var D=false;var G=function(L,J){var I=L["default"];var K=L[C]||I;if(E.substr(-1*I.length)===I){D=true;if(H.substr(-1*K.length)!==K){return[{type:f,message:"This translation doesn't end in matching "+J+" punctuation for this locale ("+K+")."}]}}else{if(H.substr(-1*K.length)===K||H.substr(-1*I.length)===I){if((K==="："&&I===":"&&E.substr(-2)===": ")||(K==="："&&I===": "&&E.substr(-1)===":")){return[]}return[{type:f,message:"This translation ends in "+J+" punctuation, but the original does not."}]}}return[]};F=F.concat(G(l,"full stop"));F=F.concat(G(o,"exclamation"));F=F.concat(G(A,"question mark"));F=F.concat(G(t,"ellipsis"));F=F.concat(G(p,"colon"+(Locale.hasWordSpaces(C)?" (with a space)":"")));F=F.concat(G(h,"colon"+(Locale.hasWordSpaces(C)?" (without a space)":"")));if(!D){if(E.substr(-1)===" "){if(Locale.hasWordSpaces(C)||Locale.hasSentenceSpaces(C)){if(H.substr(-1)!==" "){F.push({type:f,message:"This translation doesn't end in a space, but the original does."})}}}else{if(H.substr(-1)===" "){F.push({type:f,message:"This translation ends in a space, but the original does not."})}}}return F}function B(H,D,C){var E=[];if(Locale.hasWordSpaces(C)||Locale.hasSentenceSpaces(C)){var G=H.substr(0,1);var F=D.substr(0,1);if(G===" "&&F!==" "){E.push({type:f,message:"This translation starts with a space, but the original does not."})}else{if(G!==" "&&F===" "){E.push({type:f,message:"This translation does not start with a space, but the original does."})}}}if(H.indexOf("\u0009")>-1&&D.indexOf("\u0009")){E.push({type:f,message:"This translation has a tab character, but the original does not."})}if(H.indexOf("  ")>-1&&D.indexOf("  ")===-1){E.push({type:f,message:"This translation has multiple spaces, but the original does not."})}return E}function m(G,D){var E=[];var C=g(G);var F=g(D);if(C!==F){E.push({type:f,message:"This translation has "+C+" string replacement placeholders, but the original has "+F+"."})}return E}function q(E,D,F,C,G){C=C||(D.is("input, textarea")?D.val():D.text());G=G||(F.is("input, textarea")?F.val():F.text());let messages=[];if(C!==""){messages=messages.concat(r(C,G));messages=messages.concat(m(C,G));messages=messages.concat(z(C,G,E));messages=messages.concat(B(C,G,E));messages=messages.concat(d(C,G))}c(D,messages)}};WH.Layout.Responsive=new function(){const z=this;var G="header-nav-collapsed";var O=2;var o=247;var p=2;var w={elements:{collapsibleNavLinks:undefined,firstMenuItem:undefined,fullscreenModeIcon:undefined,header:undefined,headerNav:undefined,headerNavEllipsis:undefined,headerNavFeatures:undefined,headerNavFeaturesEllipsis:undefined,headerNavFeaturesLinks:undefined,headerNavLinks:undefined,headerNavWrapper:undefined,headerUser:undefined,headerWrapper:undefined,logo:undefined,search:undefined,themeSwitcher:undefined},featuredNavAltPosition:undefined,featuredNavAltPositionHiddenViewportWidths:[0,0],featuredNavOverflowMenu:[],hiddenHeader:undefined,initialized:false,logoShrinkViewportWidth:0,collapsibleNavLinkCount:undefined,maxMobileNavigationWidth:767,mobileMode:false,navOverflowLastNavState:undefined,navOverflowLastResponsiveStep:undefined,navOverflowLastViewportWidth:{standard:0,scrolling:0},navOverflowMenu:[],navScrollLimitEnabled:false,responsiveNavStep:{standard:0,scrolling:0},responsiveNavStepWidths:{standard:[0,0],scrolling:[0,0]},updateSearchWidth:false};this.check=function(R){if(!w.initialized){return w.mobileMode}var Q=w.mobileMode;if(M()){B(!w.mobileMode);ZUL.setMobileMode(w.mobileMode);if(!w.mobileMode&&M()){B(!w.mobileMode);ZUL.setMobileMode(w.mobileMode)}}if(!w.mobileMode&&WH.Theme.isClassicType()){WH.WAS.updateSkinPosition()}if(R===true||(R!==false&&Q&&!w.mobileMode)){w.updateSearchWidth=true;m();g()}if(w.updateSearchWidth){requestAnimationFrame(WH.Layout.updateSearchWidth.bind(WH.Layout,false));w.updateSearchWidth=false}return w.mobileMode};this.disableNavScrollLimit=function(){w.elements.headerWrapper.style.position="";w.elements.headerWrapper.style.top="";requestAnimationFrame(function(){requestAnimationFrame(function(){w.elements.headerWrapper.style.transition=""})});w.navScrollLimitEnabled=false};this.init=function(Q){w.initialized=true;w.elements.headerWrapper=Q.headerWrapper;w.elements.headerNavWrapper=Q.navWrapper;w.elements.headerNav=Q.nav;w.elements.headerNavLinks=Q.navLinks;w.elements.headerNavEllipsis=Q.navEllipsis;w.elements.collapsibleNavLinks=Q.collapsibleNavLinks;w.collapsibleNavLinkCount=w.elements.collapsibleNavLinks.length;w.elements.headerNavFeatures=Q.featuredNav;w.elements.headerNavFeaturesLinks=Q.featuredLinks;w.elements.headerNavFeaturesEllipsis=Q.featuredEllipsis;w.elements.headerUser=WH.qs(".header-user");WH.onMutate(document.body,function(){if(w.navScrollLimitEnabled){d()}});WH.onMutate(w.elements.headerUser,N.bind(z,true));WH.aE(window,"scroll",m);WH.aE(window,"resize",g);if(document.fonts){document.fonts.load("14px Open Sans").then(g)}m();g()};this.updateHeaderOffset=function(){if(WH.Theme.isStandardType()){z.updateHeaderOffset=function(){};return}var R=WH.Layout.getElement("header");if(!R){return}var Q=WH.Layout.getElement("page-content");if(!Q){return}Q.style.borderTopWidth=R.parentNode.offsetHeight+"px";if(!z.isZulInMobileMode()&&w.elements.headerWrapper){document.documentElement.style.scrollPaddingTop=w.elements.headerWrapper.getBoundingClientRect().height+10+"px"}WH.WAS.updateSkinPosition()};this.updateNavOverflow=function(){N(true)};this.isZulInMobileMode=function(){return Boolean(document.body.className&&document.body.className.indexOf("has-mobile-zul-bar")>-1)};function u(S,V,T,U){for(var Q=S;Q<w.collapsibleNavLinkCount;Q++){var R=w.elements.collapsibleNavLinks[Q];if(E(V,T,U)){R.classList.add(G);S++;w.navOverflowMenu.push(R.menuItem);if(T===R){break}}else{R.classList.remove(G)}}return S}function h(Q){w.mobileMode=true;var R=Q+p;if(R>w.maxMobileNavigationWidth){w.maxMobileNavigationWidth=R}}function v(){if(w.elements.headerNavEllipsis&&!w.elements.headerNavEllipsis.classList.contains(G)){return w.elements.headerNavEllipsis}var Q=w.elements.headerNavLinks||WH.qsa(".header-nav a");for(var R=Q.length-1;R>=0;R--){if(!Q[R].classList.contains(G)){return Q[R]}}return undefined}function q(){if(w.elements.fullscreenModeIcon===undefined){w.elements.fullscreenModeIcon=WH.qs(".header-user-fullscreen")}return w.elements.fullscreenModeIcon}function t(R,T){var S=R.getBoundingClientRect();var V=getComputedStyle(R).getPropertyValue("padding-right");var Q=S.right-parseInt(V||0)-2;var U=Q-(T.originalWidth||56);return{rect:S,right:Q,rightWithEllipsis:U}}function f(){return w.featuredNavAltPosition?"scrolling":"standard"}function A(){l(w.elements.headerNavFeaturesLinks,w.elements.headerNavFeaturesEllipsis,w.featuredNavOverflowMenu);A=function(){}}function L(){l(w.elements.headerNavLinks,w.elements.headerNavEllipsis,w.navOverflowMenu);L=function(){}}function l(S,R,U){for(var T=0,Q=S.length;T<Q;T++){S[T].originalWidth=S[T].getBoundingClientRect().width}R.originalWidth=R.getBoundingClientRect().width;Menu.add(R,U)}function E(T,R,S){var Q=R.getBoundingClientRect();if(Q.top!==T.rect.top){return true}return Q.left+R.originalWidth>(S?T.right:T.rightWithEllipsis)}function D(Q){if(!WH.Theme.isStandardType()){return false}if(w.elements.headerNavFeaturesLinks&&!w.featuredNavAltPosition){var S=w.elements.headerNavFeaturesLinks[0];var R=w.elements.headerNavFeaturesLinks[w.elements.headerNavFeaturesLinks.length-1];if(S&&R&&S.getBoundingClientRect().top!==R.getBoundingClientRect().top){return true}}return false}function F(U){var aa=f();N();var T=0;for(var V=1;V<=O;V++){if(U<=(w.responsiveNavStepWidths[aa][V-1]||0)){T=V}}if(T!==w.responsiveNavStep[aa]){P(aa,T);w.updateSearchWidth=true}var R=v();if(WH.Theme.isClassicType()){var S=R?R.getBoundingClientRect():null;if(WH.Theme.isClassic()){if(w.responsiveNavStep[aa]<1&&S&&S.right>w.elements.headerUser.getBoundingClientRect().left){P(aa,1)}}else{if(WH.Theme.isThottbot()){if(typeof w.elements.logo==="undefined"){w.elements.logo=WH.qs(".header-logo")}if(typeof w.elements.themeSwitcher==="undefined"){w.elements.themeSwitcher=WH.qs(".header-theme-switcher")}if(w.elements.logo&&w.elements.themeSwitcher){var X=w.elements.logo.getBoundingClientRect();var ab=w.elements.themeSwitcher.getBoundingClientRect();if(X.right>ab.left){return true}}}}if(typeof w.elements.firstMenuItem==="undefined"){w.elements.firstMenuItem=WH.qs(".header-nav a:first-child")}if(w.elements.firstMenuItem&&S){var Q=w.elements.firstMenuItem.getBoundingClientRect();return S.top>Q.top}return false}if(R&&!(w.featuredNavAltPosition&&document.body.dataset.hideFeaturedNavWhileScrolling!=="true")){var W=w.responsiveNavStep[aa];var Z=w.elements.headerNav.getBoundingClientRect().top;var Y=K(aa,Z,R,W);if(typeof Y==="number"){if(U>w.responsiveNavStepWidths[aa][Y-1]){w.responsiveNavStepWidths[aa][Y-1]=U}if(Y!==W){w.updateSearchWidth=true}}else{return true}}return false}function C(Q){if(!WH.Theme.isStandardType()){return false}var R=w.elements.header.dataset.logo==="small";var S=w.elements.search.offsetWidth;if(Q<w.logoShrinkViewportWidth||(!R&&S<o)){if(!R&&w.logoShrinkViewportWidth<Q){w.logoShrinkViewportWidth=Q}w.elements.header.dataset.logo="small";if(R&&S&&S<o){return true}}else{if(Q>w.logoShrinkViewportWidth&&R){delete w.elements.header.dataset.logo;if(w.elements.search.offsetWidth<o){w.logoShrinkViewportWidth=Q;w.elements.header.dataset.logo="small";if(w.elements.search.offsetWidth<o){return true}}}}return false}function g(){if(w.mobileMode){return}z.updateHeaderOffset()}function m(Q){if(w.mobileMode){return}c();if(WH.Theme.isStandardType()){H(Q)}d()}function M(){var R=w.mobileMode;var Q=Platform.getViewportWidth();w.mobileMode=Q<=w.maxMobileNavigationWidth;if(!w.mobileMode){if(F(Q)){h(Q)}}if(!w.mobileMode){if(typeof w.elements.header==="undefined"){w.elements.header=WH.qs(".header")}if(typeof w.elements.search==="undefined"){w.elements.search=WH.qs(".header-search form")}if(w.elements.header&&w.elements.search&&C(Q)){h(Q)}}if(!w.mobileMode&&D(Q)){h(Q)}return w.mobileMode!==R}function P(R,Q){if(w.responsiveNavStep[R]===Q){return}w.responsiveNavStep[R]=Q;document.body.dataset.responsiveNavStep=Q}function K(U,S,T,R){if(T.getBoundingClientRect().top!==S){var Q=R+1;if(Q>O){return null}P(U,Q);return K(U,S,T,Q)}return R}function J(){if(w.navOverflowMenu.length===0){w.elements.headerNavEllipsis.classList.add(G)}else{w.elements.headerNavEllipsis.classList.remove(G);w.navOverflowMenu.reverse()}if(w.featuredNavOverflowMenu.length===0){w.elements.headerNavFeaturesEllipsis.classList.add(G)}else{w.elements.headerNavFeaturesEllipsis.classList.remove(G)}}function r(Q,V){if(w.mobileMode||!w.featuredNavAltPosition||(w.featuredNavOverflowMenu.length!==w.elements.headerNavFeaturesLinks.length&&document.body.dataset.hideFeaturedNavWhileScrolling!=="true")){return}var U=w.responsiveNavStep[f()]-1;var T=Q<=w.featuredNavAltPositionHiddenViewportWidths[U];if(!T){var S=w.elements.headerNavFeaturesEllipsis.getBoundingClientRect();var R=w.elements.headerNavFeatures.getBoundingClientRect();if(S.width>R.width||S.top!==R.top){w.featuredNavAltPositionHiddenViewportWidths[U]=Q;T=true}}if(V!==true||(V===true&&T)){document.body.dataset.hideFeaturedNavWhileScrolling=JSON.stringify(T)}if(V!==true&&!T){r(Q,true)}}function c(){let useHiddenHeader=WH.Layout.getFullscreenMode()&&WH.getScroll().y>=70;if(w.hiddenHeader!==useHiddenHeader){w.hiddenHeader=useHiddenHeader;document.body.dataset.hideHeader=JSON.stringify(w.hiddenHeader)}}function N(R){if(w.mobileMode||!w.elements.headerNav){return}var W=Platform.getViewportWidth();var Z=f();if(w.navOverflowLastNavState===Z&&w.navOverflowLastResponsiveStep===w.responsiveNavStep&&w.navOverflowLastViewportWidth[Z]===W&&R!==true){return}w.navOverflowLastNavState=Z;w.navOverflowLastResponsiveStep=w.responsiveNavStep;w.navOverflowLastViewportWidth[Z]=W;if(WH.Theme.isClassic()){L();w.navOverflowMenu.length=0;for(var U=0,X=w.elements.collapsibleNavLinks.length;U<X;U++){w.elements.collapsibleNavLinks[U].classList.remove(G)}var V=w.elements.headerUser.getBoundingClientRect();for(var U=0;U<w.collapsibleNavLinkCount;U++){var Q=w.elements.collapsibleNavLinks[U];if(v().getBoundingClientRect().right>V.left){Q.classList.add(G);w.navOverflowMenu.push(Q.menuItem)}else{Q.classList.remove(G)}}J();return}var aa=0;if(w.featuredNavAltPosition){A();for(var U=0,X=w.elements.collapsibleNavLinks.length;U<X;U++){w.elements.collapsibleNavLinks[U].classList.remove(G)}w.navOverflowMenu.length=0;w.featuredNavOverflowMenu.length=0;var ab=t(w.elements.headerNavFeatures,w.elements.headerNavFeaturesEllipsis);var S=false;for(var U=0,X=w.elements.headerNavFeaturesLinks.length;U<X;U++){var Y=w.elements.headerNavFeaturesLinks[U];if(!S){var T=U===X-1;aa=u(aa,ab,Y,T);S=E(ab,Y,T)}if(S){Y.classList.add(G);w.featuredNavOverflowMenu.push(Y.menuItem)}else{Y.classList.remove(G)}}J();r(W)}else{L();w.navOverflowMenu.length=0;var ab=t(w.elements.headerNav,w.elements.headerNavEllipsis);for(var U=0,X=w.elements.headerNavLinks.length;U<X;U++){var Y=w.elements.headerNavLinks[U];if(aa<w.collapsibleNavLinkCount&&!Y.classList.contains(G)){aa=u(aa,ab,Y,U===X-1)}}J()}}function B(Q){if(!Q){document.body.classList.add("no-header")}else{document.body.classList.remove("no-header")}}function d(){if(w.hiddenHeader){return}var S=WH.Layout.getElement("main-contents");if(!S||!w.elements.headerWrapper){if(document.readyState==="complete"){d=function(){}}return}var R=WH.getScroll().y;var Q=R+S.getBoundingClientRect().bottom-w.elements.headerWrapper.getBoundingClientRect().height;if(R>=Q){if(!w.navScrollLimitEnabled){w.elements.headerWrapper.style.position="absolute";w.elements.headerWrapper.style.top=Q+"px";w.elements.headerWrapper.style.transition="none";w.navScrollLimitEnabled=true}}else{if(w.navScrollLimitEnabled){z.disableNavScrollLimit()}}}function H(T){let useAltPosition=WH.Layout.getFullscreenMode()||WH.getScroll().y>=70;if(w.featuredNavAltPosition===useAltPosition&&T!==true){return}var S=Menu.getOpener();var R;if(S&&WH.closest(S,".header-wrapper")){R=S.getBoundingClientRect()}w.featuredNavAltPosition=useAltPosition;document.body.dataset.navState=f();I();N(T);if(w.featuredNavAltPosition){requestAnimationFrame(N.bind(z,true))}if(R){var Q=S.getBoundingClientRect();if(R.left!==Q.left||R.top!==Q.top||(useAltPosition&&S.classList.contains(G))){Menu.hide(true)}}WH.DynamicFixedElement.checkAll();z.check(false)}function I(){if(w.mobileMode){return}var Q=q();var R=w.elements.headerNavWrapper.getBoundingClientRect();var S=R.right-Q.getBoundingClientRect().left+10;if(w.featuredNavAltPosition){S+=17;w.elements.headerNavWrapper.style.paddingRight=S+"px";w.elements.headerNav.style.paddingRight=""}else{w.elements.headerNav.style.paddingRight=S+"px";w.elements.headerNavWrapper.style.paddingRight=""}}};WH.Layout.User=new function(){const f=this;const m=WH.Url;let my={userMenu:undefined};this.createDebugQueueElement=function(){var p=WH.qs(".header-user");if(!p){WH.error("Cannot create debug queue element, .header-user not found.");return undefined}var o=g(p,"debug-messages","Debug Messages");WH.aef(p,o);return o};this.getLocaleMenu=function(){var r=location.pathname+location.search+location.hash;var o=Locale.getId();var q=[[null,WH.TERMS.language]];var p;$.each(Locale.getAllByName(),function(u,t){var v=[t.id,t.description,WH.Url.generate(r,{subdomain:WH.Url.getSubdomain(undefined,t.id)})];if(t.id==o){v.checked=true;p=t}q.push(v)});return q};this.getProfilerMenu=function(){if(!g_user.lists){return null}var q=[];var E=[["refresh",WH.TERMS.refreshcharacterlist,"/account=battlenet",null,{icon:WH.staticUrl+"/images/icons/battlenet.png"}]];var u=[],B=[],v=[],r=[];g_user.lists.sort(function(H,G){return WH.stringCompare(H.realm,G.realm)||WH.stringCompare(H.name,G.name)});var t=false;$.each(g_user.lists,function(G,H){if(H.mode==1){if(H.pinned>0){u.push(WH.Profiler.getMenuItem(H,true))}if(t&&(t!=H.realm)){if(B.length){B.unshift([undefined,t])}B.push([undefined,H.realm])}t=H.realm;B.push(WH.Profiler.getMenuItem(H))}else{r.push(WH.Profiler.getMenuItem(H))}});var w=0,o,A,D;var p=function(H,I){var G=0+I;return function(K){if(K){return}for(var J=0;J<H.length;J++){if(H[J][0]==G){H.splice(J--,1)}}}};if(g_user.battlenetChars&&g_user.battlenetChars.length){g_user.battlenetChars.sort(function(H,G){return WH.stringCompare(H.region,G.region)||WH.stringCompare(H.realm,G.realm)||WH.stringCompare(H.name,G.name)});t=false;for(var F=0;F<g_user.battlenetChars.length;F++){A=g_user.battlenetChars[F];if(A.level<10){continue}o=WH.Strings.slug(A.region+" "+A.realm+" "+A.name,true);D=false;for(var C=0;C<g_user.lists.length;C++){if(g_user.lists[C].url==o){D=true;break}}if(D){continue}if(t&&(t!=A.realm)){if(v.length){v.unshift([undefined,t])}v.push([undefined,A.realm])}t=A.realm;w--;v.push([w,A.name,"/list/"+o+"?private",null,{className:"listmanager-mode1"}]);WH.BlizzardApi.characterExists(A.region,A.realm,A.name,p(v,w))}}var z=0;if(B.length){z++}if(v.length){z++}if(r.length){z++}if((B.length+v.length+r.length<=12)||(z<=1)){if(B.length){q.push([undefined,WH.TERMS.profiles]);q.push.apply(q,B)}if(v.length){q.push([undefined,WH.TERMS["import"]]);q.push.apply(q,E.concat(v))}if(r.length){q.push([undefined,WH.TERMS.customlists]);q.push.apply(q,r)}}else{if(u.length){Menu.sort(u);q.push([undefined,WH.TERMS.pinnedprofiles]);q.push.apply(q,u);q.push([undefined,WH.TERMS.goal])}if(B.length){q.push([1,WH.TERMS.profiles,null,B])}if(v.length){q.push([1,WH.TERMS["import"],null,E.concat(v)])}if(r.length){q.push([1,WH.TERMS.customlists,null,r])}}return q};this.getUserMenu=function(){if(my.userMenu){return my.userMenu}let menu=[];var o=["user-page",WH.TERMS.userpage,"/user="+g_user.name,null,{checkedUrl:new RegExp("user="+g_user.name+"$","i"),fontIcon:"user"}];menu.push(o);var t=["settings",WH.TERMS.settings,"/account",null,{fontIcon:"cog",checkedUrl:/account(?!=premium|\/guides)/i}];menu.push(t);if(WH.Notifications.browserSupportsNotifications()){menu.push(["notifications",WH.TERMS.notificationSettings,"/notifications/settings",null,{fontIcon:"bell",checkedUrl:/^notifications\/settings/i}])}if(WH.User.isPremium()){menu.push(["premium",WH.TERMS.premiumsettings,"/account=premium",null,{checkedUrl:/account=premium/i,fontIcon:"star"}])}else{menu.push(["premium-upgrade",WH.TERMS.premiumsettings,"/premium",null,{className:"premium-upgrade",checkedUrl:/premium/i,fontIcon:"star"}])}var r=WH.TERMS.reputation;if(g_user.reputation){r=WH.Strings.sprintf(WH.TERMS.parens_format,WH.TERMS.reputation,WH.Strings.formatNumber(g_user.reputation))}var q=["reputation",r,"/reputation",null,{fontIcon:"trophy"}];menu.push(q);let guidesMenuItem=h();if(guidesMenuItem){menu.push(guidesMenuItem)}var p=d();if(p){menu.push(p)}menu.push(["sign-out",WH.TERMS.signout,"/account=signout"]);menu.push(["sign-out-global",WH.TERMS.logOutEverywhere,"/account=signout?global"]);my.userMenu=menu;return menu};this.init=function(){var t=WH.qs(".header");if(!t){return}var r=WH.ce("div",{className:"header-user"});WH.ae(t,r);if(WH.User.isLoggedIn()){c(r)}else{l(r)}let fullscreenToggle=g(r,"fullscreen",WH.Layout.getFullscreenMode()?WH.TERMS.exitFullscreen:WH.TERMS.fullscreen);WH.aE(fullscreenToggle,"click",WH.Layout.toggleFullscreenMode);if(!WH.Theme.isClassicType()){WH.Tooltip.simple(fullscreenToggle,function(){let q=WH.Layout.getFullscreenMode()?WH.TERMS.exitFullscreenMode:WH.TERMS.enterFullscreenMode;return WH.ce("div",{className:"no-wrap"},WH.ct(q)).outerHTML},"q2")}if((!WH.Theme.isClassicType()||!WH.User.isLoggedIn())&&WH.Notifications.browserSupportsNotifications()){let notificationSettings=g(r,"notifications",WH.TERMS.notifications,"/notifications/settings");let notificationSettingsText=WH.qs("span",notificationSettings);if(!notificationSettingsText||window.getComputedStyle(notificationSettingsText).display==="none"){WH.Tooltip.simpleNonTouch(notificationSettings,WH.TERMS.notificationSettings,"q2")}}var o=g(r,"feedback",WH.TERMS.feedback);WH.aE(o,"click",ContactTool.show.bind(ContactTool,undefined));var q=WH.qs("span",o);if(!q||window.getComputedStyle(q).display==="none"){WH.Tooltip.simpleNonTouch(o,WH.TERMS.feedback,"q2")}var p=g(r,"lang",Locale.getDescription());Menu.add(p,f.getLocaleMenu(),{padded:true})};function g(r,p,t,o){var q=WH.ce("a",{className:"header-user-"+p});if(t){WH.ae(q,WH.ce("span",undefined,WH.ct(t)))}q.href=o||"javascript:";WH.ae(r,q);return q}function h(){let guideInfo=WH.getPageData("guide.myRecent");if(!guideInfo||!guideInfo.count){return}let submenu=[];guideInfo.list.forEach(function(o){let options={extraActions:[{fontIcon:"pencil",url:"/guide=edit&id="+o.id,tooltipText:WH.TERMS.edit}]};if(!o["public"]){options.rel="np"}if(o.playerClass){options.className="c"+o.playerClass}submenu.push(Menu.createItem({label:o.name,name:o.id,url:o.url,options:options}))});return Menu.createItem({label:WH.TERMS.myguides,name:"guides",url:"/account/guides",submenu:submenu,options:{fontIcon:"book",checkedUrl:/account\/guides/i}})}function d(){if(!g_user.lists||!g_user.lists.length){return null}var p={onBeforeShow:function(q){Menu.setSubmenu(q,f.getProfilerMenu())},zulGetMobileMenu:function(){return Menu.prepareForZul(f.getProfilerMenu())},zulHref:function(u,t,q,r){return q?false:"/user="+g_user.name},fontIcon:"users"};for(var o=0;o<g_user.lists.length;o++){if(g_user.lists[o].thumbnail){delete p.icon;p.armory=WH.BlizzardApi.getCharacterThumbnailUrl(g_user.lists[o].region,g_user.lists[o].thumbnail)}}return["lists",WH.TERMS.myprofiles,"/user="+g_user.name+"#lists",null,p]}function c(w){if(WH.User.hasRole(U_GROUP_STAFF)){g(w,"staff",WH.TERMS.staffemployees)}g(w,"favorites",WH.TERMS.favorites);Favorites.refreshMenu();var p=WH.Profiler.getFavorite();if(p){var o=WH.Profiler.getAvatarUrl(p);if(o){var r=g(w,"profile",undefined,WH.Profiler.getPath(p));r.style.background="url("+o+")";var t=f.getProfilerMenu();if(t&&t.length){Menu.add(r,t,{padded:true})}}}var v=WH.User.getUsername();var q=WH.User.getReputation();if(q){v=WH.Strings.sprintf(WH.TERMS.parens_format,v,WH.Strings.formatNumber(q))}var u=g(w,"user",v,WH.User.getPath());Menu.add(u,f.getUserMenu(),{padded:true})}function l(w){var r=WH.ce("a",{className:"header-user-text",href:WH.Url.getLoginPath()},WH.ce("span",undefined,WH.ct(WH.TERMS.login+WH.TERMS.colon_punct)));WH.ae(w,r);var q="/account=battlenet?r=1";var o=g(w,"bnet btn btn-blizzard",WH.TERMS.battlenet,q);WH.aE(o,"click",function(){WH.visitUrlWithPostData("/account=battlenet",{r:1});return false});var u="/account=signin";var t=(location.pathname+location.search).substr(1);if(t&&t.indexOf("account=signin")===0){t=WH.getGets().next||""}if(t){u+="?next="+encodeURIComponent(t)}var v=g(w,"fanbyte btn btn-fanbyte",WH.TERMS.fanbyte,u);WH.Tooltip.simpleNonTouch(v,WH.TERMS.fanbyteNameChange_tip,undefined,undefined,true);var p="btn btn-site fa fa-user-plus fa-fw";g(w,"register "+p,WH.TERMS.register,m.getRegistrationPath())}};Listview.Filters=function(I){const t=this;const T=WH.DOM;const ad="all";const aw="any";const f=ad;const w=[ad,aw];const M=1;const m=2;const al=3;const c=4;const P=5;const aa=6;const B=7;const aq={">":M,"=":m,"<":al,">=":c,"<=":P};const p={};p[M]=">";p[m]="=";p[al]="<";p[c]=">=";p[P]="<=";p[aa]=WH.TERMS.min+"-"+WH.TERMS.max;p[B]=WH.TERMS.text;const o={};o["default"]=[{type:M,text:p[M]},{type:c,text:p[c]},{type:m,text:p[m]},{type:P,text:p[P]},{type:al,text:p[al]},{type:aa,text:p[aa]}];o[Listview.COLUMN_TYPE_TEXT]=[{type:B,text:p[B]},{type:M,text:p[M]},{type:c,text:p[c]},{type:m,text:p[m]},{type:P,text:p[P]},{type:al,text:p[al]},{type:aa,text:p[aa]}];const J={NUMBER:/(>|=|<|>=|<=)\s*(-?[0-9.]+)/,RANGE:/(-?[0-9.]+)\s*-\s*(-?[0-9.]+)/};const av=[Listview.COLUMN_ID_COMPLETION,Listview.COLUMN_ID_DEBUG_ID,Listview.COLUMN_ID_POPULARITY];const aj={};aj[M]=function(aB,aA){return aA>aB};aj[m]=function(aB,aA){return aA==aB};aj[al]=function(aB,aA){return aA<aB};aj[c]=function(aB,aA){return aA>=aB};aj[P]=function(aB,aA){return aA<=aB};aj[aa]=function(aB,aA){return aB.min<=aA&&aA<=aB.max};const ap={};ap[M]=function(aB,aA){return aA.max>aB};ap[m]=function(aB,aA){return aA.min<=aB&&aB<=aA.max};ap[al]=function(aB,aA){return aA.min<aB};ap[c]=function(aB,aA){return aA.max>=aB};ap[P]=function(aB,aA){return aA.min<=aB};ap[aa]=function(aB,aA){return aB.min<=aA.max&&aA.min<=aB.max};const r={elements:{container:undefined,match:{all:undefined,any:undefined,container:undefined},reset:undefined,tableFilter:undefined,tableFilterIcon:undefined,tableFilterClear:undefined},filters:[],hasFilterableColumns:false,listview:undefined,matchType:f};this.apply=function(){WH.Tooltip.hide();O();t.applyDataOnly();A();r.listview.validatePage();r.listview.updateNav();r.listview.refreshRows();r.listview.updateBrowseSession();r.listview.writeHash()};this.focus=function(){am();if(r.listview.searchable&&r.elements.tableFilter){WH.safeFocus(r.elements.tableFilter)}};this.reset=function(){while(r.filters.length){let filter=r.filters.pop();if(filter.column){ae(filter.column)}}if(r.elements.filters){WH.ee(r.elements.filters)}if(r.elements.tableFilter){r.elements.tableFilter.value=""}r.matchType=f;if(r.elements.match[f]){r.elements.match[f].checked=true}r.listview.resetRowVisibility();t.apply()};this.resetAndFocus=function(){requestAnimationFrame(N)};this.applyDataOnly=function(){r.listview.resetRowVisibility(true);if(!r.filters.length&&!r.listview.customFilter&&!r.listview.classFilter){return}let visibleColumns=[];let columns=Z();for(let i=0,column;column=columns[r.listview.visibility[i]];i++){if(!av.includes(column.id)&&W(column)){visibleColumns.push(column)}}let visibleRowCount=0;let testRow=r.matchType===aw?ak:V;for(let i=0,len=r.listview.data.length;i<len;i++){let row=r.listview.data[i];row.__hidden=true;if(r.listview.customFilter&&!r.listview.customFilter(row,i)){continue}if(r.listview.customFilter2&&!r.listview.customFilter2(row,i)){continue}if(r.listview.classFilter&&!r.listview.classFilter(row,i)){continue}if(row.__alwaysvisible||!r.filters.length||testRow(row,visibleColumns)){row.__hidden=false;visibleRowCount++}}r.listview.filtered=visibleRowCount<r.listview.data.length;r.listview.nRowsVisible=visibleRowCount};this.getColumnTooltipAdditions=function(aA){let filters=r.filters.filter(function(aB){return(aB.column||{}).id===aA.id});if(!filters.length){return null}filters.sort(function(aC,aB){WH.stringCompare(aC.invert,aB.invert)});let filterDescriptions=WH.ce("div","no-wrap");for(let i=0,filter;filter=filters[i];i++){WH.ae(filterDescriptions,WH.ce("div",undefined,WH.ct((filter.invert?WH.TERMS.invertedFilter_stc:WH.TERMS.filter)+WH.TERMS.colon_punct+ac(filter,true))))}return filterDescriptions};this.getHashParts=function(){let hashParts=[];let tableFilters=[];let columnFilters=[];for(let i=0,filter;filter=r.filters[i];i++){if(!filter.enabled){continue}let filterText=encodeURIComponent(ac(filter));if(filter.column){columnFilters.push(filter.column.id+"="+filterText)}else{tableFilters.push("q="+filterText)}}let hasMultipleFilters=tableFilters.length+columnFilters.length>1;if(tableFilters=tableFilters.join(";")){hashParts.push(tableFilters)}if(columnFilters=columnFilters.join(";")){hashParts.push(columnFilters)}if(hasMultipleFilters&&r.matchType!==f){hashParts.push("match"+WH.ucfirst(r.matchType))}return hashParts};this.getOptionsToggle=function(){if(r.listview.searchable||r.hasFilterableColumns){let link=WH.ce("a",{href:"javascript:",className:"listview-filters-link fa fa-filter"});WH.aE(link,"click",Q);WH.Tooltip.simpleNonTouch(link,az,"q2");return link}else{return null}};this.isColumnFiltered=function(aA){for(let i=0,filter;filter=r.filters[i];i++){if(filter.column.id===aA.id&&filter.enabled){return true}}return false};this.readHashPart=function(aA){let tableFilter=aA.match(/^q=(.*)$/);if(tableFilter){if(r.listview.searchable){C(decodeURIComponent(tableFilter[1]),{skipApply:true})}return}aA.split(",").forEach(function(aB){let columnFilter=aB.match(/^([A-Za-z0-9_]+)=(.+)$/);if(columnFilter){let colId=decodeURIComponent(columnFilter[1]);let value=decodeURIComponent(columnFilter[2]);let columns=Z();for(let i=0,column;column=columns[i];i++){if(column.id===colId&&r.listview.isColumnVisible(column)&&W(column)){C(value,{column:column,skipApply:true});break}}return}let matchType=aB.match(/^match([A-Za-z]+)$/);if(matchType){D(matchType[1].toLowerCase(),true)}})};function U(){return!!r.listview.container.dataset.filters}function L(){let container=WH.ce("div",{className:"listview-filters"});if(r.listview.searchable){let placeholder=r.listview._truncated?WH.TERMS.searchwithindisplayedresults_ellipsis:WH.TERMS.searchAllColumns_ellipsis;let wrapper=WH.ce("div",{className:"listview-filters-table"});if(r.listview.tabClick){WH.aE(wrapper,"click",r.listview.tabClick)}r.elements.tableFilterIcon=WH.ce("span",{className:wrapper.className+"-search-icon fa fa-search"});WH.ae(wrapper,r.elements.tableFilterIcon);let tableFilter=WH.ce("input",{placeholder:placeholder,style:{width:r.listview._truncated?"20em":"16em"},type:"text"});r.elements.tableFilter=tableFilter;for(let i=0,filter;filter=r.filters[i];i++){if(!filter.column){tableFilter.value=filter.invert+ac(filter);break}}WH.aE(tableFilter,"keyup",O);WH.onAfterTyping(tableFilter,z.bind(tableFilter),r.listview.searchDelay);WH.aE(tableFilter,"blur",function(){if(this.value&&this.value.trim()===""){this.value=""}});WH.aE(tableFilter,"keypress",r.listview.submitSearch.bind(this));WH.ae(wrapper,tableFilter);r.elements.tableFilterClear=WH.ce("a",{className:wrapper.className+"-clear fa fa-times-circle",href:"javascript:",style:{display:"none"}});WH.aE(r.elements.tableFilterClear,"click",function(){tableFilter.value="";tableFilter.placeholder=placeholder;z.call(tableFilter)});WH.ae(wrapper,r.elements.tableFilterClear);WH.ae(container,wrapper)}r.elements.filters=WH.ce("div",{className:"listview-filters-columns"});WH.ae(container,r.elements.filters);let actions=WH.ce("div",{className:"listview-filters-actions"});WH.ae(container,actions);let addColumnFilter=WH.ce("a",{className:"fa fa-plus",href:"javascript:"},WH.ct(WH.TERMS.addColumnFilter_ellipsis));Menu.add(addColumnFilter,q,{showAtElement:true});WH.ae(actions,addColumnFilter);r.elements.match.container=WH.ce("div",undefined,WH.ct(WH.TERMS.match+WH.TERMS.colon_punct));WH.ae(actions,r.elements.match.container);let matchName="listview-match-"+WH.Strings.guid();let matchAll=WH.ce("label",undefined,WH.ct(WH.TERMS.all));r.elements.match.all=WH.ce("input",{name:matchName,type:"radio"});WH.aef(matchAll,r.elements.match.all);WH.ae(r.elements.match.container,matchAll);let matchAny=WH.ce("label",undefined,WH.ct(WH.TERMS.any));r.elements.match.any=WH.ce("input",{name:matchName,type:"radio"});WH.aef(matchAny,r.elements.match.any);WH.ae(r.elements.match.container,matchAny);r.elements.match[r.matchType].checked=true;WH.aE(r.elements.match.all,"change",function(){D(ad)});WH.aE(r.elements.match.any,"change",function(){D(aw)});r.elements.reset=WH.ce("a",{className:"fa fa-times",href:"javascript:"},WH.ct(WH.TERMS.reset));WH.aE(r.elements.reset,"click",N);WH.ae(actions,r.elements.reset);return container}function X(aB,aA){aB.enabled=false;if(!t.isColumnFiltered(aB.column)){ae(aB.column)}if(aA){aB.elements.wrapper.dataset.showError="true";WH.st(aB.elements.error,aA)}else{delete aB.elements.wrapper.dataset.showError}aB.elements.wrapper.classList.toggle("ie11-dataset-fix");t.apply()}function ae(aA){if(aA.__th){aA.__th.firstChild.firstChild.classList.remove("q5")}}function H(aA){if(aA.__th){aA.__th.firstChild.firstChild.classList.add("q5")}}function E(aA){am();aA.elements.text.focus()}function d(aB,aA){const aD="listview-filters-columns-filter";let optionWrapper=WH.ce("div",{className:aD});let remove=WH.ce("a",{className:aD+"-remove",href:"javascript:"});WH.aE(remove,"click",v.bind(remove,optionWrapper));WH.Tooltip.simpleNonTouch(remove,WH.TERMS.removefilter_stc,"q10",true);WH.ae(optionWrapper,remove);let columnName=T.createImitationSelect({text:S(aB)});columnName.classList.add(aD+"-name");Menu.add(columnName,q.bind(undefined,optionWrapper,columnName),{showAtElement:true});WH.ae(optionWrapper,columnName);let operator=T.createImitationSelect({text:WH.TERMS.error});operator.classList.add(aD+"-operator");Menu.add(operator,af.bind(undefined,optionWrapper,operator),{showAtElement:true});WH.ae(optionWrapper,operator);let textWrapper=WH.ce("div",{className:aD+"-text-wrapper"});WH.ae(optionWrapper,textWrapper);let text=WH.ce("input",{className:aD+"-text",type:"text"});WH.onAfterTyping(text,g.bind(text,optionWrapper,text),r.listview.searchDelay);WH.ae(textWrapper,text);let rangeHyphen=WH.ce("div",{className:aD+"-range"},WH.ct("-"));WH.ae(textWrapper,rangeHyphen);let text2=WH.ce("input",{className:aD+"-text2",type:"text"});WH.onAfterTyping(text2,g.bind(text2,optionWrapper,text2),r.listview.searchDelay);WH.ae(textWrapper,text2);let invert=WH.ce("input",{className:aD+"-invert",type:"checkbox"});let invertLabel=WH.ce("label",{className:aD+"-invert-label",href:"javascript:"},invert);WH.ae(invertLabel,WH.ct(WH.TERMS.invert));WH.aE(invert,"change",G.bind(invert,optionWrapper,invert));WH.ae(optionWrapper,invertLabel);let error=WH.ce("span",{className:aD+"-error"});WH.ae(optionWrapper,error);if(aA){WH.st(columnName,S(aA.column));ag(operator,optionWrapper,aA.operator);text.value=aA.text;text2.value=aA.text2;invert.checked=!!aA.invert}else{if(aB.type===Listview.COLUMN_TYPE_TEXT){aA={column:aB,elements:undefined,enabled:false,invert:"",operator:B,test:undefined,text:"",text2:""};ag(operator,optionWrapper,aA.operator);r.filters.push(aA);A()}else{let error=false;try{aA=ab(">0",aB)}catch(aC){WH.error(aC.message||aC);error=true}if(!aA||error){let message="Could not create empty numeric filter.";WH.error(message,aB.id,aB);alert(message);throw new Error(message)}r.filters.push(aA);H(aA.column);ag(operator,optionWrapper,aA.operator);text.value=aA.text;text2.value=aA.text2;t.apply()}}optionWrapper.__listviewFilter=aA;aA.elements={error:error,operator:operator,text:text,text2:text2,wrapper:optionWrapper};return optionWrapper}function q(aB,aA){let menu=[];let action;let currentColumnId;if(aB){menu.push(Menu.createItem({label:WH.TERMS.changeColumn_ellipsis,options:{heading:true}}));let filter=ai(aB);action=an.bind(undefined,filter,aA);currentColumnId=filter.column.id}else{action=Y.bind(undefined)}let columns=Z();for(let i=0,column;column=columns[r.listview.visibility[i]];i++){if(!W(column)){continue}if(column.id===Listview.COLUMN_ID_DEBUG_ID){let menuItem=Menu.createItem({name:"",label:WH.Strings.sprintf(WH.TERMS.parens_format,S(column),WH.TERMS.staffonly_stc),url:action.bind(undefined,column)});menuItem.checked=column.id===currentColumnId;menu.push(menuItem);continue}let menuItem=Menu.createItem({name:"",label:S(column),url:action.bind(undefined,column)});menuItem.checked=column.id===currentColumnId;menu.push(menuItem)}return menu}function S(aA){return aA.tooltip||aA.name||aA.id}function af(aB,aA){let menu=[];let filter=ai(aB);let options=o[filter.column.type]||o["default"];for(let i=0,option;option=options[i];i++){let menuItem=Menu.createItem({name:"",label:option.text,url:R.bind(undefined,filter,aA,option)});menuItem.checked=option.type===filter.operator;menu.push(menuItem)}return menu}function ai(aA){return aA.__listviewFilter}function Z(){return r.listview.sortOptions||r.listview.columns||[]}function ah(aB,aA){let text=r.listview.template.getVisibleText?(""+r.listview.template.getVisibleText(aB)).trim():"";if(aA.getVisibleText){return text+aA.getVisibleText(aB)}if(aA.getValue){return text+aA.getValue.call(r.listview,aB)}if(aA.value){return text+aB[aA.value]}if(aA.compute){return text+aA.compute.call(r.listview,aB,WH.ce("td"),WH.ce("tr"),aA.__index)}return""}function u(aA){return aA?(aA.type||Listview.COLUMN_TYPE_NUMBER):Listview.COLUMN_TYPE_TEXT}function ab(aB,aA){aB=aB.replace(/\s+/g," ").trim();let filter={elements:undefined,enabled:true,invert:"",test:undefined,text:"",text2:""};if(aA){filter.column=aA}let columnType=u(aA);if(aB){if(aB.charAt(0)==="!"||(columnType===Listview.COLUMN_TYPE_TEXT&&aB.charAt(0)==="-")){filter.invert="!";aB=aB.substr(1)}let value;if(aB.match(J.NUMBER)){value=parseFloat(RegExp.$2);if(!isNaN(value)){filter.operator=aq[RegExp.$1];filter.value=value;filter.text=""+value}}else{if(aB.match(J.RANGE)){value={min:parseFloat(RegExp.$1),max:parseFloat(RegExp.$2)};if(!isNaN(value.min)&&!isNaN(value.max)){if(value.min===value.max){filter.operator=m;filter.value=value.min;filter.text=""+value.min}else{if(value.min>value.max){let higherValue=value.min;value.min=value.max;value.max=higherValue}filter.operator=aa;filter.value=value;filter.text=""+value.min;filter.text2=""+value.max}}}else{let parts=aB.toLowerCase().split(" ");if(columnType===Listview.COLUMN_TYPE_TEXT){filter.operator=B;filter.text=aB;if(filter.invert){filter.regExp=WH.createOrRegex(aB)}else{filter.words=parts}}else{if(parts.length===1&&!isNaN(value=parseFloat(parts[0]))&&""+value===parts[0]){filter.operator=m;filter.value=value;filter.text=""+value}}}}}if(aB&&!filter.operator){throw new Error(WH.TERMS.invalidfilter_stc)}if(!filter.text){return null}au(filter);return filter}function az(){return WH.ce("div",{className:"no-wrap"},WH.ct(U()?WH.TERMS.hidefilteroptions_stc:WH.TERMS.filterTheseResults_stc)).outerHTML}function ac(aA,aB){let invert=aB?"":aA.invert;switch(aA.operator){case aa:return invert+aA.text+"-"+aA.text2;case B:return invert+aA.text;default:if(!p[aA.operator]){let message="Could not generate simple filter text for unsupported filter operator.";WH.error(message,aA.operator);alert(message);throw new Error(message)}return invert+p[aA.operator]+aA.text}}function ao(aA){r.listview=aA;if(r.listview.filtrable){let columns=Z();for(let i=0,column;column=columns[i];++i){if(!W(column)){continue}if(!r.hasFilterableColumns&&r.listview.isColumnVisible(column)){r.hasFilterableColumns=true}if(column.actions){column.actions.unshift({action:at.bind(undefined,column),name:WH.TERMS.filter,tooltipText:WH.TERMS.rightClickToFilter_stc})}}}}function W(aA){return aA.id&&(aA.filtrable==null||aA.filtrable)}function G(aB,aA){let filter=ai(aB);filter.invert=this.checked?"!":"";let result=ay(filter);if(!result.success){X(filter,result.error)}}function g(aB,aA){let filter=ai(aB);let newText=aA.value.trim();let field=aA.className.indexOf("text2")===-1?"text":"text2";if(filter[field]===newText){return}if(filter.enabled){if(newText){if(filter[field]!==newText){filter[field]=newText;let result=ay(filter);if(!result.success){X(filter,result.error)}}}else{filter[field]=newText;X(filter)}}else{if(newText){filter[field]=newText;let result=ay(filter);if(!result.success){X(filter,result.error)}}else{delete filter.elements.wrapper.dataset.showError;filter.elements.wrapper.classList.toggle("ie11-dataset-fix")}}}function an(aC,aA,aB){if(aC.column.id===aB.id){t.apply();return}let oldColumn=aC.column;aC.column=aB;WH.st(aA,S(aB));let result=ay(aC);if(!result.success){X(aC,result.error)}if(!t.isColumnFiltered(oldColumn)){ae(oldColumn)}E(aC)}function Y(aA){let optionWrapper=d(aA);WH.ae(r.elements.filters,optionWrapper);E(ai(optionWrapper))}function R(aC,aA,aB){if(aC.operator===aB.type){t.apply();return}let oldOperator=aC.operator;aC.operator=aB.type;ag(aA,aC.elements.wrapper,aC.operator);if(aB.type===aa){if(oldOperator===B){let textValue=parseFloat(aC.text);if(!isNaN(textValue)){aC.text=""+textValue;aC.value=textValue;aC.elements.text.value=aC.text}else{aC.text="0";aC.value=0;aC.elements.text.value=aC.text}}if(!aC.text2||aC.text2===aC.text){aC.text2=(aC.value||0)+1;aC.elements.text2.value=aC.text2}}let result=ay(aC);if(!result.success){X(aC,result.error)}E(aC)}function Q(aA){if(!r.listview.container.dataset.filters){am();if(r.listview.searchable&&r.elements.tableFilter){r.elements.tableFilter.focus()}}else{delete r.listview.container.dataset.filters;r.listview.container.classList.toggle("ie11-dataset-fix")}if(!Platform.isTouch()){WH.Tooltip.showAtCursor(aA,az(),undefined,undefined,"q2")}}function v(aA){let filter=ai(aA);WH.de(aA);let index=r.filters.indexOf(filter);if(index!==-1){r.filters.splice(index,1);if(!t.isColumnFiltered(filter.column)){ae(filter.column)}t.apply()}Menu.hide(true);WH.Tooltip.hide()}function at(aA){for(let i=0,filter;filter=r.filters[i];i++){if(filter.column&&filter.column.id===aA.id){E(filter);return}}let example=aA.type===Listview.COLUMN_TYPE_TEXT?WH.TERMS.examplefilter_tip:WH.TERMS.examplefilter2_tip;let filterText=prompt(WH.sprintf(WH.TERMS.columnfilter_format+"\n\n"+example,S(aA)));if(filterText!==null){let filter=C(filterText,{column:aA});if(filter){E(filter)}}}function z(){C(this.value)}function ay(aA){let result={success:false};try{let newFilter=ab(ac(aA),aA.column);if(newFilter){l(aA,newFilter);ag(newFilter.elements.operator,newFilter.elements.wrapper,newFilter.operator);let text=newFilter.elements.text;let text2=newFilter.elements.text2;if(newFilter.operator===aa){if(newFilter.text===aA.text2||newFilter.text2===aA.text){text.value=newFilter.text;text2.value=newFilter.text2;if(document.activeElement===text){text2.focus()}else{if(document.activeElement===text2){text.focus()}}}if(document.activeElement!==text&&document.activeElement!==text2){text.focus()}}else{text.focus()}delete newFilter.elements.wrapper.dataset.showError;newFilter.elements.wrapper.classList.toggle("ie11-dataset-fix");result.success=true}}catch(aB){result.error=aB.message||aB}return result}function l(aA,aB){let index=r.filters.indexOf(aA);if(index!==-1){r.filters.splice(index,1,aB)}else{r.filters.push(aB)}aB.elements=aA.elements;aB.elements.wrapper.__listviewFilter=aB;H(aB.column);t.apply()}function N(){t.reset();t.focus()}function C(aC,aA){aA=aA||{};let filter;try{filter=ab(aC,aA.column)}catch(aB){alert(aB.message||aB);return null}let added=false;let removed=false;for(let i=r.filters.length-1;i>=0;i--){if((aA.column&&r.filters[i].column&&r.filters[i].column.id===aA.column.id)||(!aA.column&&!r.filters[i].column)){if(r.filters[i].elements){WH.de(r.filters[i].elements.wrapper)}if(filter){r.filters.splice(i,1,filter);added=true}else{r.filters.splice(i,1)}removed=true}}if(filter){if(!added){r.filters.push(filter);added=true}am();if(aA.column){WH.ae(r.elements.filters,d(aA.column,filter))}else{if(r.listview.searchable&&r.elements.tableFilter){let simpleFilterText=ac(filter);if(simpleFilterText!==r.elements.tableFilter.value.trim()){r.elements.tableFilter.value=simpleFilterText}}}}if(aA.column){if(added&&!removed){H(aA.column)}else{if(removed&&!added&&!t.isColumnFiltered(aA.column)){ae(aA.column)}}}if((added||removed)&&!aA.skipApply){t.apply()}return filter}function au(aA){if(!aA.enabled){delete aA.test;return}let colType=u(aA.column);if(colType===Listview.COLUMN_TYPE_TEXT&&aA.operator!==B){colType=Listview.COLUMN_TYPE_NUMBER}switch(colType){case Listview.COLUMN_TYPE_TEXT:aA.test=aA.invert?ax.bind(null,aA):K.bind(null,aA);break;case Listview.COLUMN_TYPE_RANGE:let testRange=ap[aA.operator].bind(null,aA.value);aA.test=h.bind(null,aA,testRange);break;case Listview.COLUMN_TYPE_NUMBER:let testNumber=aj[aA.operator].bind(null,aA.value);aA.test=F.bind(null,aA,testNumber);break;default:let message="Unknown column type cannot be filtered.";WH.error(message,colType,aA.column.id);throw new Error(message)}}function D(aB,aA){if(!w.includes(aB)){return}r.matchType=aB;am();r.elements.match[aB].checked=true;if(!aA){t.apply()}}function ag(aB,aC,aA){WH.st(aB,p[aA]);aC.dataset.type=aA===B?"string":"number";if(aA===aa){aC.dataset.useRange="true"}else{delete aC.dataset.useRange}aC.classList.toggle("ie11-dataset-fix")}function am(){if(!r.listview.searchable&&!r.hasFilterableColumns){return}if(!r.elements.container){r.elements.container=L();let after=r.listview.noteTop||r.listview.noteIndicators||r.listview.navTop;r.listview.bandTop.insertBefore(r.elements.container,after.nextSibling)}r.listview.container.dataset.filters="visible";r.listview.container.classList.toggle("ie11-dataset-fix")}function F(aB,aC,aA,aD){let val=parseFloat(aA.getValue?aA.getValue(aD):aD[aA.value]);if(typeof val!=="number"||isNaN(val)){return false}return aB.invert?!aC(val):aC(val)}function h(aC,aA,aB,aD){return aC.invert?!aA({min:aB.getMinValue(aD),max:aB.getMaxValue(aD)},aC.value):aA({min:aB.getMinValue(aD),max:aB.getMaxValue(aD)},aC.value)}function V(aB,aA){let matchCount=0;for(let i=0,filter;filter=r.filters[i];i++){if(!filter.enabled){matchCount++;continue}if(filter.column){if(filter.test(filter.column,aB)){matchCount++}else{break}}else{let tableMatchFound=false;for(let k=0,column;column=aA[k];k++){if(filter.test(column,aB)){tableMatchFound=true;break}}if(tableMatchFound){matchCount++}else{break}}}return matchCount===r.filters.length}function ak(aB,aA){for(let i=0,filter;filter=r.filters[i];i++){if(!filter.enabled){continue}if(filter.column){if(filter.test(filter.column,aB)){return true}}else{for(let k=0,column;column=aA[k];k++){if(filter.test(column,aB)){return true}}}}return false}function K(aC,aB,aD,aA){let result=false;let text=ah(aD,aB);if(text){text=text.toString().toLowerCase();result=true;for(let wordsI=0,wordsLen=aC.words.length;wordsI<wordsLen;wordsI++){if(text.indexOf(aC.words[wordsI])===-1){result=false;break}}}return result}function ax(aC,aB,aD,aA){let result=false;let text=ah(aD,aB);if(text){text=text.toString().toLowerCase();result=text.match(aC.regExp)!=null}return!result}function A(){if(!r.elements.reset){return}let relevantFilterCount=0;for(let i=0,filter;filter=r.filters[i];i++){if(filter.enabled||filter.column){relevantFilterCount++}}switch(relevantFilterCount){case 0:WH.displayNone(r.elements.match.container);WH.displayNone(r.elements.reset);break;case 1:WH.displayNone(r.elements.match.container);WH.displayBlock(r.elements.reset);break;default:WH.displayBlock(r.elements.match.container);WH.displayBlock(r.elements.reset)}}function O(){if(r.listview.searchable&&r.elements.tableFilter){if(r.elements.tableFilter.value.trim()){r.elements.tableFilterIcon.style.display="none";r.elements.tableFilterClear.style.display=""}else{r.elements.tableFilterIcon.style.display="";r.elements.tableFilterClear.style.display="none"}}}ao(I)};Listview.Filters.resetAndFocus=function(){this.Filters.resetAndFocus()};WH.Tools.Bloodmallet=new function(){var f=false;this.loadCharts=function(){if(typeof window.Highcharts!=="object"){WH.error("Can't load Bloodmallet charts because the Highcharts library isn't available.");return}if(typeof window.bloodmallet_charts!=="object"){if(!f){f=true;$.ajax({url:WH.staticUrl+"/js/3rd-party/bloodmallet_chart_import.js?2020-12-29",dataType:"script",success:c,cache:true})}}else{c()}};this.updateChartsSizes=function(g){var h=[];$(g).find(".bloodmallet_chart[data-highcharts-chart]").each(function(){h.push(this.getAttribute("data-highcharts-chart"))});if(h.length>0){WH.Tools.Highcharts.updateSizes(h)}};function c(){$(".bloodmallet_chart").each(function(){if(typeof $(this).attr("data-highcharts-chart")==="undefined"){bloodmallet_chart_import();return false}});setTimeout(d,9);$(window).resize(WH.Tools.Highcharts.updateSizes)}function d(){var h=0;var g=[];$(".bloodmallet_chart").each(function(){var l=this.getAttribute("data-highcharts-chart");if(l!==""){g.push(l)}else{h++}});if(g.length>0){WH.Tools.Highcharts.updateSizes(g)}if(h>0){setTimeout(d,9*h)}}};WH.Tools.Highcharts=new function(){var d=[];var l=false;var g={};var h=50;this.loadScript=function(m){if(m){d.push(m)}if(typeof window.Highcharts!=="object"){if(!l){l=true;$.ajax({url:WH.staticUrl+"/js/3rd-party/highcharts.js",dataType:"script",cache:true,success:f})}}else{f()}};this.updateSizes=function(p){if(typeof Highcharts==="undefined"||!Array.isArray(Highcharts.charts)){return 0}var t=0;if(Array.isArray(p)){for(var q=0,o;o=p[q];q++){if(Highcharts.charts[o]){c(Highcharts.charts[o]);t++}}}else{for(var m=0,r;r=Highcharts.charts[m];m++){c(r);t++}}return t};function f(){while(d.length){(d.pop())()}}function c(m){clearTimeout(g[m.index]);g[m.index]=setTimeout(function(){m.setSize(null,null)},h)}};WH.Wow.Achievement=new function(){const c=this;this.SIDE_BOTH=-1;this.SIDE_HORDE=0;this.SIDE_ALLIANCE=1;this.convertSide=function(d){switch(d){case c.SIDE_BOTH:return WH.Wow.SIDE_BOTH;case c.SIDE_ALLIANCE:return WH.Wow.SIDE_ALLIANCE;case c.SIDE_HORDE:return WH.Wow.SIDE_HORDE}return undefined}};var g_artifact_knowledge_max_level=55;const g_file_races={10:"bloodelf",11:"draenei",3:"dwarf",7:"gnome",1:"human",4:"nightelf",2:"orc",6:"tauren",8:"troll",5:"scourge",9:"goblin",22:"worgen",24:"pandaren",25:"pandaren",26:"pandaren",27:"nightborne",28:"highmountaintauren",29:"voidelf",30:"lightforgeddraenei",31:"zandalaritroll",32:"kultiran",34:"darkirondwarf",36:"magharorc",12:"felorc",13:"naga",14:"broken",15:"skeleton",16:"vrykul",17:"tuskarr",18:"foresttroll",19:"taunka",20:"northrendskeleton",21:"icetroll",23:"gilnean",33:"thinhuman",35:"vulpera",37:"mechagnome"};var g_file_classes={6:"deathknight",12:"demonhunter",11:"druid",3:"hunter",8:"mage",10:"monk",2:"paladin",5:"priest",4:"rogue",7:"shaman",9:"warlock",1:"warrior"};const g_file_genders={0:"male",1:"female"};var g_file_factions={1:"alliance",2:"horde"};var g_file_racefactions={10:2,11:1,3:1,7:1,1:1,4:1,2:2,6:2,8:2,5:2,9:2,22:1,24:3,25:1,26:2,27:2,28:2,29:1,30:1,31:2,32:1,34:1,35:2,36:2,37:1};var g_npc_races=[12,13,14,15,16,17,18,19,20,21,23,33];var g_race_genders={12:0,14:0,15:0,16:0,17:0,18:0,19:0,20:0,21:0,33:0};var g_file_race_upright={2:{0:"uprightorc"},36:{0:"uprightmagharorc"}};var g_class_forums={6:18,12:29,11:3,3:4,8:6,10:28,2:7,5:8,4:5,7:9,9:10,1:11};var g_file_gems={1:"meta",2:"red",4:"yellow",6:"orange",8:"blue",10:"purple",12:"green",14:"prismatic",16:"hydraulic",32:"cogwheel"};var g_chr_specs_by_class={12:["577","581"],6:["250","251","252"],11:["102","103","104","105"],3:["253","254","255"],8:["62","63","64"],10:["268","270","269"],2:["65","66","70"],5:["256","257","258"],4:["259","260","261"],7:["262","263","264"],9:["265","266","267"],1:["71","72","73"]};if(WH.isClassicTree()||WH.isBurningCrusadeTree()){g_chr_specs_by_class={11:["283","281","282"],3:["361","363","362"],8:["81","41","61"],2:["382","383","381"],5:["201","202","203"],4:["182","181","183"],7:["261","263","262"],9:["302","303","301"],1:["161","164","163"]}}var g_battlepet_types={1:"humanoid",2:"dragonkin",3:"flying",4:"undead",5:"critter",6:"magic",7:"elemental",8:"beast",9:"aquatic",10:"mechanical"};var g_battlepet_passives={1:238,2:245,3:239,4:242,5:236,6:243,7:241,8:237,9:240,10:244};var g_skill_recipe_subclass={171:6,164:4,185:5,333:8,202:3,356:9,773:11,755:10,165:1,186:12,197:2};if(WH.isClassicTree()){g_skill_recipe_subclass[129]=7;delete g_skill_recipe_subclass[773];delete g_skill_recipe_subclass[755]}if(WH.isBurningCrusadeTree()){g_skill_recipe_subclass[129]=7;delete g_skill_recipe_subclass[773]}var g_skill_recipe_subclass_url={171:"alchemy",164:"blacksmithing",185:"cooking",333:"enchanting",202:"engineering",356:"fishing",773:"inscription",755:"jewelcrafting",165:"leatherworking",186:"mining",197:"tailoring"};if(WH.isClassicTree()){g_skill_recipe_subclass_url[129]="first-aid";delete g_skill_recipe_subclass_url[773];delete g_skill_recipe_subclass_url[755]}if(WH.isBurningCrusadeTree()){g_skill_recipe_subclass_url[129]="first-aid";delete g_skill_recipe_subclass_url[773]}var g_world_bosses={71953:true,62346:true,60491:true,72057:true,69099:true,69161:true,71952:true,71954:true,71955:true};var g_grayedOutStats={3:[250,251,252,102,105,62,63,64,270,65,66,70,256,257,258,262,264,265,266,267,71,72,73],4:[102,103,104,105,253,254,255,62,63,64,268,270,269,65,256,257,258,259,260,261,262,263,264,265,266,267],5:[71,72,73,259,260,261,253,254,255,103,104,250,251,252,66,70,263,268,269],6:[250,251,252,102,103,104,253,254,255,62,63,64,268,269,66,70,258,259,260,261,262,263,265,266,267,71,72,73],50:[251,252,102,103,105,253,254,255,62,63,64,270,269,65,70,256,257,258,259,260,261,262,263,264,265,266,267,71,72]};if(WH.isClassicTree()||WH.isBurningCrusadeTree()){g_grayedOutStats={}}var g_specPrimaryStatOrders={62:[5,3,4],63:[5,3,4],64:[5,3,4],65:[5,4,3],66:[4,3,5],70:[4,3,5],71:[4,3,5],72:[4,3,5],73:[4,3,5],102:[5,3,4],103:[3,4,5],104:[3,4,5],105:[5,3,4],250:[4,3,5],251:[4,3,5],252:[4,3,5],253:[3,5,4],254:[3,5,4],255:[3,5,4],256:[5,3,4],257:[5,3,4],258:[5,3,4],259:[3,4,5],260:[3,4,5],261:[3,4,5],262:[5,3,4],263:[3,5,4],264:[5,3,4],265:[5,3,4],266:[5,3,4],267:[5,3,4],268:[3,5,4],269:[3,5,4],270:[5,3,4]};var g_spec_to_role={62:2,63:2,64:2,65:1,66:0,70:2,71:2,72:2,73:0,74:2,79:2,81:0,102:2,103:2,104:0,105:1,250:0,251:2,252:2,253:2,254:2,255:2,256:1,257:1,258:2,259:2,260:2,261:2,262:2,263:2,264:1,265:2,266:2,267:2,268:0,269:2,270:1,535:2,536:2,537:0,577:2,581:0};var g_item_slots_to_character_slots={1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,11:[11,12],12:[13,14],13:[16,17],14:17,15:16,16:15,17:16,18:null,19:19,20:5,21:16,22:17,23:17,24:null,25:null,26:16,27:null,28:null};var g_character_slots_data=[{id:1,name:"head",itemSlots:[1]},{id:2,name:"neck",itemSlots:[2],noModel:1},{id:3,name:"shoulder",itemSlots:[3]},{id:15,name:"back",itemSlots:[16],iconName:"chest"},{id:5,name:"chest",itemSlots:[5,20]},{id:4,name:"shirt",itemSlots:[4]},{id:19,name:"tabard",itemSlots:[19]},{id:9,name:"wrists",itemSlots:[9]},{id:10,name:"hands",itemSlots:[10]},{id:6,name:"waist",itemSlots:[6]},{id:7,name:"legs",itemSlots:[7]},{id:8,name:"feet",itemSlots:[8]},{id:11,name:"finger",itemSlots:[11],noModel:1,simCraftName:"finger1"},{id:12,name:"finger",itemSlots:[11],noModel:1,simCraftName:"finger2"},{id:13,name:"trinket",itemSlots:[12],noModel:1,simCraftName:"trinket1"},{id:14,name:"trinket",itemSlots:[12],noModel:1,simCraftName:"trinket2"},{id:16,name:"mainhand",itemSlots:[21,13,17,15,25,26],simCraftName:"main_hand"},{id:17,name:"offhand",itemSlots:[22,13,17,23,14],simCraftName:"off_hand"}];var g_classes_allowed_armor={6:[1,2,3,4,5],12:[1,2,5],11:[1,2,5],3:[1,2,3,5],8:[1,5],10:[1,2,5],2:[1,2,3,4,5,6],5:[1,5],4:[1,2,5],7:[1,2,3,5,6],9:[1,5],1:[1,2,3,4,5,6]};var g_classes_allowed_weapon={6:[0,1,4,5,6,7,8,20],12:[0,7,9,13,15,20],11:[4,5,6,10,13,15,20],3:[2,3,6,10,18,20],8:[7,10,15,19,20],10:[0,4,6,7,10,13,20],2:[0,1,4,5,6,7,8,20],5:[4,10,15,19,20],4:[0,2,3,4,7,13,15,18,20],7:[0,1,4,5,6,10,13,15,20],9:[7,10,15,19,20],1:[0,1,2,3,4,5,6,7,8,10,13,15,18,20]};if(WH.isClassicTree()||WH.isBurningCrusadeTree()){g_character_slots_data[g_character_slots_data.length-2].itemSlots=[21,13,17];g_character_slots_data[g_character_slots_data.length-1].itemSlots=[22,13,23,14];g_character_slots_data.push({id:18,name:"ranged",itemSlots:[15,25,26,28]});g_item_slots_to_character_slots[15]=18;g_item_slots_to_character_slots[25]=18;g_item_slots_to_character_slots[26]=18;g_item_slots_to_character_slots[28]=18;g_classes_allowed_armor[2].push(7);g_classes_allowed_armor[7].push(9);g_classes_allowed_armor[11].push(8);g_classes_allowed_weapon={11:[4,5,10,13,15,20],3:[0,1,2,3,6,7,8,10,13,15,16,18,20],8:[7,10,15,19,20],2:[0,1,4,5,6,7,8,20],5:[4,10,15,19,20],4:[2,3,4,7,13,15,16,18,20],7:[0,1,4,5,10,13,15,20],9:[7,10,15,19,20],1:[0,1,2,3,4,5,6,7,8,10,13,15,16,18,20]}}WH.getClassesAlphabetized=function(){var c=[];for(var f=1,d;d=g_chr_classes[f];f++){c.push({id:f,name:d})}c.sort(function(h,g){return WH.stringCompare(h.name,g.name)});return c};WH.getRaceSideSortString=function(d){var c=parseInt(d.side||g_file_racefactions[d.id]);if(c===1){return"alliance"}else{if(c===2){return"horde"}else{if(c===3){return"both"}}}return"npc"};WH.getSpecIndexFromSpecId=function(c){c=c.toString();for(var d in g_chr_specs_by_class){if(g_chr_specs_by_class.hasOwnProperty(d)&&g_chr_specs_by_class[d].indexOf(c)>-1){return g_chr_specs_by_class[d].indexOf(c)+1}}return null};WH.Wow.Covenant=new function(){this.KYRIAN=1;this.NECROLORD=4;this.NIGHT_FAE=3;this.VENTHYR=2;const c={};c[this.KYRIAN]="https://render-us.worldofwarcraft.com/profile-backgrounds/v2/armory_bg_covenant_kyrian.jpg";c[this.NECROLORD]="https://render-us.worldofwarcraft.com/profile-backgrounds/v2/armory_bg_covenant_necrolord.jpg";c[this.NIGHT_FAE]="https://render-us.worldofwarcraft.com/profile-backgrounds/v2/armory_bg_covenant_night_fae.jpg";c[this.VENTHYR]="https://render-us.worldofwarcraft.com/profile-backgrounds/v2/armory_bg_covenant_venthyr.jpg";const d={};d[this.KYRIAN]="ui_sigil_kyrian";d[this.NECROLORD]="ui_sigil_necrolord";d[this.NIGHT_FAE]="ui_sigil_nightfae";d[this.VENTHYR]="ui_sigil_venthyr";this.getArmoryBackgroundImageUrl=function(f){return c[f]};this.getIcon=function(f){return d[f]}};WH.Wow.Currency=new function(){this.ID_CONQUEST=390;this.ID_HONOR=392;this.ID_JUSTICE=395;this.ID_VALOR=396};var g_achievements={};var g_affixes={};var g_azeriteEssences={};var g_azeriteEssencePowers={};var g_bfa_champions={};var g_buildings={};var g_champions={};var g_classes={};var g_factions={};var g_followers={};var g_gatheredcurrencies={};var g_gatheredzones={};var g_gearsets={};var g_guides={};var g_holidays={};var g_icons={};var g_items={};var g_itemsets={};var g_mission_abilities={};var g_missions={};var g_npcs={};var g_objects={};var g_orderadvancements={};var g_outfits={};var g_petabilities={};var g_pets={};var g_quests={};var g_races={};var g_resources={};var g_ships={};var g_skills={};var g_sounds={};var g_spells={};var g_storylines={};var g_threats={};var g_titles={};var g_transmogsets={};var g_bluetweets={};var g_charts={};var g_types={1:"npc",2:"object",3:"item",4:"item-set",5:"quest",6:"spell",7:"zone",8:"faction",9:"pet",10:"achievement",11:"title",12:"event",13:"class",14:"race",15:"skill",17:"currency",19:"sound",20:"building",21:"follower",22:"mission-ability",23:"mission",25:"ship",26:"threat",27:"resource",28:"champion",29:"icon",30:"order-advancement",31:"follower_a",32:"follower_h",33:"ship_a",34:"ship_h",35:"champion_a",36:"champion_h",37:"item",38:"bfa-champion",39:"bfa-champion_a",40:"affix",41:"bfa-champion_h",42:"azerite-essence-power",43:"azerite-essence",44:"storyline",46:"adventure-combatant-ability",47:"encounter",100:"guide",101:"transmog-set",110:"outfit",111:"gear-set",150:"gallery",200:"pet-ability"};window.g_gathered_types={};g_gathered_types[WH.Types.ACHIEVEMENT]=g_achievements;g_gathered_types[WH.Types.ADVENTURE_COMBATANT_ABILITY]={};g_gathered_types[WH.Types.AFFIX]=g_affixes;g_gathered_types[WH.Types.AZERITE_ESSENCE]=g_azeriteEssences;g_gathered_types[WH.Types.AZERITE_ESSENCE_POWER]=g_azeriteEssencePowers;g_gathered_types[WH.Types.BFA_CHAMPION]=g_bfa_champions;g_gathered_types[WH.Types.BFA_CHAMPION_A]=g_bfa_champions;g_gathered_types[WH.Types.BFA_CHAMPION_H]=g_bfa_champions;g_gathered_types[WH.Types.BUILDING]=g_buildings;g_gathered_types[WH.Types.CHAMPION]=g_champions;g_gathered_types[WH.Types.CHAMPION_A]=g_champions;g_gathered_types[WH.Types.CHAMPION_H]=g_champions;g_gathered_types[WH.Types.CLASS]=g_classes;g_gathered_types[WH.Types.COVENANT]={};g_gathered_types[WH.Types.CURRENCY]=g_gatheredcurrencies;g_gathered_types[WH.Types.ENCOUNTER]={};g_gathered_types[WH.Types.EVENT]=g_holidays;g_gathered_types[WH.Types.FACTION]=g_factions;g_gathered_types[WH.Types.FOLLOWER]=g_followers;g_gathered_types[WH.Types.FOLLOWER_A]=g_followers;g_gathered_types[WH.Types.FOLLOWER_H]=g_followers;g_gathered_types[WH.Types.ICON]=g_icons;g_gathered_types[WH.Types.ITEM]=g_items;g_gathered_types[WH.Types.ITEM_SET]=g_itemsets;g_gathered_types[WH.Types.MISSION]=g_missions;g_gathered_types[WH.Types.MISSION_ABILITY]=g_mission_abilities;g_gathered_types[WH.Types.NPC]=g_npcs;g_gathered_types[WH.Types.OBJECT]=g_objects;g_gathered_types[WH.Types.ORDER_ADVANCEMENT]=g_orderadvancements;g_gathered_types[WH.Types.PET]=g_pets;g_gathered_types[WH.Types.PET_ABILITY]=g_petabilities;g_gathered_types[WH.Types.QUEST]=g_quests;g_gathered_types[WH.Types.RACE]=g_races;g_gathered_types[WH.Types.RESOURCE]=g_resources;g_gathered_types[WH.Types.SHIP]=g_ships;g_gathered_types[WH.Types.SHIP_A]=g_ships;g_gathered_types[WH.Types.SHIP_H]=g_ships;g_gathered_types[WH.Types.SKILL]=g_skills;g_gathered_types[WH.Types.SOULBIND]={};g_gathered_types[WH.Types.SOUND]=g_sounds;g_gathered_types[WH.Types.SPELL]=g_spells;g_gathered_types[WH.Types.STORYLINE]=g_storylines;g_gathered_types[WH.Types.THREAT]=g_threats;g_gathered_types[WH.Types.TITLE]=g_titles;g_gathered_types[WH.Types.ZONE]=g_gatheredzones;g_gathered_types[WH.Types.GEAR_SET]=g_gearsets;g_gathered_types[WH.Types.GUIDE]=g_guides;g_gathered_types[WH.Types.OUTFIT]=g_outfits;g_gathered_types[WH.Types.TRANSMOG_SET]=g_transmogsets;g_gathered_types[WH.Types.GUIDE_IMAGE]={};g_gathered_types[WH.Types.LISTVIEW]={};g_gathered_types[WH.Types.SCREENSHOT]={};g_gathered_types[WH.Types.SURVEY_COVENANTS]={};var g_completion_categories={1:[12],3:[2,4,9,"15-2","15-5"],6:[-5,-6,9,11]};WH.cO(g_items,{add:function(f,c){var d={};d[f]=c;WH.Gatherer.addData(WH.Types.ITEM,WH.getDataEnv(),d)},getIcon:function(m,f,l,h){var d=WH.Gatherer.get(WH.Types.ITEM,m,h);var g=Icon.questionMarkIcon;if(d!=null&&d.icon){g=d.icon}var c=g_items.getAppearance(m,f,l,h);if(c!=null&&c[1]){g=c[1]}return g},getAppearance:function(c,d,l,f){var h=null;var g=WH.Gatherer.get(WH.Types.ITEM,c,f);var q=-1;var m=(g&&g.appearances)?g.appearances:(g&&g.jsonequip&&g.jsonequip.appearances?g.jsonequip.appearances:null);if(l&&m&&m[l]){h=m[l]}else{if(WH.isSet("g_itembonuses")&&d&&d.length>0){for(var p in d){var o=d[p];if(o>0&&g_itembonuses[o]){WH.arrayWalk(g_itembonuses[o],function(r){if(r[0]==7){q=r[1]}})}if(q!=-1&&m&&m[q]){h=m[q];break}}}}return h},createIcon:function(l,f,d,h,g){var c={};if(g&&g.length>0){c.bonus=g.join(":")}return Icon.create(g_items.getIcon(l,g),f,null,WH.Entity.getPath(WH.Types.ITEM,l,null,c),d,h)}});WH.cO(g_spells,{WH_IDS:1000000,add:function(d,c){if(g_spells[d]!=null){WH.cO(g_spells[d],c)}else{g_spells[d]=c}},getIcon:function(c){if(g_spells[c]!=null&&g_spells[c].icon){return g_spells[c].icon}else{return Icon.questionMarkIcon}},createIcon:function(g,d,c,f){return Icon.create(g_spells.getIcon(g),d,null,WH.Entity.getPath(WH.Types.SPELL,g),c,f)}});WH.cO(g_petabilities,{add:function(d,c){if(g_petabilities[d]!=null){WH.cO(g_petabilities[d],c)}else{g_petabilities[d]=c}},getIcon:function(c){if(g_petabilities[c]!=null&&g_petabilities[c].icon){return g_petabilities[c].icon}else{return Icon.questionMarkIcon}},createIcon:function(g,d,c,f){return Icon.create(g_petabilities.getIcon(g),d,null,WH.Entity.getPath(WH.Types.PET_ABILITY,g),c,f)}});WH.cO(g_achievements,{getIcon:function(c){if(g_achievements[c]!=null&&g_achievements[c].icon){return g_achievements[c].icon}else{return Icon.questionMarkIcon}},createIcon:function(g,d,c,f){return Icon.create(g_achievements.getIcon(g),d,null,WH.Entity.getPath(WH.Types.ACHIEVEMENT,g),c,f)}});WH.cO(g_classes,{getIcon:function(c){if(g_file_classes[c]){return"class_"+g_file_classes[c]}else{return Icon.questionMarkIcon}},createIcon:function(g,d,c,f){return Icon.create(g_classes.getIcon(g),d,null,WH.Entity.getPath(WH.Types.CLASS,g),c,f)}});WH.cO(g_races,{getIcon:function(d,c){if(c===undefined){c=0}if(g_file_races[d]&&g_file_genders[c]){return"race_"+g_file_races[d]+"_"+g_file_genders[c]}else{return Icon.questionMarkIcon}},createIcon:function(g,d,c,f){return Icon.create(g_races.getIcon(g),d,null,WH.Entity.getPath(WH.Types.RACE,g),c,f)}});WH.cO(g_skills,{getIcon:function(c){if(g_skills[c]!=null&&g_skills[c].icon){return g_skills[c].icon}else{return Icon.questionMarkIcon}},createIcon:function(g,d,c,f){return Icon.create(g_skills.getIcon(g),d,null,WH.Entity.getPath(WH.Types.SKILL,g),c,f)}});WH.cO(g_gatheredcurrencies,{getIcon:function(c){if(g_gatheredcurrencies[c]!=null&&g_gatheredcurrencies[c].icon){return g_gatheredcurrencies[c].icon}return WH.Icon.UNKNOWN},createIcon:function(g,d,c,f){return Icon.create(g_gatheredcurrencies.getIcon(g),d,null,WH.Entity.getPath(WH.Types.CURRENCY,g),Math.abs(c),f)}});WH.cO(g_holidays,{getIcon:function(c){if(g_holidays[c]!=null&&g_holidays[c].icon){return g_holidays[c].icon}else{return Icon.questionMarkIcon}},createIcon:function(g,d,c,f){return Icon.create(g_holidays.getIcon(g),d,null,WH.Entity.getPath(WH.Types.EVENT,g),c,f)}});WH.cO(g_mission_abilities,{getIcon:function(c){if(g_mission_abilities[c]!=null&&g_mission_abilities[c].icon){return g_mission_abilities[c].icon}else{return Icon.questionMarkIcon}},createIcon:function(h,f,c,g){var d=Icon.create(g_mission_abilities.getIcon(h),f,null,WH.Entity.getPath(WH.Types.MISSION_ABILITY,h),c,g);d.className+=" garrison-ability";return d}});WH.Wow.Difficulty=new function(){const p=this;this.ID_NONE=0;this.ID_DUNGEON_NORMAL=1;this.ID_DUNGEON_HEROIC=2;this.ID_LEGACY_10_PLAYER=3;this.ID_LEGACY_25_PLAYER=4;this.ID_LEGACY_10_PLAYER_HEROIC=5;this.ID_LEGACY_25_PLAYER_HEROIC=6;this.ID_LEGACY_RAID_FINDER=7;this.ID_DUNGEON_CHALLENGE=8;this.ID_RAID_40_PLAYER=9;this.ID_SCENARIO=11;this.ID_SCENARIO_HEROIC=12;this.ID_RAID_NORMAL=14;this.ID_RAID_HEROIC=15;this.ID_RAID_MYTHIC=16;this.ID_RAID_FINDER=17;this.ID_RAID_EVENT=18;this.ID_DUNGEON_EVENT=19;this.ID_SCENARIO_EVENT=20;this.ID_DUNGEON_MYTHIC=23;this.ID_DUNGEON_TIMEWALKING=24;this.ID_CLASSIC_RAID_20_PLAYER=148;this.GROUP_NONE=1;this.GROUP_DUNGEON=2;this.GROUP_LEGACY_RAID=3;this.GROUP_RAID=4;this.GROUPS={};this.GROUPS[this.GROUP_RAID]=[this.ID_RAID_NORMAL,this.ID_RAID_HEROIC,this.ID_RAID_MYTHIC,this.ID_RAID_FINDER];this.GROUPS[this.GROUP_LEGACY_RAID]=[this.ID_LEGACY_10_PLAYER,this.ID_LEGACY_25_PLAYER,this.ID_LEGACY_10_PLAYER_HEROIC,this.ID_LEGACY_25_PLAYER_HEROIC,this.ID_LEGACY_RAID_FINDER,this.ID_RAID_40_PLAYER,this.ID_CLASSIC_RAID_20_PLAYER,this.ID_RAID_NORMAL];this.GROUPS[this.GROUP_DUNGEON]=[this.ID_DUNGEON_NORMAL,this.ID_DUNGEON_HEROIC,this.ID_DUNGEON_MYTHIC,this.ID_DUNGEON_TIMEWALKING];this.GROUPS[this.GROUP_NONE]=[this.ID_NONE];this.SORT_ORDER=[this.ID_NONE,this.ID_DUNGEON_NORMAL,this.ID_DUNGEON_HEROIC,this.ID_DUNGEON_MYTHIC,this.ID_DUNGEON_CHALLENGE,this.ID_DUNGEON_EVENT,this.ID_DUNGEON_TIMEWALKING,this.ID_LEGACY_RAID_FINDER,this.ID_LEGACY_10_PLAYER,this.ID_LEGACY_10_PLAYER_HEROIC,this.ID_LEGACY_25_PLAYER,this.ID_LEGACY_25_PLAYER_HEROIC,this.ID_CLASSIC_RAID_20_PLAYER,this.ID_RAID_40_PLAYER,this.ID_RAID_FINDER,this.ID_RAID_NORMAL,this.ID_RAID_HEROIC,this.ID_RAID_MYTHIC,this.ID_RAID_EVENT,this.ID_SCENARIO,this.ID_SCENARIO_HEROIC,this.ID_SCENARIO_EVENT];const o=-2;const h=-1;const l=1;const d=2;const m=3;const g=4;const c=5;const f={};f[h]=this.ID_DUNGEON_NORMAL;f[o]=this.ID_DUNGEON_HEROIC;f[c]=this.ID_LEGACY_RAID_FINDER;f[l]=this.ID_LEGACY_10_PLAYER;f[d]=this.ID_LEGACY_25_PLAYER;f[m]=this.ID_LEGACY_10_PLAYER_HEROIC;f[g]=this.ID_LEGACY_25_PLAYER_HEROIC;this.comparator=function(t,q){var u=p.SORT_ORDER.indexOf(parseInt(t));var r=p.SORT_ORDER.indexOf(parseInt(q));if(u<0){if(r<0){return 0}return 1}if(r<0){return-1}return Math.sign(u-r)};this.convertLegacyDropDifficulty=function(q){return f[q]||q};this.getIds=function(){var q=[];for(var r in this){if(!this.hasOwnProperty(r)||(typeof this[r]!="number")){continue}if(r.substr(0,3)==="ID_"){q.push(this[r])}}return q};this.getIconClass=function(q){let iconClass=undefined;switch(q){case this.ID_DUNGEON_HEROIC:case this.ID_LEGACY_10_PLAYER_HEROIC:case this.ID_LEGACY_25_PLAYER_HEROIC:case this.ID_RAID_HEROIC:iconClass="icon-heroic";break;case this.ID_DUNGEON_MYTHIC:case this.ID_RAID_MYTHIC:iconClass="icon-mythic";break}return iconClass};this.getName=function(q){var r="";switch(q){case this.ID_NONE:case this.ID_DUNGEON_NORMAL:case this.ID_RAID_NORMAL:r=WH.TERMS.normal;break;case this.ID_DUNGEON_HEROIC:case this.ID_RAID_HEROIC:r=WH.TERMS.heroic;break;case this.ID_DUNGEON_MYTHIC:case this.ID_RAID_MYTHIC:r=WH.TERMS.mythic;break;case this.ID_DUNGEON_TIMEWALKING:r=WH.TERMS.timewalking;break;case this.ID_RAID_FINDER:case this.ID_LEGACY_RAID_FINDER:r=WH.TERMS.raidfinder;break;case this.ID_LEGACY_10_PLAYER:r=WH.sprintf(WH.TERMS.normal_format,10);break;case this.ID_LEGACY_25_PLAYER:r=WH.sprintf(WH.TERMS.normal_format,25);break;case this.ID_LEGACY_10_PLAYER_HEROIC:r=WH.sprintf(WH.TERMS.heroic_format,10);break;case this.ID_LEGACY_25_PLAYER_HEROIC:r=WH.sprintf(WH.TERMS.heroic_format,25);break;case this.ID_RAID_40_PLAYER:r=WH.GlobalStrings.RAID_DIFFICULTY_40PLAYER;break;case this.ID_CLASSIC_RAID_20_PLAYER:r=WH.GlobalStrings.RAID_DIFFICULTY_20PLAYER;break}return r||("["+q+"]")};this.getNameAbbrev=function(q){var r="";switch(q){case this.ID_NONE:case this.ID_DUNGEON_NORMAL:case this.ID_RAID_NORMAL:r=WH.TERMS.normal_abbrev;break;case this.ID_DUNGEON_HEROIC:case this.ID_RAID_HEROIC:r=WH.TERMS.heroic_abbrev;break;case this.ID_DUNGEON_MYTHIC:case this.ID_RAID_MYTHIC:r=WH.TERMS.mythic_abbrev;break;case this.ID_DUNGEON_TIMEWALKING:r=WH.TERMS.timewalking_abbrev;break;case this.ID_RAID_FINDER:case this.ID_LEGACY_RAID_FINDER:r=WH.TERMS.lookingforraid_abbrev;break;case this.ID_LEGACY_10_PLAYER:r="10"+WH.TERMS.normal_abbrev;break;case this.ID_LEGACY_25_PLAYER:r="25"+WH.TERMS.normal_abbrev;break;case this.ID_LEGACY_10_PLAYER_HEROIC:r="10"+WH.TERMS.heroic_abbrev;break;case this.ID_LEGACY_25_PLAYER_HEROIC:r="25"+WH.TERMS.heroic_abbrev;break;case this.ID_RAID_40_PLAYER:r="40";break;case this.ID_CLASSIC_RAID_20_PLAYER:r="20";break}return r||("["+q+"]")};this.getNameShorthand=function(q){let name="";switch(q){case this.ID_NONE:case this.ID_DUNGEON_NORMAL:case this.ID_RAID_NORMAL:case this.ID_LEGACY_10_PLAYER:case this.ID_LEGACY_25_PLAYER:name=WH.TERMS.normal;break;case this.ID_DUNGEON_HEROIC:case this.ID_RAID_HEROIC:case this.ID_LEGACY_10_PLAYER_HEROIC:case this.ID_LEGACY_25_PLAYER_HEROIC:name=WH.TERMS.heroic;break;case this.ID_DUNGEON_MYTHIC:case this.ID_RAID_MYTHIC:name=WH.TERMS.mythic;break;case this.ID_DUNGEON_TIMEWALKING:name=WH.TERMS.timewalking;break;case this.ID_RAID_FINDER:case this.ID_LEGACY_RAID_FINDER:name=WH.TERMS.lookingforraid_abbrev;break;case this.ID_RAID_40_PLAYER:name=WH.GlobalStrings.RAID_DIFFICULTY_40PLAYER;break;case this.ID_CLASSIC_RAID_20_PLAYER:name=WH.GlobalStrings.RAID_DIFFICULTY_20PLAYER;break}return name||("["+q+"]")}};WH.Wow.Event=new function(){this.getNextEvent=function(d,c){c=c||new Date();for(let i in d){let occurrence=d[i];if(new Date(occurrence.end)>=c){return occurrence}}return null}};WH.Wow.Expansion=new function(){const g=this;this.CLASSIC=0;this.TBC=1;this.WOTLK=2;this.CATA=3;this.MOP=4;this.WOD=5;this.LEGION=6;this.BFA=7;this.SL=8;this.LEVEL_CAP_RETAIL_CLASSIC=30;this.LEVEL_CAP_RETAIL_TBC=30;this.LEVEL_CAP_RETAIL_WOTLK=30;this.LEVEL_CAP_RETAIL_CATA=35;this.LEVEL_CAP_RETAIL_MOP=35;this.LEVEL_CAP_RETAIL_WOD=40;this.LEVEL_CAP_RETAIL_LEGION=45;this.LEVEL_CAP_RETAIL_BFA=50;this.LEVEL_CAP_RETAIL_SL=60;this.LEVEL_START_RETAIL_CATA=30;this.LEVEL_START_RETAIL_EXPANSION=10;const c={};c[this.CLASSIC]="";c[this.TBC]="tbc";c[this.WOTLK]="wotlk";c[this.CATA]="cata";c[this.MOP]="mop";c[this.WOD]="wod";c[this.LEGION]="legion";c[this.BFA]="bfa";c[this.SL]="sl";var f={0:[WH.TERMS.classic],1:[WH.TERMS.theburningcrusade_short,WH.TERMS.burningcrusade_abbrev],2:[WH.TERMS.wrathofthelichking_short,WH.TERMS.wrathofthelichking_abbrev],3:[WH.TERMS.cataclysm_short,WH.TERMS.cataclysm_abbrev],4:[WH.TERMS.mistsofpandaria_short,WH.TERMS.mistsofpandaria_abbrev],5:[WH.TERMS.warlordsofdraenor_short,WH.TERMS.warlordsofdraenor_abbrev],6:[WH.TERMS.legion_abbrev],7:[WH.TERMS.battleforazeroth_short,WH.TERMS.battleforazeroth_abbrev]};const l={};l[this.CLASSIC]="classic";l[this.TBC]="theburningcrusade";l[this.WOTLK]="wrathofthelichking";l[this.CATA]="cataclysm";l[this.MOP]="mistsofpandaria";l[this.WOD]="warlordsofdraenor";l[this.LEGION]="legion_expansion";l[this.BFA]="battleforazeroth";l[this.SL]="shadowlands_expansion";const d={};d[this.CLASSIC]="classic_abbrev";d[this.TBC]="theburningcrusade_short";d[this.WOTLK]="wrathofthelichking_abbrev";d[this.CATA]="cataclysm_abbrev";d[this.MOP]="mistsofpandaria_abbrev";d[this.WOD]="warlordsofdraenor_abbrev";d[this.LEGION]="legion_abbrev";d[this.BFA]="battleforazeroth_abbrev";d[this.SL]="shadowlands_abbrev";const m={};m[this.CLASSIC]="classic";m[this.TBC]="theburningcrusade_short";m[this.WOTLK]="wrathofthelichking_short";m[this.CATA]="cataclysm_short";m[this.MOP]="mistsofpandaria_short";m[this.WOD]="warlordsofdraenor_short";m[this.LEGION]="legion_expansion";m[this.BFA]="battleforazeroth_short";m[this.SL]="shadowlands_short";this.available=function(o,p){return g.get(p)>=o};this.get=function(o){o=o||WH.getDataEnv();let expansion=h(WH.Wow.getVersionString(o));if(expansion===undefined){let message="Could not get expansion for data env. ["+o+"]";WH.error(message);throw message}return expansion};this.getAbbreviation=function(o){return WH.TERMS[d[o]]||WH.TERMS.unknown};this.getIconClass=function(o){if(!c[o]){return null}return"icon-"+c[o]};this.getName=function(o){return WH.TERMS[l[o]]||WH.TERMS.unknown};this.getRightIconClass=function(o){let expansionClass=g.getIconClass(o);return expansionClass?expansionClass+"-right":null};this.getSearchText=function(p){var q=f[p]||[];for(var o=1;o<q.length;o++){if(q[o-1]===q[o]){q.splice(o--,1)}}return q};this.getShortName=function(o){return WH.TERMS[m[o]]||WH.TERMS.unknown};function h(o){let majorVersion=parseInt(o.substr(0,o.indexOf(".")));if(isNaN(majorVersion)){return undefined}return majorVersion-1}};WH.Wow.Faction=new function(){this.getCategoryName=function(c){return g_faction_categories[c]}};WH.Wow.Follower=new function(){this.FOLLOWER_TYPE_FOLLOWER=1;this.FOLLOWER_TYPE_SHIP=2;this.FOLLOWER_TYPE_LEGION_CHAMPION=4;this.FOLLOWER_TYPE_BFA_CHAMPION=22;this.FOLLOWER_TYPE_ADVENTURE_COMBATANT=123};WH.Wow.Item=new function(){const q=this;const h=WH.Wow.Difficulty;const g=WH.Wow;this.BONUS_MANA=0;this.BONUS_HEALTH=1;this.BONUS_AGILITY=3;this.BONUS_STRENGTH=4;this.BONUS_INTELLECT=5;this.BONUS_SPIRIT=6;this.BONUS_STAMINA=7;this.BONUS_WEAPON_SKILL_RATING=11;this.BONUS_DEFENSE_SKILL_RATING=12;this.BONUS_DODGE_RATING=13;this.BONUS_PARRY_RATING=14;this.BONUS_BLOCK_RATING=15;this.BONUS_HIT_MELEE_RATING=16;this.BONUS_HIT_RANGED_RATING=17;this.BONUS_HIT_SPELL_RATING=18;this.BONUS_CRIT_MELEE_RATING=19;this.BONUS_CRIT_RANGED_RATING=20;this.BONUS_CRIT_SPELL_RATING=21;this.BONUS_CRAFTING_STAT_1=24;this.BONUS_CRAFTING_STAT_2=25;this.BONUS_HIT_RATING=31;this.BONUS_CRIT_RATING=32;this.BONUS_HASTE_RATING=36;this.BONUS_ATTACK_POWER=38;this.BONUS_RANGED_ATTACK_POWER=39;this.BONUS_VERSATILITY_RATING=40;this.BONUS_SPELL_HEALING_DONE=41;this.BONUS_SPELL_DAMAGE_DONE=42;this.BONUS_MANA_REGENERATION=43;this.BONUS_SPELL_POWER=45;this.BONUS_HEALTH_REGENERATION=46;this.BONUS_SPELL_PENETRATION=47;this.BONUS_BLOCK_VALUE=48;this.BONUS_MASTERY_RATING=49;this.BONUS_ARMOR=50;this.BONUS_FIRE_RESISTANCE=51;this.BONUS_FROST_RESISTANCE=52;this.BONUS_HOLY_RESISTANCE=53;this.BONUS_SHADOW_RESISTANCE=54;this.BONUS_NATURE_RESISTANCE=55;this.BONUS_ARCANE_RESISTANCE=56;this.BONUS_SPEED_RATING=61;this.BONUS_LEECH_RATING=62;this.BONUS_AVOIDANCE_RATING=63;this.BONUS_AGI_STR_INT=71;this.BONUS_AGI_STR=72;this.BONUS_AGI_INT=73;this.BONUS_STR_INT=74;this.CLASS_WEAPON=2;this.CLASS_ARMOR=4;this.CLASS_QUEST=12;this.CRAFTING_STAT_FROM=[this.BONUS_CRAFTING_STAT_1,this.BONUS_CRAFTING_STAT_2];this.CRAFTING_STAT_TO=[this.BONUS_CRIT_RATING,this.BONUS_HASTE_RATING,this.BONUS_VERSATILITY_RATING,this.BONUS_MASTERY_RATING,this.BONUS_SPEED_RATING,this.BONUS_LEECH_RATING,this.BONUS_AVOIDANCE_RATING];this.ARMOR_SUBCLASS_MISC=0;this.ARMOR_SUBCLASS_CLOTH=1;this.ARMOR_SUBCLASS_LEATHER=2;this.ARMOR_SUBCLASS_MAIL=3;this.ARMOR_SUBCLASS_PLATE=4;this.ARMOR_SUBCLASS_COSMETIC=5;this.ARMOR_SUBCLASS_SHIELDS=6;this.ARMOR_SUBCLASS_RINGS=-2;this.ARMOR_SUBCLASS_AMULETS=-3;this.ARMOR_SUBCLASS_TRINKETS=-4;this.ARMOR_SUBCLASS_OFF_HAND_FRILLS=-5;this.ARMOR_SUBCLASS_CLOAKS=-6;this.ARMOR_SUBCLASS_TABARDS=-7;this.ARMOR_SUBCLASS_SHIRTS=-8;this.WEAPON_SUBCLASS_ONE_HANDED_AXE=0;this.WEAPON_SUBCLASS_TWO_HANDED_AXE=1;this.WEAPON_SUBCLASS_BOW=2;this.WEAPON_SUBCLASS_GUN=3;this.WEAPON_SUBCLASS_ONE_HANDED_MACE=4;this.WEAPON_SUBCLASS_TWO_HANDED_MACE=5;this.WEAPON_SUBCLASS_POLEARM=6;this.WEAPON_SUBCLASS_ONE_HANDED_SWORD=7;this.WEAPON_SUBCLASS_TWO_HANDED_SWORD=8;this.WEAPON_SUBCLASS_WARGLAIVE=9;this.WEAPON_SUBCLASS_STAFF=10;this.WEAPON_SUBCLASS_FIST_WEAPON=13;this.WEAPON_SUBCLASS_MISCELLANEOUS=14;this.WEAPON_SUBCLASS_DAGGER=15;this.WEAPON_SUBCLASS_THROWN=16;this.WEAPON_SUBCLASS_CROSSBOW=18;this.WEAPON_SUBCLASS_WAND=19;this.WEAPON_SUBCLASS_FISHING_POLE=20;this.INVENTORY_TYPE_HEAD=1;this.INVENTORY_TYPE_NECK=2;this.INVENTORY_TYPE_SHOULDERS=3;this.INVENTORY_TYPE_SHIRT=4;this.INVENTORY_TYPE_CHEST=5;this.INVENTORY_TYPE_WAIST=6;this.INVENTORY_TYPE_LEGS=7;this.INVENTORY_TYPE_FEET=8;this.INVENTORY_TYPE_WRISTS=9;this.INVENTORY_TYPE_HANDS=10;this.INVENTORY_TYPE_FINGER=11;this.INVENTORY_TYPE_TRINKET=12;this.INVENTORY_TYPE_ONE_HAND=13;this.INVENTORY_TYPE_SHIELD=14;this.INVENTORY_TYPE_RANGED=15;this.INVENTORY_TYPE_BACK=16;this.INVENTORY_TYPE_TWO_HAND=17;this.INVENTORY_TYPE_BAG=18;this.INVENTORY_TYPE_TABARD=19;this.INVENTORY_TYPE_ROBE=20;this.INVENTORY_TYPE_MAIN_HAND=21;this.INVENTORY_TYPE_OFF_HAND=22;this.INVENTORY_TYPE_HELD_IN_OFF_HAND=23;this.INVENTORY_TYPE_PROJECTILE=24;this.INVENTORY_TYPE_THROWN=25;this.INVENTORY_TYPE_RANGED_RIGHT=26;this.INVENTORY_TYPE_QUIVER=27;this.INVENTORY_TYPE_RELIC=28;this.INV_TYPES=[this.INVENTORY_TYPE_HEAD,this.INVENTORY_TYPE_NECK,this.INVENTORY_TYPE_SHOULDERS,this.INVENTORY_TYPE_SHIRT,this.INVENTORY_TYPE_CHEST,this.INVENTORY_TYPE_WAIST,this.INVENTORY_TYPE_LEGS,this.INVENTORY_TYPE_FEET,this.INVENTORY_TYPE_WRISTS,this.INVENTORY_TYPE_HANDS,this.INVENTORY_TYPE_FINGER,this.INVENTORY_TYPE_TRINKET,this.INVENTORY_TYPE_ONE_HAND,this.INVENTORY_TYPE_SHIELD,this.INVENTORY_TYPE_RANGED,this.INVENTORY_TYPE_BACK,this.INVENTORY_TYPE_TWO_HAND,this.INVENTORY_TYPE_BAG,this.INVENTORY_TYPE_TABARD,this.INVENTORY_TYPE_ROBE,this.INVENTORY_TYPE_MAIN_HAND,this.INVENTORY_TYPE_OFF_HAND,this.INVENTORY_TYPE_HELD_IN_OFF_HAND,this.INVENTORY_TYPE_PROJECTILE,this.INVENTORY_TYPE_THROWN,this.INVENTORY_TYPE_RANGED_RIGHT,this.INVENTORY_TYPE_QUIVER,this.INVENTORY_TYPE_RELIC];this.QUALITY_DEFAULT="";this.QUALITY_POOR=0;this.QUALITY_COMMON=1;this.QUALITY_UNCOMMON=2;this.QUALITY_RARE=3;this.QUALITY_EPIC=4;this.QUALITY_LEGENDARY=5;this.QUALITY_ARTIFACT=6;this.QUALITY_HEIRLOOM=7;this.QUALITY_WOW_TOKEN=8;this.QUALITY_GLYPH=9;this.QUALITY_FAIL=10;this.QUALITY_SET_BONUSES=13;const p=[this.INVENTORY_TYPE_HEAD,this.INVENTORY_TYPE_SHOULDERS,this.INVENTORY_TYPE_SHIRT,this.INVENTORY_TYPE_CHEST,this.INVENTORY_TYPE_WAIST,this.INVENTORY_TYPE_LEGS,this.INVENTORY_TYPE_FEET,this.INVENTORY_TYPE_WRISTS,this.INVENTORY_TYPE_HANDS,this.INVENTORY_TYPE_ROBE];const d=[q.ARMOR_SUBCLASS_CLOTH,q.ARMOR_SUBCLASS_LEATHER,q.ARMOR_SUBCLASS_MAIL,q.ARMOR_SUBCLASS_PLATE];const f={};const l=WH.getPageData("WH.Wow.Item.SLOT_TO_INV_TYPES");var o={"default":{"":"ffd100",0:"9d9d9d",1:"ffffff",2:"1eff00",3:"0070dd",4:"a335ee",5:"ff8000",6:"e5cc80",7:"00ccff",8:"00ccff",9:"71d5ff",10:"ff4040",13:"ffff98"},thottbot:{"":"e5c017",0:"777777",1:"000000",2:"00bb00",3:"0070dd",4:"a335ee",5:"ff8000",6:"998856",7:"00ccff",8:"00ccff",9:"4f95b3",10:"ff4040",13:"99995c"}};var m={"":"default",0:"poor",1:"common",2:"uncommon",3:"rare",4:"epic",5:"legendary",6:"artifact",7:"heirloom",8:"wowtoken",9:"glyph",10:"error",13:"setbonuses"};const c=[q.WEAPON_SUBCLASS_BOW,q.WEAPON_SUBCLASS_GUN,q.WEAPON_SUBCLASS_THROWN,q.WEAPON_SUBCLASS_CROSSBOW,q.WEAPON_SUBCLASS_WAND];this.getClassName=function(t,r){if(r){return(g_item_subclasses[t]||{})[r]}else{return g_item_classes[t]}};this.getInvTypeSlots=function(r){let dataEnv=WH.getDataEnv();if(!f[dataEnv]){f[dataEnv]={};let slotToInvTypes=l[dataEnv]||l[WH.getRootEnv()];for(let slot in slotToInvTypes){if(!slotToInvTypes.hasOwnProperty(slot)){continue}for(let i=0,invType;invType=slotToInvTypes[slot][i];i++){if(!f[dataEnv][invType]){f[dataEnv][invType]=[]}f[dataEnv][invType].push(parseInt(slot))}}}return f[dataEnv][r]||[]};this.getPath=function(u,t,r){return WH.Entity.getPath(WH.Types.ITEM,u,t,r)};this.getQualityColor=function(v,t){var r=t?o["default"]:(o[WH.Theme.getTheme()]||o["default"]);var u=r[v]||r[q.QUALITY_DEFAULT];return"#"+u};this.getQualityName=function(r){return WH.TERMS[m[r]]||WH.TERMS.unknown};this.getSourceCategory=function(t,r){switch(t){case 2:if(r.bd){return WH.TERMS.bossdrop}if(r.z){return WH.TERMS.zonedrop}break;case 4:return WH.TERMS.quests;case 5:return WH.TERMS.vendors}return g_sources[t]||""};this.getSourceDescription=function(u,r){switch(u){case 3:if(r.p&&g_sources_pvp[r.p]){return{text:g_sources_pvp[r.p]}}break}switch(r.t||0){case 0:case 1:case 2:if(r.z){var t={url:WH.Entity.getPath(WH.Types.ZONE,r.z,g_zones[r.z]),text:g_zones[r.z]};if(r.t&&u==5){t.pretext=WH.TERMS.vendorin}if(r.dd){let diff=h.getNameAbbrev(h.convertLegacyDropDifficulty(r.dd));t.posttext=WH.Strings.sprintf(WH.TERMS.parens_format,"",diff)}return t}break;case 5:return{url:"/quests="+r.c2+"."+r.c,text:WH.Wow.Quest.getCategoryName(r.c)};break;case 6:if(r.c&&r.s){return{url:"/spells="+r.c+"."+r.s,text:g_spell_skills[r.s]}}else{return{url:"/spells=0",text:"??"}}break}};this.getThumbUrl=function(t,r,u){return WH.staticUrl+WH.ModelViewer.getStaticBase(WH.getRootEnv(u))+"/webthumbs/item/"+(t&255)+"/"+t+(r?"-"+r:"")+WH.WebP.getImageExtension()};this.getTypeNameAndUrl=function(u,t,r){if(g_item_subsubclasses.hasOwnProperty(u)&&g_item_subsubclasses[u].hasOwnProperty(t)&&g_item_subsubclasses[u][t].hasOwnProperty(r)){return{url:"/items="+u+"."+t+"."+r,text:g_item_subsubclasses[u][t][r]}}if(g_item_subclasses.hasOwnProperty(u)&&g_item_subclasses[u].hasOwnProperty(t)){return{url:"/items="+u+"."+t,text:g_item_subclasses[u][t]}}if(g_item_classes.hasOwnProperty(u)){return{url:"/items="+u,text:g_item_classes[u]}}WH.error("Could not find item class name for: "+JSON.stringify({itemClass:u,itemSubClass:t,itemSubSubClass:r}));return{url:"/items",text:WH.TERMS.unknown}};this.isArmorInvType=function(r){return p.includes(r)};this.isBodyArmor=function(t,r){return t===q.CLASS_ARMOR&&d.includes(r)};this.isRangedWeaponSubclass=function(r){return c.includes(r)};this.tooltipHasSpecStats=function(u){var t=/<span[^>]*?><!--stat(\d+)-->([-+][\d\.,]+(?:-[\d\.,]+)?\D*?)<\/span>/gi;var r=t.exec(u);while(r!=null){if(g_grayedOutStats.hasOwnProperty(r[1])||WH.inArray([q.BONUS_AGI_STR_INT,q.BONUS_AGI_STR,q.BONUS_AGI_INT,q.BONUS_STR_INT],r[1])!==-1){return true}r=t.exec(u)}return u.indexOf("<!--traitspec")>0}};WH.Wow.ItemSet=new function(){this.getThumbUrl=function(g,c,d,f){return WH.staticUrl+WH.ModelViewer.getStaticBase(WH.getRootEnv(f))+"/webthumbs/item-set/"+c+"/"+d+"/"+(Math.abs(g)&255)+"/"+g+WH.WebP.getImageExtension()}};WH.Wow.Models=new function(){this.getRaceIdFromMask=function(c){return c?Math.round(Math.log2(c&-c)+1):null};this.isPepeEnabled=function(){return WH.isRetailTree()}};WH.Wow.Npc=new function(){this.getThumbUrl=function(c,d){return WH.staticUrl+WH.ModelViewer.getStaticBase(d)+"/webthumbs/npc/"+(c&255)+"/"+c+WH.WebP.getImageExtension()}};WH.Wow.PlayerClass=new function(){const o=this;const f=WH.Wow.Item;this.DEATH_KNIGHT=6;this.DEMON_HUNTER=12;this.DRUID=11;this.HUNTER=3;this.MAGE=8;this.MONK=10;this.PALADIN=2;this.PRIEST=5;this.ROGUE=4;this.SHAMAN=7;this.WARLOCK=9;this.WARRIOR=1;const l=WH.getPageData("WH.Wow.PlayerClass.raceIds")||{};const h={};h[WH.dataEnv.CLASSIC]=[this.DRUID,this.HUNTER,this.MAGE,this.PALADIN,this.PRIEST,this.ROGUE,this.SHAMAN,this.WARLOCK,this.WARRIOR];h[WH.dataEnv.TBC]=[this.DRUID,this.HUNTER,this.MAGE,this.PALADIN,this.PRIEST,this.ROGUE,this.SHAMAN,this.WARLOCK,this.WARRIOR];h[WH.dataEnv.MAIN]=[this.DEATH_KNIGHT,this.DEMON_HUNTER,this.DRUID,this.HUNTER,this.MAGE,this.MONK,this.PALADIN,this.PRIEST,this.ROGUE,this.SHAMAN,this.WARLOCK,this.WARRIOR];const g={};g[this.DEATH_KNIGHT]="deathknight";g[this.DEMON_HUNTER]="demonhunter";g[this.DRUID]="druid";g[this.HUNTER]="hunter";g[this.MAGE]="mage";g[this.MONK]="monk";g[this.PALADIN]="paladin";g[this.PRIEST]="priest";g[this.ROGUE]="rogue";g[this.SHAMAN]="shaman";g[this.WARLOCK]="warlock";g[this.WARRIOR]="warrior";const d={};d[f.ARMOR_SUBCLASS_CLOTH]=[o.MAGE,o.PRIEST,o.WARLOCK];d[f.ARMOR_SUBCLASS_LEATHER]=[o.DEMON_HUNTER,o.DRUID,o.MONK,o.ROGUE];d[f.ARMOR_SUBCLASS_MAIL]=[o.HUNTER,o.SHAMAN];d[f.ARMOR_SUBCLASS_PLATE]=[o.DEATH_KNIGHT,o.PALADIN,o.WARRIOR];const c={};c[WH.dataEnv.CLASSIC]={};c[WH.dataEnv.CLASSIC][this.DRUID]="druid";c[WH.dataEnv.CLASSIC][this.HUNTER]="hunter";c[WH.dataEnv.CLASSIC][this.MAGE]="mage";c[WH.dataEnv.CLASSIC][this.PALADIN]="paladin";c[WH.dataEnv.CLASSIC][this.PRIEST]="priest";c[WH.dataEnv.CLASSIC][this.ROGUE]="rogue";c[WH.dataEnv.CLASSIC][this.SHAMAN]="shaman";c[WH.dataEnv.CLASSIC][this.WARLOCK]="warlock";c[WH.dataEnv.CLASSIC][this.WARRIOR]="warrior";c[WH.dataEnv.TBC]={};c[WH.dataEnv.TBC][this.DRUID]="druid";c[WH.dataEnv.TBC][this.HUNTER]="hunter";c[WH.dataEnv.TBC][this.MAGE]="mage";c[WH.dataEnv.TBC][this.PALADIN]="paladin";c[WH.dataEnv.TBC][this.PRIEST]="priest";c[WH.dataEnv.TBC][this.ROGUE]="rogue";c[WH.dataEnv.TBC][this.SHAMAN]="shaman";c[WH.dataEnv.TBC][this.WARLOCK]="warlock";c[WH.dataEnv.TBC][this.WARRIOR]="warrior";c[WH.dataEnv.MAIN]={};c[WH.dataEnv.MAIN][this.DEATH_KNIGHT]="death-knight";c[WH.dataEnv.MAIN][this.DEMON_HUNTER]="demon-hunter";c[WH.dataEnv.MAIN][this.DRUID]="druid";c[WH.dataEnv.MAIN][this.HUNTER]="hunter";c[WH.dataEnv.MAIN][this.MAGE]="mage";c[WH.dataEnv.MAIN][this.MONK]="monk";c[WH.dataEnv.MAIN][this.PALADIN]="paladin";c[WH.dataEnv.MAIN][this.PRIEST]="priest";c[WH.dataEnv.MAIN][this.ROGUE]="rogue";c[WH.dataEnv.MAIN][this.SHAMAN]="shaman";c[WH.dataEnv.MAIN][this.WARLOCK]="warlock";c[WH.dataEnv.MAIN][this.WARRIOR]="warrior";this.canBeRace=function(r,q){if(!l[r]){WH.error("Class not available in current data env.",o.getName(r)||r,WH.getDataEnvTerm());return false}return l[r].indexOf(q)>-1};this.getAll=function(){let dataEnv=WH.getDataEnv();let classes=h[dataEnv]||h[WH.getRootEnv()];if(!classes){WH.error("No classes defined for "+WH.getDataEnvTerm()+".");return[]}return classes.slice()};this.getBySlug=function(q){let slugs=p();for(let id in slugs){if(slugs[id]===q){return parseInt(id)}}return undefined};this.getBySpec=function(q){let spec=""+q;for(let classId in g_chr_specs_by_class){if(g_chr_specs_by_class.hasOwnProperty(classId)&&g_chr_specs_by_class[classId].includes(spec)){return parseInt(classId)}}return undefined};this.getIconName=function(q){return"class_"+g[q]};this.getIdString=function(q){return g[q]};this.getName=function(q){return g_chr_classes[q]};this.getPreferredArmorSubclass=function(q){for(let armorSubclass in d){if(d[armorSubclass].includes(q)){return parseInt(armorSubclass)}}return undefined};this.getSlug=function(q){return p()[q]};this.removeClasses=function(q){let regExp=/^c1?\d$/;q.classList.forEach(function(t,r,u){if(regExp.test(t)){u.remove(t)}})};function p(){return c[WH.getDataEnv()]||c[WH.getRootEnv()]}function m(){for(let dataEnv in h){h.hasOwnProperty(dataEnv)&&h[dataEnv].sort(function(r,q){return(o.getName(r)||"").localeCompare(o.getName(q)||"")})}}m()};WH.Wow.Quest=new function(){this.getCategoryName=function(c){return g_quest_sorts[c]};this.roundQuestXp=function(c){if(c==undefined){return c}let roundFactor=c<1000?10:50;return Math.round(c/roundFactor)*roundFactor}};WH.Wow.Race=new function(){const d=this;const l=WH.Wow;this.ID_BLOOD_ELF=10;this.ID_DARK_IRON_DWARF=34;this.ID_DRAENEI=11;this.ID_DWARF=3;this.ID_GNOME=7;this.ID_GOBLIN=9;this.ID_HIGHMOUNTAIN_TAUREN=28;this.ID_HUMAN=1;this.ID_KUL_TIRAN=32;this.ID_LIGHTFORGED_DRAENEI=30;this.ID_MAGHAR_ORC=36;this.ID_MECHAGNOME=37;this.ID_NIGHT_ELF=4;this.ID_NIGHTBORNE=27;this.ID_ORC=2;this.ID_PANDAREN_ALLIANCE=25;this.ID_PANDAREN_HORDE=26;this.ID_PANDAREN_NEUTRAL=24;this.ID_TAUREN=6;this.ID_TROLL=8;this.ID_UNDEAD=5;this.ID_VOID_ELF=29;this.ID_VULPERA=35;this.ID_WORGEN=22;this.ID_ZANDALARI_TROLL=31;var h={1:"human",2:"orc",3:"dwarf",4:"nightelf",5:"scourge",6:"tauren",7:"gnome",8:"troll",9:"goblin",10:"bloodelf",11:"draenei",12:"felorc",13:"naga",14:"broken",15:"skeleton",16:"vrykul",17:"tuskarr",18:"foresttroll",19:"taunka",20:"northrendskeleton",21:"icetroll",22:"worgen",23:"gilnean",24:"pandaren",25:"pandaren",26:"pandaren",27:"nightborne",28:"highmountaintauren",29:"voidelf",30:"lightforgeddraenei",31:"zandalaritroll",32:"kultiran",33:"thinhuman",34:"darkirondwarf",35:"vulpera",36:"magharorc",37:"mechagnome"};const f=1101;const g=690;const c=f|g;var o={};o[WH.dataTree.RETAIL]={11:"draenei",34:"dark-iron-dwarf",3:"dwarf",7:"gnome",1:"human",32:"kul-tiran",30:"lightforged-draenei",37:"mechagnome",4:"night-elf",25:"alliance-pandaren",29:"void-elf",22:"worgen",10:"blood-elf",9:"goblin",28:"highmountain-tauren",36:"maghar-orc",27:"nightborne",2:"orc",26:"horde-pandaren",6:"tauren",8:"troll",5:"undead",35:"vulpera",31:"zandalari-troll",24:"pandaren"};o[WH.dataTree.CLASSIC]={3:"dwarf",7:"gnome",1:"human",4:"night-elf",2:"orc",6:"tauren",8:"troll",5:"undead"};o[WH.dataTree.TBC]={11:"draenei",3:"dwarf",7:"gnome",1:"human",4:"night-elf",10:"blood-elf",2:"orc",6:"tauren",8:"troll",5:"undead"};var m={localeSortedIds:undefined,localeSortedIdsAll:undefined};this.exists=function(p){if(WH.isClassicTree()){return p>=1&&p<=9}if(WH.isBurningCrusadeTree()){return p>=1&&p<=11}return h[p]!==undefined};this.getAll=function(){let ids=[];let slugs=o[WH.getDataTree()];for(let raceId in slugs){if(slugs.hasOwnProperty(raceId)){ids.push(parseInt(raceId))}}return ids};this.getIcon=function(p,q){if(!d.isPlayableRace(p)){return undefined}let raceString=d.getString(p);if(!raceString){return undefined}let genderString=l.getGenderString(q)||l.getGenderString(l.GENDER_MALE);return"race_"+raceString+"_"+genderString};this.getIdFromSlug=function(q){var r=o[WH.getDataTree()];for(var p in r){if(!r.hasOwnProperty(p)){continue}if(r[p]===q){return parseInt(p)}}return undefined};this.getIdString=function(p){return h[p]};this.getName=function(p){return g_chr_races[p]};this.getPlayableRaceIds=function(t){var u=t?"localeSortedIdsAll":"localeSortedIds";if(m[u]){return m[u]}var q=[];var r=o[WH.getDataTree()];for(var p in r){if(r.hasOwnProperty(p)&&(t===true||(p!=d.ID_PANDAREN_ALLIANCE&&p!=d.ID_PANDAREN_HORDE))){q.push(parseInt(p))}}q.sort(function(w,v){return WH.stringCompare(d.getName(w),d.getName(v))});m[u]=q;return q};this.getSide=function(p){if((p&c)===f){return WH.Wow.SIDE_ALLIANCE}else{if((p&c)===g){return WH.Wow.SIDE_HORDE}}return undefined};this.getSlug=function(p){return o[WH.getDataTree()][p]};this.getString=function(p){return g_file_races[p]};this.getUnique=function(){return d.getAll().filter(function(p){return![d.ID_PANDAREN_ALLIANCE,d.ID_PANDAREN_HORDE].includes(p)})};this.isPlayableRace=function(p){return d.getSlug(p)!==undefined}};WH.Wow.Realm=new function(){var c={callbacks:[],dataRequested:false};this.fetchData=function(f){if(window.g_bnet_realms){window.requestAnimationFrame(f);return}if(c.dataRequested){c.callbacks.push(f);return}let script=WH.ajaxIshRequest(WH.Url.getDataPageUrl("realms"));if(script){WH.aE(script,"load",d);if(f){c.callbacks.push(f)}}c.dataRequested=true};this.getAll=function(){return window.g_bnet_realms||null};this.getSlugByName=function(m,h){var l=this.getAll();if(!l){return null}l=l[m.toUpperCase()];if(!l){return null}var o="name_"+Locale.getName();h=h.toLocaleLowerCase();for(var g in l){if(!l.hasOwnProperty(g)){continue}var f=l[g];if(f.name.toLocaleLowerCase()===h){return f.slug}if(f[o]&&f[o].toLocaleLowerCase()===h){return f.slug}}return null};function d(){if(!window.g_bnet_realms){WH.error("The realm data failed to load.");return}while(c.callbacks.length){var g=c.callbacks.shift();try{g()}catch(f){WH.error("Realm data loading callback error:",f)}}}};WH.Wow.Skill=new function(){this.ID_DEFENSE=95;this.ID_AXES=44;this.ID_BOWS=45;this.ID_CROSSBOWS=226;this.ID_DAGGERS=173;this.ID_FIST_WEAPONS=473;this.ID_GUNS=46;this.ID_MACES=54;this.ID_POLEARMS=229;this.ID_STAVES=136;this.ID_SWORDS=43;this.ID_THROWN=176;this.ID_TWO_HANDED_AXES=172;this.ID_TWO_HANDED_MACES=160;this.ID_TWO_HANDED_SWORDS=55;this.ID_UNARMED=162;this.ID_WANDS=228};WH.Wow.Spell=new function(){this.AURA_EFFECT_MOD_RESISTANCE=22;this.AURA_EFFECT_MOD_SKILL_TEMPORARY=30;this.AURA_EFFECT_MOD_PARRY_PCT=47;this.AURA_EFFECT_MOD_DODGE_PCT=49;this.AURA_EFFECT_MOD_BLOCK_PCT=51;this.AURA_EFFECT_MOD_MELEE_RANGED_CRIT_PCT=52;this.AURA_EFFECT_MOD_MELEE_RANGED_HIT_CHANCE_PCT=54;this.AURA_EFFECT_MOD_SPELL_HIT_CHANCE_PCT=55;this.AURA_EFFECT_MOD_SKILL=98;this.AURA_EFFECT_ADD_MODIFIER_FLAT=107;this.AURA_EFFECT_REDUCE_TARGET_RESISTANCES_FLAT=123;this.AURA_EFFECT_MOD_INCREASE_MAXIMUM_POWER_PCT=132;this.AURA_EFFECT_MOD_INCREASE_MAXIMUM_HEALTH_PCT=133;this.AURA_EFFECT_ALLOW_PCT_OF_MANA_REGENERATION_TO_CONTINUE_IN_COMBAT=134;this.AURA_EFFECT_MOD_STAT_PCT2=137;this.AURA_EFFECT_MOD_BASE_RESISTANCE_PCT=142;this.AURA_EFFECT_MOD_BLOCK_VALUE_PCT=150;this.AURA_EFFECT_MOD_MELEE_ATTACK_POWER_PCT=166;this.AURA_EFFECT_MOD_SPELL_POWER_BY_PCT_OF_STAT=174;this.AURA_EFFECT_MOD_HEALING_POWER_BY_PCT_OF_STAT=175;this.AURA_EFFECT_MOD_RESISTANCE_BY_PCT_OF_STAT=182;this.ID_EXOTIC_BEASTS=53270;this.OPTIONAL_REAGENT_ICON_PATH="/images/wow/interface/GuildFrame/communities-icon-addgroupplus.png";const c=[15,25,30,35,40,45,50];this.get=function(d){return WH.Gatherer.get(WH.Types.SPELL,d)||null};this.getName=function(d){return WH.Gatherer.getName(WH.Types.SPELL,d)};this.getPath=function(f,d){return WH.Entity.getPath(WH.Types.SPELL,f,d)};this.getTalentLevels=function(){return c}};WH.Wow.TransmogSet=new function(){this.getCompletionAmount=function(d,c){if(!d||!g_completion.wardrobe||!(c in g_completion.wardrobe)){return null}let collected=g_completion.wardrobe[c]||[];let types=Object.keys(d);if(types.length===0){return 0}let foundTypes=0;types.forEach(function(f){let displays=d[f];for(let displayIndex=0;displayIndex<displays.length;displayIndex++){if(collected.includes(f+"|"+displays[displayIndex])){foundTypes++;return}}});return foundTypes/types.length};this.getThumbUrl=function(g,c,d,f){return WH.staticUrl+WH.ModelViewer.getStaticBase(WH.getRootEnv(f))+"/webthumbs/transmog/"+c+"/"+d+"/"+(g&255)+"/"+g+WH.WebP.getImageExtension()}};WH.Wow.UiMap=new function(){const f=this;this.clickToCopyCoordinates=function(h,l,g){g=g||{};let coordsFunc=typeof l==="function"?l:function(){return l};h.style.cursor="pointer";WH.Tooltip.simple(h,function(){let tooltip=WH.ce("div",undefined,WH.ct(coordsFunc().join(WH.TERMS.comma_punct)));WH.ae(tooltip,WH.ce("div",{className:"q2",style:{marginTop:"10px"}},WH.ct(WH.TERMS.clickToCopy)));return tooltip.innerHTML},"q",true,true,true);WH.aE(h,"click",d.bind(h,coordsFunc,g))};this.generateInGamePinLinkCommand=function(m,g,l,h){let nameWithIcon;if(h){nameWithIcon="\\124A:Waypoint-MapPin-ChatIcon:13:13:0:0\\124a "+(WH.term("mapPin_format",h).replace(/:+$/,"").replace(/"/g,'\\"'))}else{nameWithIcon=WH.GlobalStrings.MAP_PIN_HYPERLINK.replace(/\|/g,"\\124")}return'/script DEFAULT_CHAT_FRAME:AddMessage("\\124cffffff00\\124Hworldmap:'+m+":"+g+":"+l+"\\124h["+nameWithIcon+']\\124h\\124r");'};this.generateTomTomCommand=function(h,g){let map=g.uiMapId?" #"+g.uiMapId:(g.uiMapName?" "+g.uiMapName:"");let tomTomCommand="/way"+map+" "+h[0]+" "+h[1];if(g.name&&g.name!==g.uiMapName){tomTomCommand+=" "+g.name}return tomTomCommand};function c(h,g){return{x:parseFloat(h[0])*100,y:parseFloat(h[1])*100,name:g.name&&g.uiMapName?WH.term("parens_format",g.name,g.uiMapName):(g.name||g.uiMapName)}}function d(g,h){let rawCoords=g();let allRawCoords=h.getAllCoords?h.getAllCoords():null;if(allRawCoords&&allRawCoords.length<=1){allRawCoords=null}let allInGameMapPins=h.getAllInGameMapPins?h.getAllInGameMapPins():null;if(allInGameMapPins&&allInGameMapPins.length<=1){allInGameMapPins=null}let allTomTomCommands=h.getAllTomTomCommands?h.getAllTomTomCommands():null;if(allTomTomCommands&&allTomTomCommands.length<=1){allTomTomCommands=null}let copyOneMenu=[Menu.createItem({label:WH.TERMS.copy_clipboard,options:{heading:true}})];let copyAllMenu=allRawCoords||allTomTomCommands?[Menu.createItem({label:WH.TERMS.copyAll,options:{heading:true}})]:null;copyOneMenu.push(Menu.createItem({name:"",label:WH.TERMS.coordinates,url:function(){WH.copyToClipboard(rawCoords.join(" "),true)}}));if(allRawCoords){copyAllMenu.push(Menu.createItem({name:"",label:WH.TERMS.coordinates,url:function(){let allCoords=[];allRawCoords.forEach(function(l){allCoords.push(l.join(" "))});WH.copyToClipboard(allCoords.join("\n"),true)}}))}if(h.uiMapId){copyOneMenu.push(Menu.createItem({name:"",label:WH.TERMS.inGameMapPin,url:function(){let opts=c(rawCoords,h);let command=f.generateInGamePinLinkCommand(h.uiMapId,opts.x,opts.y,opts.name);WH.copyToClipboard(command,true)}}));if(allInGameMapPins){copyAllMenu.push(Menu.createItem({name:"",label:WH.TERMS.inGameMapPin,url:function(){WH.copyToClipboard(allInGameMapPins.join("\n"),true)}}))}else{if(allRawCoords){copyAllMenu.push(Menu.createItem({name:"",label:WH.TERMS.inGameMapPin,url:function(){let allPinCommands=[];allRawCoords.forEach(function(l){let opts=c(l,h);allPinCommands.push(f.generateInGamePinLinkCommand(h.uiMapId,opts.x,opts.y,opts.name))});WH.copyToClipboard(allPinCommands.join("\n"),true)}}))}}}if(h.includeTomTom||h.uiMapId||h.uiMapName){copyOneMenu.push(Menu.createItem({name:"",label:WH.TERMS.tomTomCommand,url:function(){WH.copyToClipboard(f.generateTomTomCommand(rawCoords,h),true)}}));if(allTomTomCommands){copyAllMenu.push(Menu.createItem({name:"",label:WH.TERMS.tomTomCommand,url:function(){WH.copyToClipboard(allTomTomCommands.join("\n"),true)}}))}else{if(allRawCoords){copyAllMenu.push(Menu.createItem({name:"",label:WH.TERMS.tomTomCommand,url:function(){let allTomTomCommands=[];allRawCoords.forEach(function(l){allTomTomCommands.push(f.generateTomTomCommand(l,h))});WH.copyToClipboard(allTomTomCommands.join("\n"),true)}}))}}}let menu=copyAllMenu?copyOneMenu.concat(copyAllMenu):copyOneMenu;if(menu.length===2){menu[1][Menu.ITEM_URL]();return}Menu.show(menu,this)}};WH.Wow.PlayerClass.Specialization=new function(){const f=this;const g=WH.Wow.PlayerClass;this.ID_DEATH_KNIGHT_BLOOD=250;this.ID_DEATH_KNIGHT_FROST=251;this.ID_DEATH_KNIGHT_UNHOLY=252;this.ID_DEMON_HUNTER_HAVOC=577;this.ID_DEMON_HUNTER_VENGEANCE=581;this.ID_DRUID_BALANCE=102;this.ID_DRUID_FERAL=103;this.ID_DRUID_GUARDIAN=104;this.ID_DRUID_RESTORATION=105;this.ID_HUNTER_BEAST_MASTERY=253;this.ID_HUNTER_MARKSMANSHIP=254;this.ID_HUNTER_SURVIVAL=255;this.ID_MAGE_ARCANE=62;this.ID_MAGE_FIRE=63;this.ID_MAGE_FROST=64;this.ID_MONK_BREWMASTER=268;this.ID_MONK_MISTWEAVER=270;this.ID_MONK_WINDWALKER=269;this.ID_PALADIN_HOLY=65;this.ID_PALADIN_PROTECTION=66;this.ID_PALADIN_RETRIBUTION=70;this.ID_PRIEST_DISCIPLINE=256;this.ID_PRIEST_HOLY=257;this.ID_PRIEST_SHADOW=258;this.ID_ROGUE_ASSASSINATION=259;this.ID_ROGUE_OUTLAW=260;this.ID_ROGUE_SUBTLETY=261;this.ID_SHAMAN_ELEMENTAL=262;this.ID_SHAMAN_ENHANCEMENT=263;this.ID_SHAMAN_RESTORATION=264;this.ID_WARLOCK_AFFLICTION=265;this.ID_WARLOCK_DEMONOLOGY=266;this.ID_WARLOCK_DESTRUCTION=267;this.ID_WARRIOR_ARMS=71;this.ID_WARRIOR_FURY=72;this.ID_WARRIOR_PROTECTION=73;this.ID_CLASSIC_DRUID_BALANCE=283;this.ID_CLASSIC_DRUID_FERAL_COMBAT=281;this.ID_CLASSIC_DRUID_RESTORATION=282;this.ID_CLASSIC_HUNTER_BEAST_MASTERY=361;this.ID_CLASSIC_HUNTER_MARKSMANSHIP=363;this.ID_CLASSIC_HUNTER_SURVIVAL=362;this.ID_CLASSIC_MAGE_ARCANE=81;this.ID_CLASSIC_MAGE_FIRE=41;this.ID_CLASSIC_MAGE_FROST=61;this.ID_CLASSIC_PALADIN_HOLY=382;this.ID_CLASSIC_PALADIN_PROTECTION=383;this.ID_CLASSIC_PALADIN_RETRIBUTION=381;this.ID_CLASSIC_PRIEST_DISCIPLINE=201;this.ID_CLASSIC_PRIEST_HOLY=202;this.ID_CLASSIC_PRIEST_SHADOW=203;this.ID_CLASSIC_ROGUE_ASSASSINATION=182;this.ID_CLASSIC_ROGUE_COMBAT=181;this.ID_CLASSIC_ROGUE_SUBTLETY=183;this.ID_CLASSIC_SHAMAN_ELEMENTAL=261;this.ID_CLASSIC_SHAMAN_ENHANCEMENT=263;this.ID_CLASSIC_SHAMAN_RESTORATION=262;this.ID_CLASSIC_WARLOCK_AFFLICTION=302;this.ID_CLASSIC_WARLOCK_DEMONOLOGY=303;this.ID_CLASSIC_WARLOCK_DESTRUCTION=301;this.ID_CLASSIC_WARRIOR_ARMS=161;this.ID_CLASSIC_WARRIOR_FURY=164;this.ID_CLASSIC_WARRIOR_PROTECTION=163;const c={};c[WH.dataEnv.CLASSIC]={};c[WH.dataEnv.CLASSIC][g.DRUID]=[this.ID_CLASSIC_DRUID_BALANCE,this.ID_CLASSIC_DRUID_FERAL_COMBAT,this.ID_CLASSIC_DRUID_RESTORATION];c[WH.dataEnv.CLASSIC][g.HUNTER]=[this.ID_CLASSIC_HUNTER_BEAST_MASTERY,this.ID_CLASSIC_HUNTER_MARKSMANSHIP,this.ID_CLASSIC_HUNTER_SURVIVAL];c[WH.dataEnv.CLASSIC][g.MAGE]=[this.ID_CLASSIC_MAGE_ARCANE,this.ID_CLASSIC_MAGE_FIRE,this.ID_CLASSIC_MAGE_FROST];c[WH.dataEnv.CLASSIC][g.PALADIN]=[this.ID_CLASSIC_PALADIN_HOLY,this.ID_CLASSIC_PALADIN_PROTECTION,this.ID_CLASSIC_PALADIN_RETRIBUTION];c[WH.dataEnv.CLASSIC][g.PRIEST]=[this.ID_CLASSIC_PRIEST_DISCIPLINE,this.ID_CLASSIC_PRIEST_HOLY,this.ID_CLASSIC_PRIEST_SHADOW];c[WH.dataEnv.CLASSIC][g.ROGUE]=[this.ID_CLASSIC_ROGUE_ASSASSINATION,this.ID_CLASSIC_ROGUE_COMBAT,this.ID_CLASSIC_ROGUE_SUBTLETY];c[WH.dataEnv.CLASSIC][g.SHAMAN]=[this.ID_CLASSIC_SHAMAN_ELEMENTAL,this.ID_CLASSIC_SHAMAN_ENHANCEMENT,this.ID_CLASSIC_SHAMAN_RESTORATION];c[WH.dataEnv.CLASSIC][g.WARLOCK]=[this.ID_CLASSIC_WARLOCK_AFFLICTION,this.ID_CLASSIC_WARLOCK_DEMONOLOGY,this.ID_CLASSIC_WARLOCK_DESTRUCTION];c[WH.dataEnv.CLASSIC][g.WARRIOR]=[this.ID_CLASSIC_WARRIOR_ARMS,this.ID_CLASSIC_WARRIOR_FURY,this.ID_CLASSIC_WARRIOR_PROTECTION];c[WH.dataEnv.TBC]=c[WH.dataEnv.CLASSIC];c[WH.dataEnv.MAIN]={};c[WH.dataEnv.MAIN][g.DEATH_KNIGHT]=[this.ID_DEATH_KNIGHT_BLOOD,this.ID_DEATH_KNIGHT_FROST,this.ID_DEATH_KNIGHT_UNHOLY];c[WH.dataEnv.MAIN][g.DEMON_HUNTER]=[this.ID_DEMON_HUNTER_HAVOC,this.ID_DEMON_HUNTER_VENGEANCE];c[WH.dataEnv.MAIN][g.DRUID]=[this.ID_DRUID_BALANCE,this.ID_DRUID_FERAL,this.ID_DRUID_GUARDIAN,this.ID_DRUID_RESTORATION];c[WH.dataEnv.MAIN][g.HUNTER]=[this.ID_HUNTER_BEAST_MASTERY,this.ID_HUNTER_MARKSMANSHIP,this.ID_HUNTER_SURVIVAL];c[WH.dataEnv.MAIN][g.MAGE]=[this.ID_MAGE_ARCANE,this.ID_MAGE_FIRE,this.ID_MAGE_FROST];c[WH.dataEnv.MAIN][g.MONK]=[this.ID_MONK_BREWMASTER,this.ID_MONK_MISTWEAVER,this.ID_MONK_WINDWALKER];c[WH.dataEnv.MAIN][g.PALADIN]=[this.ID_PALADIN_HOLY,this.ID_PALADIN_PROTECTION,this.ID_PALADIN_RETRIBUTION];c[WH.dataEnv.MAIN][g.PRIEST]=[this.ID_PRIEST_DISCIPLINE,this.ID_PRIEST_HOLY,this.ID_PRIEST_SHADOW];c[WH.dataEnv.MAIN][g.ROGUE]=[this.ID_ROGUE_ASSASSINATION,this.ID_ROGUE_OUTLAW,this.ID_ROGUE_SUBTLETY];c[WH.dataEnv.MAIN][g.SHAMAN]=[this.ID_SHAMAN_ELEMENTAL,this.ID_SHAMAN_ENHANCEMENT,this.ID_SHAMAN_RESTORATION];c[WH.dataEnv.MAIN][g.WARLOCK]=[this.ID_WARLOCK_AFFLICTION,this.ID_WARLOCK_DEMONOLOGY,this.ID_WARLOCK_DESTRUCTION];c[WH.dataEnv.MAIN][g.WARRIOR]=[this.ID_WARRIOR_ARMS,this.ID_WARRIOR_FURY,this.ID_WARRIOR_PROTECTION];const m={};m[WH.dataEnv.CLASSIC]={};m[WH.dataEnv.CLASSIC][g.DRUID]={};m[WH.dataEnv.CLASSIC][g.DRUID][this.ID_CLASSIC_DRUID_BALANCE]="balance";m[WH.dataEnv.CLASSIC][g.DRUID][this.ID_CLASSIC_DRUID_FERAL_COMBAT]="feral-combat";m[WH.dataEnv.CLASSIC][g.DRUID][this.ID_CLASSIC_DRUID_RESTORATION]="restoration";m[WH.dataEnv.CLASSIC][g.HUNTER]={};m[WH.dataEnv.CLASSIC][g.HUNTER][this.ID_CLASSIC_HUNTER_BEAST_MASTERY]="beast-mastery";m[WH.dataEnv.CLASSIC][g.HUNTER][this.ID_CLASSIC_HUNTER_MARKSMANSHIP]="marksmanship";m[WH.dataEnv.CLASSIC][g.HUNTER][this.ID_CLASSIC_HUNTER_SURVIVAL]="survival";m[WH.dataEnv.CLASSIC][g.MAGE]={};m[WH.dataEnv.CLASSIC][g.MAGE][this.ID_CLASSIC_MAGE_ARCANE]="arcane";m[WH.dataEnv.CLASSIC][g.MAGE][this.ID_CLASSIC_MAGE_FIRE]="fire";m[WH.dataEnv.CLASSIC][g.MAGE][this.ID_CLASSIC_MAGE_FROST]="frost";m[WH.dataEnv.CLASSIC][g.PALADIN]={};m[WH.dataEnv.CLASSIC][g.PALADIN][this.ID_CLASSIC_PALADIN_HOLY]="holy";m[WH.dataEnv.CLASSIC][g.PALADIN][this.ID_CLASSIC_PALADIN_PROTECTION]="protection";m[WH.dataEnv.CLASSIC][g.PALADIN][this.ID_CLASSIC_PALADIN_RETRIBUTION]="retribution";m[WH.dataEnv.CLASSIC][g.PRIEST]={};m[WH.dataEnv.CLASSIC][g.PRIEST][this.ID_CLASSIC_PRIEST_DISCIPLINE]="discipline";m[WH.dataEnv.CLASSIC][g.PRIEST][this.ID_CLASSIC_PRIEST_HOLY]="holy";m[WH.dataEnv.CLASSIC][g.PRIEST][this.ID_CLASSIC_PRIEST_SHADOW]="shadow";m[WH.dataEnv.CLASSIC][g.ROGUE]={};m[WH.dataEnv.CLASSIC][g.ROGUE][this.ID_CLASSIC_ROGUE_ASSASSINATION]="assassination";m[WH.dataEnv.CLASSIC][g.ROGUE][this.ID_CLASSIC_ROGUE_COMBAT]="combat";m[WH.dataEnv.CLASSIC][g.ROGUE][this.ID_CLASSIC_ROGUE_SUBTLETY]="subtlety";m[WH.dataEnv.CLASSIC][g.SHAMAN]={};m[WH.dataEnv.CLASSIC][g.SHAMAN][this.ID_CLASSIC_SHAMAN_ELEMENTAL]="elemental";m[WH.dataEnv.CLASSIC][g.SHAMAN][this.ID_CLASSIC_SHAMAN_ENHANCEMENT]="enhancement";m[WH.dataEnv.CLASSIC][g.SHAMAN][this.ID_CLASSIC_SHAMAN_RESTORATION]="restoration";m[WH.dataEnv.CLASSIC][g.WARLOCK]={};m[WH.dataEnv.CLASSIC][g.WARLOCK][this.ID_CLASSIC_WARLOCK_AFFLICTION]="affliction";m[WH.dataEnv.CLASSIC][g.WARLOCK][this.ID_CLASSIC_WARLOCK_DEMONOLOGY]="demonology";m[WH.dataEnv.CLASSIC][g.WARLOCK][this.ID_CLASSIC_WARLOCK_DESTRUCTION]="destruction";m[WH.dataEnv.CLASSIC][g.WARRIOR]={};m[WH.dataEnv.CLASSIC][g.WARRIOR][this.ID_CLASSIC_WARRIOR_ARMS]="arms";m[WH.dataEnv.CLASSIC][g.WARRIOR][this.ID_CLASSIC_WARRIOR_FURY]="fury";m[WH.dataEnv.CLASSIC][g.WARRIOR][this.ID_CLASSIC_WARRIOR_PROTECTION]="protection";m[WH.dataEnv.TBC]=m[WH.dataEnv.CLASSIC];m[WH.dataEnv.MAIN]={};m[WH.dataEnv.MAIN][g.DEATH_KNIGHT]={};m[WH.dataEnv.MAIN][g.DEATH_KNIGHT][this.ID_DEATH_KNIGHT_BLOOD]="blood";m[WH.dataEnv.MAIN][g.DEATH_KNIGHT][this.ID_DEATH_KNIGHT_FROST]="frost";m[WH.dataEnv.MAIN][g.DEATH_KNIGHT][this.ID_DEATH_KNIGHT_UNHOLY]="unholy";m[WH.dataEnv.MAIN][g.DEMON_HUNTER]={};m[WH.dataEnv.MAIN][g.DEMON_HUNTER][this.ID_DEMON_HUNTER_HAVOC]="havoc";m[WH.dataEnv.MAIN][g.DEMON_HUNTER][this.ID_DEMON_HUNTER_VENGEANCE]="vengeance";m[WH.dataEnv.MAIN][g.DRUID]={};m[WH.dataEnv.MAIN][g.DRUID][this.ID_DRUID_BALANCE]="balance";m[WH.dataEnv.MAIN][g.DRUID][this.ID_DRUID_FERAL]="feral";m[WH.dataEnv.MAIN][g.DRUID][this.ID_DRUID_GUARDIAN]="guardian";m[WH.dataEnv.MAIN][g.DRUID][this.ID_DRUID_RESTORATION]="restoration";m[WH.dataEnv.MAIN][g.HUNTER]={};m[WH.dataEnv.MAIN][g.HUNTER][this.ID_HUNTER_BEAST_MASTERY]="beast-mastery";m[WH.dataEnv.MAIN][g.HUNTER][this.ID_HUNTER_MARKSMANSHIP]="marksmanship";m[WH.dataEnv.MAIN][g.HUNTER][this.ID_HUNTER_SURVIVAL]="survival";m[WH.dataEnv.MAIN][g.MAGE]={};m[WH.dataEnv.MAIN][g.MAGE][this.ID_MAGE_ARCANE]="arcane";m[WH.dataEnv.MAIN][g.MAGE][this.ID_MAGE_FIRE]="fire";m[WH.dataEnv.MAIN][g.MAGE][this.ID_MAGE_FROST]="frost";m[WH.dataEnv.MAIN][g.MONK]={};m[WH.dataEnv.MAIN][g.MONK][this.ID_MONK_BREWMASTER]="brewmaster";m[WH.dataEnv.MAIN][g.MONK][this.ID_MONK_MISTWEAVER]="mistweaver";m[WH.dataEnv.MAIN][g.MONK][this.ID_MONK_WINDWALKER]="windwalker";m[WH.dataEnv.MAIN][g.PALADIN]={};m[WH.dataEnv.MAIN][g.PALADIN][this.ID_PALADIN_HOLY]="holy";m[WH.dataEnv.MAIN][g.PALADIN][this.ID_PALADIN_PROTECTION]="protection";m[WH.dataEnv.MAIN][g.PALADIN][this.ID_PALADIN_RETRIBUTION]="retribution";m[WH.dataEnv.MAIN][g.PRIEST]={};m[WH.dataEnv.MAIN][g.PRIEST][this.ID_PRIEST_DISCIPLINE]="discipline";m[WH.dataEnv.MAIN][g.PRIEST][this.ID_PRIEST_HOLY]="holy";m[WH.dataEnv.MAIN][g.PRIEST][this.ID_PRIEST_SHADOW]="shadow";m[WH.dataEnv.MAIN][g.ROGUE]={};m[WH.dataEnv.MAIN][g.ROGUE][this.ID_ROGUE_ASSASSINATION]="assassination";m[WH.dataEnv.MAIN][g.ROGUE][this.ID_ROGUE_OUTLAW]="outlaw";m[WH.dataEnv.MAIN][g.ROGUE][this.ID_ROGUE_SUBTLETY]="subtlety";m[WH.dataEnv.MAIN][g.SHAMAN]={};m[WH.dataEnv.MAIN][g.SHAMAN][this.ID_SHAMAN_ELEMENTAL]="elemental";m[WH.dataEnv.MAIN][g.SHAMAN][this.ID_SHAMAN_ENHANCEMENT]="enhancement";m[WH.dataEnv.MAIN][g.SHAMAN][this.ID_SHAMAN_RESTORATION]="restoration";m[WH.dataEnv.MAIN][g.WARLOCK]={};m[WH.dataEnv.MAIN][g.WARLOCK][this.ID_WARLOCK_AFFLICTION]="affliction";m[WH.dataEnv.MAIN][g.WARLOCK][this.ID_WARLOCK_DEMONOLOGY]="demonology";m[WH.dataEnv.MAIN][g.WARLOCK][this.ID_WARLOCK_DESTRUCTION]="destruction";m[WH.dataEnv.MAIN][g.WARRIOR]={};m[WH.dataEnv.MAIN][g.WARRIOR][this.ID_WARRIOR_ARMS]="arms";m[WH.dataEnv.MAIN][g.WARRIOR][this.ID_WARRIOR_FURY]="fury";m[WH.dataEnv.MAIN][g.WARRIOR][this.ID_WARRIOR_PROTECTION]="protection";const l={icons:WH.getPageData("WH.Wow.PlayerClass.Specialization.icons"),names:WH.getPageData("WH.Wow.PlayerClass.Specialization.names")};this.getAll=function(){let result=[];g.getAll().forEach(function(o){result=result.concat(f.getByClass(o)||[])});return result};this.getByClass=function(o){let indexedSpecs=d();if(!indexedSpecs[o]){return undefined}let specIds=indexedSpecs[o].slice();specIds.sort(function(q,p){f.getName(q).localeCompare(f.getName(p))});return specIds};this.getByIndex=function(p,o){let indexedSpecs=d();return indexedSpecs[p]&&indexedSpecs[p][o]||undefined};this.getBySlug=function(o,p){let slugs=h();let classId=g.getBySlug(o);if(slugs[classId]){for(let specId in slugs[classId]){if(slugs[classId][specId]===p){return parseInt(specId)}}}return undefined};this.getIconName=function(o){return l.icons[o]};this.getId=function(p,o){let indexedSpecs=d();if(indexedSpecs[p]){for(let specIndex=0,specId;specId=indexedSpecs[p][specIndex];specIndex++){if(specIndex+1===o){return specId}}}else{WH.error("Tried to get a specialization ID from a non-existent class.",p,o)}WH.error("Could not get a specialization ID for this class and spec.",p,o);return undefined};this.getName=function(o){return l.names[o]};this.getNameWithClass=function(o){return WH.Strings.sprintf(WH.TERMS.specclass_format,f.getName(o),g.getName(g.getBySpec(o)))};this.getNumber=function(p,o){let indexedSpecs=d();if(indexedSpecs[p]){for(let specIndex=0;specIndex<indexedSpecs[p].length;specIndex++){if(o===indexedSpecs[p][specIndex]){return specIndex+1}}}WH.error("Could not get a specialization number for this class and spec.",p,o);return undefined};this.getSlug=function(p,o){return(h()[p]||{})[o]};function d(){return c[WH.getDataEnv()]||c[WH.getRootEnv()]}function h(){return m[WH.getDataEnv()]||m[WH.getRootEnv()]}};WH.ModelViewer=new function(){const w=this;const p=WH.Icon;const G=WH.Wow.Item;const l=WH.Wow.PlayerClass.Specialization;const N=WH.Tooltip;const X=WH.Url;this.ANIMATION_CHARACTER_CREATE_BFA="StandCharacterCreate";this.ANIMATION_CHARACTER_CREATE_SL="DressingRoom";this.LOCAL_STORAGE_LAST_MODEL="lastViewedModel";var aa=[181581];var C={};C[G.INVENTORY_TYPE_ONE_HAND]=G.INVENTORY_TYPE_MAIN_HAND;C[G.INVENTORY_TYPE_TWO_HAND]=G.INVENTORY_TYPE_MAIN_HAND;C[G.INVENTORY_TYPE_THROWN]=G.INVENTORY_TYPE_MAIN_HAND;C[G.INVENTORY_TYPE_RANGED_RIGHT]=G.INVENTORY_TYPE_MAIN_HAND;C[G.INVENTORY_TYPE_RANGED]=G.INVENTORY_TYPE_OFF_HAND;C[G.INVENTORY_TYPE_HELD_IN_OFF_HAND]=G.INVENTORY_TYPE_OFF_HAND;var h=[G.INVENTORY_TYPE_HEAD,G.INVENTORY_TYPE_SHOULDERS,G.INVENTORY_TYPE_SHIRT,G.INVENTORY_TYPE_CHEST,G.INVENTORY_TYPE_WAIST,G.INVENTORY_TYPE_LEGS,G.INVENTORY_TYPE_FEET,G.INVENTORY_TYPE_WRISTS,G.INVENTORY_TYPE_HANDS,G.INVENTORY_TYPE_ONE_HAND,G.INVENTORY_TYPE_SHIELD,G.INVENTORY_TYPE_RANGED,G.INVENTORY_TYPE_BACK,G.INVENTORY_TYPE_TWO_HAND,G.INVENTORY_TYPE_TABARD,G.INVENTORY_TYPE_ROBE,G.INVENTORY_TYPE_MAIN_HAND,G.INVENTORY_TYPE_OFF_HAND,G.INVENTORY_TYPE_HELD_IN_OFF_HAND,G.INVENTORY_TYPE_THROWN,G.INVENTORY_TYPE_RANGED_RIGHT];var ae=1;var af=2;var F=4;var ad=8;var A=16;var ah=32;var B=64;var Y=128;var u=256;var H=512;var S=1024;var J=[1819228];var f=[{name:WH.TERMS.hd,value:"true"},{name:WH.TERMS.sd,value:"false"}];const r={animationsLoaded:false,canTakeScreenshots:false,elements:{animationSelect:undefined,definition:undefined,gender:undefined,lightboxContent:undefined,race:undefined,screen:undefined},library:{},libraryLoadedCallbacks:{},ratio:16/9,resizeEventBound:false,shown:false};var g,W,ag=[],I,d,o,Z,P,T,D,K;this.applyDataEnv=function(ai,aj){ai.env=ai.dataEnv=ai.gameDataEnv=WH.getDataEnvTerm(aj)};this.canTakeScreenshots=function(){return!!r.canTakeScreenshots};this.getBackgroundFilename=function(){if(WH.Theme.isThottbot()){return"background-classic-ddd.png"}if(WH.Theme.isClassic()){return"background-classic-181818.png"}return"background-181818.png"};this.getBackgroundUrl=function(ai){return WH.staticUrl+w.getStaticBase(ai)+"/"+w.getBackgroundFilename()};this.getContentPath=function(ai){return""+(WH.isDev()?"https://wow.zamimg.com":WH.staticUrl)+w.getStaticBase(ai)+"/"};this.getEffectiveInventoryType=function(ai){return C[ai]||ai};this.getLibrary=function(ai){if(ai===undefined){ai=WH.getDataEnv()}return r.library[ai]};this.getStaticBase=function(ai){return"/modelviewer/"+WH.getDataEnvTerm(ai)};this.grabScreenshot=function(am,aj){if(!aj){aj="screenshot";if(g_pageInfo){if(g_pageInfo.name){aj=g_pageInfo.name}else{if(g_pageInfo.type&&g_types[g_pageInfo.type]){aj=g_types[g_pageInfo.type];if(g_pageInfo.typeId){aj+=" "+g_pageInfo.typeId}}}}}var ak=$(am.renderer.canvas)[0];var ai="fullscreenchange";var al;var an=function(ao){if(ao){document.removeEventListener(ai,al,false)}window.requestAnimationFrame(function(){am.renderer.makeDataURL=["image/png",1];window.requestAnimationFrame(function(){var ap=am.renderer.screenshotDataURL;var aq=WH.ce("a");aq.download=aj+".png";aq.href=ap;aq.style.display="none";WH.ae(document.body,aq);aq.click();if(document.exitFullscreen){document.exitFullscreen()}else{if(document.webkitExitFullscreen){document.webkitExitFullscreen()}else{if(document.mozCancelFullScreen){document.mozCancelFullScreen()}}}})})};if(ak.requestFullscreen){document.addEventListener(ai,al=an.bind(this,true),false);ak.requestFullscreen()}else{if(ak.webkitRequestFullscreen){ai="webkit"+ai;document.addEventListener(ai,al=an.bind(this,true),false);ak.webkitRequestFullscreen()}else{if(ak.mozRequestFullScreen){ai="moz"+ai;document.addEventListener(ai,al=an.bind(this,true),false);ak.mozRequestFullScreen()}else{an(false)}}}};this.isLibraryLoaded=function(ai){return w.getLibrary(ai)!==undefined};this.loadLibrary=function(al,ak){if(ak===undefined){ak=WH.getDataEnv()}if(w.isLibraryLoaded(ak)){if(al){window.requestAnimationFrame(al)}return}var aj=!!r.libraryLoadedCallbacks[ak];if(!aj){r.libraryLoadedCallbacks[ak]=[]}if(al){if(r.libraryLoadedCallbacks[ak].length>100){WH.error("Too many callbacks waiting for ZamModelViewer!")}else{r.libraryLoadedCallbacks[ak].push(al)}}if(aj){return}var ai=WH.ce("script");ai.src=w.getContentPath(ak)+"viewer/viewer.min.js";WH.aE(ai,"load",function(){if(window.ZamModelViewer){r.library[ak]=window.ZamModelViewer;delete window.ZamModelViewer}if(!w.isLibraryLoaded(ak)){WH.error("Model viewer script file was loaded, but ZamModelViewer is still undefined!");return}while(r.libraryLoadedCallbacks[ak].length){r.libraryLoadedCallbacks[ak].shift()()}});WH.aE(ai,"error",function(){WH.error("Failed to load ZamModelViewer JS")});WH.ae(WH.qs("head"),ai)};this.showLightbox=function(ai){Z=ai;Lightbox.show("modelviewer",{onShow:U,onHide:ab},ai)};this.supportsEnchantVisual=function(ai){switch(w.getEffectiveInventoryType(ai)){case G.INVENTORY_TYPE_MAIN_HAND:case G.INVENTORY_TYPE_OFF_HAND:return true}return false};this.supportsInventoryType=function(ai){return h.indexOf(parseInt(ai))>=0};function ac(){r.canTakeScreenshots=(g_user.roles&U_GROUP_STAFF)>0;r.canTakeScreenshots=r.canTakeScreenshots||(J.indexOf(g_user.id)>=0);Object.defineProperty(w,"canTakeScreenshots",{writable:false});WH.onLoad(M)}function R(aj,ai){return WH.inArray([G.INVENTORY_TYPE_SHIRT,G.INVENTORY_TYPE_CHEST,G.INVENTORY_TYPE_WAIST,G.INVENTORY_TYPE_LEGS,G.INVENTORY_TYPE_FEET,G.INVENTORY_TYPE_WRISTS,G.INVENTORY_TYPE_HANDS,G.INVENTORY_TYPE_BACK,G.INVENTORY_TYPE_TABARD,G.INVENTORY_TYPE_ROBE],aj)!==-1||aa.indexOf(ai)!==-1}function M(){if(location.hash&&location.hash.indexOf("#modelviewer")==0){var an=location.hash.split(":");if(an.length>=3){an.shift();var al=parseInt(an.shift());var ak={type:al,extendedHash:true};switch(al){case WH.Types.NPC:ak.displayId=parseInt(an.shift());var ai=parseInt(an.shift());if(ai==1){ak.humanoid=1}break;case WH.Types.OBJECT:ak.displayId=parseInt(an.shift());break;case WH.Types.ITEM:ak.displayId=parseInt(an.shift());ak.slot=parseInt(an.shift());break;case WH.Types.ITEM_SET:var am=an.shift();ak.equipList=am.split(";");break}if(ak.displayId||ak.equipList){w.showLightbox(ak)}}else{var aj=WH.ge("wh-mv-view-in-3d-button");if(aj){aj.click()}}}}function L(){if(!r.shown){return}let width;let height;if(window.innerWidth<767){width=r.elements.lightboxContent.offsetWidth;height=r.elements.lightboxContent.offsetHeight;r.elements.screen.style.width="100%";r.elements.screen.style.height="100%"}else{let padding=Math.min(100,window.innerWidth/10,window.innerHeight/10)*2;width=window.innerWidth-padding-Lightbox.UI_WIDTH;height=window.innerHeight-padding-Lightbox.UI_HEIGHT;let maxWidth=Math.round(height*(16/9));let maxHeight=Math.round(width*(9/16));if(width>maxWidth){width=maxWidth}else{if(height>maxHeight){height=maxHeight}}r.elements.screen.style.width=width+"px";r.elements.screen.style.height=height+"px"}if(width&&height){r.ratio=width/height;if(P){P.renderer.onResize(width,height,r.ratio)}}}function c(){return{race:r.elements.race.selectedIndex>=0?r.elements.race.options[r.elements.race.selectedIndex].value:"",gender:r.elements.gender.selectedIndex>=0?r.elements.gender.options[r.elements.gender.selectedIndex].value:0}}function z(ai,aj){return WH.Wow.Race.exists(ai)&&(aj===0||aj===1)}function O(){var ap=Z.dataEnv;if(!w.isLibraryLoaded(ap)){w.loadLibrary(O.bind(this),ap);return}var al=c();var ak=al.race;var am=al.gender;if(P){P.destroy()}var ao={type:w.getLibrary(ap).WOW,contentPath:w.getContentPath(ap),container:$(r.elements.screen),aspect:r.ratio,background:w.getBackgroundFilename(),models:{type:W,id:g}};if(K.hasOwnProperty("characterData")){if(K.characterData.race==ak&&K.characterData.gender==am){if(WH.Wow.Expansion.available(WH.Wow.Expansion.SL)){ao.charCustomization={race:K.characterData.race,gender:K.characterData.gender,options:K.characterData.charCustomization||[]}}else{ao.sk=K.characterData.skincolor;ao.ha=K.characterData.hairstyle;ao.hc=K.characterData.haircolor;ao.fa=K.characterData.facetype;ao.fh=K.characterData.features;ao.fc=K.characterData.haircolor;ao.ep=K.characterData.blindfolds;ao.ho=K.characterData.hornstyle;ao.ta=K.characterData.tattoos}ao.cls=K.characterData.charClass}if(WH.Wow.Expansion.available(WH.Wow.Expansion.SL)){ao.charCustomization=ao.charCustomization||{};if(K.characterData.hasOwnProperty("sheathMain")){ao.charCustomization.sheathMain=K.characterData.sheathMain}if(K.characterData.hasOwnProperty("sheathOff")){ao.charCustomization.sheathOff=K.characterData.sheathOff}}else{if(K.characterData.hasOwnProperty("sheathMain")){ao.sheathMain=K.characterData.sheathMain}if(K.characterData.hasOwnProperty("sheathOff")){ao.sheathOff=K.characterData.sheathOff}}}if((W==ad||W==ah||W==A)&&ag.length){var an=[];ag=[].concat.apply([],ag);for(var aj=0;aj<ag.length;aj+=2){an.push([ag[aj],ag[aj+1]])}ao.items=an}if(I){ao.link=I}if(d){ao.label=d}if(WH.isClassicTree()||WH.isBurningCrusadeTree()){ao.hd=false}else{ao.hd=true}if(w.canTakeScreenshots()&&WH.getGets().modelViewerTransparency!==undefined){ao.transparent=true;delete ao.background;r.elements.screen.style.backgroundImage='url("'+w.getBackgroundUrl(ap)+'")'}w.applyDataEnv(ao,ap);WH.debug("Creating ZamModelViewer with these options:",JSON.stringify(ao),ao);w.viewer=P=new(w.getLibrary(ap))(ao);w.viewer.setAdaptiveMode(true);if(!r.resizeEventBound){WH.aE(window,"resize",L);r.resizeEventBound=true}L();if(!Z.noPound){var ai="#modelviewer";if(Z.extendedHash||!WH.ge("wh-mv-view-in-3d-button")){switch(Z.type){case WH.Types.NPC:ai+=":"+Z.type+":"+Z.displayId+":"+(Z.humanoid|0);break;case WH.Types.OBJECT:ai+=":"+Z.type+":"+Z.displayId;break;case WH.Types.ITEM:ai+=":"+Z.type+":"+Z.displayId+":"+(Z.slot|0);break;case WH.Types.ITEM_SET:ai+=":"+Z.type+":"+ag.join(";");break;case WH.Types.TRANSMOG_SET:case WH.Types.OUTFIT:case WH.Types.GEAR_SET:ai+=":"+Z.type+":"+ag.join(";");break}}if(ak&&am){ai+=":"+ak+"+"+am}else{ai+=":"}WH.ee(r.elements.animationSelect);WH.ae(r.elements.animationSelect,WH.ce("option",{value:0},WH.ct(WH.TERMS.loading_ellipsis)));r.animationsLoaded=false;V();location.replace(WH.rtrim(ai,":"))}}function E(){var al=c();var ak=al.race;var am=al.gender;if(!ak){if(r.elements.gender.style.display==="none"){return}WH.displayNone(r.elements.gender);g=ag[1];switch(Z.slot){case 1:W=af;break;case 3:W=F;break;default:W=ae}}else{if(r.elements.gender.style.display==="none"){WH.displayInline(r.elements.gender)}var aj=WH.Wow.Race.getIdString(ak);var ai=WH.Wow.getGenderString(am);if(aj&&ai){g=aj+ai;W=A}WH.LocalStorage.set("defaultModel",JSON.stringify({race:parseInt(ak),gender:parseInt(am)}))}t();O()}function v(){let animation=r.elements.animationSelect.value;if(animation&&P&&P.method("isLoaded")){WH.debug("Setting model viewer animation to:",animation);P.method("setAnimation",animation)}}function V(){if(r.animationsLoaded){return}if(!P||!P.method("isLoaded")){setTimeout(function(){V()},100);return}WH.ee(r.elements.animationSelect);let animations=[];let animationCount=P.method("getNumAnimations");for(let i=0;i<animationCount;i++){let animation=P.method("getAnimation",i);if(animation&&!animations.includes(animation)){animations.push(animation)}}animations.sort();animations.forEach(function(ai){WH.ae(r.elements.animationSelect,WH.ce("option",{value:ai},WH.ct(ai)))});r.animationsLoaded=true}function m(ai,al,aj,ak){WH.arrayWalk(ai,function(an){an.checked=false;if(an){var am=Menu.getSubmenu(an);if(am){WH.arrayWalk(am,function(ao){ao.checked=false})}}});al.checked=true;aj.checked=true;ag[1]=ak;g=ak;if(c().race){E()}else{O()}}function q(al,ak,aj,ai,am){g=aj;o=ak[MENU_IDX_NAME];$(ai).text(am);O()}function t(){var ak=[];switch(K.type){case WH.Types.ITEM_SET:case WH.Types.TRANSMOG_SET:case WH.Types.OUTFIT:case WH.Types.GEAR_SET:if(K.itemData){for(var ai in K.itemData){ak.push({itemId:K.itemData[ai][0],itemBonus:K.itemData[ai][1],slot:K.itemData[ai][2]})}}break}if(ak.length>0){if(K.characterData){let charData=$.extend({},K.characterData);charData.date=(new Date()).getTime();if(!charData["class"]&&charData.charClass){charData["class"]=charData.charClass;delete charData.charClass}if(Array.isArray(charData.charCustomization)){charData.charCustomization.forEach(function(al){if(al.optionSlug){charData[al.optionSlug]=al.choiceId}});delete charData.charCustomization}ak.push(charData)}else{var aj=c();aj.date=(new Date()).getTime();ak.push(aj)}WH.LocalStorage.set(w.LOCAL_STORAGE_LAST_MODEL,JSON.stringify(ak))}}function Q(an,ai){var ap=-1;var au=-1;if(ai.race!=null&&ai.gender!=null){ap=ai.race;au=ai.gender;T.hide();an=false}else{T.show()}if(ai.hasOwnProperty("characterData")&&ai.characterData.hasOwnProperty("race")){ap=ai.characterData.race}if(ai.hasOwnProperty("characterData")&&ai.characterData.hasOwnProperty("gender")){au=ai.characterData.gender}if(ap===-1&&au===-1){if(location.hash){var am=location.hash.match(/modelviewer:.*?([0-9]+)\+([0-9]+)/);if(am){if(z(am[1],am[2])){ap=am[1];au=am[2];WH.displayInline(r.elements.gender)}}}}r.elements.race.options[0].hidden=!an;r.elements.race.options[0].disabled=!an;if(an){r.elements.race.selectedIndex=0;if(au===-1){WH.displayNone(r.elements.gender)}}else{if(ap===-1&&au===-1){var aj=WH.Wow.Race.ID_HUMAN;var av=WH.Wow.GENDER_MALE;if(g_user&&g_user.settings&&g_user.settings.defaultModel){aj=g_user.settings.defaultModel.race;av=g_user.settings.defaultModel.gender-1}else{var ak=WH.LocalStorage.get("defaultModel");if(ak){ak=JSON.parse(ak);if(ak.race){aj=ak.race;av=ak.gender}}}aj=ai.defaultRace||aj;if(z(aj,av)){ap=aj;au=av}else{ap=WH.Wow.Race.ID_HUMAN;au=WH.Wow.GENDER_MALE}}WH.displayInline(r.elements.gender)}if(au!==-1){r.elements.gender.selectedIndex=au}if(ap!==-1&&au!==-1){var at=WH.Wow.Race.getIdString(ap);var aq=WH.Wow.getGenderString(au);if(at&&aq){g=at+aq;W=A;for(var al,ao=0;al=r.elements.race.options[ao];ao++){if(al.value==ap){r.elements.race.selectedIndex=ao}}for(var al,ao=0;al=r.elements.gender.options[ao];ao++){if(al.value==au){r.elements.gender.selectedIndex=ao}}}}}function ab(){r.shown=false;if(!Z.noPound){if(!Z.fromTag&&D&&D.indexOf("modelviewer")==-1){WH.setHash(D)}else{WH.clearHash()}}if(P){P.destroy()}if(Z.onHide){Z.onHide()}}function U(aw,ap,aj){K=aj;r.shown=true;if(ap){aw=$(aw);aw.addClass("has-lightbox-caption modelviewer");r.elements.screen=WH.ce("div",{className:"modelviewer-screen"});r.elements.lightboxContent=WH.ce("div",{className:"lightbox-content modelviewer-modelbg"});WH.ae(r.elements.lightboxContent,r.elements.screen);aw.append(r.elements.lightboxContent);let fullscreen=WH.ce("a",{className:"fa fa-arrows-alt",href:"javascript:"});WH.aE(fullscreen,"click",function(){P.setFullscreen(true)});N.simple(fullscreen,WH.TERMS.fullscreen,"q2",true);WH.ae(r.elements.screen,fullscreen);let pause=WH.ce("a",{className:"fa fa-pause",href:"javascript:"});WH.aE(pause,"click",function(){P.method("setAnimPaused",this.classList.contains("fa-pause"));this.classList.toggle("fa-play");this.classList.toggle("fa-pause");let text=this.classList.contains("fa-pause")?WH.TERMS.pause:WH.TERMS.play;N.show(this,text,undefined,undefined,"q2")});N.simple(pause,function(){return this.classList.contains("fa-pause")?WH.TERMS.pause:WH.TERMS.play},"q2",true);WH.ae(r.elements.screen,pause);L();let animationWrapper=WH.ce("div",{className:"modelviewer-animation"});WH.ae(animationWrapper,WH.ce("var",undefined,WH.ct(WH.TERMS.animation)));r.elements.animationSelect=WH.ce("select");WH.ae(r.elements.animationSelect,WH.ce("option",{value:0},WH.ct(WH.TERMS.loading_ellipsis)));WH.aE(r.elements.animationSelect,"change",v);WH.ae(animationWrapper,r.elements.animationSelect);V();aw.append(animationWrapper);aw.append($("<a/>",{"class":"dialog-option fa fa-times",href:"javascript:",click:Lightbox.hide,text:WH.TERMS.close}));aw.append($("<a/>",{"class":"dialog-option fa fa-question",href:"/help=modelviewer",target:"_blank",text:WH.TERMS.help}));if(w.canTakeScreenshots()){aw.append($("<a/>",{"class":"dialog-option fa fa-camera",href:"javascript:",click:function(){w.grabScreenshot(P)},text:WH.TERMS.screenshot}));let transparencyToggle=WH.ce("a",{className:"dialog-option fa"},WH.ct("Transparency"));aw.append(transparencyToggle);if(WH.getGets().modelViewerTransparency===undefined){transparencyToggle.classList.add("fa-square");WH.aE(transparencyToggle,"click",function(){location.href=X.modifyUrlQuery(location.href,function(aI){aI.modelViewerTransparency=""})})}else{transparencyToggle.classList.add("fa-check-square","fa-color-white");WH.aE(transparencyToggle,"click",function(){location.href=X.modifyUrlQuery(location.href,function(aI){delete aI.modelViewerTransparency})})}}if(aj.modelTileUrl){aw.append($("<a/>",{"class":"dialog-option fa fa-th-large",href:aj.modelTileUrl,text:"Tile"}))}if(aj.itemData){let slots=WH.ce("div",{className:"modelviewer-slots"});let modelViewerSlotsLeft=WH.ce("div",{className:"modelviewer-slots-left"});let modelViewerSlotsRight=WH.ce("div",{className:"modelviewer-slots-right"});let modelViewerSlotsBottom=WH.ce("div",{className:"modelviewer-slots-bottom"});WH.ae(slots,modelViewerSlotsLeft);WH.ae(slots,modelViewerSlotsRight);WH.ae(slots,modelViewerSlotsBottom);WH.ae(r.elements.screen,slots);r.elements.screen.dataset.dressingRoomButton="true";WH.ae(slots,WH.ce("a",{className:"btn btn-site btn-small modelviewer-dressing-room-link fa fa-male",href:"/dressing-room",text:WH.TERMS.openindressingroom}));let slotIcons={};for(let i=0,slot;slot=g_character_slots_data[i];++i){let slotName=slot.name==="back"?"chest":slot.name;slotIcons[slot.id]=p.create("inventoryslot_"+slotName,p.MEDIUM,"javascript:");slotIcons[slot.id].classList.add("modelviewer-slots-noicon");if(slot.noModel){slotIcons[slot.id].style.visibility="hidden"}WH.ae(i<8?modelViewerSlotsLeft:(i<16?modelViewerSlotsRight:modelViewerSlotsBottom),slotIcons[slot.id])}let icon;for(let i=0,itemData;itemData=aj.itemData[i];i++){if(icon=slotIcons[itemData[2]]){p.setName(icon,p.MEDIUM,g_items.getIcon(itemData[0],itemData[1]).toLowerCase());icon.classList.remove("modelviewer-slots-noicon");icon.style.visibility=""}}}T=$("<div/>",{"class":"modelviewer-model"});var ak=WH.Wow.Race.getPlayableRaceIds();r.elements.race=WH.ce("select");T.append(r.elements.race);WH.aE(r.elements.race,"change",E);WH.ae(r.elements.race,WH.ce("option"));for(let i=0,len=ak.length;i<len;++i){WH.ae(r.elements.race,WH.ce("option",{value:ak[i],text:WH.Wow.Race.getName(ak[i])}))}r.elements.gender=WH.ce("select");T.append(r.elements.gender);WH.aE(r.elements.gender,"change",E);WH.ae(r.elements.gender,WH.ce("option",{value:0,text:WH.Wow.getGenderName(0)}));WH.ae(r.elements.gender,WH.ce("option",{value:1,text:WH.Wow.getGenderName(1)}));WH.displayNone(r.elements.gender);var ay=K.artifact&&!$.isEmptyObject(K.artifact);var aG=$("<a>"+WH.TERMS.artifactappearances+"</a>");aG.get(0).style.marginLeft="5px";if(ay){var aF=g_items[K.typeId];var aC=[];for(let i in K.artifact){var ax=K.artifact[i];if(!$.isEmptyObject(ax)){var ai=[i,ax["1"]?ax["1"].setname:""];var az=[];var aA=false;for(let j in ax){var aH=ax[j].mod;if(aF.appearances&&aF.appearances[aH]&&aF.appearances[aH][0]){var at=ax[j].swatchrgb;var aD=WH.ce("span");aD.className="artifact-appearance";aD.style.backgroundColor="rgba("+WH.sprintf("$1,$2,$3,1",(at>>16)&255,(at>>8)&255,at&255)+")";var au=[j,aD];au[MENU_IDX_URL]=m.bind(this,aC,ai,au,aF.appearances[aH][0]);az.push(au);if(aF.appearances[aH][0]==aj.displayId){az[az.length-1].checked=true;aA=true}}}Menu.setSubmenu(ai,az);ai.checked=aA;aC.push(ai)}}Menu.add(aG,aC)}var ao=K.specVariants&&!$.isEmptyObject(K.specVariants);var al=$("<a>",{text:WH.TERMS.specializationvariants});al.get(0).style.marginLeft="5px";if(ao){var aC=[];for(let i in K.specVariants){var av=K.specVariants[i];var aB=WH.ce("span");aB.className="spec-variant";aB.innerHTML=av.specName;var am=[i,aB];am[MENU_IDX_URL]=q.bind(this,aC,am,av.modelId,al,av.specName);am[MENU_IDX_OPT]={tinyIcon:WH.staticUrl+"/images/wow/icons/tiny/"+l.getIconName(av.specId)+".gif",checkedFunc:function(aI){return aI[MENU_IDX_NAME]==o}};if(av.modelId==aj.displayId){$(al).text(av.specName);o=i}aC.push(am)}Menu.add(al,aC)}if(ay){T.append("<br>");T.append(aG)}aw.append(T);if(ao){aw.append("<br>");aw.append(al)}var aD=$("<div/>",{"class":"modelviewer-instructions"});aD.append(WH.TERMS.modelviewercontrols_tip);aw.append(aD);var aE=$("<div/>",{id:"modelviewer-msg","class":"sub",css:{display:"none","margin-top":"-6px",color:"#ccc","font-size":"13px"}});aw.append(aE);if(WH.isSet("g_user")&&g_user.id){$.ajax({url:"/website-achievement-explored",data:{trigger:"modelviewer"},success:function(){AchievementCheck()},type:"POST"})}}switch(aj.type){case WH.Types.NPC:T.hide();if(aj.humanoid){W=ah}else{W=ad}if(aj.equipList){ag=aj.equipList}g=aj.displayId;break;case WH.Types.OBJECT:T.hide();W=B;g=aj.displayId;break;case WH.Types.ITEM:case WH.Types.ITEM_SET:case WH.Types.TRANSMOG_SET:case WH.Types.OUTFIT:case WH.Types.GEAR_SET:if(aj.type==WH.Types.ITEM){ag=[aj.slot,aj.displayId]}else{ag=aj.equipList}if(ag.length>2||R(ag[0],ag[1])||(WH.inArray([WH.Types.TRANSMOG_SET,WH.Types.OUTFIT,WH.Types.GEAR_SET],aj.type)>=0&&ag.length>1)){Q(false,aj)}else{switch(ag[0]){case 1:W=af;break;case 3:W=F;break;default:W=ae}g=ag[1];Q(true,aj)}break}if(aj.fileId){T.hide();W=u;g=aj.fileId}setTimeout(O,1);var an=$("#modelviewer-msg");if(aj.message&&an.length>0){an.html(aj.message);an.show()}else{an.hide()}if(aj.link){I=aj.link}if(aj.label){d=aj.label}var aq="";if(aj.fromTag){aq+="Custom ";switch(aj.type){case WH.Types.NPC:aq+="NPC "+aj.displayId+(aj.humanoid?" humanoid":"");break;case WH.Types.OBJECT:aq+="Object "+aj.displayId;break;case WH.Types.ITEM:aq+="Item "+aj.displayId+" Slot "+(aj.slot|0);break;case WH.Types.ITEM_SET:aq+="Item set "+ag.join(".");break;case WH.Types.TRANSMOG_SET:aq+="Transmog set "+ag.join(".");break;case WH.Types.OUTFIT:aq+="Outfit "+ag.join(".");break;case WH.Types.GEAR_SET:aq+="Gear set "+ag.join(".");break}}else{switch(aj.type){case WH.Types.NPC:aq+="NPC "+(aj.typeId?aj.typeId:" DisplayID "+aj.displayId);break;case WH.Types.OBJECT:aq+="Object "+aj.typeId;break;case WH.Types.ITEM:aq+="Item "+aj.typeId;break;case WH.Types.ITEM_SET:aq+="Item set "+ag.join(".");break;case WH.Types.TRANSMOG_SET:aq+="Transmog set "+ag.join(".");break;case WH.Types.OUTFIT:aq+="Outfit "+ag.join(".");break;case WH.Types.GEAR_SET:aq+="Gear set "+ag.join(".");break}}WH.Track.interactiveEvent("Model Viewer","Show",WH.Strings.slug(aq));D=location.hash;t()}ac()};