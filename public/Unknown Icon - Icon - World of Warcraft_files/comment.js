Listview.funcBox.coFlagUpOfDate=function(c){var a=c.commentCell.find(".comment-notification");var b=c.user==g_user.name||((g_user.roles&(U_GROUP_ADMIN|U_GROUP_MODERATOR))!=0);if(!b){return}if(confirm("Mark comment "+c.id+" as up to date?")){c.container.removeClass("comment-outofdate");$.post("/comment=out-of-date",{id:c.id,remove:1},function(d){if(d=="ok"){MessageBox(a,WH.TERMS.uptodateresponse)}else{MessageBox(a,"Error: "+d)}})}return};Listview.funcBox.coFlagOutOfDate=function(d){var a=d.commentCell.find(".comment-notification");var b=d.user==g_user.name||((g_user.roles&(U_GROUP_ADMIN|U_GROUP_MODERATOR))!=0);if(b){if(confirm("Mark comment "+d.id+" as out of date?")){d.container.addClass("comment-outofdate");$.post("/comment=out-of-date",{id:d.id},function(e){if(e=="ok"){MessageBox(a,WH.TERMS.outofdateresponse)}else{MessageBox(a,"Error: "+e)}})}return}var c=null;while(true){c=prompt(WH.TERMS.outofdate_tip);if(c==null||c==false){return}else{if(c.toString().length>0){break}}alert(WH.TERMS.youmustprovideareason_stc)}$.post("/comment=out-of-date",{id:d.id,reason:c},function(e){if(e=="ok"){MessageBox(a,WH.TERMS.outofdateresponsequeued)}else{MessageBox(a,"Error: "+e)}})};Listview.funcBox.coDelete=function(c){var b=c.user==g_user.name||((g_user.roles&(U_GROUP_ADMIN|U_GROUP_MOD|U_GROUP_BUREAU))!=0);var a=c.commentCell.find(".comment-notification");if(b){if(!confirm(WH.TERMS.deletecomment_tip)){return}$.post("/comment=delete",{id:c.id});if(!c.commentv2){this.deleteRows([c]);return}c.container.addClass("comment-deleted");MessageBox(a,WH.TERMS.commentdeleted_tip);c.deletedInfo=[WH.getServerTime(),g_user.name];c.deleted=true;Listview.templates.comment.updateCommentCell.call(this,c);WH.Tooltip.hide();return}};Listview.funcBox.coUndelete=function(c){var b=c.user==g_user.name||((g_user.roles&(U_GROUP_ADMIN|U_GROUP_MOD))!=0);var a=c.commentCell.find(".comment-notification");if(confirm(WH.TERMS.votetoundelete_tip)){$.post("/comment=undelete",{id:c.id});if(b){MessageBox(a,"This comment has been restored.");if(c.commentv2){c.container.removeClass("comment-deleted");c.deletedInfo=null;c.deleted=false;Listview.templates.comment.updateCommentCell.call(this,c);WH.Tooltip.hide()}}else{MessageBox(a,WH.TERMS.votedtodelete_tip)}}};Listview.funcBox.coSortNewestFirst=function(a){WH.setCookie("comments_sort",1000,"1","/",".wowhead.com");$(a).parent().find("a.selected").removeClass("selected");a.className="selected";this.mainDiv.className+=" listview-aci";this.setSort([-5,4,6,-7,-1,-2],true,false)};Listview.funcBox.coSortOldestFirst=function(a){WH.setCookie("comments_sort",1000,"2","/",".wowhead.com");$(a).parent().find("a.selected").removeClass("selected");a.className="selected";this.mainDiv.className+=" listview-aci";this.setSort([-5,4,6,7,1,2],true,false)};Listview.funcBox.coSortHighestRatedFirst=function(a){WH.setCookie("comments_sort",1000,"3","/",".wowhead.com");$(a).parent().find("a.selected").removeClass("selected");a.className="selected";this.mainDiv.className=this.mainDiv.className.replace("listview-aci","");this.setSort([-5,4,6,-3,7],true,false)};Listview.funcBox.coFilterByPatchVersion=function(a){this.minPatchVersion=a.value;this.refreshRows()};Listview.templates.comment={sort:[-5,4,6,-3,7],mode:Listview.MODE_DIV,nItemsPerPage:40,hash:Listview.HASH_SIMPLE,alternateVersions:undefined,columns:[{value:"number"},{value:"id"},{value:"rating"},{value:"deleted"},{value:"sticky"},{value:"outofdate"},{value:"date",sortFunc:function(d,c){try{return Math.sign(Date.parse(d.date)-Date.parse(c.date))}catch(f){return(d.date||"").localeCompare(c.date||"")}}}],compute:function(h,g,c){var b=$("<div></div>");var e=(!this.alternateVersions)&&h.__minPatch&&((h.__minPatch.substr(0,1)!="-"&&h.__minPatch>new Date(h.date))||(h.__minPatch.substr(0,1)=="-"&&h.__minPatch!="-"+h.dataTree));h.locale=this.id=="english-comments"?LOCALE_ENUS:Locale.getId();b.append('<table><tr><td class="vote-column"><p class="upvote"><span class="fa fa-chevron-up"></span></p><div class="rating-container"></div><p class="downvote"><span class="fa fa-chevron-down"></span></p><p class="comment-sticky" title="'+WH.TERMS.stickycomment_tip+'">STICKY</p></td><td class="comment-content-column"><div class="comment-header"><table><tr><td class="comment-author"></td><td class="comment-controls"></td><td class="comment-notification"></td></tr></table></div><div class="text comment-body" lang="'+Locale.getCode(h.locale)+'"></div><div class="comment-replies"></div><p class="comment-replies-control" style="display: none"></p></td></tr></table>');h.colorClass="comment"+(c%2);b.addClass("comment").addClass(h.colorClass);if(h.rating<WH.Comments.LOW_RATING_THRESHOLD){b.addClass("comment-very-low-rating")}if(h.deleted){b.addClass("comment-deleted")}if(h.outofdate){b.addClass("comment-outofdate")}h.container=b;h.voteCell=b.find(".vote-column");h.commentCell=b.find(".comment-content-column");h.repliesCell=b.find(".comment-replies");h.repliesControl=b.find(".comment-replies-control");h.headerCell=b.find(".comment-header");h.commentBody=b.find(".comment-body");h.commentAuthor=b.find(".comment-author");h.commentControls=b.find(".comment-controls");this.template.updateVoteCell.call(this,h);this.template.updateCommentCell.call(this,h);this.template.updateStickyStatus.call(this,h);this.template.updateReplies.call(this,h);if(h.deleted||h.rating<WH.Comments.LOW_RATING_THRESHOLD){h.headerCell.bind("click",function(){h.container.toggleClass("comment-expanded")})}var a=$(g);a.addClass("comment-wrapper").html(b);if(h.imported){var d=WH.ce("span",{className:"comment-author-source-imported",dataset:{importedSite:h.user}});var f=WH.ce("span",{className:"comment-author-source-imported-title"},WH.ct(h.user));d.innerHTML=WH.TERMS.fromSite_format.replace("%s",f.outerHTML);h.commentAuthor.prepend(d);g.classList.add("comment-wrapper-imported")}if(e){a.hide()}else{a.show()}},updateReplies:function(d){this.template.updateRepliesCell.call(this,d);this.template.updateRepliesControl.call(this,d);WH.CommentReplies.setupReplies(d.container,d,this);if(!d.alreadyLoadedBefore){d.alreadyLoadedBefore=true;var c=location.hash.match("#comments:id=([0-9]+):reply=([0-9]+)");if(c){var b=c[1];var a=c[2];if(d.id==b){this.template.highlightReply.call(this,d,a)}}}},highlightReply:function(g,b,c){var e=null;for(var a in g.replies){if(g.replies[a].id==b){e=g.replies[a];break}}if(!e){if(c){return}$.ajax({type:"GET",url:"/comment/show-replies",data:{id:g.id},success:function(h){g.replies=h;Listview.templates.comment.updateReplies(g);Listview.templates.comment.highlightReply(g,b,true)},dataType:"json"});return}var d=g.repliesCell.find(".comment-reply-row[data-replyid="+b+"]");var f="#242424";if(g.deleted){f="#402424"}else{if(g.outofdate){f="#322C1C"}}d.css("background-color","#581111")},updateStickyStatus:function(a){if(a.sticky){a.voteCell.find(".comment-sticky").show()}else{a.voteCell.find(".comment-sticky").hide()}},updateRepliesCell:function(h){var b=h.repliesCell;var n=$("<table></table>");b.html("");if(!h.replies.length){b.append(n).hide();return}for(var f=0;f<h.replies.length;++f){var d=h.replies[f];var o=$('<tr class="comment-reply-row"><td class="reply-controls"><p class="reply-upvote"><span class="fa fa-chevron-up"></span></p><p class="reply-rating"></p><p class="reply-downvote"><span class="fa fa-chevron-down"></span></p></td><td class="reply-text"></td></tr>');var p=$('<p class="comment-reply-author"></p>');var m=$("<a></a>");let replyBody=WH.ce("div",{className:"comment-reply-body"});replyBody.setAttribute("lang",Locale.getCode(h.locale));var e=new Date(d.creationdate);var l=(WH.getServerTime()-e)/1000;var k=o.find(".reply-upvote");var j=o.find(".reply-downvote");var a=(g_user.name==d.username)||(g_user.roles&U_GROUP_COMMENTS_MODERATOR)!=0;var c=a;if(d.deleted){o.addClass("comment-reply-row-deleted");o.bind("click",function(){this.classList.remove("comment-reply-row-deleted")})}else{if(d.rating<WH.Comments.LOW_RATING_THRESHOLD){o.addClass("comment-reply-row-very-low-rating");o.bind("click",function(){this.classList.remove("comment-reply-row-very-low-rating")})}}o.attr("data-replyid",d.id);o.attr("data-idx",f);o.find(".reply-text").addClass(WH.User.getCommentRoleClass(d.roles,d.username));var g=$("<a></a>");g.text(WH.formatDate(null,l,e));g.attr("href","#comments:id="+h.id+":reply="+d.id);g.attr("id","comments:id="+h.id+":reply="+d.id);g.addClass("when");if(!d.imported){m.attr("href","/user="+d.username);m.text(d.username);p.append(m)}else{o.addClass("reply-imported");o.get(0).dataset.importedSite=d.username;p.append(WH.ct(d.importedAuthor))}p.append(" ").append(g).append(" ");if(d.dataTree==WH.dataTree.RETAIL||d.imported){p.append(WH.sprintf(WH.TERMS.patchparens_format,WH.Wow.getVersionStringFromTimestamp(e,this.alternateVersions)))}else{p.append(WH.TERMS.openparenthesis_punct+WH.TERMS[WH.dataTreeTerm[d.dataTree]]+WH.TERMS.closedparenthesis_punct)}WH.Comments.appendImportedSubject(p,d.importedSubject);WH.ae(replyBody,WH.markup.getDomFragment(d.body,{allow:WH.markup.CLASS.USER,mode:WH.markup.MODE.REPLY,roles:0,locale:h.locale,disabledEnvironments:d.markupDisabledEnvironments}));if(g_user.canUpvote&&g_user.name!==d.username&&!d.reportedByUser){WH.ae(replyBody,WH.ct(" "));WH.ae(replyBody,WH.ce("span",{className:"reply-report",dataset:{simpleTooltip:WH.TERMS.reportthisreply_stc}},WH.ce("span",{className:"fa fa-warning"})))}if(c){WH.ae(replyBody,WH.ct(" "));WH.ae(replyBody,WH.ce("span",{className:"reply-edit",dataset:{simpleTooltip:WH.TERMS.editthisreply_stc}},WH.ce("span",{className:"fa fa-pencil"})))}if(a){WH.ae(replyBody,WH.ct(" "));WH.ae(replyBody,WH.ce("span",{className:"reply-delete",dataset:{simpleTooltip:WH.TERMS.deletethisreply_stc}},WH.ce("span",{className:"fa fa-times"})))}o.find(".reply-text").append(p).append(replyBody);o.find(".reply-rating").text(d.rating);if(d.votedByUser){k.attr("data-hasvoted","true")}if(g_user.canUpvote&&g_user.name!=d.username&&!d.votedByUser&&!d.downvotedByUser){k.attr("data-canvote","true")}if(d.downvotedByUser){j.attr("data-hasvoted","true")}if(g_user.canDownvote&&g_user.name!=d.username&&!d.votedByUser&&!d.downvotedByUser){j.attr("data-canvote","true")}n.append(o)}b.html(n)},updateRepliesControl:function(c){var b=c.repliesControl;b.html("").hide().unbind().attr("class","comment-replies-control");var a=Math.max(c.nreplies-c.replies.length,0);if((c.deleted||c.outofdate||c.rating<WH.Comments.LOW_RATING_THRESHOLD)||(!g_user.canPostReplies&&!a)){return}if(g_user.canPostReplies){if(!a){b.text(WH.TERMS.addreply_stc).addClass("add-reply")}else{b.text(WH.sprintf(a==1?WH.TERMS.addshow1morereply_stc:WH.TERMS.addshowmorereplies_format,a)).addClass("show-more-replies")}}else{b.text(WH.sprintf(a==1?WH.TERMS.show1morereply_stc:WH.TERMS.showmorereplies_format,a)).addClass("show-more-replies")}b.addClass("btn btn-small");b.show()},updateCommentCell:function(a){a.commentCell.find(".comment-edit").remove();this.template.updateCommentBody.call(this,a,a.commentBody);this.template.updateCommentAuthor.call(this,a,a.commentAuthor);this.template.updateCommentControls.call(this,a,a.commentControls)},updateCommentAuthor:function(e,c){var d=g_users[e.user];var b=new Date(e.date);var a=(WH.getServerTime()-b)/1000;c.html("");c.append(WH.TERMS.by);if(!e.imported){c.append(WH.sprintf('<a href="/user=$1">$2</a>',e.user,e.user));if(d){c.append(WH.getReputationPlusAchievementText(d.gold,d.silver,d.copper,d.reputation))}}else{c.append(WH.ct(e.importedAuthor))}c.append(WH.sprintf(' <a class="q0" id="comments:id=$1" href="#comments:id=$2">$3</a>',e.id,e.id,WH.formatDate(null,a,b)));if(e.dataTree==WH.dataTree.RETAIL||e.imported){c.append(WH.sprintf(WH.TERMS.patchparens_format,WH.Wow.getVersionStringFromTimestamp(b,this.alternateVersions)))}else{c.append(" "+WH.TERMS.openparenthesis_punct+WH.TERMS[WH.dataTreeTerm[e.dataTree]]+WH.TERMS.closedparenthesis_punct)}WH.Comments.appendImportedSubject(c,e.importedSubject)},updateCommentControls:function(g,b){var j=[];var c=(g_user.roles&U_GROUP_COMMENTS_MODERATOR)!=0||(g.user.toLowerCase()==g_user.name.toLowerCase()&&!g_user.commentban);var a=(g_user.roles&U_GROUP_COMMENTS_MODERATOR)!=0||(g.user.toLowerCase()==g_user.name.toLowerCase()&&!g_user.commentban);var h=(g_user.roles&U_GROUP_COMMENTS_MODERATOR)!=0;if(c){if(!g.outofdate&&!g.deleted){j.push({extraClass:"fa fa-pencil",name:WH.TERMS.edit,func:WH.Comments.edit.bind(this,g,WH.Comments.EDIT_MODE_EDIT_COMMENT,false)})}}if(a&&!g.deleted){j.push({extraClass:"fa fa-times delete",name:WH.TERMS["delete"],func:Listview.funcBox.coDelete.bind(this,g)})}if(h&&g.deleted){j.push({extraClass:"fa fa-times undelete",name:WH.TERMS.undelete,func:Listview.funcBox.coUndelete.bind(this,g)})}if(WH.isRetailTree()){if(h&&g.outofdate){j.push({extraClass:"fa fa-clock-o uptodate",name:WH.TERMS.uptodate,func:Listview.funcBox.coFlagUpOfDate.bind(this,g)})}if(g_user.id!=0&&!g.outofdate&&!g.deleted){j.push({extraClass:"fa fa-clock-o outofdate",name:WH.TERMS.outofdate,func:Listview.funcBox.coFlagOutOfDate.bind(this,g)})}}if(h&&!g.sticky&&!g.outofdate&&!g.deleted){j.push({extraClass:"fa fa-thumb-tack sticky",name:"Sticky",func:this.template.sticky.bind(this,g)})}if(h&&g.sticky&&!g.outofdate&&!g.deleted){j.push({extraClass:"fa fa-thumb-tack unsticky",name:"Unsticky",func:this.template.sticky.bind(this,g)})}if(!g.outofdate&&!g.deleted){j.push({extraClass:"fa fa-warning",tooltip:WH.TERMS.reportingoptions_tip,name:WH.TERMS.report,func:ContactTool.show.bind(ContactTool,{mode:1,comment:g})})}b.html("");for(var i in j){var f=j[i];var e=$("<a></a>");var d=$("<span></span>");e.click(f.func);if(f.extraClass){e.addClass(f.extraClass)}if(f.tooltip){WH.Tooltip.simple(e.get(0),f.tooltip,"q2")}else{if(f.name){WH.Tooltip.simple(e.get(0),f.name,"q2")}}d.append(e);b.append(d)}},updateCommentBody:function(d,b){var c=WH.markup.rolesToClass(d.roles);b.empty();WH.Comments.appendImportedSubject(b,d.importedSubject);b.removeClass("comment-high-rating");b.addClass(WH.Comments.getColorClass(d));b.append(WH.markup.getDomFragment(d.body,{allow:c,mode:WH.markup.MODE.COMMENT,roles:d.roles,locale:d.locale,disabledEnvironments:d.markupDisabledEnvironments}));if(d.response){var a=$("<div></div>");a.addClass("text comment-body");a.empty().append(WH.markup.getDomFragment("[div][/div][wowheadresponse="+d.responseuser+" roles="+d.responseroles+"]"+d.response+"[/wowheadresponse]",{allow:WH.markup.CLASS.STAFF,roles:d.responseroles,uid:"resp-"+d.id,disabledEnvironments:d.markupDisabledEnvironments}));b.append(a)}if(d.lastEdit){this.template.addEditedByOrDeletedByText.call(this,b,WH.TERMS.lasteditedby_stc,d.lastEdit[2],d.lastEdit[0],d.dataTree)}if(d.deletedInfo){this.template.addEditedByOrDeletedByText.call(this,b,WH.TERMS.deletedby_stc,d.deletedInfo[1],d.deletedInfo[0],d.dataTree)}d.divBody=b[0]},addEditedByOrDeletedByText:function(f,g,h,a,e){var c=new Date(a);var b=(WH.getServerTime()-c)/1000;var d=$("<div></div>");d.addClass("comment-lastedit");d.html(WH.sprintf("$1 <a></a> $2"+(e===WH.dataTree.RETAIL?" $3":""),g,WH.formatDate(null,b,c),WH.sprintf(WH.TERMS.patchparens_format,WH.Wow.getVersionStringFromTimestamp(c,this.alternateVersions))));d.find("a").text(h).attr("href","/user="+h);f.append(d)},updateVoteCell:function(g){var b=g.voteCell.find(".upvote");var c=g.voteCell.find(".downvote");var f=g.voteCell.find(".rating-container");var a=$('<p class="rating"></p>');var d=this.template;f.html(a);var e=g.hasOwnProperty("langOverride")?g.langOverride:LANG;if(g.userRating>0){b.attr("data-hasvoted","true").attr("title",e.upvoted_tip)}else{b.attr("data-hasvoted","false").attr("title",e.upvote_tip)}if(g.userRating<0){c.attr("data-hasvoted","true").attr("title",e.downvoted_tip)}else{c.attr("data-hasvoted","false").attr("title",e.downvote_tip)}a.unbind();b.unbind();c.unbind();a.text(g.rating);a.click((function(){d.showVoteBreakdown.call(this,g,f)}).bind(this));b.click((function(){d.vote.call(this,g,1)}).bind(this));c.click((function(){d.vote.call(this,g,-1)}).bind(this))},vote:function(h,e){if(!e){return}var f=h.hasOwnProperty("langOverride")?h.langOverride:LANG;if(!g_user.id){this.template.voteError.call(this,h,f.votelogin_tip);return}if(h.deleted){this.template.voteError.call(this,h,f.votedeleted_tip);return}if(g_user.name==h.user){this.template.voteError.call(this,h,f.voteself_tip);return}if(!g_user.canUpvote&&e>0){this.template.voteError.call(this,h,WH.sprintf(f.upvotenorep_tip,g_user.upvoteRep));return}if(!g_user.canDownvote&&e<0){this.template.voteError.call(this,h,WH.sprintf(f.downvotenorep_tip,g_user.downvoteRep));return}if(e>0){e=g_user.superCommentVotes?2:1}else{if(e<0){e=g_user.superCommentVotes?-2:-1}else{return}}var g=h.rating;var c=h.userRating;var d=this.template;if((h.userRating>0&&e>0)||(h.userRating<0&&e<0)){h.rating-=h.userRating;h.userRating=0}else{h.rating-=h.userRating;h.rating+=e;h.userRating=e}d.updateVoteCell.call(this,h);var a=function(i){if(i.error){h.rating=g;h.userRating=c;d.updateVoteCell.call(this,h)}if(i.message){d.voteError.call(this,h,i.message)}};var b="/comment=vote";if(h.hasOwnProperty("voteUrl")){b=h.voteUrl}$.get(b,{id:h.id,rating:e},a.bind(this),"json")},voteError:function(b,a){MessageBox(b.voteCell,a)},showVoteBreakdown:function(c,b){b.find("p").html('<img src="'+WH.staticUrl+'/images/icons/ajax.gif" />');var a="/comment=rating";if(c.hasOwnProperty("ratingUrl")){a=c.ratingUrl}$.get(a+"&id="+c.id,null,function(d){if(d.success){b.html(WH.sprintf('<p class="rating-up">$1</p><div class="rating-separator"></div><p class="rating-down">$2</p>',(d.up?("+"+d.up):0),-d.down))}else{MessageBox(b,"An error has occurred while fetching vote counts. Try refreshing the page.")}},"json")},sticky:function(b){var a=b.commentCell.find(".comment-notification");b.sticky=!b.sticky;this.template.updateStickyStatus.call(this,b);this.template.updateCommentCell.call(this,b);if(b.sticky){MessageBox(a,"This comment is now sticky.")}else{MessageBox(a,"This comment is no longer sticky.")}$.post("/comment=sticky",{id:b.id,sticky:b.sticky?1:0})},createNote:function(l){var q=WH.ce("small");if(!g_user.commentban){var t=WH.ce("a");if(g_user.id>0){t.href="javascript:";t.onclick=co_addYourComment}else{t.href="/account=signin"}WH.ae(t,WH.ct(WH.TERMS.addyourcomment_stc));WH.ae(q,t);var p=WH.ce("span");p.style.padding="0 5px";p.style.color="white";WH.ae(p,WH.ct("|"));WH.ae(q,p)}WH.ae(q,WH.ct(WH.TERMS.sort+": "));var d=WH.ce("a");d.href="javascript:";WH.ae(d,WH.ct(WH.TERMS.newestfirst_lc));d.onclick=Listview.funcBox.coSortNewestFirst.bind(this,d);WH.ae(q,d);WH.ae(q,WH.ct(WH.TERMS.comma_punct));var c=WH.ce("a");c.href="javascript:";WH.ae(c,WH.ct(WH.TERMS.oldestfirst_lc));c.onclick=Listview.funcBox.coSortOldestFirst.bind(this,c);WH.ae(q,c);WH.ae(q,WH.ct(WH.TERMS.comma_punct));var b=WH.ce("a");b.href="javascript:";WH.ae(b,WH.ct(WH.TERMS.highestrated_lc));b.onclick=Listview.funcBox.coSortHighestRatedFirst.bind(this,b);WH.ae(q,b);var s=WH.getCookies()["comments_sort"];switch(s){case"1":d.onclick();break;case"2":c.onclick();break;default:case"3":b.onclick();break}if(!this.alternateVersions){var o=WH.ce("span");o.style.padding="0 5px";o.style.color="white";WH.ae(o,WH.ct("|"));WH.ae(q,o);var m=WH.ce("select");var k=WH.ce("option");k.value=0;k.selected="selected";WH.ae(m,k);var g={};var f={};for(var u=0,v=this.data.length;u<v;u++){if(this.data[u].dataTree!==WH.dataTree.RETAIL){f[this.data[u].dataTree]=true;continue}var r=WH.Wow.getPatchVersionObject(new Date(this.data[u].date).getTime());if(r){g[r.build]=r}}var j=[];for(var n in g){j.push(n)}j.sort(function(x,w){return w-x});for(var e in f){if(!f.hasOwnProperty(e)){continue}var k=WH.ce("option");k.value="-"+e;WH.ae(k,WH.ct(WH.TERMS[WH.dataTreeTerm[e]]));WH.ae(m,k)}for(var i=0,h=j.length;i<h;i++){var k=WH.ce("option");k.value=g[j[i]].timestamp;WH.ae(k,WH.ct(g[j[i]].version));WH.ae(m,k)}m.onchange=Listview.funcBox.coFilterByPatchVersion.bind(this,m);WH.ae(q,WH.ct(WH.TERMS.filterbypatch_colon));WH.ae(q,m)}WH.ae(l,q);if(this.tabClick){$("a, select",q).click(this.tabClick)}},onNoData:function(c){var a="<b>"+WH.TERMS.nocomments_tip+'</b><div class="pad2"></div>';if(g_user.id>0){var b=WH.TERMS.commentfirst_tip;b=b.replace("<a>",'<a href="javascript:" onclick="co_addYourComment()" onmousedown="return false">');a+=b}else{a+=WH.term("commentlogin_tip",'<a href="'+WH.Url.getLoginPath(location.pathname+location.search+location.hash)+'">',"</a>",'<a href="'+WH.Url.getRegistrationPath()+'">',"</a>")}c.style.padding="1.5em 0";c.innerHTML=a},onBeforeCreate:function(){if(location.hash&&location.hash.match(/:id=([0-9]+)/)!=null){var a=WH.getCookies()["comments_sort"];switch(a){case"1":this.setSort([-5,4,-1,-2],false,false);break;case"2":this.setSort([-5,4,1,2],false,false);break;default:case"3":this.setSort([-5,4,-3,2],false,false);break}var b=WH.inArray(this.data,parseInt(RegExp.$1),function(c){return c.id});this.rowOffset=this.getRowOffset(b);return this.data[b]}},onAfterCreate:function(a){if(a!=null){var b=a.__div;this.tabs.__st=b}}};